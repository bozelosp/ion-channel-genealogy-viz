NEURON{SUFFIXCa_HVAUSEIONcaREADecaWRITEicaRANGEgbar,g,ica}UNITS{(S)=(siemens)(mV)=(millivolt)(mA)=(milliamp)}PARAMETER{gbar=0.00001(S/cm2)}ASSIGNED{v(mV)eca(mV)ica(mA/cm2)g(S/cm2)mInfmTaumAlphamBetahInfhTauhAlphahBeta}STATE{mh}BREAKPOINT{SOLVEstatesMETHODcnexpg=gbar*m*m*hica=g*(v-eca)}DERIVATIVEstates{rates()m'=(mInf-m)/mTauh'=(hInf-h)/hTau}INITIAL{rates()m=mInfh=hInf}PROCEDURErates(){UNITSOFFmAlpha=0.055*vtrap(-27-v,3.8)mBeta=(0.94*exp((-75-v)/17))mInf=mAlpha/(mAlpha+mBeta)mTau=1/(mAlpha+mBeta)hAlpha=(0.000457*exp((-13-v)/50))hBeta=(0.0065/(exp((-v-15)/28)+1))hInf=hAlpha/(hAlpha+hBeta)hTau=1/(hAlpha+hBeta)UNITSON}FUNCTIONvtrap(x,y){UNITSOFFif(fabs(x/y)<1e-6){vtrap=y*(1-x/y/2)}else{vtrap=x/(exp(x/y)-1)}UNITSON}