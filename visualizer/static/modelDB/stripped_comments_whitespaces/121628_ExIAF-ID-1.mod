UNITS{(mV)=(millivolt)(mA)=(milliamp)}INDEPENDENT{tFROM0TO1WITH1(ms)}NEURON{SUFFIXExIAFNONSPECIFIC_CURRENTiGLOBALspikedur,refact,tauAHP,eAHP,gAHPbarRANGEThr,lastspikeRANGEgPAS,ePAS,gAHP,AHPon,gON,gOFF,eON,eOFFRANGESetCa,AvgCa,Ca,tauDCCa,Gain,PlasThrRANGEScaleFactor,InductionGLOBALSCALEGLOBALtstop}PARAMETER{vi(mA/cm2)gPAS=0.001(mho/cm2)ePAS=-60(mV)ePASconst=-60Thr=-40(mv)ThrConst=-40spikedur=1(ms)refact=2.0(ms)gONconst=1(mho/cm2)gOFFconst=1(mho/cm2)eON=40(mV)eOFF=-60(mV)tauAHP=0.1(/ms)gAHPbar=0.00005(mho/cm2)eAHP=-90(mv)SetCa=1tauDCCa=10tstopSCALE=1}ASSIGNED{lastspikegAHP(mho/cm2)AHPongON(mho/cm2)gOFF(mho/cm2)CaAvgCaPlasThrGainScaleFactorInduction}INITIAL{ePAS=ePASconstgAHP=0AHPon=-9e4gON=0gOFF=0lastspike=-9e4Ca=0Induction=0}BREAKPOINT{SOLVEupdatei=gPAS*(v-ePAS)+gAHP*(v-eAHP)+gON*(v-eON)+gOFF*(v-eOFF)}PROCEDUREupdate(){LOCALq,dvgON=0gOFF=0q=(t-lastspike)-spikedurif(q>refact){if(v>Thr){gON=gONconstlastspike=tCa=Ca+1}}elseif(q<0){gON=gONconst}elseif(v>0){gOFF=gOFFconstgAHP=gAHP+gAHPbarAHPon=t}gAHP=gAHP-gAHP*tauAHP*dtif(t>(tstop-(2*dt)+dt/2)){if(Induction==0&&SCALE!=0){SOLVEINDUCTION}}}PROCEDUREINDUCTION(){AvgCa=AvgCa+(Ca-AvgCa)/tauDCCaPlasThr=(AvgCa^2)/SetCaGain=(Ca-PlasThr)ScaleFactor=1+(0.05*(SetCa-AvgCa)/(SetCa+AvgCa))*SCALEInduction=1}