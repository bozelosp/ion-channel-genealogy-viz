UNITS{(mA)=(milliamp)(mV)=(millivolt)}NEURON{THREADSAFESUFFIXKD_caUSEIONcaREADcaiUSEIONkREADekWRITEikRANGEgmax,g,taun,taul,kD_ca,lGLOBALtnmax,tlmax,tauc}PARAMETER{gmax=0.01(mho/cm2)vhalfn=-48(mV)vn2=-62(mV)zn=5.5(mV)tnmax=150(us)tnmin=3.0(ms)tns=-7.0(mV)vhalfl=-61.5(mV)zl=-3.0(mV)tlmax=850(ms)tlmin=20(ms)tauc=30(ms)vl2=-66tls=19(mV)kD_ca=0.0001(mM)lcp=4}STATE{nlvlc}ASSIGNED{v(mV)ek(mV)cai(mM)ik(mA/cm2)lninflinflcinftaultaung(S/cm2)}BREAKPOINT{SOLVEstatesMETHODcnexpl=lc*0.4+lv*0.6g=gmax*n*lik=g*(v-ek)}INITIAL{rates(v)n=ninflv=linflci(cai)lc=lcinfl=lc*0.4+lv*0.6}FUNCTIONalpn(v(mV)){alpn=exp((vhalfn-v)/zn)}FUNCTIONbetn(v(mV)){betn=exp((vn2-v)/tns)}FUNCTIONalpl(v(mV)){alpl=exp((vhalfl-v)/zl)}DERIVATIVEstates{rates(v)n'=(ninf-n)/taunlv'=(linf-lv)/(taul*(lc+0.4)/1.4)lci(cai)lc'=(lcinf-lc)/tauc}PROCEDURErates(v(mV)){LOCALaTABLEninf,taun,linf,taulDEPENDtlmax,tnmaxFROM-100TO50WITH1500a=alpn(v)ninf=1/(1+a)taun=4*(tnmax-tnmin)/(1+betn(v))*ninf+tnmina=alpl(v)linf=(1/(1+a))taul=2*tlmax/(exp((v-vl2)/tls)+exp((vl2-v)/tls))+tlmin}PROCEDURElci(cai(mM)){TABLElcinfDEPENDlcp,kD_caFROM0TO0.01WITH1000lcinf=(1-cai/(cai+kD_ca))^lcp}