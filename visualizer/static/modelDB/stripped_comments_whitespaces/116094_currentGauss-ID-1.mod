INDEPENDENT{tFROM0TO1WITH1(ms)}NEURON{POINT_PROCESScurrent_gaussNONSPECIFIC_CURRENTinRANGEdel,durRANGEinRANGErandRANGEmean,std0,stdRANGEf0RANGEN_smoothRANGEcountRANGEnoise_seedRANGEtau_fRANGEindic_max,indic_sim,indic_kern}UNITS{(nA)=(nanoamp)(mV)=(millivolt)}PARAMETER{del=0(ms)dur=100(ms)<0,1e9>dt=0.01(ms)mean=0(nA)std0=1e-4(nA)std=1e-4noise_seed=1f0=4000(1/s)tau_f=5(ms)t_kern=20(ms)t_sim=1000(ms)}ASSIGNED{v(mV)in(nA)in_temp(nA)randcountN_smoothnoise[29000]filter[1000]current[28000]indic_kernindic_simindic_maxuucurrent_totalnoise_totalcurrent_meannoise_meancurrent_varnoise_varpower_ratio}PROCEDUREseed(x){set_seed(x)}LOCALu,wBREAKPOINT{if(t<del+dur-.1&&t>=del){if(count/N_smooth==1){in=-current[uu]uu=uu+1count=0}else{count=count+1}}else{in=0}}INITIAL{N_smooth=floor(1000/f0/dt)*2std=std0/sqrt(4000/f0)rand=normrand(mean,std)in=-randcount=0uu=0w=0u=0power_ratio=0indic_kern=t_kern*f0/1000indic_sim=dur*f0/1000indic_max=indic_sim+indic_kernFROMu=0TOindic_kern-1{filter[u]=exp(-u*(1000/f0)/tau_f)}FROMu=0TOindic_max-1{noise[u]=normrand(mean,std)}FROMu=0TOindic_sim-1{current[u]=0FROMw=0TOindic_kern-1{current[u]=current[u]+noise[w+u]*filter[indic_kern-w-1]}}current_total=0noise_total=0FROMu=0TOindic_sim-1{current_total=current_total+current[u]noise_total=noise_total+noise[u]}current_mean=current_total/(dur*f0/1000)noise_mean=noise_total/(dur*f0/1000)printf("current_mean=%g\n",current_mean)printf("noise_mean=%g\n",noise_mean)current_var=0noise_var=0FROMu=0TOindic_sim-1{current_var=current_var+pow(current[u]-current_mean,2)noise_var=noise_var+pow(noise[u]-noise_mean,2)}current_var=current_var/(dur*f0/1000)noise_var=noise_var/(dur*f0/1000)power_ratio=current_var/noise_varFROMu=0TOindic_sim-1{current[u]=(current[u]-current_mean+noise_mean)/sqrt(current_var/noise_var)}count=0}UNITSON