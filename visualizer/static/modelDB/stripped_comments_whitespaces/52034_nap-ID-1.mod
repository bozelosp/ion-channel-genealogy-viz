PARAMETER{erev=45(mV)gmax=0.1(umho)mvalence=4.3mgamma=0.7mbaserate=4.2mvhalf=-40mbasetau=0.1mtemp=37mq10=3mexp=3hvalence=-6hgamma=0.5hbaserate=0.2hvhalf=-50hbasetau=4htemp=37hq10=3hexp=1cao(mM)cai(mM)celsius=37(degC)dt(ms)v(mV)vmax=50(mV)vmin=-100(mV)}PROCEDUREiassign(){i=g*(v-erev)ina=i}INDEPENDENT{tFROM0TO1WITH1(ms)}NEURON{SUFFIXnapUSEIONnaWRITEinaUSEIONkWRITEikUSEIONcaREADcao,caiWRITEicaRANGEgmax,g,i,mbaserateGLOBALerev,Inf,Tau,Mult,Add,vmin,vmax}CONSTANT{FARADAY=96489.0R=8.31441}UNITS{(mA)=(milliamp)(mV)=(millivolt)(umho)=(micromho)}ASSIGNED{i(mA/cm^2)ica(mA/cm^2)ina(mA/cm^2)ik(mA/cm^2)g(mho/cm^2)Inf[2]Tau[2]Mult[2]Add[2]}STATE{mh}INITIAL{mh(v)if(usetable==0){m=Inf[0]h=Inf[1]}else{m=Add[0]/(1-Mult[0])h=Add[1]/(1-Mult[1])}}BREAKPOINT{LOCALhexp_val,index,mexp_valSOLVEstateshexp_val=1mexp_val=1if(hexp>0){FROMindex=1TOhexp{hexp_val=h*hexp_val}}if(mexp>0){FROMindex=1TOmexp{mexp_val=m*mexp_val}}g=gmax*mexp_val*hexp_valiassign()}PROCEDUREstates(){mh(v*1(/mV))m=m*Mult[0]+Add[0]h=h*Mult[1]+Add[1]VERBATIMreturn0;ENDVERBATIM}PROCEDUREmh(v){LOCALa,b,j,mqq10,hqq10TABLEAdd,MultDEPENDdt,hbaserate,hbasetau,hexp,hgamma,htemp,hvalence,hvhalf,mbaserate,mbasetau,mexp,mgamma,mtemp,mvalence,mvhalf,celsius,mq10,hq10,vmin,vmaxFROMvminTOvmaxWITH200mqq10=mq10^((celsius-mtemp)/10.)hqq10=hq10^((celsius-htemp)/10.)FROMj=0TO1{a=alpha(v,j)b=beta(v,j)Inf[j]=a/(a+b)VERBATIMswitch(_lj){case0:if((Tau[_lj]=1/(_la+_lb))<mbasetau){Tau[_lj]=mbasetau;}Tau[_lj]=Tau[_lj]/_lmqq10;break;case1:if((Tau[_lj]=1/(_la+_lb))<hbasetau){Tau[_lj]=hbasetau;}Tau[_lj]=Tau[_lj]/_lhqq10;if(hexp==0){Tau[_lj]=1.;}break;}ENDVERBATIMMult[j]=exp(-dt/Tau[j])Add[j]=Inf[j]*(1.-exp(-dt/Tau[j]))}}FUNCTIONalpha(v,j){if(j==1){if(hexp==0){alpha=1}else{alpha=hbaserate*exp((v-hvhalf)*hvalence*hgamma*FRT(htemp))}}else{alpha=mbaserate*exp((v-mvhalf)*mvalence*mgamma*FRT(mtemp))}}FUNCTIONbeta(v,j){if(j==1){if(hexp==0){beta=1}else{beta=hbaserate*exp((-v+hvhalf)*hvalence*(1-hgamma)*FRT(htemp))}}else{beta=mbaserate*exp((-v+mvhalf)*mvalence*(1-mgamma)*FRT(mtemp))}}FUNCTIONFRT(temperature){FRT=FARADAY*0.001/R/(temperature+273.15)}FUNCTIONghkca(v){LOCALnu,efunnu=v*2*FRT(celsius)if(fabs(nu)<1.e-6){efun=1.-nu/2.}else{efun=nu/(exp(nu)-1.)}ghkca=-FARADAY*2.e-3*efun*(cao-cai*exp(nu))}