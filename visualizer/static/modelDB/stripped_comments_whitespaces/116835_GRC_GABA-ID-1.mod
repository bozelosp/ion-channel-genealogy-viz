NEURON{POINT_PROCESSGRC_GABANONSPECIFIC_CURRENTiRANGEg,Cdur,Erev,Open,OpenScaled,ScaleFactorRANGEkon,koff,d3,r3,d1d2,r1r2,a1,b1,a2,b2,r1,r2,d1,d2RANGETmax,gmax,onSETRANGEtau_1,tau_rec,tau_facil,U,TRANGEdiff_flag,M,Rd,Diff,lamdRANGEnd}UNITS{(nA)=(nanoamp)(mV)=(millivolt)(umho)=(micromho)(mM)=(milli/liter)(pS)=(picosiemens)PI=(pi)(1)}PARAMETER{gmax=756.35(pS)Cdur=0.3(ms)kon=20(/ms/mM)koff=2(/ms)d3=15(/ms)r3=3.75(/ms)d1d2=15(/ms/mM)r1r2=0.007(/ms)a1=0.06(/ms)b1=0.03(/ms)a2=0.4(/ms)b2=10(/ms)r1=7e-4(/ms)r2=6e-3(/ms)d1=3.3e-4(/ms)d2=1.2(/ms)Erev=-65(mV)tau_1=0.1(ms)<1e-9,1e9>tau_rec=43.4(ms)<1e-9,1e9>tau_facil=6.22(ms)<0,1e9>U=0.35<0,1>Tmax=1(mM)onSET=1M=52.76Rd=4.79(um)Diff=0.223(um2/ms)lamd=20(nm)diff_flag=1nd=1ScaleFactor=1}ASSIGNED{v(mV)i(nA)g(pS)OpenOpenScaledT(mM)Trelease(mM)Mres(mM)tpre(ms)tspike[50](ms)PRE[50]numpulsestzero}STATE{CCA1CA2DA1DA2DA2fOA1OA2}INITIAL{C=1CA1=0CA2=0DA1=0DA2=0DA2f=0OA1=0OA2=0CA1=0CA2=0Open=0T=0(mM)numpulses=0Mres=1e3*(1e3*1e15/6.022e23*M)FROMi=1TO50{PRE[i-1]=0tspike[i-1]=0}tspike[0]=1e12(ms)if(tau_1>=tau_rec){printf("Warningtau_rec=tau_1+1e-5}}FUNCTIONdiffusione(){LOCALDifWave,iDifWave=0FROMi=1TOnumpulses{tzero=tspike[i-1]if(t>tzero){DifWave=DifWave+PRE[i-1]*Mres*exp(-Rd*Rd/(4*Diff*(t-tzero)))/((4*PI*Diff*(1e-3)*lamd)*(t-tzero))^nd}}diffusione=DifWave}BREAKPOINT{SOLVEkstatesMETHODsparseOpen=OA1+OA2OpenScaled=Open*ScaleFactorg=gmax*Openi=(1e-6)*g*(v-Erev)}KINETICkstates{if(diff_flag){Trelease=T+diff_flag*diffusione()}else{Trelease=T}~C<->CA1(2*kon*Trelease,koff)~CA1<->CA2(kon*Trelease,2*koff)~CA2<->DA2f(d3,r3)~DA1<->DA2(d1d2*Trelease,r1r2)~OA1<->CA1(a1,b1)~OA2<->CA2(a2,b2)~DA1<->CA1(r1,d1)~DA2<->CA2(r2,d2)CONSERVEC+CA1+CA2+DA1+DA2+DA2f+OA1+OA2=1}NET_RECEIVE(weight,on,nspike,tzero(ms),x,y,z,u,tsyn(ms)){INITIAL{x=0y=0z=0u=0tsyn=tnspike=1}if(onSET){on=0onSET=0}if(flag==0){nspike=nspike+1if(!on){tzero=ttpre=ton=1z=z*exp(-(t-tsyn)/tau_rec)z=z+(y*(exp(-(t-tsyn)/tau_1)-exp(-(t-tsyn)/tau_rec))/((tau_1/tau_rec)-1))y=y*exp(-(t-tsyn)/tau_1)x=1-y-zif(tau_facil>0){u=u*exp(-(t-tsyn)/tau_facil)u=u+U*(1-u)}else{u=U}y=y+x*uT=Tmax*yPRE[numpulses]=ytspike[numpulses]=tnumpulses=numpulses+1tsyn=t}net_send(Cdur,nspike)}if(flag==nspike){T=0on=0}}