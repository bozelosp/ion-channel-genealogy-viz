UNITS{(mA)=(milliamp)(mV)=(millivolt)(S)=(siemens)(mS)=(millisiemens)}NEURON{THREADSAFESUFFIXgCaUSEIONcaREADecaWRITEicaRANGEgmax,g,iGLOBALrss}PARAMETER{gmax=0.004(mho/cm2)rss=0(1)}STATE{sr}ASSIGNED{v(mV)eca(mV)ica(mA/cm2)s_inf(1)r_inf(1)tau_s(ms)tau_r(ms)g(S/cm2)i(mA/cm2)}BREAKPOINT{SOLVEstatesMETHODcnexpif(rss==1){g=gmax*s^2}else{g=gmax*s^2*r}i=g*(v-eca)ica=i}INITIAL{rates(v)s=s_infr=r_inf}FUNCTIONalpha_s(v(mV)){alpha_s=1.6/(1+exp(-0.072*(v-65)))}FUNCTIONbeta_s(v(mV)){beta_s=0.02*(v-51.1)/(exp((v-51.1)/5)-1)}FUNCTIONalpha_r(v(mV)){if(v<=0){alpha_r=0.005}else{alpha_r=exp(-v/20)/200}}FUNCTIONbeta_r(v(mV)){if(v<=0){beta_r=0}else{beta_r=0.005-exp(-v/20)/200}}DERIVATIVEstates{rates(v)s'=(s_inf-s)/tau_sr'=(r_inf-r)/tau_r}PROCEDURErates(v(mV)){LOCALalpha,betaTABLEs_inf,tau_s,r_inf,tau_rFROM-20TO130WITH750alpha=alpha_s(v)beta=beta_s(v)tau_s=1/(alpha+beta)s_inf=alpha*tau_salpha=alpha_r(v)beta=beta_r(v)tau_r=1/(alpha+beta)r_inf=alpha*tau_r}