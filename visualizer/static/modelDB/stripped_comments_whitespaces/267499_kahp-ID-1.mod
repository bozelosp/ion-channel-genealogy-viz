NEURON{SUFFIXkahpUSEIONkREADekWRITEikUSEIONcaREADcaiRANGEgkahp,ik,m}UNITS{(molar)=(1/liter)(mV)=(millivolt)(mA)=(milliamp)(mM)=(millimolar)FARADAY=96485.309(coul/mole)PI=(pi)(1)}INDEPENDENT{tFROM0TO1WITH100(ms)}PARAMETER{gkahp=0.00005(mho/cm2)}ASSIGNED{ik(mA/cm2)alpha(/ms)beta(/ms)v(mV)ek(mV)cai(mM)}STATE{m}BREAKPOINT{SOLVEstatesMETHODcnexpik=gkahp*m*(v-ek)}INITIAL{rates(cai)m=alpha/(alpha+beta)ik=gkahp*m*(v-ek)}DERIVATIVEstates{rates(cai)m'=alpha*(1-m)-beta*m}PROCEDURErates(chi(mM)){if(cai<5e-5){cai=5e-5}if(cai<=5.5e-5){alpha=(cai-5e-5)*1e-2*2e5}else{alpha=1e-2}beta=1e-2}