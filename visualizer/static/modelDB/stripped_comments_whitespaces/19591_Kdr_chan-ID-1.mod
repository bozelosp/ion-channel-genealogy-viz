UNITS{(mA)=(milliamp)(mV)=(millivolt)}NEURON{SUFFIXkdr_chanRANGEgbar,iNONSPECIFIC_CURRENTiGLOBALe,minf,hinf,am,bm,cm,dm,taum_min,a1h,b1h,c1h,d1h,e1h,a2h,b2h,c2h,tauh_min}INDEPENDENT{tFROM0TO1WITH1(ms)}PARAMETER{v(mV)dt(ms)e=-90(mV)gbar=1.939e-2(mho/cm2)am=0.17bm=0.091cm=0.8dm=-38taum_min=1e-3a1h=0.76e-3b1h=0.7e-3c1h=6e-5d1h=-0.08e1h=-46a2h=110e-5b2h=-0.0807c2h=78tauh_min=150}STATE{mh}ASSIGNED{i(mA/cm2)minfhinf}LOCALmexp,hexpBREAKPOINT{SOLVEstatesi=gbar*m*m*m*m*h*(v-e)}UNITSOFFINITIAL{rates(v)m=minfh=hinf}PROCEDUREstates(){rates(v)m=m+mexp*(minf-m)h=h+hexp*(hinf-h)VERBATIMreturn0;ENDVERBATIM}PROCEDURErates(v){LOCALtau,alpha,betaTABLEminf,mexp,hinf,hexpDEPENDdtFROM-100TO100WITH2000alpha=am*exp(bm*cm*(v-dm))beta=am*exp(-bm*(1-cm)*(v-dm))tau=1/(alpha+beta)minf=alpha*tauif(tau<taum_min){tau=taum_min}mexp=1-exp(-dt/tau)if(v>e1h){alpha=a1h}else{alpha=b1h+c1h*exp(d1h*(v-e1h))}beta=a2h/(1+exp(b2h*(v+c2h)))tau=1/(alpha+beta)hinf=alpha*tauif(tau<tauh_min){tau=tauh_min}hexp=1-exp(-dt/tau)}UNITSON