UNITS{(mA)=(milliamp)(mV)=(millivolt)(molar)=(1/liter)(mM)=(millimolar)FARADAY=96520(coul)R=8.3134(joule/degC)KTOMV=.0853(mV/degC)}PARAMETER{v(mV)celsius=25(degC)gcatbar=.003(mho/cm2)cao=2(mM)q10=5mmin=0.2hmin=10a0h=0.015zetah=3.5vhalfh=-75gmh=0.6a0m=0.04zetam=2vhalfm=-28gmm=0.61vhm=-60vhh=-85mfactor=1hfactor=1}NEURON{SUFFIXcatUSEIONcaREADcai,caoWRITEicaRANGEgcatbar,ica,gcat,vhm,vhh,mtau,htauGLOBALhinf,minf}STATE{mh}ASSIGNED{ica(mA/cm2)gcat(mho/cm2)hinfhtauminfmtaucai(mM)}INITIAL{cai=50e-6rates(v)m=minfh=hinf}BREAKPOINT{SOLVEstatesMETHODcnexpgcat=gcatbar*m*m*hica=gcat*ghk(v,cai,cao)}DERIVATIVEstates{rates(v)m'=(minf-m)/mtauh'=(hinf-h)/htau}FUNCTIONghk(v(mV),ci(mM),co(mM))(mV){LOCALnu,ff=KTF(celsius)/2nu=v/fghk=-f*(1.-(ci/co)*exp(nu))*efun(nu)}FUNCTIONKTF(celsius(DegC))(mV){KTF=((25./293.15)*(celsius+273.15))}FUNCTIONefun(z){if(fabs(z)<1e-4){efun=1-z/2}else{efun=z/(exp(z)-1)}}FUNCTIONalph(v(mV)){alph=exp(0.0378*zetah*(v-vhalfh))}FUNCTIONbeth(v(mV)){beth=exp(0.0378*zetah*gmh*(v-vhalfh))}FUNCTIONalpmt(v(mV)){alpmt=exp(0.0378*zetam*(v-vhalfm))}FUNCTIONbetmt(v(mV)){betmt=exp(0.0378*zetam*gmm*(v-vhalfm))}PROCEDURErates(v(mV)){LOCALa,b,qtqt=q10^((celsius-25)/10)minf=(1/(1+exp(-(v-vhm)/10)))mtau=mfactor*(betmt(v)/(qt*a0m*(1+alpmt(v))))if(mtau<mmin){mtau=mmin}hinf=(1/(1+exp((v-vhh)/10)))htau=hfactor*(beth(v)/(a0h*(1+alph(v))))if(htau<hmin){htau=hmin}}