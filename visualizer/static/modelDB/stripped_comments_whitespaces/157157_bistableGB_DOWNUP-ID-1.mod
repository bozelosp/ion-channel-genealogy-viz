INDEPENDENT{tFROM0TO1WITH1(ms)}NEURON{SUFFIXBistableGBdownupUSEIONcaREADcaiRANGEpDOWN,pUP,pDOWN0,pUP0,C1,tau,ps,gp,gd,thp,thd,tp,td,beta,w0,w1,b,weight}UNITS{(nA)=(nanoamp)(mV)=(millivolt)(pS)=(picosiemens)(umho)=(micromho)(mM)=(milli/liter)(uM)=(micro/liter)}PARAMETER{pDOWN0=0(1)pUP0=1(1)tau=700000(ms)ps=0.5(1)gp=1600(1)gd=300(1)thp=1.3(uM)thd=1.0(uM)tp=20000(ms)td=20000(ms)beta=0.5(1)w0=0.5(1)w1=1.5(1)}ASSIGNED{cai(mM)C1(uM)b(1)weight(1)}STATE{pDOWNpUP}INITIAL{pDOWN=pDOWN0pUP=pUP0b=w1/w0weight=(((1-wpDOWN(pDOWN))*beta+wpUP(pUP)*(1-beta))+b*(wpDOWN(pDOWN)*beta+(1-wpUP(pUP))*(1-beta)))/(beta+(1-beta)*b)}BREAKPOINT{SOLVEstatesMETHODeulerweight=(((1-wpDOWN(pDOWN))*beta+wpUP(pUP)*(1-beta))+b*(wpDOWN(pDOWN)*beta+(1-wpUP(pUP))*(1-beta)))/(beta+(1-beta)*b)}DERIVATIVEstates{C1=1000*caipDOWN'=(-pDOWN*(1-pDOWN)*(ps-pDOWN)+gp*(1-pDOWN)*heavi(C1-thp)-gd*pDOWN*heavi(C1-thd))/taupUP'=(-pUP*(1-pUP)*(ps-pUP)+gp*(1-pUP)*heavi(C1-thp)-gd*pUP*heavi(C1-thd))/tau}FUNCTIONheavi(x(uM))(1){heavi=0if(x>0){heavi=1}}FUNCTIONwpUP(x)(1){wpUP=0if(x<=0.5){wpUP=1}}FUNCTIONwpDOWN(x)(1){wpDOWN=0if(x>=0.5){wpDOWN=1}}