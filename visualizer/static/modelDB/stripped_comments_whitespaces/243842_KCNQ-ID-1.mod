NEURON{SUFFIXKCNQUSEIONkREADekWRITEikRANGEgbar,ik,ap,vhalfl,k1,mt,ht,vhalf2,k2,ahGLOBALhinf,htau,iinf,itau,q10}UNITS{(mA)=(milliamp)(mV)=(millivolt)}PARAMETER{v(mV)ekgbar=0.009(mho/cm2)vhalfl=7.1(mV)kl=-15vhalf2=-54.5(mV)k2=9celsius(degC)q10=2.3ap=2ah=1mt=1ht=10}STATE{hi}ASSIGNED{ik(mA/cm2)iinfitauhinfhtau}INITIAL{rate(v)h=hinfi=iinfiinf=0.5}BREAKPOINT{SOLVEstateMETHODcnexpik=gbar*h^ap*i^ah*(v-ek)}DERIVATIVEstate{rate(v)i'=(iinf-i)/itauh'=(hinf-h)/htau}PROCEDURErate(v(mV)){LOCALa,qt,bqt=q10^((celsius-37)/10)hinf=(1/(1+exp((v-vhalfl)/kl)))iinf=(0.55/(1+exp((v-vhalf2)/k2)))+0.45htau=mt*(1/(1+(((v+15)/20)^2)))/qtitau=ht*(200+(10/(1+(((v+54.18)/120)^5))))/qt}FUNCTIONtrap0(v,th,a,q){if(fabs(v-th)>1e-6){trap0=a*(v-th)/(1-exp(-(v-th)/q))}else{trap0=a*q}}