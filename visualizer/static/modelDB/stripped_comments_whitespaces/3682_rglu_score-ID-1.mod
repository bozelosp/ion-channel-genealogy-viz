VERBATIMstaticcharrcsid[]="$Id:rglu_score.mod,v1.42000/08/1422:21:27karchieExp$";externdoubleexprand(doublemean);ENDVERBATIMINDEPENDENT{tFROM0TO1WITH1(ms)}NEURON{POINT_PROCESSrGluScRANGEC,gp_NMDA,lastrelease,score,idx,phase,mean_ia_time,gmax_NMDA,R_NMDA,R0_NMDA,R1_NMDA,gp_AMPA,gmax_AMPA,R_AMPA,R0_AMPA,R1_AMPANONSPECIFIC_CURRENTiGLOBALCmax,Cdur,Deadtime,score_thresh,score_tau,Alpha_NMDA,Beta_NMDA,Erev_NMDA,Rinf_NMDA,Rtau_NMDA,Alpha_AMPA,Beta_AMPA,Erev_AMPA,Rinf_AMPA,Rtau_AMPA}UNITS{(nA)=(nanoamp)(mV)=(millivolt)(umho)=(micromho)(mM)=(milli/liter)}PARAMETER{dt(ms)Cmax=1(mM)Cdur=1.1(ms)Deadtime=0(ms)phase=0mean_ia_time=100(ms)Alpha_NMDA=10(/msmM)Beta_NMDA=0.0125(/ms)Alpha_AMPA=10(/msmM)Beta_AMPA=0.5(/ms)Erev_NMDA=0(mV)Erev_AMPA=0(mV)gmax_NMDA(umho)gmax_AMPA(umho)score_thresh=-63(mV)score_tau=20(ms)eta=0.33(/mM)mag=1(mM)gamma=0.06(/mV)}ASSIGNED{v(mV)i(nA)gp_NMDA(umho)gp_AMPA(umho)depol(mV)C(mM)R_NMDAR0_NMDAR1_NMDAR_AMPAR0_AMPAR1_AMPARinf_NMDARtau_NMDA(ms)Rinf_AMPARtau_AMPA(ms)lastrelease(ms)ia_time(ms)scorescore_postsyn_actidx}INITIAL{C=0R_NMDA=0R1_NMDA=R_NMDAR_AMPA=0R1_AMPA=R_AMPARinf_NMDA=Cmax*Alpha_NMDA/(Cmax*Alpha_NMDA+Beta_NMDA)Rtau_NMDA=1/((Alpha_NMDA*Cmax)+Beta_NMDA)Rinf_AMPA=Cmax*Alpha_AMPA/(Cmax*Alpha_AMPA+Beta_AMPA)Rtau_AMPA=1/((Alpha_AMPA*Cmax)+Beta_AMPA)score=0score_postsyn_act=0VERBATIMassert(phase<1.0);if(phase<0.0){assert(mean_ia_time>0.0);}else{assert(mean_ia_time>Cdur+Deadtime);}ENDVERBATIMif(phase<0.0){lastrelease=t-next_ia_time()ia_time=next_ia_time()}else{ia_time=mean_ia_timelastrelease=t-phase*mean_ia_time}}BREAKPOINT{SOLVEreleasegp_AMPA=gmax_AMPA*R_AMPAgp_NMDA=(gmax_NMDA*R_NMDA)/(1+eta*mag*exp(-(gamma*v)))i=gp_AMPA*(v-Erev_AMPA)+gp_NMDA*(v-Erev_NMDA)depol=v-score_threshif(depol<0){depol=0}score_postsyn_act=score_postsyn_act+dt*(depol-score_postsyn_act)/score_tauscore=score+dt*gp_NMDA*score_postsyn_act}PROCEDURErelease(){LOCALqq=t-lastreleaseif(q>=ia_time){C=CmaxR0_NMDA=R_NMDAR0_AMPA=R_AMPAlastrelease=tia_time=next_ia_time()}elseif(q<Cdur){}elseif(C==Cmax){R1_NMDA=R_NMDAR1_AMPA=R_AMPAC=0.}if(C>0){R_NMDA=Rinf_NMDA+(R0_NMDA-Rinf_NMDA)*exptable(-(t-lastrelease)/Rtau_NMDA)R_AMPA=Rinf_AMPA+(R0_AMPA-Rinf_AMPA)*exptable(-(t-lastrelease)/Rtau_AMPA)}else{R_NMDA=R1_NMDA*exptable(-Beta_NMDA*(t-(lastrelease+Cdur)))R_AMPA=R1_AMPA*exptable(-Beta_AMPA*(t-(lastrelease+Cdur)))}VERBATIMreturn0;ENDVERBATIM}FUNCTIONnext_ia_time(){if(phase<0.0){next_ia_time=0while(next_ia_time<=Cdur+Deadtime){VERBATIM_lnext_ia_time=exprand(mean_ia_time);ENDVERBATIM}}else{next_ia_time=mean_ia_time}}FUNCTIONexptable(x){TABLEFROM-10TO10WITH2000if((x>-10)&&(x<10)){exptable=exp(x)}else{exptable=0.}}