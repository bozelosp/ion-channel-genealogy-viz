NEURON{POINT_PROCESSExp4NMDANONSPECIFIC_CURRENTiRANGEtau1,tau2,wtau2,tau3,tauV,e,i,gVI,gVDst,gVDv0,Mg,K0,delta,tp,wfGLOBALinfTHREADSAFE}UNITS{(nA)=(nanoamp)(mV)=(millivolt)(uS)=(microsiemens)(mM)=(milli/liter)(S)=(siemens)(pS)=(picosiemens)(um)=(micron)(J)=(joules)}PARAMETER{tau1=8.8(ms)<1e-9,1e9>tau2=23.5(ms)<1,1e9>wtau2=0.65<1e-9,1>tau3=123(ms)<10,1e9>Q10_tau1=2.2Q10_tau2=3.68Q10_tau3=2.65T0_tau=35(degC)tp=30(ms)tauV=7(ms)<1e-9,1e9>gVDst=0.007(1/mV)gVDv0=-100(mV)gVI=1(uS)Q10=1.52T0=26(degC)celsius(degC)Mg=1(mM)K0=4.1(mM)delta=0.8(1)e=-0.7(mV)}CONSTANT{T=273.16(degC)F=9.648e4(coul)R=8.315(J/degC)z=2(1)}ASSIGNED{v(mV)dt(ms)i(nA)g(uS)factorwfinf(uS)tau(ms)wtau3}STATE{ABCgVD(uS)}INITIAL{Mgblock(v)rates(v)tau1=tau1*Q10_tau1^((T0_tau-celsius)/10(degC))tau2=tau2*Q10_tau2^((T0_tau-celsius)/10(degC))tau3=tau3*Q10_tau3^((T0_tau-celsius)/10(degC))tau=tauV*Q10^((T0-celsius)/10(degC))if(tau1/tau2>.9999){tau1=.9999*tau2}if(tau2/tau3>.9999){tau2=.9999*tau3}wtau3=1-wtau2factor=-exp(-tp/tau1)+wtau2*exp(-tp/tau2)+wtau3*exp(-tp/tau3)factor=1/factorA=0B=0C=0gVD=0wf=1}BREAKPOINT{SOLVEstateMETHODderivimpliciti=(wtau3*C+wtau2*B-A)*(gVI+gVD)*Mgblock(v)*(v-e)}DERIVATIVEstate{rates(v)A'=-A/tau1B'=-B/tau2C'=-C/tau3gVD'=((wtau3*C+wtau2*B)/wf)*(inf-gVD)/tau}NET_RECEIVE(weight){wf=weight*factorA=A+wfB=B+wfC=C+wf}FUNCTIONMgblock(v(mV)){Mgblock=1/(1+(Mg/K0)*exp((0.001)*(-z)*delta*F*v/R/(T+celsius)))}PROCEDURErates(v(mV)){inf=(v-gVDv0)*gVDst*gVI}