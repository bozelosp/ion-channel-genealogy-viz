NEURON{SUFFIXKv723USEIONkREADekWRITEikRANGEgkbar,ik,minf,tau1,tau2,i,gk,m1,m2,tadjtauGLOBALVhalf,Vshift,k,v0erev,kV,gammaGLOBALDtaumult1,Dtaumult2,tau0mult,taudiv,q10tau}UNITS{(mA)=(milliamp)(mV)=(millivolt)(S)=(siemens)(um)=(micron)}PARAMETER{gkbar=0.002(S/cm2)k=9(mV)Vhalf=-50(mV)Vshift=0(mV)v0erev=65(mV)kV=40(mV)gamma=0.5temptau=22(degC)q10tau=5taudiv=1Dtaumult1=6Dtaumult2=6tau0mult=0.2vmin=-100(mV)vmax=100(mV)temp0=273(degC)FoverR=11.6045039552(degC/mV)}ASSIGNED{ek(mV)v(mV)celsius(degC)Vhalf1(mV)Dtau1(ms)z1tau01(ms)Vhalf2(mV)Dtau2(ms)z2tau02(ms)alpha1beta1alpha2beta2i(mA/cm2)ik(mA/cm2)gk(S/cm2)minfv0(mV)tau1(ms)tau2(ms)tadjtaufrt(/mV)}STATE{m1m2}INITIAL{rates(v)m1=minfm2=minf}BREAKPOINT{SOLVEstatesMETHODcnexpgk=gkbar*gsat(v)*(m1^2)*m2ik=gk*(v-ek)i=ik}DERIVATIVEstates{rates(v)m1'=(minf-m1)/tau1m2'=(minf-m2)/tau2}PROCEDURErates(v(mV)){TABLEminf,tau1,tau2DEPENDcelsius,gamma,k,Vhalf,Vshift,taudiv,Dtaumult1,Dtaumult2,tau0multFROMvminTOvmaxWITH199IF(gamma==0.5){z1=2.8Vhalf1=-49.8+Vshifttau01=20.7(ms)*tau0multDtau1=176.1(ms)*Dtaumult1z2=8.9Vhalf2=-55.5+Vshifttau02=149(ms)*tau0multDtau2=1473(ms)*Dtaumult2}IF(gamma==1){z1=3.6Vhalf1=-25.3+Vshifttau01=29.2(ms)*tau0multDtau1=74.6(ms)*Dtaumult1z2=9.8Vhalf2=-44.7+Vshifttau02=155(ms)*tau0multDtau2=549(ms)*Dtaumult2}tadjtau=q10tau^((celsius-temptau)/10(degC))frt=FoverR/(temp0+celsius)alpha1=exp(z1*gamma*frt*(v-Vhalf1))beta1=exp(-z1*(1-gamma)*frt*(v-Vhalf1))tau1=(Dtau1/(alpha1+beta1)+tau01)/(tadjtau*taudiv)alpha2=exp(z2*gamma*frt*(v-Vhalf2))beta2=exp(-z2*(1-gamma)*frt*(v-Vhalf2))tau2=(Dtau2/(alpha2+beta2)+tau02)/(tadjtau*taudiv)minf=1/(1+exp(-(v-Vhalf-Vshift)/k))}FUNCTIONgsat(v(mV)){gsat=1v0=v0erev+ekIF(v>v0){gsat=1+(v0-v+kV*(1-exp(-(v-v0)/kV)))/(v-ek)}}