NEURON{SUFFIXKv4USEIONkREADekWRITEikRANGEgk,gbar,ik,vshift}UNITS{(mV)=(millivolt)(mA)=(milliamp)(nA)=(nanoamp)(pA)=(picoamp)(S)=(siemens)(nS)=(nanosiemens)(pS)=(picosiemens)(um)=(micron)(molar)=(1/liter)(mM)=(millimolar)}CONSTANT{q10=3F=9.6485e4(coulombs)R=8.3145(joule/kelvin)can=0.15743(1/ms)cvan=57(mV)ckan=-32.19976(mV)cbn=0.15743(1/ms)cvbn=57(mV)ckbn=37.51346(mV)cah=0.01342(1/ms)cvah=60(mV)ckah=-7.86476(mV)cbh=0.04477(1/ms)cvbh=54(mV)ckbh=11.3615(mV)vh=-75.30348(mV)kh=-6.06329(mV)ki=150(mM)ko=2.5(mM)}PARAMETER{v(mV)celsius(degC)vshift=0gbar=0.0039(mho/cm2)<0,1e9>}ASSIGNED{ik(mA/cm2)ek(mV)gk(mho/cm2)g(coulombs/cm3)T(kelvin)qtE(volt)zetaninftaun(ms)alphan(1/ms)betan(1/ms)alphah(1/ms)betah(1/ms)hinftauh(ms)}STATE{nh}INITIAL{T=kelvinfkt(celsius)qt=q10^((celsius-23(degC))/10(degC))rates(v)n=ninfh=hinf}BREAKPOINT{SOLVEstatesMETHODcnexpgk=gbar*n*n*n*n*hik=gk*(v-ek)}DERIVATIVEstates{rates(v)n'=(ninf-n)/taunh'=(hinf-h)/tauh}PROCEDURErates(v(mV)){alphan=alphanfkt(v)betan=betanfkt(v)ninf=1.0/(1.0+exp((-49-v)/12.5))taun=1/((alphan+betan)*qt)alphah=alphahfkt(v)betah=betahfkt(v)hinf=1/(1+exp((v-(vh-vshift))/-kh))tauh=20/qtg=ghk(v,ki,ko,1)}FUNCTIONghk(v(mV),ki(mM),ko(mM),z)(coulombs/cm3){E=(1e-3)*vzeta=(z*F*E)/(R*T)if(fabs(1-exp(-zeta))<1e-6){ghk=(1e-6)*(z*F)*(ki-ko*exp(-zeta))*(1+zeta/2)}else{ghk=(1e-6)*(z*zeta*F)*(ki-ko*exp(-zeta))/(1-exp(-zeta))}}FUNCTIONalphanfkt(v(mV))(1/ms){alphanfkt=can*exp(-(v+cvan)/ckan)}FUNCTIONbetanfkt(v(mV))(1/ms){betanfkt=cbn*exp(-(v+cvbn)/ckbn)}FUNCTIONkelvinfkt(t(degC))(kelvin){kelvinfkt=273.19+t}FUNCTIONalphahfkt(v(mV))(1/ms){alphahfkt=cah/(1+exp(-(v+cvah)/ckah))}FUNCTIONbetahfkt(v(mV))(1/ms){betahfkt=cbh/(1+exp(-(v+cvbh)/ckbh))}