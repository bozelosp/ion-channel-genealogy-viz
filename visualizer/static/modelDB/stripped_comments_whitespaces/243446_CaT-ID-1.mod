INDEPENDENT{tFROM0TO1WITH1(ms)}NEURON{SUFFIXCaT3_1USEIONcaREADcai,caoUSEIONCaWRITEiCaVALENCE2RANGEg,pcabar,minf,taum,hinf,tauhRANGEiCa,m,h}UNITS{(molar)=(1/liter)(mV)=(millivolt)(mA)=(milliamp)(mM)=(millimolar)}CONSTANT{q10=1.0913F=9.6485e4(coulombs)R=8.3145(joule/kelvin)}PARAMETER{v(mV)celsius(degC)eca(mV)pcabar=2.5e-4(cm/s)cai=1e-4(mM)cao=2(mM)v0_m_inf=-42.206(mV)v0_h_inf=-75.118(mV)vshift=-6.6k_m_inf=-4.7056(mV)k_h_inf=6.4635(mV)C_tau_m=1.2757A_tau_m=-2.3199B_tau_m=2.5712v0_tau_m1=-48.048(mV)v0_tau_m2=-28.386(mV)k_tau_m1=30.655(mV)k_tau_m2=9.6306(mV)C_tau_h=0.0076A_tau_h=0.17746B_tau_h=0.13402v0_tau_h1=-58.535(mV)v0_tau_h2=-101.436k_tau_h1=6.2692(mV)k_tau_h2=-5.5845(mV)}STATE{mh}ASSIGNED{iCa(mA/cm2)g(coulombs/cm3)minftaum(ms)hinftauh(ms)qtT(kelvin)E(volt)zeta}BREAKPOINT{SOLVEcastateMETHODcnexpiCa=(1e3)*pcabar*m*m*m*h*g}DERIVATIVEcastate{evaluate_fct(v)m'=(minf-m)/taumh'=(hinf-h)/tauh}FUNCTIONghk2(v(mV),ci(mM),co(mM),z)(coulombs/cm3){E=(1e-3)*vzeta=(z*F*E)/(R*T)if(fabs(1-exp(-zeta))<1e-6){ghk2=(1e-6)*(z*F)*(ci-co*exp(-zeta))*(1+zeta/2)}else{ghk2=(1e-6)*(z*zeta*F)*(ci-co*exp(-zeta))/(1-exp(-zeta))}}UNITSOFFINITIAL{T=kelvinfkt(celsius)qt=q10^((celsius-32(degC))/10(degC))evaluate_fct(v)m=minfh=hinf}PROCEDUREevaluate_fct(v(mV)){minf=1.0/(1+exp((v-v0_m_inf-vshift)/k_m_inf))^(1/3)hinf=1.0/(1+exp((v-v0_h_inf-vshift)/k_h_inf))taum=1/(C_tau_m+A_tau_m/(1+exp((v0_tau_m1-v-vshift)/k_tau_m1))+B_tau_m/(1+exp((v0_tau_m2-v-vshift)/k_tau_m2)))/qttauh=1/(C_tau_h+A_tau_h/(1+exp((v0_tau_h1-v-vshift)/k_tau_h1))+B_tau_h/(1+exp((v0_tau_h2-v-vshift)/k_tau_h2)))/qtg=ghk2(v-vshift,cai,cao,2)}FUNCTIONkelvinfkt(t(degC))(kelvin){kelvinfkt=273.19+t}UNITSON