NEURON{SUFFIXcalHUSEIONcaREADecaWRITEicaRANGEgcal,gcalbar,m,h,icaRANGEinf,fac,tau}UNITS{(mA)=(milliamp)(mV)=(millivolt)}PARAMETER{v(mV)celsius=34(degC)dt(ms)gcalbar=0(mho/cm2)gcal(mho/cm2)eca=140(mV)}STATE{mh}ASSIGNED{ica(mA/cm2)inf[2]tau[2]}INITIAL{m=0h=1rate(v)}BREAKPOINT{SOLVEstateMETHODcnexpica=gcalbar*m*m*m*h*(v-eca)gcal=gcalbar*m*m*m*h}DERIVATIVEstate{rate(v)m'=(inf[0]-m)/tau[0]h'=(inf[1]-h)/tau[1]}PROCEDURErate(v(mV)){FROMi=0TO1{tau[i]=vartau(v,i)inf[i]=varss(v,i)}}FUNCTIONvarss(v,i){LOCALArgif(i==0){Arg=(v+37)/(-1)if(Arg<-50){varss=1}elseif(Arg>50){varss=0}else{varss=1/(1+exp(Arg))}}elseif(i==1){Arg=(v+41)/(0.5)if(Arg<-50){varss=1}elseif(Arg>50){varss=0}else{varss=1/(1+exp(Arg))}}}FUNCTIONvartau(v,i){if(i==0){vartau=3.6}elseif(i==1){vartau=29}}