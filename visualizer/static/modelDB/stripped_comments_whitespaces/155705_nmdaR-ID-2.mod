NEURON{POINT_PROCESSnmdaRRANGEg,g_eff,s,synon,t1,t2RANGECdur,Alpha,Beta,Erev,Rinf,RtauRANGEmag,eta,gammaNONSPECIFIC_CURRENTi}UNITS{(nA)=(nanoamp)(mV)=(millivolt)(mM)=(milli/liter)(uS)=(microsiemens)}PARAMETER{Cdur=4.0(ms)Alpha=0.3(/ms)Beta=0.01(/ms)Erev=0(mV)mag=1(mM)eta=3.57(mM)gamma=0.062(/mV)g=1e-5(uS)}ASSIGNED{v(mV)i(nA)g_eff(uS)RinfRtau(ms)synont1t2s}STATE{RonRoff}INITIAL{Rinf=Alpha/(Alpha+Beta)Rtau=1/(Alpha+Beta)synon=0t1=0t2=0}BREAKPOINT{SOLVEreleaseMETHODcnexps=Ron+Roffg_eff=g*s/(1+mag*exp(-gamma*v)/eta)i=g_eff*(v-Erev)}DERIVATIVErelease{Ron'=(synon*Rinf-Ron)/RtauRoff'=-Beta*Roff}NET_RECEIVE(weight,on,nspike,r0,t0(ms)){if(flag==0){nspike=nspike+1t1=t1+1if(!on){t2=t2+1r0=r0*exp(-Beta*(t-t0))t0=ton=1synon=synon+weightRon=Ron+r0Roff=Roff-r0}net_send(Cdur,nspike)}if(flag==nspike){r0=weight*Rinf+(r0-weight*Rinf)*exp(-(t-t0)/Rtau)t0=tsynon=synon-weightRon=Ron-r0Roff=Roff+r0on=0}}