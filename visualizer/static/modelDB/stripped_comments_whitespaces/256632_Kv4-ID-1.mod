UNITS{(mV)=(millivolt)(mA)=(milliamp)(S)=(siemens)}NEURON{SUFFIXkv4USEIONkREADekWRITEikRANGEgkbar,gk,ikGLOBALvhninf,kninf,antaul,bntaul,cntaul,dntaul,antaur,bntaur,cntaur,dntaur,brkvntauGLOBALvhhinf,khinf,ahtaul,bhtaul,chtaul,dhtaul,ahtaur,bhtaur,chtaur,dhtaur,brkvhtau}PARAMETER{gkbar=0.0008(S/cm2)ek=-88(mV)vhninf=-50kninf=17.6antaul=0.6bntaul=1.5cntaul=-87dntaul=6.16brkvntau=-70antaur=0.5bntaur=1.5cntaur=-50.5dntaur=11.8vhhinf=-73khinf=4ahtaul=24.2bhtaul=191.9chtaul=-79.1dhtaul=4.67brkvhtau=-78ahtaur=22.5bhtaur=211.5chtaur=-66.3dhtaur=5.59}ASSIGNED{v(mV)ik(mA/cm2)gk(S/cm2)ninfhinfntau(ms)htau(ms)}STATE{nh}BREAKPOINT{SOLVEstatesMETHODcnexpgk=gkbar*n^4*hik=gk*(v-ek)}UNITSOFFINITIAL{settables(v)n=ninfh=hinf}DERIVATIVEstates{settables(v)n'=(ninf-n)/ntauh'=(hinf-h)/htau}PROCEDUREsettables(v(mV)){TABLEninf,ntau,hinf,htauFROM-100TO100WITH200ninf=1/(1+exp(-(v-vhninf)/kninf))if(v<brkvntau){ntau=antaul+bntaul*(1/(1+exp(-(v-cntaul)/dntaul)))}else{ntau=antaur+bntaur*(1/(1+exp((v-cntaur)/dntaur)))}hinf=1/(1+exp((v-vhhinf)/khinf))if(v<brkvhtau){htau=ahtaul+bhtaul*(1/(1+exp(-(v-chtaul)/dhtaul)))}else{htau=ahtaur+bhtaur*(1/(1+exp((v-chtaur)/dhtaur)))}}UNITSON