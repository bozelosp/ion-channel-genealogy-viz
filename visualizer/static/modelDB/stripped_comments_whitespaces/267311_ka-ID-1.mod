NEURON{SUFFIXkaUSEIONkREADekWRITEikRANGEgbar,g,ik,n,lRANGEninf,linf,taul,taunRANGEvhalfn,vhalflGLOBALlmin,nscale,lscale}UNITS{(mA)=(milliamp)(mV)=(millivolt)(mol)=(1)}PARAMETER{gbar(mho/cm2)v(mV)ek(mV)celsius(degC)vhalfn=11(mV)a0n=0.05(/ms)zetan=-1.5(1)gmn=0.55(1)pw=-1(1)tq=-40(mV)qq=5(mV)nmin=0.1(ms)nscale=1vhalfl=-56(mV)a0l=0.05(/ms)zetal=3(1)lmin=2(ms)lscale=1q10=5temp=24(degC)}STATE{nl}ASSIGNED{ik(mA/cm2)ninflinftaul(ms)taun(ms)g(mho/cm2)qt}INITIAL{rates(v)n=ninfl=linfg=gbar*n*lik=g*(v-ek)}BREAKPOINT{SOLVEstatesMETHODcnexpg=gbar*n*lik=g*(v-ek)}DERIVATIVEstates{rates(v)n'=(ninf-n)/taunl'=(linf-l)/taul}FUNCTIONalpn(v(mV)){LOCALzetazeta=zetan+pw/(1+exp((v-tq)/qq))alpn=exp(zeta*(v-vhalfn)*1.e-3(V/mV)*9.648e4(coulomb/mol)/(8.315(joule/mol/degC)*(273.16(degC)+celsius)))}FUNCTIONbetn(v(mV)){LOCALzetazeta=zetan+pw/(1+exp((v-tq)/qq))betn=exp(zeta*gmn*(v-vhalfn)*1.e-3(V/mV)*9.648e4(coulomb/mol)/(8.315(joule/mol/degC)*(273.16(degC)+celsius)))}FUNCTIONalpl(v(mV)){alpl=exp(zetal*(v-vhalfl)*1.e-3(V/mV)*9.648e4(coulomb/mol)/(8.315(joule/mol/degC)*(273.16(degC)+celsius)))}FUNCTIONbetl(v(mV)){betl=exp(zetal*(v-vhalfl)*1.e-3(V/mV)*9.648e4(coulomb/mol)/(8.315(joule/mol/degC)*(273.16(degC)+celsius)))}PROCEDURErates(v(mV)){LOCALa,qtqt=q10^((celsius-temp)/10(degC))a=alpn(v)ninf=1/(1+a)taun=betn(v)/(qt*a0n*(1+a))*nscaleif(taun<nmin){taun=nmin}a=alpl(v)linf=1/(1+a)taul=0.26(ms/mV)*(v+50)*lscaleif(taul<lmin){taul=lmin}}