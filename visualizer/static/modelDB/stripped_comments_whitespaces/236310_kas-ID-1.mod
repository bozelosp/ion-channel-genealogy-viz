UNITS{(mA)=(milliamp)(mV)=(millivolt)(S)=(siemens)}NEURON{SUFFIXkasUSEIONkREADekWRITEikRANGEgkbar,ik}PARAMETER{gkbar=0.04(mho/cm2)qfact=6.48vmh=-27.0(mV)vmc=-16(mV)vhh=-33.5(mV)vhc=21.5(mV)taum0=3.4(ms)Cm=89.2(ms)vthm=-34.3(mV)vtcm=30.1(mV)alpha=1vth1=-0.96(mV)vtc1=29.01(mV)beta=1vth2=-0.96(mV)vtc2=100(mV)Ch=9876.6(ms)a=0.996hshift=14.848(mV)mshift=10.801(mV)htaushift=-98.801(mV)}STATE{mh}ASSIGNED{ek(mV)v(mV)ik(mA/cm2)gk(S/cm2)minfhinfmtau(ms)htau(ms)}INITIAL{settables(v)m=minfh=hinf}BREAKPOINT{SOLVEstateMETHODcnexpgk=gkbar*m*m*(a*h+(1-a))ik=gk*(v-ek)}DERIVATIVEstate{settables(v)mtau=mtau/qfacthtau=htau/qfactm'=(minf-m)/mtauh'=(hinf-h)/htau}PROCEDUREsettables(v(mV)){LOCALleft,rightTABLEminf,hinf,mtau,htauDEPENDhshift,ChFROM-200TO200WITH201minf=1/(1+(exp((v-vmh-mshift)/vmc)))hinf=1/(1+(exp((v-vhh-hshift)/vhc)))mtau=taum0+Cm*exp(-((v-vthm)/vtcm)^2)left=alpha*exp(-(v-vth1-htaushift)/vtc1)right=beta*exp((v-vth2-htaushift)/vtc2)htau=Ch/(left+right)}