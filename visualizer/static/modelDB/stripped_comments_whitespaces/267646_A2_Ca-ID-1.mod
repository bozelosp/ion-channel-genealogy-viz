INDEPENDENT{tFROM0TO1WITH1(ms)}NEURON{SUFFIXA2_tsbpUSEIONcaREADcai,eca,caoWRITEicaUSEIONkREADekWRITEikRANGEgcabar,gkcabarRANGEc_inf,m_infRANGEtau_c,tau_mRANGEc_exp,m_exp}UNITS{(molar)=(1/liter)(mM)=(millimolar)(mA)=(milliamp)(mV)=(millivolt)}PARAMETER{gcabar=0.002(mho/cm2)gkcabar=0.0014(mho/cm2)eca(mV)ek(mV)cao=1.8(mM)cai=0.0001(mM)dt(ms)v(mV)}STATE{cm}INITIAL{c=0.0038m=0.0345}ASSIGNED{ica(mA/cm2)ik(mA/cm2)c_infm_inftau_ctau_mc_expm_exp}BREAKPOINT{SOLVEstatesica=gcabar*c*c*c*(v-eca)ik=gkcabar*m*m*((cai)/(cai+0.2))*(v-ek)}PROCEDUREstates(){evaluate_fct(v)c=c+c_exp*(c_inf-c)m=m+m_exp*(m_inf-m)VERBATIMreturn0;ENDVERBATIM}UNITSOFFPROCEDUREevaluate_fct(v(mV)){LOCALa,b,am,bma=(-0.3*(v+70))/((exp(-0.1*(v+70)))-1)b=10*(exp((-1*(v+38))/9))tau_c=1/(a+b)c_inf=a*tau_cc_exp=1-exp(-dt/tau_c)am=(100*(230-v))/((exp((230-v)/52))-1)bm=120*(exp((-v/95)))tau_m=1/(am+bm)m_inf=a*tau_mm_exp=1-exp(-dt/tau_m)}UNITSON