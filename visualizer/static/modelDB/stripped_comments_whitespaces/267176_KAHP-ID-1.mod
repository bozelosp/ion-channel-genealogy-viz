NEURON{SUFFIXKAHPUSEIONkREADekWRITEikUSEIONcaREADecaWRITEicaRANGEgkcamax,gcamax,ik,cai,ica,taurGLOBALbKCa}UNITS{(mA)=(milliamp)(mV)=(millivolt)(S)=(siemens)(um)=(micron)(molar)=(1/liter)(mM)=(millimolar)(msM)=(msmM)FARADAY=(faraday)(coulomb)}PARAMETER{gkcamax=0.05(S/cm2)gcamax=3e-5(S/cm2)cainf=0.0001(mM)taur=10(ms)bKCa=0.1B=-17.024celsius(degC)}ASSIGNED{ik(mA/cm2)v(mV)ica(mA/cm2)ek(mV)eca(mV)qinfqtau(ms)minfcamtauca(ms)hinfcahtauca(ms)}STATE{mcahcaqcai(mM)}INITIAL{cai=cainfrates(cai)mcarate(v)q=qinfmca=minfcahca=hinfca}BREAKPOINT{SOLVEstatesMETHODcnexpica=gcamax*mca^2*hca*(v-eca)ik=gkcamax*q*(v-ek)}DERIVATIVEstates{rates(cai)cai'=B*ica-cai/taurq'=(qinf-q)/qtaumcarate(v)mca'=(minfca-mca)/mtaucahca'=(hinfca-hca)/htauca}PROCEDURErates(cai(mM)){LOCALalphaq,betaqalphaq=caibetaq=bKCaqtau=1/(alphaq+betaq)qinf=alphaq*qtau}PROCEDUREmcarate(v(mV)){LOCALalphacam,betacam,alphacah,betacahalphacam=0.25/(1+exp((v+20)/-5))betacam=0.25/(1+exp((v+20)/5))minfca=alphacam/(alphacam+betacam)mtauca=1/(alphacam+betacam)alphacah=0.025/(1-exp((v+35)/-5))betacah=0.025/(1-exp((v+35)/5))hinfca=alphacah/(alphacah+betacah)htauca=1/(alphacah+betacah)}