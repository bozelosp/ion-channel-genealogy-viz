UNITS{(mA)=(milliamp)(mV)=(millivolt)(S)=(siemens)(molar)=(1/liter)(mM)=(millimolar)}NEURON{THREADSAFESUFFIXKD_cnUSEIONkREADekWRITEikUSEIONcnREADcniVALENCE1RANGEgmax,g,taun,taulGLOBALtnmax,tlmax}PARAMETER{gmax=0.01(mho/cm2)vhalfn=-52(mV)vn2=-65(mV)zn=6.0(mV)tnmax=20(ms)tnmin=1.5(ms)tns=-7.5(mV)np=2vhalfl=-67(mV)zl=-3.6(mV)tlmax=2000(ms)tlmin=50(ms)vl2=-75(mV)tls=14(mV)cntm=50(1)lcp=2(1)kD=3e-4(mM)}STATE{nl}ASSIGNED{v(mV)ek(mV)cni(mM)ik(mA/cm2)ninflinftf(1)taul(ms)taun(ms)g(S/cm2)}BREAKPOINT{SOLVEstatesMETHODcnexpg=gmax*n*lik=g*(v-ek)}INITIAL{rates(v)n=ninfl=linftf=1}FUNCTIONalpn(v(mV)){alpn=exp((vhalfn-v)/zn)}FUNCTIONbetn(v(mV)){betn=exp((vn2-v)/tns)}FUNCTIONalpl(v(mV)){alpl=exp((vhalfl-v)/zl)}DERIVATIVEstates{rates(v)lci(cni)n'=(ninf-n)/taunl'=(linf-l)/(taul/tf)}PROCEDURErates(v(mV)){LOCALaTABLEninf,taun,linf,taulDEPENDvhalfn,tlmax,tnmax,tnminFROM-100TO50WITH600a=alpn(v)ninf=1/(1+a)taun=4*(tnmax-tnmin)/(1+betn(v))*ninf+tnmina=alpl(v)linf=(1/(1+a))taul=2*tlmax/(exp((v-vl2)/tls)+exp((vl2-v)/tls))+tlmin}PROCEDURElci(cni(mM)){TABLEtfDEPENDlcp,kDFROM0TO0.001WITH500tf=1+cntm-cntm/(1+(cni/kD)^lcp)}