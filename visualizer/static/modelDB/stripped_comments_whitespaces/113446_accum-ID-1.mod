NEURON{SUFFIXaccumUSEIONnaREADina,nao,naiWRITEnai,nao,inaUSEIONkREADik,ko,kiWRITEki,ko,ikUSEIONclREADicl,clo,cliWRITEcli,clo,iclVALENCE-1USEIONaREADia,ao,aiWRITEai,aoVALENCE-1USEIONcaREADica,cao,caiWRITEcai,cao,icaVALENCE2RANGEosmin,electin,osmout,electout,osmglia,electgliaRANGEvolin,volout,volglia,deltan,deltagliaRANGEqnai,qnao,qcai,qcao,qki,qcli,qai,qko,qclo,qaoRANGEqnag,nag,qcag,cag,qkg,gckg,qag,kg,clg,agRANGEsetina,setik,seticl,ica_pump,totcaPOINTERdiamg,inag,ikg,iclg,iagGLOBALsetnag,setkg,setclg,setag,setcag,TotalBuffer,k1buf,k2buf,Kd,minvolisvf,tau}UNITS{(um3)=(liter/1e15)(mV)=(millivolt)(mA)=(milliamp)FARADAY=96485.309(coul)(molar)=(1/liter)(mM)=(millimolar)PI=(pi)(1)R=(k-mole)(joule/degC)}PARAMETER{Difna=1.33(um2/ms)Difk=1.96(um2/ms)Difcl=2.03(um2/ms)Difca=0.6(um2/ms)tau=100(ms)k1buf=20(/mM-ms)k2buf=.5(/ms)TotalBuffer=1.562(mM)Kd=.008(mM)setvolin=1setvolout=1setvolglia=1minvolisvf=.04setnagsetkgsetclgsetagsetcagmethod=0}ASSIGNED{ina(mA/cm2)ik(mA/cm2)icl(mA/cm2)ia(mA/cm2)ica(mA/cm2)inag(mA/cm2)ikg(mA/cm2)iclg(mA/cm2)iag(mA/cm2)osmin(mM)electin(mM)osmout(mM)electout(mM)osmglia(mM)electglia(mM)diam(um)diamg(um)B0(mM)naflux[3]clflux[3]aflux[3]kflux[3]caflux[3]deltandeltagnaikiaiclicainaokoaoclocaonagkgagclgcagvolinvoloutvolgliaqkiqkoqkgqnaiqnaoqnagqaiqaoqagqcliqcloqclgqcaiqcaoqcag}STATE{na[3]k[3]a[3]cl[3]ca[3](mM)<1e-4>vol[3]CaBufferBufferpump(mol/cm2)pumpca(mol/cm2)catot}LOCALb,c,dBREAKPOINT{SOLVEstateMETHODsparse}INITIAL{na[0]=naina[1]=naona[2]=setnagcl[0]=clicl[1]=clocl[2]=setclgk[0]=kik[1]=kok[2]=setkga[0]=aia[1]=aoa[2]=setagca[0]=caica[1]=caoca[2]=setcagB0=TotalBuffer/(1+Kd*cai)Buffer=B0CaBuffer=TotalBuffer-B0catot=cai*(1+(TotalBuffer/(cai+Kd)))vol[0]=setvolinvol[1]=setvoloutvol[2]=setvolgliavolin=vol[0]volout=vol[1]volglia=vol[2]nag=na[2]kg=k[2]clg=cl[2]ag=a[2]cag=ca[2]osmin=nai+ki+cli+ai+caiosmout=nao+ko+clo+ao+caoosmglia=nag+kg+clg+ag+cagelectin=nai+ki-cli-ai+cai*2electout=nao+ko-clo-ao+cao*2electglia=nag+kg-clg-ag+cag*2qnai=na[0]*vol[0]qnao=na[1]*vol[1]qnag=na[2]*vol[2]qcai=ca[0]*vol[0]qcao=ca[1]*vol[1]qcag=ca[2]*vol[2]qcli=cl[0]*vol[0]qclo=cl[1]*vol[1]qclg=cl[2]*vol[2]qki=k[0]*vol[0]qko=k[1]*vol[1]qkg=k[2]*vol[2]qai=a[0]*vol[0]qao=a[1]*vol[1]qag=a[2]*vol[2]}KINETICstate{deltan=(nai+ki+cli+ai+cai-nao-ko-clo-ao-cao)/taudeltag=(nag+kg+clg+ag+cag-nao-ko-clo-ao-cao)/tauIF(vol[1]<=minvolisvf&&deltan>0){deltan=0}IF(vol[1]<=minvolisvf&&deltag>0){deltag=0}IF(method==0){~vol[0]<->vol[1](deltan/(diam*diam*PI/4),-deltan/(diam*diam*PI/4))~vol[1]<->vol[2](-deltag/(diam*diam*PI/4),deltag/(diam*diam*PI/4))}ELSE{~vol[0]<<(deltan/(diam*diam*PI/4))~vol[1]<<((-deltan-deltag)/(diam*diam*PI/4))~vol[2]<<((deltag)/(diam*diam*PI/4))}COMPARTMENTi,vol[i]*diam*diam*PI/4{nakclaca}COMPARTMENTvol[0]*diam*diam*PI/4{catot}LONGITUDINAL_DIFFUSIONi,Difna*diam*diam*PI*vol[i]/4{na}LONGITUDINAL_DIFFUSIONi,Difk*diam*diam*PI*vol[i]/4{k}LONGITUDINAL_DIFFUSIONi,Difcl*diam*diam*PI*vol[i]/4{cl}LONGITUDINAL_DIFFUSIONi,Difca*diam*diam*PI*vol[i]/4{ca}naflux[0]=-deltan*na[0]-(ina*diam)*PI*(1e4)/FARADAYcaflux[0]=-deltan*catot-((ica)*diam)*PI*(1e4)/(FARADAY*2)clflux[0]=-deltan*cl[0]-(icl*diam)*PI*(1e4)/FARADAY*-1kflux[0]=-deltan*k[0]-(ik*diam)*PI*(1e4)/FARADAYaflux[0]=-deltan*a[0]naflux[1]=(deltan+deltag)*na[1]+(ina*diam+inag*diamg)*PI*(1e4)/FARADAYcaflux[1]=(deltan+deltag)*ca[1]+((ica)*diam+0*diamg)*PI*(1e4)/(FARADAY*2)clflux[1]=(deltan+deltag)*cl[1]+(icl*diam+iclg*diamg)*PI*(1e4)/FARADAY*-1kflux[1]=(deltan+deltag)*k[1]+(ik*diam+ikg*diamg)*PI*(1e4)/FARADAYaflux[1]=(deltan+deltag)*a[1]naflux[2]=-deltag*na[2]-(inag*diamg)*PI*(1e4)/FARADAYcaflux[2]=0clflux[2]=-deltag*cl[2]-(iclg*diamg)*PI*(1e4)/FARADAY*-1kflux[2]=-deltag*k[2]-(ikg*diamg)*PI*(1e4)/FARADAYaflux[2]=-deltag*a[2]~na[0]<<(naflux[0])~catot<<(caflux[0])~k[0]<<(kflux[0])~cl[0]<<(clflux[0])~a[0]<<(aflux[0])~na[1]<<(naflux[1])~ca[1]<<(caflux[1])~k[1]<<(kflux[1])~cl[1]<<(clflux[1])~a[1]<<(aflux[1])~na[2]<<(naflux[2])~ca[2]<<(caflux[2])~k[2]<<(kflux[2])~cl[2]<<(clflux[2])~a[2]<<(aflux[2])b=TotalBuffer*setvolin/vol[0]-catot+Kdc=-Kd*catotd=b*b-4*ccai=(-b+sqrt(d))/(2)CaBuffer=catot-caiBuffer=TotalBuffer*setvolin/vol[0]-CaBuffervolin=vol[0]volout=vol[1]volglia=vol[2]nai=na[0]nao=na[1]nag=na[2]cao=ca[1]cag=ca[2]cli=cl[0]clo=cl[1]clg=cl[2]ki=k[0]ko=k[1]kg=k[2]ai=a[0]ao=a[1]ag=a[2]osmin=nai+ki+cli+ai+caiosmout=nao+ko+clo+ao+caoosmglia=nag+kg+clg+ag+cagelectin=nai+ki-cli-ai+cai*2electout=nao+ko-clo-ao+cao*2electglia=nag+kg-clg-ag+cag*2qnai=na[0]*vol[0]qnao=na[1]*vol[1]qnag=na[2]*vol[2]qcai=ca[0]*vol[0]qcao=ca[1]*vol[1]qcag=ca[2]*vol[2]qcli=cl[0]*vol[0]qclo=cl[1]*vol[1]qclg=cl[2]*vol[2]qki=k[0]*vol[0]qko=k[1]*vol[1]qkg=k[2]*vol[2]qai=a[0]*vol[0]qao=a[1]*vol[1]qag=a[2]*vol[2]}