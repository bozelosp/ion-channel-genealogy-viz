INDEPENDENT{tFROM0TO1WITH1(ms)}NEURON{POINT_PROCESSNMDASNONSPECIFIC_CURRENTiRANGERb,Ru,Rd,Rr,Ro,Rc,rbRANGEg,gmax,Cdur,ErevRANGEMgBlock,v0_block,k_blockRANGEgg1,gg2,gg3RANGET,Trelease,TdiffRANGEtau_1,tau_rec,tau_facil,U,u0RANGEA1,A2,A3,tau_dec1,tau_dec2,tau_dec3RANGEtdelay,ton,PRE}UNITS{(nA)=(nanoamp)(mV)=(millivolt)(pS)=(picosiemens)(umho)=(micromho)(mM)=(milli/liter)(uM)=(micro/liter)PI=(pi)(1)}PARAMETER{Rb=5(/ms/mM)Ru=0.1(/ms)Rd=12e-4(/ms)Rr=9e-3(/ms)Ro=3e-2(/ms)Rc=0.966(/ms)Erev=-3.7(mV)gmax=10e4(pS)v0_block=-20(mV)k_block=13(mV)A1=0.131837A2=0.0555027A3=0.0135232tau_dec1=3.4958tau_dec2=16.6317tau_dec3=128.983tau_1=3(ms)<1e-9,1e9>tau_rec=35.1(ms)<1e-9,1e9>tau_facil=10.8(ms)<0,1e9>U=0.416(1)<0,1>u0=0(1)<0,1>}ASSIGNED{v(mV)i(nA)g(pS)rb(/ms)MgBlockT(mM)Trelease(mM)Tdiff(mM)Tdiff_0(mM)tdelay(ms)ton(ms)xPRE}STATE{C0C1C2DOgg1gg2gg3sink}INITIAL{rates(v)C0=1C1=0C2=0O=0D=0T=0(mM)Tdiff=0(mM)Trelease=0(mM)Tdiff_0=0(mM)gg1=0gg2=0gg3=0ton=-1(ms)PRE=0}FUNCTIONSET_tdelay(R,D){tdelay=0.25*R*R/D}BREAKPOINT{rates(v)if((t-ton)>tdelay){Tdiff=gg1+gg2+gg3Tdiff_0=Tdiff}else{Tdiff=Tdiff_0+(A1+A2+A3)*PRE*(t-ton)/tdelay}Trelease=TdiffSOLVEkstatesMETHODsparseg=gmax*Oi=(1e-6)*g*(v-Erev)*MgBlock}KINETICkstates{rb=Rb*Trelease~C0<->C1(rb,Ru)~C1<->C2(rb,Ru)~C2<->D(Rd,Rr)~C2<->O(Ro,Rc)CONSERVEC0+C1+C2+D+O=1~gg1<->sink(1/tau_dec1,0)~gg2<->sink(1/tau_dec2,0)~gg3<->sink(1/tau_dec3,0)}PROCEDURErates(v(mV)){TABLEMgBlockDEPENDv0_block,k_blockFROM-120TO30WITH150MgBlock=1/(1+exp(-(v-v0_block)/k_block))}NET_RECEIVE(weight,on,nspike,flagtdel,t0(ms),y,z,u,tsyn(ms)){INITIAL{flagtdel=1nspike=1Tdiff=0y=0z=0u=u0tsyn=t}if(flag==0){nspike=nspike+1if(!on){ton=tt0=ton=1z=z*exp(-(t-tsyn)/tau_rec)z=z+(y*(exp(-(t-tsyn)/tau_1)-exp(-(t-tsyn)/tau_rec))/(tau_1/tau_rec-1))y=y*exp(-(t-tsyn)/tau_1)x=1-y-zif(tau_facil>0){u=u*exp(-(t-tsyn)/tau_facil)u=u+U*(1-u)}else{u=U}y=y+x*utsyn=tPRE=y}net_send(tdelay,flagtdel)}if(flag==flagtdel){flagtdel=flagtdel+1state_discontinuity(gg1,gg1+A1*x*u)state_discontinuity(gg2,gg2+A2*x*u)state_discontinuity(gg3,gg3+A3*x*u)on=0}}