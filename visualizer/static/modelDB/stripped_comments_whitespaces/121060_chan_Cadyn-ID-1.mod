INDEPENDENT{tFROM0TO1WITH1(ms)}NEURON{SUFFIXCadynUSEIONCaREADiCa,CaiWRITECaiVALENCE2RANGEcainf,taur,drive}UNITS{(molar)=(1/liter)(mM)=(millimolar)(um)=(micron)(mA)=(milliamp)(msM)=(msmM)}CONSTANT{FARADAY=96489(coul)pump=0.02}PARAMETER{drive=10000(1)depth=0.1(um)cainf=1e-5(mM)taur=43(ms)kt=1e-4(mM/ms)kd=1e-4(mM)}STATE{Cai(mM)}INITIAL{Cai=cainf}ASSIGNED{iCa(mA/cm2)drive_channel(mM/ms)drive_pump(mM/ms)}BREAKPOINT{SOLVEstateMETHODderivimplicit}DERIVATIVEstate{drive_channel=-drive*iCa/(2*FARADAY*depth)if(drive_channel<=0.){drive_channel=0.}drive_pump=-kt*Cai/(Cai+kd)Cai'=(drive_channel+pump*drive_pump+(cainf-Cai)/taur)}