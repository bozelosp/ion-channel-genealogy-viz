UNITS{(mA)=(milliamp)(mV)=(millivolt)(S)=(siemens)}NEURON{SUFFIXhhSSdaUSEIONnaREADenaWRITEinaUSEIONkREADekWRITEikNONSPECIFIC_CURRENTilRANGEgnabar,gkbar,gl,el,NNa,NK,se}PARAMETER{se=-1gnabar=.12(S/cm2)<0,1e9>gkbar=.036(S/cm2)<0,1e9>gl=.0003(S/cm2)<0,1e9>el=-54.3(mV)NNa=5000NK=1500}ASSIGNED{v(mV)celsius(degC)ena(mV)ek(mV)dt(ms)ina(mA/cm2)ik(mA/cm2)il(mA/cm2)am(/ms)ah(/ms)an(/ms)bm(/ms)bh(/ms)bn(/ms)stsumMNHR[3](/ms)mh0n0}STATE{mh1mh2mh3mh4mh5mh6mh7n1n2n3n4}BREAKPOINT{SOLVEstatesMETHODcnexpina=gnabar*mh7*(v-ena)ik=gkbar*n4*(v-ek)il=gl*(v-el)}INITIAL{if(se>0){set_seed(se)}rates(v)M=am/bmH=ah/bhN=an/bnstsum=(1+H)*(1+M)^3mh0=1/stsummh1=3*M/stsummh2=3*M^2/stsummh3=M^3/stsummh4=H/stsummh5=H*3*M/stsummh6=H*3*M^2/stsummh7=H*M^3/stsumstsum=(1+N)^4n0=1/stsumn1=4*N/stsumn2=6*N^2/stsumn3=4*N^3/stsumn4=N^4/stsumrates(v)}DERIVATIVEstates{rates(v)mh1'=(-2*am-bm-ah)*mh1+3*am*mh0+2*bm*mh2+bh*mh5mh2'=(-am-2*bm-ah)*mh2+2*am*mh1+3*bm*mh3+bh*mh6mh3'=(-3*bm-ah)*mh3+am*mh2+bh*mh7+R[0]mh4'=(-3*am-bh)*mh4+bm*mh5+ah*mh0mh5'=(-2*am-bm-bh)*mh5+3*am*mh4+2*bm*mh6+ah*mh1mh6'=(-am-2*bm-bh)*mh6+2*am*mh5+3*bm*mh7+ah*mh2+R[1]mh7'=(-3*bm-bh)*mh7+am*mh6+ah*mh3-R[1]-R[0]mh0=1-mh1-mh2-mh3-mh4-mh5-mh6-mh7n1'=(-3*an-bn)*n1+4*an*n0+2*bn*n2n2'=(-2*an-2*bn)*n2+3*an*n1+3*bn*n3n3'=(-an-3*bn)*n3+2*an*n2+4*bn*n4+R[2]n4'=-4*bn*n4+an*n3-R[2]n0=1-n1-n2-n3-n4}LOCALq10PROCEDURErates(v(mV)){LOCALq10UNITSOFFq10=3^((celsius-6.3)/10)am=q10*0.1*(v+40)/(1-exp(-(v+40)/10))bm=q10*4*exp(-(v+65)/18)ah=q10*0.07*exp(-(v+65)/20)bh=q10/(1+exp(-(v+35)/10))an=q10*0.01*(v+55)/(1-exp(-(v+55)/10))bn=q10*0.125*exp(-(v+65)/80)FROMii=0TO1{R[ii]=normrand(0,1/sqrt(NNa*dt))}R[2]=normrand(0,1/sqrt(NK*dt))R[0]=R[0]*sqrt(fabs(ah*mh3+bh*mh7))R[1]=R[1]*sqrt(fabs(am*mh6+3*bm*mh7))R[2]=R[2]*sqrt(fabs(an*n3+4*bn*n4))UNITSON}