NEURON{SUFFIXsAHPUSEIONcaREADicaUSEIONkREADekWRITEikRANGEgbar,g,iGLOBALca0,tau,taucadiv,n,kca,cah,a1max,a2,b1,b2GLOBALtau1Ref,tau1,tau2,oinf,c1inf,CaRef}UNITS{(molar)=(1/liter)(mM)=(millimolar)(mV)=(millivolt)(mA)=(milliamp)(S)=(siemens)(pS)=(picosiemens)(um)=(micron)}PARAMETER{B=.26(mM-cm2/mA-ms)gbar=.0(pS/um2)ca0=.00007(mM)tau=9(ms)taucadiv=1n=1tau1Ref=200(ms)tau2=200(ms)c1inf=0.25oinf=0.5CaRef=.002(mM)kca=0.001(mM)cah=0.01(mM)}ASSIGNED{v(mV)ek(mV)ik(mA/cm2)i(mA/cm2)ica(mA/cm2)g(pS/um2)a1ca(/ms)a1maxCaRef(/ms)a1max(/ms/mM)a1(/ms/mM)b1(/ms)a2(/ms)b2(/ms)tau1(ms)}STATE{ca_i(mM)<1e-5>c1o}INITIAL{ca_i=ca0a2=-(oinf/((-1+c1inf)*tau2))b1=-(c1inf/((-1+oinf)*tau1Ref))b2=1/tau2-a2a1maxCaRef=1/tau1Ref-b1a1max=a1maxCaRef/CaRefa1ca=(a1max*ca_i)/(1+exp(-(ca_i-cah)/kca))tau1=1/(a1ca+b1)o=(a2*(-1+b1*tau1)*tau2)/(-1+a2*b1*tau1*tau2)c1=(b1*tau1*(-1+a2*tau2))/(-1+a2*b1*tau1*tau2)}BREAKPOINT{SOLVEstateMETHODcnexpg=gbar*o^nik=g*(v-ek)*(1e-4)i=ik}DERIVATIVEstate{ca_i'=-B*ica-taucadiv*(ca_i-ca0)/taua1ca=(a1max*ca_i)/(1+exp(-(ca_i-cah)/kca))c1'=b1*(1-o)-c1*(a1ca+b1)o'=a2*(1-c1)-o*(a2+b2)}