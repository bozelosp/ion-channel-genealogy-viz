NEURON{SUFFIXkpkjslow_cnUSEIONkREADekWRITEikRANGEgkbar,ikGLOBALninf,ntauRANGEgk,gamma_kRANGENk,one_over_NkRANGEseed}UNITS{(mV)=(millivolt)(mA)=(milliamp)(S)=(siemens)(pS)=(picosiemens)}PARAMETER{v(mV)gkbar=.004(mho/cm2)nivh=-16.5(mV)nik=18.4ekseed=5061983(1)gamma_k=10(pS)}ASSIGNED{ikninfntau(ms)gk(S/cm2)Nk(1)one_over_Nk(1)dt(ms)area(um2)tau1_kpkjslow(ms)tau2_kpkjslow(ms)tau3_kpkjslow(ms)tau4_kpkjslowsigma1_kpkjslow(ms2)sigma2_kpkjslow(ms2)sigma3_kpkjslow(ms2)sigma4_kpkjslow(ms2)noise1_kpkjslownoise2_kpkjslownoise3_kpkjslownoise4_kpkjslowmu1_kpkjslowmu2_kpkjslowmu3_kpkjslowmu4_kpkjslow}STATE{nz1_kpkjslowz2_kpkjslowz3_kpkjslowz4_kpkjslow}INITIAL{rates(v)n=ninfNk=ceil(((1e-8)*area)*(gkbar)/((1e-12)*gamma_k))one_over_Nk=1.0/Nkprintf("kpkjslow>>thenumberofchannelsis%.0f.\n",Nk)z1_kpkjslow=0.z2_kpkjslow=0.z3_kpkjslow=0.z4_kpkjslow=0.}BREAKPOINT{SOLVEstatesgk=gkbar*(n*n*n*n+z1_kpkjslow+z2_kpkjslow+z3_kpkjslow+z4_kpkjslow)if(gk<0){gk=0}elseif(gk>gkbar){gk=gkbar}ik=gk*(v-ek)}PROCEDUREstates(){rates(v)n=n+dt*(ninf-n)/ntauz1_kpkjslow=z1_kpkjslow*mu1_kpkjslow+noise1_kpkjslowz2_kpkjslow=z2_kpkjslow*mu2_kpkjslow+noise2_kpkjslowz3_kpkjslow=z3_kpkjslow*mu3_kpkjslow+noise3_kpkjslowz4_kpkjslow=z4_kpkjslow*mu4_kpkjslow+noise4_kpkjslow}PROCEDURErates(Vm(mV)){LOCALv,n4,one_minus_nv=Vm+11ninf=1/(1+exp(-(v-nivh)/nik))ntau=1000*ntau_func(v)tau1_kpkjslow=ntautau2_kpkjslow=0.5*ntautau3_kpkjslow=0.3333333*ntautau4_kpkjslow=0.25*ntaumu1_kpkjslow=exp(-dt/tau1_kpkjslow)mu2_kpkjslow=exp(-dt/tau2_kpkjslow)mu3_kpkjslow=exp(-dt/tau3_kpkjslow)mu4_kpkjslow=exp(-dt/tau4_kpkjslow)n4=ninf*ninf*ninf*ninfone_minus_n=1.-ninfsigma1_kpkjslow=one_over_Nk*4*n4*ninf*ninf*ninf*one_minus_nsigma2_kpkjslow=one_over_Nk*6*n4*ninf*ninf*one_minus_n*one_minus_nsigma3_kpkjslow=one_over_Nk*4*n4*n*one_minus_n*one_minus_n*one_minus_nsigma4_kpkjslow=one_over_Nk*n4*one_minus_n*one_minus_n*one_minus_n*one_minus_nnoise1_kpkjslow=sqrt(sigma1_kpkjslow*(1-mu1_kpkjslow*mu1_kpkjslow))*normrand(0,1)noise2_kpkjslow=sqrt(sigma2_kpkjslow*(1-mu2_kpkjslow*mu2_kpkjslow))*normrand(0,1)noise3_kpkjslow=sqrt(sigma3_kpkjslow*(1-mu3_kpkjslow*mu3_kpkjslow))*normrand(0,1)noise4_kpkjslow=sqrt(sigma4_kpkjslow*(1-mu4_kpkjslow*mu4_kpkjslow))*normrand(0,1)}FUNCTIONntau_func(v(mV)){ntau_func=.000796+1/(exp((v+73.2)/11.7)+exp((v-306.7)/-74.2))}