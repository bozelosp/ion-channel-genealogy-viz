UNITS{(mA)=(milliamp)(mV)=(millivolt)(S)=(siemens)}NEURON{SUFFIXiAUSEIONkREADekWRITEikRANGEgkbar,gk,iGLOBALminf,mtau,hinfTHREADSAFE}PARAMETER{gkbar=.0025(S/cm2)<0,1e9>ek=-80(mV)mtau=0.1(ms)}ASSIGNED{v(mV)celsius(degC)gk(S/cm2)ik(mA/cm2)i(mA/cm2)minfhinfhtau(ms)}STATE{mh}?currentsBREAKPOINT{SOLVEstatesMETHODcnexpgk=gkbar*m*hi=gk*(v-ek)ik=i}INITIAL{rates(v)m=minfh=hinf}?statesDERIVATIVEstates{rates(v)m'=(minf-m)/mtauh'=(hinf-h)/htau}?ratesPROCEDURErates(v(mV)){LOCALalpha,betaTABLEminf,hinf,htauFROM-100TO100WITH200UNITSOFFalpha=0.01*vtrap(-(v+21.3),35.0)beta=0.01*vtrap((v+21.3),35.0)minf=alpha/(alpha+beta)alpha=-0.01*vtrap((v+58.0),8.2)beta=-0.01*vtrap(-(v+58.0),8.2)hinf=alpha/(alpha+beta)htau=htauv(v)UNITSON}FUNCTIONhtauv(v(mV)){UNITSOFFif(v>-20.0){htauv=5.+2.6*(v+20.)/10.}else{htauv=5.}UNITSON}FUNCTIONvtrap(x,y){if(fabs(x/y)<1e-6){vtrap=y*(1.0-x/y/2.0)}else{vtrap=x/(exp(x/y)-1.0)}}