INDEPENDENT{tFROM0TO1WITH1(ms)}NEURON{SUFFIXiahpUSEIONk2WRITEik2VALENCE1USEIONCaREADCaiVALENCE2USEIONcaREADcaiRANGEgkbar,i,g,ratc,ratC,minf,taumGLOBALbeta,cac,m_inf,tau_m,x}UNITS{(mA)=(milliamp)(mV)=(millivolt)(molar)=(1/liter)(mM)=(millimolar)}PARAMETER{v(mV)celsius=36(degC)erev=-95(mV)Cai=5e-5(mM)cai=5e-5(mM)gkbar=.001(mho/cm2)beta=2.5(1/ms)cac=1e-4(mM)taumin=1(ms)ratc=0ratC=0x=2}STATE{m}ASSIGNED{ik2(mA/cm2)i(mA/cm2)g(mho/cm2)m_inftau_m(ms)minftaumtadj}BREAKPOINT{SOLVEstatesMETHODcnexpminf=m_inftaum=tau_mg=gkbar*m*mi=g*(v-erev)ik2=i}DERIVATIVEstates{evaluate_fct(v,Cai,cai)m'=(m_inf-m)/tau_m}UNITSOFFINITIAL{VERBATIMcai=_ion_cai;Cai=_ion_Cai;ENDVERBATIMtadj=3^((celsius-22.0)/10)evaluate_fct(v,Cai,cai)m=m_infminf=m_inftaum=tau_m}PROCEDUREevaluate_fct(v(mV),Cai(mM),cai(mM)){LOCALcar,tcartcar=ratC*Cai+ratc*caicar=(tcar/cac)^xm_inf=car/(1+car)tau_m=1/beta/(1+car)/tadjif(tau_m<taumin){tau_m=taumin}}UNITSON