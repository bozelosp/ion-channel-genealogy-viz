INDEPENDENT{tFROM0TO1WITH1(ms)}NEURON{SUFFIXCadUSEIONCaREADiCa,CaiWRITECai,CaoVALENCE2RANGECa,depth,Cainf,taur,entryF}UNITS{(molar)=(1/liter)(mM)=(millimolar)(um)=(micron)(mA)=(milliamp)(msM)=(msmM)FARADAY=(faraday)(coulomb)}PARAMETER{depth=.1(um)taur=200(ms)Cainf=2e-3(mM)Cai(mM)Cao=2(mM)entryF=1}STATE{Ca(mM)}INITIAL{Ca=CainfCao=2}ASSIGNED{iCa(mA/cm2)drive_channel(mM/ms)}BREAKPOINT{SOLVEstateMETHODderivimplicit}DERIVATIVEstate{drive_channel=-(10000)*iCa/(2*FARADAY*depth)if(drive_channel<=0.){drive_channel=0.}Ca'=entryF*drive_channel/2+(Cainf-Ca)/taurCai=CaCao=2}