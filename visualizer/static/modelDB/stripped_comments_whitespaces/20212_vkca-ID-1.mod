NEURON{SUFFIXvkcaUSEIONkREADekWRITEikUSEIONcaREADcaiRANGEgk,gbar,m,h,c,c_infRANGEinf,fac,tau}UNITS{(mA)=(milliamp)(mV)=(millivolt)(molar)=(1/liter)(mM)=(millimolar)}INDEPENDENT{tFROM0TO1WITH1(ms)}PARAMETER{v(mV)celsius=34(degC)dt(ms)gbar=0(mho/cm2)ek=-80(mV)cai(mM)cac=0.025(mM)gk}STATE{mhc}ASSIGNED{ikinf[3]fac[3]tau[3]c_inf}BREAKPOINT{SOLVEstatesgk=gbar*m*m*m*h*c*cik=gk*(v-ek)}INITIAL{h=1m=0c=0states()gk=gbar*m*m*m*h*c*cik=gk*(v-ek)}PROCEDUREcalcg(){mhn(v*1(/mV),cai)m=m+fac[0]*(inf[0]-m)h=h+fac[1]*(inf[1]-h)c=c+fac[2]*(inf[2]-c)}PROCEDUREevaluate_fct(v(mV),cai(mM)){LOCALcarcar=(cai/cac)^2c_inf=1}PROCEDUREstates(){calcg()VERBATIMreturn0;ENDVERBATIM}FUNCTIONvarss(v,i){if(i==0){varss=1/(1+exp((v+60)/(-1)))}elseif(i==1){varss=1/(1+exp((v+57)/(0.5)))}}FUNCTIONvartau(v,i){if(i==0){vartau=2}elseif(i==1){vartau=45}elseif(i==2){vartau=2}}PROCEDUREmhn(v,cai){LOCALa,bFROMi=0TO1{if(cai<0.001||cai>0.2){}else{inf[i]=varss(v,i)}tau[i]=vartau(v,i)fac[i]=(1-exp(-dt/tau[i]))}evaluate_fct(v,cai)inf[2]=c_inftau[2]=vartau(v,2)fac[2]=(1-exp(-dt/tau[2]))}