NEURON{SUFFIXsAHPNEUSEIONkREADekWRITEikUSEIONcasREADcasiVALENCE2RANGEik,gk,gsAHPbar}UNITS{(mM)=(milli/liter)(mA)=(milliamp)(mV)=(millivolt)}PARAMETER{tone_period=4000NE_period=500NE_start=64000NE_stop=96000NE_t1=0.9NE_ext1=196000NE_ext2=212000NE_period2=100NE_start2=36000NE_t2=0.7gsAHPbar=2.318144e-05}ASSIGNED{v(mV)ek(mV)casi(mM)ik(mA/cm2)cinfctau(ms)gk(mho/cm2)}STATE{c}BREAKPOINT{SOLVEstatesMETHODcnexpgk=gsAHPbar*cik=gk*(v-ek)*NE1(t)*NE2(t)}INITIAL{rate(v,casi)c=cinf}DERIVATIVEstates{rate(v,casi)c'=(cinf-c)/ctau}UNITSOFFFUNCTIONcalf(v(mV),casi(mM))(/ms){LOCALvs,vaUNITSOFFvs=10*log10(1000*casi)calf=0.0048/exp(-0.5*(vs-35))UNITSON}FUNCTIONcbet(v(mV),casi(mM))(/ms){LOCALvs,vbUNITSOFFvs=10*log10(1000*casi)cbet=0.012/exp(0.2*(vs+100))UNITSON}UNITSONPROCEDURErate(v(mV),casi(mM)){LOCALcsum,ca,cbUNITSOFFca=calf(v,casi)cb=cbet(v,casi)csum=ca+cbif(v<-65){cinf=0}else{cinf=ca/csum}ctau=48UNITSON}FUNCTIONNE1(t){if(t>=NE_start&&t<=NE_stop){if((t/tone_period-floor(t/tone_period))>=(1-NE_period/tone_period)){NE1=NE_t1}elseif((t/tone_period-floor(t/tone_period))==0){NE1=NE_t1}else{NE1=1}}elseif(t>=NE_ext1&&t<=NE_ext2){if((t/tone_period-floor(t/tone_period))>=(1-NE_period/tone_period)){NE1=NE_t1}elseif((t/tone_period-floor(t/tone_period))==0){NE1=NE_t1}else{NE1=1}}else{NE1=1}}FUNCTIONNE2(t){if(t>=NE_start2&&t<=NE_stop){if((t/tone_period-floor(t/tone_period))>=(1-NE_period2/tone_period)){NE2=NE_t2}elseif((t/tone_period-floor(t/tone_period))==0){NE2=NE_t2}else{NE2=1}}else{NE2=1}}