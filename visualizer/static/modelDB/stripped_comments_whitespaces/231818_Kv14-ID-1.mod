UNITS{(mA)=(milliamp)(mV)=(millivolt)}NEURON{THREADSAFESUFFIXKv14USEIONkREADekWRITEikRANGEgkbar,gk,scale_a,scale_i,ikGLOBALvshift}PARAMETER{gkbar=.0(mho/cm2)<0,1e9>scale_a=1.0scale_i=1.0vshift=0(mV)}STATE{nh}ASSIGNED{v(mV)celsius(degC)ek(mV)gk(mho/cm2)ik(milliamp/cm2)ninfntau(ms)hinfhtau(ms)}BREAKPOINT{SOLVEstatesMETHODcnexpgk=gkbar*n*n*n*n*hik=gk*(v-ek)}INITIAL{rates(v)n=ninfh=hinf}DERIVATIVEstates{rates(v)n'=(ninf-n)/ntauh'=(hinf-h)/htau}PROCEDURErates(v(mV)){LOCALalpha,beta,sumUNITSOFFalpha=scale_a*.01*vtrap((-55+vshift-v),10)beta=scale_a*.125*exp((-65+vshift-v)/80)sum=alpha+betantau=1/sumninf=alpha/sumalpha=scale_i*0.0000256077*exp((vshift-v)/45.4217)beta=scale_i*0.0330402/(exp((-45.6599+vshift-v)/2.30235)+1)sum=alpha+betahtau=1/sumhinf=alpha/sum}FUNCTIONvtrap(x,y){if(fabs(x/y)<1e-6){vtrap=y*(1-x/y/2)}else{vtrap=x/(exp(x/y)-1)}}UNITSON