NEURON{SUFFIXfhUSEIONnaREADenaWRITEinaNONSPECIFIC_CURRENTilRANGEgnabar,gl,el,gna,il,vshGLOBALminf,hinf,mtau,htau}UNITS{(mA)=(milliamp)(mV)=(millivolt)(S)=(siemens)}PARAMETER{celsius(degC)gnabar=0(S/cm2)<0,1e9>gl=0(S/cm2)<0,1e9>el=0(mV)vsh=-70(mV)}STATE{mh}ASSIGNED{v(mV)ena(mV)gna(S/cm2)ina(mA/cm2)il(mA/cm2)minfhinfmtau(ms)htau(ms)inf[2]tau[2](ms)}BREAKPOINT{LOCALghknaSOLVEstatesMETHODcnexpgna=gnabar*m*m*hina=gna*(v-ena)il=gl*(v-el)}INITIAL{mh(v*1(/mV))m=inf[0]h=inf[1]}?statesDERIVATIVEstates{mh(v*1(/mV))m'=(inf[0]-m)/tau[0]h'=(inf[1]-h)/tau[1]}UNITSOFFFUNCTIONalp(v(mV),i){LOCALa,b,c,q10v=v-vshq10=3^((celsius-20)/10)if(i==0){a=.36b=22.c=3.alp=q10*a*expM1(b-v,c)}elseif(i==1){a=.1b=-10.c=6.alp=q10*a*expM1(v-b,c)}}FUNCTIONbet(v,i){LOCALa,b,c,q10v=v-vshq10=3^((celsius-20)/10)if(i==0){a=.4b=13.c=20.bet=q10*a*expM1(v-b,c)}elseif(i==1){a=4.5b=45.c=10.bet=q10*a/(exp((b-v)/c)+1)}}FUNCTIONexpM1(x,y){if(fabs(x/y)<1e-6){expM1=y*(1-x/y/2)}else{expM1=x/(exp(x/y)-1)}}PROCEDUREmh(v){LOCALa,bTABLEinf,tauDEPENDcelsiusFROM-100TO100WITH200FROMi=0TO1{a=alp(v,i)b=bet(v,i)tau[i]=1/(a+b)inf[i]=a/(a+b)}}UNITSON