NEURON{POINT_PROCESSpyrV2pyrD_STFDUSEIONcaREADecaNONSPECIFIC_CURRENTinmda,iampaRANGEinitWRANGECdur_nmda,AlphaTmax_nmda,Beta_nmda,Erev_nmda,gbar_nmda,W_nmda,on_nmda,g_nmdaRANGECdur_ampa,AlphaTmax_ampa,Beta_ampa,Erev_ampa,gbar_ampa,W,on_ampa,g_ampaRANGEeca,ICa,P0,fCa,tauCa,iCatotalRANGECainf,pooldiam,zRANGElambda1,lambda2,threshold1,threshold2RANGEfmax,fmin,Wmax,Wmin,maxChange,normW,scaleW,srcid,destidRANGEpregid,postgid,thr_rpRANGEF,f,tauF,D1,d1,tauD1,D2,d2,tauD2RANGEfacfactor}UNITS{(mV)=(millivolt)(nA)=(nanoamp)(uS)=(microsiemens)FARADAY=96485(coul)pi=3.141592(1)}PARAMETER{srcid=-1(1)destid=-1(1)Cdur_nmda=16.7650(ms)AlphaTmax_nmda=.2659(/ms)Beta_nmda=0.008(/ms)Erev_nmda=0(mV)gbar_nmda=.5e-3(uS)Cdur_ampa=1.4210(ms)AlphaTmax_ampa=3.8142(/ms)Beta_ampa=0.1429(/ms)Erev_ampa=0(mV)gbar_ampa=1e-3(uS)eca=120Cainf=50e-6(mM)pooldiam=1.8172(micrometer)z=2tauCa=50(ms)P0=.015fCa=.024lambda1=80lambda2=.03threshold1=0.3threshold2=0.55initW=1fmax=4fmin=.8thr_rp=1facfactor=1f=0(1)<0,1e9>tauF=20(ms)<1e-9,1e9>d1=0.95(1)<0,1>tauD1=40(ms)<1e-9,1e9>d2=0.9(1)<0,1>tauD2=70(ms)<1e-9,1e9>}ASSIGNED{v(mV)inmda(nA)g_nmda(uS)on_nmdaW_nmdaiampa(nA)g_ampa(uS)on_ampaWt0(ms)ICa(mA)Afactor(mM/ms/nA)iCatotal(mA)dW_ampaWmaxWminmaxChangenormWscaleWpregidpostgidrptsynfaFD1D2}STATE{r_nmdar_ampacapoolcon}INITIAL{on_nmda=0r_nmda=0W_nmda=initWon_ampa=0r_ampa=0W=initWt0=-1Wmax=fmax*initWWmin=fmin*initWmaxChange=(Wmax-Wmin)/10dW_ampa=0capoolcon=CainfAfactor=1/(z*FARADAY*4/3*pi*(pooldiam/2)^3)*(1e6)fa=0F=1D1=1D2=1}BREAKPOINT{SOLVEreleaseMETHODcnexp}DERIVATIVErelease{if(t0>0){if(rp<thr_rp){if(t-t0<Cdur_nmda){on_nmda=1}else{on_nmda=0}if(t-t0<Cdur_ampa){on_ampa=1}else{on_ampa=0}}else{on_nmda=0on_ampa=0}}r_nmda'=AlphaTmax_nmda*on_nmda*(1-r_nmda)-Beta_nmda*r_nmdar_ampa'=AlphaTmax_ampa*on_ampa*(1-r_ampa)-Beta_ampa*r_ampadW_ampa=eta(capoolcon)*(lambda1*omega(capoolcon,threshold1,threshold2)-lambda2*W)*dtif(fabs(dW_ampa)>maxChange){if(dW_ampa<0){dW_ampa=-1*maxChange}else{dW_ampa=maxChange}}normW=(W-Wmin)/(Wmax-Wmin)if(dW_ampa<0){scaleW=sqrt(fabs(normW))}else{scaleW=sqrt(fabs(1.0-normW))}W=W+dW_ampa*scaleWif(W>Wmax){W=Wmax}elseif(W<Wmin){W=Wmin}g_nmda=gbar_nmda*r_nmda*facfactorinmda=W_nmda*g_nmda*(v-Erev_nmda)*sfunc(v)g_ampa=gbar_ampa*r_ampa*facfactoriampa=W*g_ampa*(v-Erev_ampa)ICa=P0*g_nmda*(v-eca)*sfunc(v)capoolcon'=-fCa*Afactor*ICa+(Cainf-capoolcon)/tauCa}NET_RECEIVE(dummy_weight){t0=trp=unirand()D1=1-(1-D1)*exp(-(t-tsyn)/tauD1)D2=1-(1-D2)*exp(-(t-tsyn)/tauD2)tsyn=tfacfactor=F*D1*D2if(F>3){F=3}if(facfactor<0.5){facfactor=0.5}D1=D1*d1D2=D2*d2}FUNCTIONsfunc(v(mV)){UNITSOFFsfunc=1/(1+0.33*exp(-0.06*v))UNITSON}FUNCTIONeta(Cani(mM)){LOCALtaulearn,P1,P2,P4,CaconP1=0.1P2=P1*1e-4P4=1Cacon=Cani*1e3taulearn=P1/(P2+Cacon*Cacon*Cacon)+P4eta=1/taulearn*0.001}FUNCTIONomega(Cani(mM),threshold1(uM),threshold2(uM)){LOCALr,mid,CaconCacon=Cani*1e3r=(threshold2-threshold1)/2mid=(threshold1+threshold2)/2if(Cacon<=threshold1){omega=0}elseif(Cacon>=threshold2){omega=1/(1+50*exp(-50*(Cacon-threshold2)))}else{omega=-sqrt(r*r-(Cacon-mid)*(Cacon-mid))}}FUNCTIONunirand(){unirand=scop_random()}