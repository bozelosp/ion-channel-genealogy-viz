UNITS{(mA)=(milliamp)(mV)=(millivolt)}NEURON{THREADSAFESUFFIXIhUSEIONhREADehWRITEihVALENCE1RANGEgkhbar,ih,g,t1,t2,t3,t4,t5,v_half,kGLOBALrinf}INDEPENDENT{tFROM0TO1WITH1(ms)}PARAMETER{v(mV)p=5(degC)dt(ms)gkhbar=0.000005(mho/cm2)eh=-32.9(mV)t1=1(1/mV)t2=-0.116(1/mV)t3=1(1/mV)t4=0.09(1/mV)t5=100(ms)v_half=-103.44(mV)k=8.63}STATE{r}ASSIGNED{ih(mA/cm2)rinftau_r(ms)g(siemens/cm2)}BREAKPOINT{SOLVEstateMETHODcnexpih=gkhbar*r*(v-eh)g=gkhbar*r}INITIAL{rates(v,v_half,k,t1,t2,t3,t4,t5)r=0}DERIVATIVEstate{rates(v,v_half,k,t1,t2,t3,t4,t5)r'=(rinf-r)/tau_r}UNITSOFFPROCEDURErates(v(mV),v_half(mV),k,t1(1/mV),t2(1/mV),t3(1/mV),t4(1/mV),t5(ms)){rinf=1/(1+exp((v-v_half)/k))tau_r=1/(exp(-t1-t2*v)+exp(-t3+t4*v))+t5}UNITSON