UNITS{(molar)=(1/liter)(mV)=(millivolt)(mA)=(milliamp)(mM)=(millimolar)}INDEPENDENT{tFROM0TO1WITH100(ms)}NEURON{SUFFIXkaUSEIONkREADekWRITEikRANGEgkbar,ik,qkGLOBALshiftm,shifth}UNITS{PI=(pi)(1)FARADAY=96485.309(coul)R=(k-mole)(joule/degC)}PARAMETER{celsius(degC)gkbar=1e-3(cm/s)shiftm=0(mV)shifth=0(mV)}ASSIGNED{ik(mA/cm2)v(mV)ek(mV)diam(um)}STATE{amacbmbcqk}BREAKPOINT{SOLVEkstateMETHODsparseik=gkbar*am*am*bm*(v-ek)}INITIAL{am=a_inf(v)ac=1-ambm=b_inf(v)bc=1-bmqk=0ik=gkbar*am*am*bm*(v-ek)}LOCALa1,a2,b1,b2KINETICkstate{a1=a_m(v)a2=a_c(v)b1=b_m(v)b2=b_c(v)~ac<->am(a1,a2)~bc<->bm(b1,b2)CONSERVEam+ac=1CONSERVEbm+bc=1COMPARTMENTdiam*diam*PI/4{qk}~qk<<((-ik*diam)*PI*(1e4)/FARADAY)}FUNCTIONa_m(v(mV)){LOCALshiftTABLEDEPENDshiftmFROM-150TO150WITH200shift=-30+shiftma_m=0.02*(13.1-v-70-shift)/(exp((13.1-v-70-shift)/10)-1)}FUNCTIONa_c(v(mV)){LOCALshiftTABLEDEPENDshiftmFROM-150TO150WITH200shift=-30+shiftma_c=0.0175*(v-40.1+70+shift)/(exp((v-40.1+70+shift)/10)-1)}FUNCTIONb_m(v(mV)){TABLEDEPENDshifthFROM-150TO150WITH200b_m=0.016*exp((-13-v-70-shifth)/18)}FUNCTIONb_c(v(mV)){TABLEDEPENDshifthFROM-150TO150WITH200b_c=0.5/(1+exp((10.1-v-70-shifth)/5))}FUNCTIONa_inf(v(mV)){a_inf=a_m(v)/(a_m(v)+a_c(v))}FUNCTIONb_inf(v(mV)){b_inf=b_m(v)/(b_m(v)+b_c(v))}FUNCTIONwindow(v(mV)){window=gkbar*a_inf(v)*a_inf(v)*b_inf(v)*(v-ek)}FUNCTIONghk(v(mV),ci(mM),co(mM))(.001coul/cm3){LOCALz,eci,ecoz=(1e-3)*1*FARADAY*v/(R*(celsius+273.11247574))eco=co*efun(z)eci=ci*efun(-z)ghk=(.001)*1*FARADAY*(eci-eco)}FUNCTIONefun(z){if(fabs(z)<1e-4){efun=1-z/2}else{efun=z/(exp(z)-1)}}