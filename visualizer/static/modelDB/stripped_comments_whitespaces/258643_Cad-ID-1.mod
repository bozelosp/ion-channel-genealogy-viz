NEURON{SUFFIXcadUSEIONcaREADcai,icaWRITEcaiGLOBALPmax,betaRANGEcai_prime,CaCurr,CaDepEXTERNALapc_metap,fpc_metap}UNITS{(mV)=(millivolt)(mA)=(milliamp)(mM)=(milli/liter)(um)=(micrometer)}PARAMETER{Pmax=2(um/ms)beta=0.001z=2F=9.64846e4(coulomb)}ASSIGNED{diam(um)ica(mA/cm2)icalcium(mA/m2)dt(ms)cai_prime(mM/ms)CaCurr(mM/ms)CaDep(mM/ms)}STATE{cai(mM)}BREAKPOINT{SOLVECaUpdateMETHODcnexp}DERIVATIVECaUpdate{rates(ica,cai)cai'=CaCurr-CaDep}INITIAL{cai=5e-5}PROCEDURErates(ica(mA/cm2),cai(mM)){icalcium=ica*-1e4(cm2/m2)CaCurr=(icalcium*4*beta)/(z*F*diam)CaDep=(Pmax*4*beta*cai)/diam}