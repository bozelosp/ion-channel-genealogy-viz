UNITS{(mA)=(milliamp)(mV)=(millivolt)(uF)=(microfarad)(molar)=(1/liter)(nA)=(nanoamp)(mM)=(millimolar)(um)=(micron)FARADAY=96520(coul)R=8.3134(joule/degC)}NEURON{SUFFIXtcaUSEIONtcaREADetcaWRITEitcaVALENCE2RANGEgtcaRANGEgcatbarRANGEainf,atau,binf,btau,itca}INDEPENDENT{tFROM0TO100WITH100(ms)}PARAMETER{v(mV)celsius=6.3(degC)dt(ms)gcatbar(mho/cm2)}STATE{ab}ASSIGNED{gtca(mho/cm2)itca(mA/cm2)etca(mV)ainfbinfatau(ms)btau(ms)aexpbexp}BREAKPOINT{SOLVEstatesgtca=gcatbar*a*a*bitca=gtca*(v-etca)}UNITSOFFINITIAL{trates(v)a=ainfb=binf}PROCEDUREstates(){trates(v)a=a+aexp*(ainf-a)b=b+bexp*(binf-b)VERBATIMreturn0;ENDVERBATIM}LOCALq10PROCEDURErates(v){LOCALalpha,beta,sumq10=3^((celsius-6.3)/10)alpha=-0.2*vtrap(v-19.26,-10)beta=0.009*exp(-v/22.03)sum=alpha+betaatau=1/sumainf=alpha/sumalpha=1e-6*exp(-v/16.26)beta=1/(exp((29.79-v)/10)+1)sum=alpha+betabtau=1/sumbinf=alpha/sum}PROCEDUREtrates(v){LOCALtincTABLEainf,aexp,binf,bexp,atau,btauDEPENDdt,celsiusFROM-100TO100WITH200rates(v)tinc=-dt*q10aexp=1-exp(tinc/atau)bexp=1-exp(tinc/btau)}FUNCTIONvtrap(x,y){if(fabs(x/y)<1e-6){vtrap=y*(1-x/y/2)}else{vtrap=x/(exp(x/y)-1)}}UNITSON