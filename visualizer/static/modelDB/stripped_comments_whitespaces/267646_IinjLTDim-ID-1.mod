NEURON{POINT_PROCESSIinjLTDimRANGEdel,ton,toff,num,amp,ssI,iELECTRODE_CURRENTi}UNITS{(pA)=(picoamp)(nA)=(nanoamp)}PARAMETER{del=1000(ms)ton=8000(ms)<0,1e9>toff=1000(ms)<0,1e9>num=2amp=18.87043569(pA)ssI=40(pA)}ASSIGNED{Ncountival(nA)i(nA)ontallytr(ms)Part1Part2Part3ssInA(nA)ampnA(nA)}INITIAL{i=0ssInA=0.001*ssIampnA=amp*0.001ival=0tally=numNcount=0if(tally>0){net_send(del,1)on=0tally=tally-1}}BREAKPOINT{LOCALtau1,tau2,tau3,t1,t2,t3,tt,PhotoItr=t-del-(ton+toff)*(Ncount-1)+dtif(on==1){tau1=0.140104647tau2=0.596464897tau3=0.590572966t1=0.230595125t2=0.691774291t3=0.035251144tt=tr/1000Part1=-exp(-(tt-t1)/tau1)Part2=exp(-(tt-t2)/tau2)Part3=-exp(-(tt-t3)/tau3)PhotoI=(Part1+Part2+Part3)if(PhotoI>=0){i=ssInA-ival*(Part1+Part2+Part3)}else{i=ssInA}}else{i=ssInA+ival}}NET_RECEIVE(w){if(flag==1){if(on==0){Ncount=Ncount+1ival=ampnAon=1net_send(ton,1)}else{ival=0on=0if(tally>0){net_send(toff,1)tally=tally-1}}}}