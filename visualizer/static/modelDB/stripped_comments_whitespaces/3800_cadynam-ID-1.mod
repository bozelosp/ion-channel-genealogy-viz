NEURON{SUFFIXCadynamUSEIONcaREADica,caiWRITEcaiUSEIONcuREADcuiVALENCE2USEIONcrREADicr,criVALENCE2RANGEVi,Vrel,Vup,Trpn,Kmtrpn,Cmdn,Kmcmdn,cupmax,Kup}UNITS{(mM)=(milli/liter)(mA)=(milliamp)F=(faraday)(coulombs)}ASSIGNED{icr(mA/cm2)ica(mA/cm2)cui(mm)cri(mM)}PARAMETER{Vi=13668e-12(cm3)Vup=1109.52e-12(cm3)Vrel=96.48e-12(cm3)Trpn=0.07(mM)Kmtrpn=0.0005(mM)Cmdn=0.05(mM)Kmcmdn=0.00238(mM)Iupmax=0.005(mM/ms)cupmax=15(mM)Kup=0.00092(mM)}STATE{caiSTART0.0001(mM)<1e-6>}LOCALViF,VuP,VeRINITIAL{VERBATIMcai=_ion_cai;ENDVERBATIMViF=Vi*F*2e4VuP=Vup/ViVeR=Vrel/Vi}BREAKPOINT{SOLVEstateMETHODderivimplicit}DERIVATIVEstate{cai'=(-0.5*ica/(ViF)+VuP*(cui*Iupmax/cupmax-Iupmax/(1+(Kup/cai)))+0.5*icr*VeR)/(1+Trpn*Kmtrpn/((cai+Kmtrpn)*(cai+Kmtrpn))+Cmdn*Kmcmdn/((cai+Kmcmdn)*(cai+Kmcmdn)))}