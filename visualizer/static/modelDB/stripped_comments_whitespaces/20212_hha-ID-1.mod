NEURON{SUFFIXhhaUSEIONnaREADenaWRITEinaUSEIONkREADekWRITEikNONSPECIFIC_CURRENTilRANGEgnabar,gkbar,gl,elRANGEar2,vhalfsRANGEinf,fac,tauRANGEtausRANGEWGLOBALtaumin}UNITS{(mA)=(milliamp)(mV)=(millivolt)}INDEPENDENT{tFROM0TO1WITH1(ms)}PARAMETER{a0r=0.0003(ms)b0r=0.0003(ms)zetar=12(1)zetas=12(1)gms=0.2(1)gmr=0.2(1)a0s=0.0003(ms)vvs=2(mV)vhalfr=-60(mV)v(mV)W=0.016(/mV)celsius=34(degC)dt(ms)gnabar=0(mho/cm2)gkbar=0(mho/cm2)gl=0(mho/cm2)ena=60(mV)ek=-77(mV)el=-70.0(mV)ar2=1.0b=0taumin=3}STATE{mhnls}ASSIGNED{ina(mA/cm2)ik(mA/cm2)il(mA/cm2)inf[5]fac[5]tau[5]}BREAKPOINT{SOLVEstatesina=gnabar*m*m*h*s*(v-ena)ik=gkbar*n*n*l*(v-ek)il=gl*(v-el)}INITIAL{states()s=1l=1h=1ina=gnabar*m*m*h*s*(v-ena)ik=gkbar*n*n*l*(v-ek)il=gl*(v-el)}PROCEDUREcalcg(){mhn(v*1(/mV))m=m+fac[0]*(inf[0]-m)h=h+fac[1]*(inf[1]-h)n=n+fac[2]*(inf[2]-n)l=l+fac[3]*(inf[3]-l)s=s+fac[4]*(inf[4]-s)}PROCEDUREstates(){calcg()VERBATIMreturn0;ENDVERBATIM}FUNCTIONvarss(v,i){LOCALmax,min,vhalf,smoothif(i==0){varss=1/(1+exp((v+40)/(-3)))}elseif(i==1){varss=1/(1+exp((v+45)/(2.5)))}elseif(i==2){varss=1/(1+exp((v+40)/(-2)))}elseif(i==3){varss=(1+1.6/(1+exp((v+65)/12)))/2.52}else{max=1min=0smooth=2vhalf=-60varss=alpv(v,vhalfr)}}FUNCTIONalpr(v(mV)){alpr=exp(1.e-3*zetar*(v-vhalfr)*9.648e4/(8.315*(273.16+celsius)))}FUNCTIONalpv(v(mV),vh){alpv=(1+ar2*exp((v-vh)/vvs))/(1+exp((v-vh)/vvs))}FUNCTIONbetr(v(mV)){betr=exp(1.e-3*zetar*gmr*(v-vhalfr)*9.648e4/(8.315*(273.16+celsius)))}FUNCTIONvartau(v,i){LOCALalpha,beta,sum,tmpif(i==0){vartau=0.05}elseif(i==1){vartau=0.5}elseif(i==2){vartau=1.5}elseif(i==3){vartau=350}else{tmp=betr(v)/(a0r+b0r*alpr(v))if(tmp<taumin){tmp=taumin}VERBATIMENDVERBATIMvartau=tmp}}PROCEDUREmhn(v){LOCALa,bFROMi=0TO4{tau[i]=vartau(v,i)inf[i]=varss(v,i)fac[i]=(1-exp(-dt/tau[i]))}}