UNITS{(mA)=(milliamp)(mV)=(millivolt)(S)=(siemens)(pS)=(picosiemens)(um)=(micrometer)}NEURON{SUFFIXHHUSEIONnaREADenaWRITEinaUSEIONkREADekWRITEikRANGEgnabar,gkbarRANGEgna,gkRANGEnm,gkmbarRANGEm_exp,h_exp,n_exp,km_expRANGEkm_inf,tau_kmRANGEm_inf,h_inf,n_infGLOBALseedGLOBALvshiftGLOBALtaukm,NFTHREADSAFE}PARAMETER{gnabar=0.12(S/cm2)gkbar=0.036(S/cm2)gkmbar=.002(S/cm2)gamma_na=10(pS)gamma_k=10(pS)gamma_km=10(pS)seed=1vshift=0taukm=1NF=1hslow=100hfast=0.3}STATE{mhnnm}ASSIGNED{ina(mA/cm2)ikdr(mA/cm2)ikm(mA/cm2)ik(mA/cm2)gna(S/cm2)gk(S/cm2)gkm(S/cm2)ena(mV)ek(mV)dt(ms)area(um2)celsius(degC)v(mV)m_exph_expn_expkm_expm_infh_infn_infkm_inftau_m(ms)tau_h(ms)tau_n(ms)tau_km(ms)}INITIAL{rates(v)m=m_infh=h_infn=n_infnm=km_infset_seed(seed)}BREAKPOINT{SOLVEstatesgna=gnabar*((m)*(m)*(m)*(h))ina=gna*(v-ena)gk=gkbar*((n)*(n)*(n)*(n))ikdr=gk*(v-ek)gkm=gkmbar*((nm))ikm=gkm*(v-ek)ik=ikm+ikdr}PROCEDUREstates(){rates(v+vshift)m=m+m_exp*(m_inf-m)h=h+h_exp*(h_inf-h)n=n+n_exp*(n_inf-n)nm=nm+km_exp*(km_inf-nm)VERBATIMreturn0;ENDVERBATIM}PROCEDURErates(vm(mV)){LOCALa,b,iUNITSOFFa=-.6*vtrap((vm+30),-10)b=20*(exp((-1*(vm+55))/18))tau_m=1/(a+b)m_inf=addnoise(a*tau_m)a=0.4*(exp((-1*(vm+50))/20))b=6/(1+exp(-0.1*(vm+20)))tau_h=hslow/((1+exp((vm+30)/4))+(exp(-(vm+50)/2)))+hfasth_inf=addnoise(1/(1+exp((vm+44)/4)))a=-0.02*vtrap((vm+40),-10)b=0.4*(exp((-1*(vm+50))/80))tau_n=1/(a+b)n_inf=addnoise(a*tau_n)a=-.001/taukm*vtrap((vm+30),-9)b=.001/taukm*vtrap((vm+30),9)tau_km=1/(a+b)km_inf=addnoise(a*tau_km)m_exp=1-exp(-dt/tau_m)h_exp=1-exp(-dt/tau_h)n_exp=1-exp(-dt/tau_n)km_exp=1-exp(-dt/tau_km)UNITSON}FUNCTIONvtrap(x,y){if(fabs(exp(x/y)-1)<1e-6){vtrap=y*(1-x/y/2)}else{vtrap=x/(exp(x/y)-1)}}FUNCTIONaddnoise(input){addnoise=inputif(NF>0){addnoise=input*normrand(1,NF*input*(1-input))}if(addnoise<0){addnoise=0}if(addnoise>1){addnoise=1}}