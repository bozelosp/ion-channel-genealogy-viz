NEURON{SUFFIXHvaUSEIONcaREADcai,caoWRITEicaRANGEghvabar,ica,gca,eca}UNITS{(mA)=(milliamp)(mV)=(millivolt)}INDEPENDENT{tFROM0TO1WITH1(ms)}PARAMETER{v(mV)dt(ms)ghvabar=0.00034(mho/cm2)<0,1e9>}STATE{uz}ASSIGNED{ica(mA/cm2)uinfzinfutau(ms)ztau(ms)gca(mho/cm2)eca(mV)cai(mM)cao(mM)}INITIAL{rate(v)u=uinfz=zinf}BREAKPOINT{SOLVEstatesMETHODcnexpgca=ghvabar*u*u*zeca=12.5*log(cao/cai)ica=gca*(v-eca)}DERIVATIVEstates{rate(v)u'=(uinf-u)/utauz'=(zinf-z)/ztau}UNITSOFFPROCEDURErate(v(mV)){LOCALvu,vz,vxvx=-0.031*(v+37.1)vu=v+24.6if(fabs(vu)<1e-04){vu=vu+0.00001uinf=1/(1+exp(-(vu/11.3)))utau=(1.25*(2/(exp(vx)+exp(-vx))))}else{uinf=1/(1+exp(-(vu)/11.3))utau=(1.25*(2/(exp(vx)+exp(-vx))))}vz=v+12.6if(fabs(vz)<1e-04){vz=vz+0.00001zinf=1/(1+exp(vz/18.9))ztau=420}else{zinf=1/(1+exp(vz/18.9))ztau=420}}UNITSON