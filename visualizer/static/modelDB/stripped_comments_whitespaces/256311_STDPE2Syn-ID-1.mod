NEURON{POINT_PROCESSSTDPE2RANGEtau1,tau2,e,i,d,p,dtau,ptau,thresh,wmax,wminRANGEg,gbdel,gblen,gbint,gscaleNONSPECIFIC_CURRENTi}UNITS{(nA)=(nanoamp)(mV)=(millivolt)(uS)=(microsiemens)}PARAMETER{tau1=.1(ms)<1e-9,1e9>tau2=10(ms)<1e-9,1e9>e=0(mV)wmax=0(uS)wmin=0(uS)d=0<0,1>p=0.5dtau=34(ms)ptau=17(ms)thresh=-20(mV)gbdel=100(ms)<1e-9,1e9>gbint=100(ms)<1e-9,1e9>gblen=100(ms)<1e-9,1e9>gscale=0.1}ASSIGNED{v(mV)i(nA)tpost(ms)ong(uS)gsfactor}STATE{C(uS)B(uS)}INITIAL{LOCALtpif(tau1/tau2>.9999){tau1=.9999*tau2}C=0B=0tp=(tau1*tau2)/(tau2-tau1)*log(tau2/tau1)factor=-exp(-tp/tau1)+exp(-tp/tau2)factor=1/factorgs=1on=0tpost=-1e9net_send(0,1)net_send(gbdel,3)}BREAKPOINT{SOLVEstateMETHODcnexpg=B-Ci=g*gs*(v-e)}DERIVATIVEstate{C'=-C/tau1B'=-B/tau2}NET_RECEIVE(w(uS),A,tpre(ms)){INITIAL{A=0tpre=-1e9}if(flag==0){C=C+(w+A)*factorB=B+(w+A)*factortpre=tif(on==1){A=A*(1-d*exp((tpost-t)/dtau))}}elseif(flag==2&&on==1){tpost=tFOR_NETCONS(w1,A1,tp){A1=A1+(wmax-w1-A1)*p*exp((tp-t)/ptau)}}elseif(flag==1){WATCH(v>thresh)2}elseif(flag==3){if(on==0){on=1gs=gscalenet_send(gblen,3)}else{on=0gs=1net_send(gbint,3)}}}