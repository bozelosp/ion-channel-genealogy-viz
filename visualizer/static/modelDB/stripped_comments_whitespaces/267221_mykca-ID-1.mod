NEURON{SUFFIXmykcaUSEIONcaREADcaiUSEIONkREADekWRITEikRANGEgkbar,ik}UNITS{(mV)=(millivolt)(mA)=(milliamp)(S)=(siemens)(molar)=(1/liter)(mM)=(millimolar)FARADAY=(faraday)(kilocoulombs)R=(k-mole)(joule/degC)}PARAMETER{gkbar=0.01(S/cm2)d1=0.84(1)d2=1.0(1)k1=0.18(mM)k2=0.011(mM)bbar=0.28(/ms)abar=0.48(/ms)}ASSIGNED{cai(mM)celsius(degC)v(mV)ek(mV)ik(mA/cm2)oinftau(ms)}STATE{o}BREAKPOINT{SOLVEstateMETHODcnexpik=gkbar*o*(v-ek)}DERIVATIVEstate{rate(v,cai)o'=(oinf-o)/tau}INITIAL{rate(v,cai)o=oinf}FUNCTIONalp(v(mV),ca(mM))(1/ms){alp=abar/(1+exp1(k1,d1,v)/ca)}FUNCTIONbet(v(mV),ca(mM))(1/ms){bet=bbar/(1+ca/exp1(k2,d2,v))}FUNCTIONexp1(k(mM),d(1),v(mV))(mM){exp1=k*exp(-2*d*v*FARADAY/(R*(273.15(degC)+celsius)))}PROCEDURErate(v(mV),ca(mM)){LOCALaa=alp(v,ca)tau=1/(a+bet(v,ca))oinf=a*tau}