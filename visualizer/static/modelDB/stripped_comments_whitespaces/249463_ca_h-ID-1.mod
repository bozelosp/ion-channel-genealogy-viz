INDEPENDENT{tFROM0TO1WITH1(ms)}NEURON{SUFFIXcahUSEIONcaREADcai,caoWRITEicaRANGEpbar,minf,taum,hinf,tauh,shift,shifthGLOBALqm,qh}UNITS{(molar)=(1/liter)(mV)=(millivolt)(mA)=(milliamp)(mM)=(millimolar)FARADAY=(faraday)(coulomb)R=(k-mole)(joule/degC)}PARAMETER{v(mV)celsius(degC)pbar=.2e-3(cm/s)shift=2(mV)shifth=0(mV)cai(mM)cao(mM)qm=4qh=2offm=-14.17offh=-22.63offmt=-26.31offht=19.73slom=9.76sloh=6.6slomt=31.25sloht=21.2765957taummax=0.97tauhmax=70mmax=1.092mmin=0.75}STATE{mh}ASSIGNED{ica(mA/cm2)minftaum(ms)hinftauh(ms)phimphih}BREAKPOINT{SOLVEcastateMETHODcnexpica=pbar*m*m*h*ghk(v,cai,cao)}DERIVATIVEcastate{evaluatefct(v)m'=(minf-m)/taumh'=(hinf-h)/tauh}UNITSOFFINITIAL{phim=qm^((celsius-24)/10)phih=qh^((celsius-24)/10)evaluatefct(v)m=minfh=hinf}PROCEDUREevaluatefct(v(mV)){minf=mmax/(1+exp((offm-(v+shift))/slom))hinf=mmin/(1+exp(-(offh-(v+shifth))/sloh))taum=(taummax/(cosh(-(offmt-(v+shift))/slomt)))/phimtauh=(tauhmax/(cosh(-(offht-(v+shifth))/sloht)))/phih}FUNCTIONghk(v(mV),ci(mM),co(mM))(.001coul/cm3){LOCALz,eci,ecoz=(1e-3)*2*FARADAY*v/(R*(celsius+273.15))eco=co*efun(z)eci=ci*efun(-z)ghk=(.001)*2*FARADAY*(eci-eco)}FUNCTIONefun(z){if(fabs(z)<1e-4){efun=1-z/2}else{efun=z/(exp(z)-1)}}FUNCTIONnongat(v,cai,cao){nongat=pbar*ghk(v,cai,cao)}UNITSON