NEURON{POINT_PROCESSIzhi2007bSRANGEC,k,vr,vt,vpeak,a,b,c,d,Iin,celltype,alive,cellid,verbose,derivtypeNONSPECIFIC_CURRENTi}UNITS{(mV)=(millivolt)(uM)=(micrometer)}PARAMETER{C=1k=0.7vr=-60(mV)vt=-40(mV)vpeak=35(mV)a=0.03b=-2c=-50d=100Iin=0celltype=1alive=1cellid=-1}ASSIGNED{v(mV)i(nA)derivtype}STATE{u(mV)}INITIAL{u=0.0derivtype=2net_send(0,1)}BREAKPOINT{SOLVEstatesMETHODeuleri=-(k*(v-vr)*(v-vt)-u+Iin)/C/1000}FUNCTIONderivfunc(){if(celltype==5&&derivtype==2){derivfunc=a*(0-u)}elseif(celltype==5&&derivtype==1){derivfunc=a*((0.025*(v-d)*(v-d)*(v-d))-u)}elseif(celltype==5){VERBATIMhoc_execerror("izhi2007b.modERRA:derivtypenotset",0);ENDVERBATIM}else{derivfunc=a*(b*(v-vr)-u)}}DERIVATIVEstates{LOCALff=derivfunc()u'=f}NET_RECEIVE(w){if(flag==1){if(celltype==4){WATCH(v>(vpeak-0.1*u))2}elseif(celltype==6){WATCH(v>(vpeak+0.1*u))2}else{WATCH(v>vpeak)2}if(celltype==6||celltype==7){WATCH(v>-65)3WATCH(v<-65)4}if(celltype==5){WATCH(v>d)3WATCH(v<d)4}v=vr}elseif(flag==2){if(alive){net_event(t)}if(celltype==4){v=c+0.04*uif((u+d)<670){u=u+d}else{u=670}}elseif(celltype==5){v=c}elseif(celltype==6){v=c-0.1*uu=u+d}else{v=cu=u+d}}elseif(flag==3){if(celltype==5){derivtype=1}elseif(celltype==6){b=0}elseif(celltype==7){b=2}}elseif(flag==4){if(celltype==5){derivtype=2}elseif(celltype==6){b=15}elseif(celltype==7){b=10}}}