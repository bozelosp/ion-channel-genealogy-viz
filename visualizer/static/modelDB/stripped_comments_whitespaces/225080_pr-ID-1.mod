NEURON{POINT_PROCESSPrRANGEP,P0,random,f,tau_F,d1,tau_D1,F,D1,tlastTHREADSAFEPOINTERrandObjPtr}PARAMETER{P0=0.200(1)<0,1>f=1.769(1)<0,1e9>tau_F=67.351(ms)<1e-9,1e9>d1=0.878(1)<0,1>tau_D1=92.918(ms)<1e-9,1e9>}ASSIGNED{PrandObjPtrrandomFD1tlast(ms)}INITIAL{P=P0random=1F=1D1=1}NET_RECEIVE(weight){INITIAL{tlast=t}F=1+(F-1)*exp(-(t-tlast)/tau_F)D1=1-(1-D1)*exp(-(t-tlast)/tau_D1)if(P0*F*D1>1){P=1}else{P=P0*F*D1}random=randGen()if(random<=P){net_event(t)}tlast=tF=F+fD1=D1*d1}VERBATIM#ifndefNRN_VERSION_GTEQ_8_2_0doublenrn_random_pick(void*r);void*nrn_random_arg(intargpos);#defineRANDCAST#else#defineRANDCAST(Rand*)#endifENDVERBATIMFUNCTIONrandGen(){VERBATIMif(_p_randObjPtr){_lrandGen=nrn_random_pick(RANDCAST_p_randObjPtr);}else{hoc_execerror("RandomobjectrefnotsetcorrectlyforrandObjPtr","onlyviahocRandom");}ENDVERBATIM}PROCEDUREsetRandObjRef(){VERBATIMvoid**pv4=(void**)(&_p_randObjPtr);if(ifarg(1)){*pv4=nrn_random_arg(1);}else{*pv4=(void*)0;}ENDVERBATIM}