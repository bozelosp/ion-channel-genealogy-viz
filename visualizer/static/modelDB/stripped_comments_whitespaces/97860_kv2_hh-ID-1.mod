NEURON{SUFFIXkv2_hhUSEIONkREADekWRITEikRANGEg,ninf,tn,hinf,th,ik,gbarGLOBALvhn,vcn,vhh,vch,pGLOBALCtn,vhtn,atn,btn,tn0GLOBALCth,vhth,ath,bth,th0}UNITS{(S)=(siemens)(mV)=(millivolt)(mA)=(milliamp)}PARAMETER{gbar=1(S/cm2)vhn=17.5(mV)vcn=-10(mV)vhh=-25(mV)vch=-12(mV)p=.26Ctn=5(ms)vhtn=-30(mV)atn=14(mV)btn=20(mV)tn0=5(ms)Cth=500(ms)vhth=50(mV)ath=20(mV)bth=20(mV)th0=800(ms)Cq10=4celsius(degC)}ASSIGNED{g(S/cm2)v(mV)ninfhinftn(ms)th(ms)ik(mA/cm2)ek(mV)}STATE{nh}BREAKPOINT{SOLVEstatesMETHODcnexpg=gbar*n*hik=g*(v-ek)}DERIVATIVEstates{values()n'=(ninf-n)/tnh'=(hinf-h)/th}INITIAL{values()n=ninfh=hinf}PROCEDUREvalues(){LOCALq10q10=Cq10^((celsius-23(degC))/10(degC))ninf=1/(1+exp((v-vhn)/vcn))hinf=(1-p)/(1+exp(-(v-vhh)/vch))+ptn=q10*Ctn/(exp((v-vhtn)/atn)+exp(-(v-vhtn)/btn))+tn0th=q10*Cth/(exp((v-vhth)/ath)+exp(-(v-vhth)/bth))+th0}