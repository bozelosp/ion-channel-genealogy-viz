NEURON{SUFFIXk_olmUSEIONkREADekWRITEikRANGEgkbar,ikRANGERa,Rb,vhalf_a,vhalf_b,qa,qb}UNITS{(mA)=(milliamp)(mV)=(millivolt)(S)=(siemens)}PARAMETER{gkbar=0(S/cm2)Ra=0.018(/ms)Rb=0.0036(/ms)vhalf_a=25(mV)vhalf_b=35(mV)qa=25(mV)qb=12(mV)}ASSIGNED{v(mV)ek(mV)ik(mA/cm2)ninftaun(ms)}STATE{n}BREAKPOINT{SOLVEstatesMETHODcnexpik=gkbar*pow(n,4)*(v-ek)}DERIVATIVEstates{rates(v)n'=(ninf-n)/taun}INITIAL{rates(v)n=ninf}FUNCTIONExp(x){if(x<-100){Exp=0}else{Exp=exp(x)}}FUNCTIONvtrap(x(mV),y(mV))(1){if(fabs(x/y)<1e-6){vtrap=1(/mV)*y*(1-x/y/2)}else{vtrap=1(/mV)*x/(Exp(x/y)-1)}}PROCEDURErates(v(mV)){LOCALalpha,betaalpha=Ra*vtrap(-(v-vhalf_a),qa)beta=Rb*vtrap(v-vhalf_b,qb)taun=1/(alpha+beta)ninf=alpha*taun}