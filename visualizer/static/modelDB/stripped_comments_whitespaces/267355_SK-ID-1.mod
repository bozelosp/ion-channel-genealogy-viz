NEURON{SUFFIXskUSEIONkREADekWRITEikUSEIONtcaREADtcaiUSEIONncaREADncaiRANGEgbar,gkahp,ik,ninf,taun,gGLOBALCq10,mt,a0,b0,cahco,carco}UNITS{(mA)=(milliamp)(mV)=(millivolt)(molar)=(1/liter)(mM)=(millimolar)(pS)=(picosiemens)(um)=(micron)}PARAMETER{gbar=0.01(S/cm2)cai=50.e-6(mM)a0=1.3e4(1/ms-mM)b0=0.06(1/ms)celsius=37(degC)Cq10=2mt=0.2tcai(mM)ncai(mM)cahco=0.0carco=1}STATE{n}ASSIGNED{ik(mA/cm2)g(S/cm2)ninftaun(ms)a(1/ms)v(mV)ek(mV)}BREAKPOINT{SOLVEstateMETHODcnexpg=gbar*nik=g*(v-ek)}INITIAL{rate(tcai,ncai)n=ninf}DERIVATIVEstate{rate(tcai,ncai)n'=(ninf-n)/taun}PROCEDURErate(tcai(mM),ncai(mM)){LOCALq10q10=Cq10^((celsius-22(degC))/10(degC))a=a0*(tcai*carco+ncai*cahco)/10if(a<0.05){a=0}taun=b0ninf=a}