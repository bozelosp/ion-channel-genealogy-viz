UNITS{(mA)=(milliamp)(mV)=(millivolt)(S)=(siemens)}NEURON{SUFFIXkrpUSEIONkREADekWRITEikRANGEgkbar,ik}PARAMETER{gkbar=0.002(S/cm2)mvhalf=-13.5(mV)mslope=-11.8(mV)mshift=0(mV)hvhalf=-54.7(mV)hslope=18.6(mV)hshift=0(mV)a=0.7qfact=3.0}STATE{mh}ASSIGNED{ek(mV)v(mV)ik(mA/cm2)gk(S/cm2)minfhinf}BREAKPOINT{SOLVEstateMETHODcnexpgk=gkbar*m*(a*h+(1-a))ik=gk*(v-ek)}INITIAL{rates(v)m=minfh=hinf}FUNCTION_TABLEtaumkrp(v(mV))(ms)FUNCTION_TABLEtauhkrp(v(mV))(ms)DERIVATIVEstate{rates(v)m'=(minf-m)/(taumkrp(v)/qfact)h'=(hinf-h)/(tauhkrp(v)/qfact)}PROCEDURErates(v(mV)){TABLEminf,hinfDEPENDmshift,hshiftFROM-200TO200WITH201minf=1/(1+exp((v-mvhalf-mshift)/mslope))hinf=1/(1+exp((v-hvhalf-hshift)/hslope))}