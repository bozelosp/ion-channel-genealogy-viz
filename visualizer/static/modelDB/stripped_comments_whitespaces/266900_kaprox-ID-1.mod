UNITS{(mA)=(milliamp)(mV)=(millivolt)}PARAMETER{currv(mV)celsius(degC)gkabar=.008(mho/cm2)vhalfn=11(mV)vhalfl=-56(mV)a0l=0.05(/ms)a0n=0.05(/ms)zetan=-1.5(1)zetal=3(1)gmn=0.55(1)gml=1(1)lmin=2(mS)nmin=0.1(mS)pw=-1(1)tq=-40qq=5q10=5qtl=1ekek2=-80(mV)sh=0(mV)count=1vrun(mV)delta=0vinit=-76.2alpha=1.06sh2alphash0=0alphash1=0.15vvrun=0timestep=1000vrun2v0dv0ddvflag=0FK=2PK=1BK=2.11CK=48stim_moltK=1}NEURON{SUFFIXkapPOINTERstim_iUSEIONkREADekWRITEikRANGEflag,curr,gkabar,gka,sh,ek2,vrun,count,vvrun,vrun2,delta2,stim_moltKGLOBALninf,linf,taul,taun,lmin,alpha}STATE{nl}ASSIGNED{ik(mA/cm2)ninflinftaultaungkastim_i}INITIAL{vrun=0vvrun=vrunrates(v,sh2)n=ninfl=linf}BREAKPOINT{SOLVEstatesMETHODcnexpgka=gkabar*n*lek2=ek+vvrun*alphaik=gka*(v-ek2)}FUNCTIONalpn(v(mV)){LOCALzetazeta=zetan+pw/(1+exp((v-tq)/qq))alpn=exp(1.e-3*zeta*(v-vhalfn)*9.648e4/(8.315*(273.16+celsius)))}FUNCTIONbetn(v(mV)){LOCALzetazeta=zetan+pw/(1+exp((v-tq)/qq))betn=exp(1.e-3*zeta*gmn*(v-vhalfn)*9.648e4/(8.315*(273.16+celsius)))}FUNCTIONalpl(v(mV)){alpl=exp(1.e-3*zetal*(v-vhalfl)*9.648e4/(8.315*(273.16+celsius)))}FUNCTIONbetl(v(mV)){betl=exp(1.e-3*zetal*gml*(v-vhalfl)*9.648e4/(8.315*(273.16+celsius)))}DERIVATIVEstates{rates(v,sh2)n'=(ninf-n)/taunl'=(linf-l)/taul}BEFORESTEP{LOCALiif(stim_i==0&&flag==0){vrun=0vvrun=0}else{flag=1delta=v-vinitif(count<timestep+1){vrun=(delta-vrun)*(FK/(count+1))+vrunvrun2=vrun}else{vrun2=(delta)*(FK/(timestep+1))+vrun2*pow((1-FK/(timestep+1)),PK)}vvrun=(BK*vrun2/(1+vrun2/CK))count=count+1}sh2=sh+alphash1*vvrun}PROCEDURErates(v(mV),sh2){LOCALa,qt,iqt=q10^((celsius-24)/10)a=alpn(v-sh2)ninf=1/(1+a)taun=betn(v-sh2)/(qt*a0n*(1+a))if(taun<nmin){taun=nmin}a=alpl(v-sh2)linf=1/(1+a)taul=0.26*(v+50-sh2)/qtlif(taul<lmin/qtl){taul=lmin/qtl}}