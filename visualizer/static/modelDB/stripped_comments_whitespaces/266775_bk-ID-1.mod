UNITS{(molar)=(1/liter)(mV)=(millivolt)(mA)=(milliamp)(mM)=(millimolar)FARADAY=(faraday)(kilocoulombs)R=(k-mole)(joule/degC)}NEURON{SUFFIXbkUSEIONcaREADcaiUSEIONkREADekWRITEikRANGEgbar,ik}PARAMETER{gbar=0.0(mho/cm2)k1=0.180(mM)k4=0.011(mM)}ASSIGNED{v(mV)ik(mA/cm2)celsius(degC)cai(mM)ek(mV)oinfotau(ms)}STATE{o}BREAKPOINT{SOLVEstateMETHODcnexpik=gbar*o*(v-ek)}DERIVATIVEstate{rate(v,cai)o'=(oinf-o)/otau}INITIAL{rate(v,cai)o=oinf}PROCEDURErate(v(mV),ca(mM)){LOCALa,b,sum,zUNITSOFFz=1e-3*2*FARADAY/(R*(celsius+273.15))a=0.48*ca/(ca+k1*exp(-0.84*z*v))b=0.28/(1+ca/(k4*exp(-z*v)))sum=a+boinf=a/sumotau=1/sumUNITSON}