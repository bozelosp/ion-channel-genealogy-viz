UNITS{(mA)=(milliamp)(mV)=(millivolt)(S)=(siemens)(molar)=(1/liter)(mM)=(millimolar)}NEURON{THREADSAFESUFFIXKD_ca3USEIONkREADekWRITEikUSEIONcaREADcaiRANGEgmax,g,taun,taulGLOBALtnmax,tlmax}PARAMETER{gmax=0.01(mho/cm2)vhalfn=-49(mV)vn2=-60(mV)zn=7.0(mV)tnmax=10(ms)tnmin=1.5(ms)tns=-5.5(mV)np=2vhalfl=-70(mV)zl=-3.5(mV)tlmax=1050(ms)tlmin=70(ms)vl2=-75(mV)tls=15(mV)cavm=18(mV)lcp=1(1)kD=4e-4(mM)tauca=20(ms)}STATE{nlov(mV)ovs(mV)}ASSIGNED{v(mV)ek(mV)cai(mM)ik(mA/cm2)ninflinfvs(mV)taul(ms)taun(ms)g(S/cm2)}BREAKPOINT{SOLVEstatesMETHODcnexpl=1/(1+exp((vhalfl-ov+ovs)/zl))g=gmax*n^np*lik=g*(v-ek)}INITIAL{lf(v)rates(v)n=ninfl=1/(1+exp((vhalfl-v)/zl)*exp(vs/zl))ov=vovs=vs}FUNCTIONalpn(v(mV)){alpn=exp((vhalfn-v)/zn)}FUNCTIONbetn(v(mV)){betn=exp((vn2-v)/tns)}DERIVATIVEstates{lci(cai)rates(v)n'=(ninf-n)/taunov'=(v-ov)/taulovs'=(vs-ovs)/tauca}PROCEDURElf(v(mV)){LOCALdvdt,dsdtlci(cai)linf=1/(1+exp((vhalfl-ov+ovs)/zl))}PROCEDURErates(v(mV)){LOCALaTABLEninf,taun,taulDEPENDvhalfn,tlmax,tnmax,tnminFROM-100TO50WITH600a=alpn(v)ninf=1/(1+a)taun=4*(tnmax-tnmin)/(1+betn(v))*ninf+tnmintaul=2*tlmax/(exp((v-vl2)/tls)+exp((vl2-v)/tls))+tlmin}PROCEDURElci(cai(mM)){TABLEvsDEPENDlcp,kD,cavmFROM0TO0.02WITH500vs=cavm-cavm/(1+(cai/kD)^lcp)}