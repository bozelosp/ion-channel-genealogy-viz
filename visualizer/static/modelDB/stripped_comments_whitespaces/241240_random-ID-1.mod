NEURON{SUFFIXnothing}VERBATIM#include<stdio.h>#include<stdlib.h>#include<math.h>#include<limits.h>#if!defined(MAXLONG)#include<limits.h>#defineMAXLONGLONG_MAX#endifstaticintdev0_first=1;staticlongdev0_seed;externdoubledu_dev0();externdoubledu_dev(doublemin,doublemax);externintiu_dev(intmin,intmax);externdoubledexp_dev0();externdoubledexp_dev(doublelambda);externdoubledgauss_dev0();externdoubledgauss_dev(doublemean,doublesdev);externintigeom_dev(doublepg);doubleran2(long*);ENDVERBATIMFUNCTIONset_dev0_seed(seed){VERBATIMdev0_first=0;dev0_seed=-1*(long)_lseed;ran2(&dev0_seed);ENDVERBATIMset_dev0_seed=1}VERBATIMdoubledu_dev0(){doubler2;if(dev0_first){dev0_first=0;dev0_seed=1234;}r2=ran2(&dev0_seed);returnr2;}ENDVERBATIMVERBATIMdoubledu_dev(doublemin,doublemax){return(min+(max-min)*du_dev0());}intiu_dev(intmin,intmax){return((int)((double)min+(double)(max-min+1)*du_dev0()));}doubledexp_dev0(){doubledum;dodum=du_dev0();while(dum==0.0);return(-log(dum));}doubledexp_dev(doublelambda){return(dexp_dev0()/lambda);}doubledgauss_dev0(){staticintNotHave=1;staticdoubleX2;doubleV1,V2,S,LS;if(NotHave){NotHave=0;do{V1=2.0*du_dev0()-1.0;V2=2.0*du_dev0()-1.0;}while((S=V1*V1+V2*V2)>1.0);LS=sqrt((-2.0*log(S))/S);X2=V2*LS;return(V1*LS);}else{NotHave=1;return(X2);}}doubledgauss_dev(doublemean,doublesdev){return(dgauss_dev0()*sdev+mean);}intigeom_dev(doublepg){intig;ig=1;while(pg<du_dev0()&&pg<=1.0)ig++;return(ig);}#defineIM12147483563#defineIM22147483399#defineAM(1.0/IM1)#defineIMM1(IM1-1)#defineIA140014#defineIA240692#defineIQ153668#defineIQ252774#defineIR112211#defineIR23791#defineNTAB32#defineNDIV(1+IMM1/NTAB)#defineEPS1.2e-7#defineRNMX(1.0-EPS)doubleran2(long*idum){intj;longk;staticlongidum2=123456789;staticlongiy=0;staticlongiv[NTAB];doubletemp;if(*idum<=0){if(-(*idum)<1)*idum=1;else*idum=-(*idum);idum2=(*idum);for(j=NTAB+7;j>=0;j--){k=(*idum)/IQ1;*idum=IA1*(*idum-k*IQ1)-k*IR1;if(*idum<0)*idum+=IM1;if(j<NTAB)iv[j]=*idum;}iy=iv[0];}k=(*idum)/IQ1;*idum=IA1*(*idum-k*IQ1)-k*IR1;if(*idum<0)*idum+=IM1;k=idum2/IQ2;idum2=IA2*(idum2-k*IQ2)-k*IR2;if(idum2<0)idum2+=IM2;j=iy/NDIV;iy=iv[j]-idum2;iv[j]=*idum;if(iy<1)iy+=IMM1;if((temp=AM*iy)>RNMX)returnRNMX;elsereturntemp;}#undefIM1#undefIM2#undefAM#undefIMM1#undefIA1#undefIA2#undefIQ1#undefIQ2#undefIR1#undefIR2#undefNTAB#undefNDIV#undefEPS#undefRNMXENDVERBATIM