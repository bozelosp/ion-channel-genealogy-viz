NEURON{SUFFIXiCcrUSEIONkREADki,koWRITEikUSEIONcaREADcaiRANGEik,gk,gkcbar}UNITS{(mM)=(milli/liter)(mA)=(milliamp)(mV)=(millivolt)}INDEPENDENT{tFROM0TO1WITH1(ms)}PARAMETER{v(mV)dt(ms)cai(mM)gkcbar=0.0022(mho/cm2)}STATE{c}ASSIGNED{ik(mA/cm2)cinfctau(ms)gk(mho/cm2)ek(mV)ki(mM)ko(mM)}INITIAL{rate()c=cinf}BREAKPOINT{SOLVEstatesMETHODcnexpgk=gkcbar*c*cek=25*log(ko/ki)ik=gk*(v-ek)}DERIVATIVEstates{rate()c'=(cinf-c)/ctau}UNITSOFFFUNCTIONcalf(v(mV),cai(mM))(/ms){LOCALvs,vavs=v+40*log10(1000*cai)va=vs+18if(fabs(va)<1e-04){va=va+0.0001}calf=(-0.00642*vs-0.1152)/(-1+exp(-va/12))}FUNCTIONcbet(v(mV),cai(mM))(/ms){LOCALvs,vbvs=v+40*log10(cai*1000)vb=vs+152if(fabs(vb)<1e-04){vb=vb+0.0001}cbet=1.7*exp(-vb/30)}UNITSONPROCEDURErate(){LOCALcsum,ca,cbca=calf(v,cai)cb=cbet(v,cai)csum=ca+cbcinf=ca/csumif((1/csum)>1.1){ctau=1/csum}else{ctau=1.1}}