INDEPENDENT{tFROM0TO1WITH1(ms)}NEURON{SUFFIXcadUSEIONcaREADica,caiWRITEcaiRANGEca,depthGLOBALcainf,taur}UNITS{(molar)=(1/liter)(mM)=(millimolar)(um)=(micron)(mA)=(milliamp)(msM)=(msmM)}PARAMETER{depth=.2(um)taur=0.1(ms)cainf=4e-5(mM)cai(mM)}STATE{ca(mM)}INITIAL{ca=cainfcai=ca}ASSIGNED{ica(mA/cm2)drive_channel(mM/ms)}BREAKPOINT{SOLVEstateMETHODcnexp}DERIVATIVEstate{drive_channel=-(10000)*ica/(2*96494*depth)if(drive_channel<=0.){drive_channel=0.}ca'=drive_channel+(cainf-ca)/taurcai=ca}