NEURON{SUFFIXhha2USEIONnaREADenaWRITEinaUSEIONkREADekWRITEikNONSPECIFIC_CURRENTilRANGEgnabar,gkbar,gl,el,ik,inaRANGEar2,vhalfsGLOBALinf,tau,taumin}UNITS{(mA)=(milliamp)(mV)=(millivolt)}PARAMETER{a0r=0.0003(/ms)b0r=0.0003(/ms)zetar=12zetas=12gmr=0.2ar2=1.0taumin=10(ms)vvs=2(mV)vhalfr=-60(mV)vvh=-58(mV)gnabar=0(mho/cm2)gkbar=0(mho/cm2)gl=0(mho/cm2)el=-70.0(mV)}ASSIGNED{celsius(degC)v(mV)ena(mV)ek(mV)ina(mA/cm2)ik(mA/cm2)il(mA/cm2)inf[4]tau[4](ms)}STATE{mhns}INITIAL{rates(v,ar2)m=inf[0]h=inf[1]n=inf[2]s=inf[3]}BREAKPOINT{SOLVEstatesMETHODcnexpina=gnabar*m*m*h*s*(v-ena)ik=gkbar*n*n*(v-ek)il=gl*(v-el)}DERIVATIVEstates{rates(v,ar2)m'=(inf[0]-m)/tau[0]h'=(inf[1]-h)/tau[1]n'=(inf[2]-n)/tau[2]s'=(inf[3]-s)/tau[3]}PROCEDURErates(v(mV),a2){LOCALtmp,cFROMi=0TO2{tau[i]=vartau(v,i)inf[i]=varss(v,i)}tau[3]=betr(v)/(a0r*(1+alpr(v)))if(tau[3]<taumin){tau[3]=taumin}c=alpv(v)inf[3]=c+a2*(1-c)}FUNCTIONvarss(v(mV),i){if(i==0){varss=1/(1+exp((v+44)/(-3(mV))))}elseif(i==1){varss=1/(1+exp((v+49)/(3.5(mV))))}elseif(i==2){varss=1/(1+exp((v+46.3)/(-3(mV))))}}FUNCTIONalpv(v(mV)){alpv=1/(1+exp((v-vvh)/vvs))}FUNCTIONalpr(v(mV)){UNITSOFFalpr=exp(1.e-3*zetar*(v-vhalfr)*9.648e4/(8.315*(273.16+celsius)))UNITSON}FUNCTIONbetr(v(mV)){UNITSOFFbetr=exp(1.e-3*zetar*gmr*(v-vhalfr)*9.648e4/(8.315*(273.16+celsius)))UNITSON}FUNCTIONvartau(v(mV),i)(ms){LOCALtmpif(i==0){vartau=0.05(ms)}elseif(i==1){vartau=1(ms)}elseif(i==2){vartau=3.5(ms)}}