UNITS{(molar)=(1/liter)(mM)=(millimolar)(mA)=(milliamp)(mV)=(millivolt)}NEURON{SUFFIXskUSEIONkREADekWRITEikUSEIONncaREADncaiVALENCE2USEIONlcaREADlcaiVALENCE2USEIONtcaREADtcaiVALENCE2RANGEgsk,gskbar,qinf,qtau,ik}INDEPENDENT{tFROM0TO1WITH1(ms)}PARAMETER{celsius=6.3(degC)v(mV)dt(ms)gskbar(mho/cm2)ek(mV)cai(mM)ncai(mM)lcai(mM)tcai(mM)}STATE{q}ASSIGNED{ik(mA/cm2)gsk(mho/cm2)qinfqtau(ms)qexp}BREAKPOINT{SOLVEstategsk=gskbar*q*qik=gsk*(v-ek)}UNITSOFFINITIAL{cai=ncai+lcai+tcairate(cai)q=qinfVERBATIMncai=_ion_ncai;lcai=_ion_lcai;tcai=_ion_tcai;ENDVERBATIM}PROCEDUREstate(){cai=ncai+lcai+tcairate(cai)q=q+(qinf-q)*qexpVERBATIMreturn0;ENDVERBATIM}LOCALq10PROCEDURErate(cai){LOCALalpha,beta,tincq10=3^((celsius-6.3)/10)alpha=0.00246/exp((12*log10(cai)+28.48)/-4.5)beta=0.006/exp((12*log10(cai)+60.4)/35)qtau=1/(alpha+beta)qinf=alpha*qtautinc=-dt*q10qexp=1-exp(tinc/qtau)*q10}UNITSON