INDEPENDENT{tFROM0TO1WITH1(ms)}NEURON{SUFFIXCaL12USEIONCaREADCai,CaoWRITEiCaVALENCE2RANGEminf,mtau,hinf,htau,iCa,pGLOBALpmax}UNITS{(mA)=(milliamp)(mV)=(millivolt)(mM)=(milli/liter)FARADAY=96489(coul)R=8.314(volt-coul/degC)}PARAMETER{v(mV)celsius(degC)Cai(mM)Cao(mM)pmax=6.7e-6(cm/s)}CONSTANT{a=0.17(1)}STATE{mh}ASSIGNED{iCa(mA/cm2)mtau(ms)minfhinfhtau(ms)p(cm/s)}BREAKPOINT{SOLVEstateMETHODeulerp=pmax*m*m*(a*h+(1-a))iCa=p*ghk(v,Cai,Cao,2)}DERIVATIVEstate{rates(v)m'=(minf-m)/mtauh'=(hinf-h)/htau}INITIAL{rates(v)m=minfh=hinf}FUNCTIONghk(v(mV),ci(mM),co(mM),z)(millicoul/cm3){LOCALe,ww=v*(.001)*z*FARADAY/(R*(celsius+273.16))if(fabs(w)>1e-4){e=w/(exp(w)-1)}else{e=1-w/2}ghk=-(.001)*z*FARADAY*(co-ci*exp(w))*e}PROCEDURErates(v(mV)){LOCALm_alpha,m_betam_alpha=0.1194*(v+8.124)/(exp((v+8.124)/9.005)-1)m_beta=2.97*exp(v/31.4)mtau=1/(m_alpha+m_beta)htau=14.77minf=1/(1+exp((v+8.9)/-6.7))hinf=1/(1+exp((v+13.4)/11.9))}