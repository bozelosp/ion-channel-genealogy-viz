NEURON{SUFFIXcapumpUSEIONcaREADcaiWRITEicaRANGEicaGLOBALVmax,Km,hill,Vconv,carest}UNITS{(mA)=(milliamp)(mV)=(millivolt)FARADAY=(faraday)(coulombs)}PARAMETER{Vmax=352(uM/s)vol_surf_ratio=1.85(um)Km=.0069(mM)hill=1scale=1e-4}ASSIGNED{ica(mA/cm2)cai(mM)Vconvcarest}INITIAL{VERBATIMcai=_ion_cai;carest=_ion_cai;ENDVERBATIMica=pumprate(cai)*scale}BREAKPOINT{ica=pumprate(cai)*scale}FUNCTIONpumprate(ci){Vconv=Vmax*vol_surf_ratio*FARADAY*2*(1e-4)if(fabs(ci-carest)<1e-7){pumprate=(ci-carest)*Vconv/Km}else{pumprate=Vconv/(1+Km/(ci-carest))}}