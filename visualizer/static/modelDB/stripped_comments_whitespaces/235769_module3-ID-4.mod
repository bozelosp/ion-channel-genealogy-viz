UNITS{}NEURON{SUFFIXfHillRANGEa0,b0,c0,d0RANGEp0,g1,g2,g3RANGEKse,A,Fc,FRANGExm_init,xm,xce_init,xceUSEIONmgREADmgiVALENCE2USEIONclREADcli}PARAMETER{a0=2.35b0=24.35c0=-7.4d0=30.3p0=23g1=-8g2=21.4xm_init=-8xce_init=-8Kse=0.4}STATE{Axcexm}ASSIGNED{FFcmgicli}BREAKPOINT{LOCALd_xm,d_xce,d_seA=mgixm=cliSOLVEstate_hillMETHODcnexpF=p0*Kse*xse(xm,xce)}DERIVATIVEstate_hill{Fc=p0*g(xm)*Axce'=dxdt(F,Fc)}FUNCTIONxse(x,y){LOCALd_xm,d_xce,d_sed_xm=xm-xm_initd_xce=xce-xce_initd_se=d_xm-d_xceif(d_se<=0){xse=0}else{xse=d_se}}FUNCTIONg(x){g=exp(-((x-g1)/g2)^2)}FUNCTIONdxdt(x,xc){LOCALgain_lengthif(x<=xc){dxdt=(10^-3)*(-b0*(xc-x))/(x+a0*xc/p0)}else{gain_length=(-d0*(xc-x))/(2*xc-x+c0*xc/p0)if(gain_length<=0){dxdt=(10^-3)*1e5}else{dxdt=(10^-3)*gain_length}}}INITIAL{A=0xm=xm_initxce=xce_initF=1e-5}