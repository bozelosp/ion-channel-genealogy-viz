NEURON{SUFFIXCaTUSEIONcaREADecaWRITEicaVALENCE2RANGEgcat,eca,mt,ht,x,y,vhfa,vhfi,sla,sli,icatGLOBALcinf,binf,tauc,taub,q10}UNITS{(mA)=(milliamp)(mV)=(millivolt)(molar)=(1/liter)(mM)=(millimolar)FARADAY=(faraday)(coulomb)R=(k-mole)(joule/degC)}PARAMETER{v(mV)celsius(degC)dt(ms)gcat=0.0002(mho/cm2)mt=0.1ht=0.5x=2y=1vhfa=-36.9(mV)vhfi=-74.8(mV)sla=6.6(mV)sli=50(mV)q10=2eca=51(mV)}ASSIGNED{ica(mA/cm2)icat(mA/cm2)cinfbinftauctaub}STATE{bc}INITIAL{rates(v)b=binfc=cinf}BREAKPOINT{SOLVEstatesMETHODcnexpica=gcat*b^x*c^y*(v-eca)icat=ica}DERIVATIVEstates{rates(v)b'=(binf-b)/taubc'=(cinf-c)/tauc}PROCEDURErates(v(mV)){LOCALa,qtUNITSOFFqt=q10^((celsius-37)/10)binf=1/(1+exp((vhfa-v)/sla))cinf=1/(1+exp((v-vhfi)/sli))taub=mt*qt*(0.45+(3.9/(1+((v+66)/26)^2)))tauc=ht*qt*(150-(150/((1+exp((v-417.43)/203.18))*(1+exp(-(v+61.11)/8.07)))))UNITSON}FUNCTIONtrap0(v,th,a,q){if(fabs(v-th)>1e-6){trap0=a*(v-th)/(1-exp(-(v-th)/q))}else{trap0=a*q}}