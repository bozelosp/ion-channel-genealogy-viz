NEURON{SUFFIXcdp20N_FD2USEIONcaREADcao,cai,icaWRITEcaiRANGEica_pmpGLOBALvrat,TotalPump}DEFINENannuli20UNITS{(mol)=(1)(molar)=(1/liter)(mM)=(millimolar)(um)=(micron)(mA)=(milliamp)FARADAY=(faraday)(10000coulomb)PI=(pi)(1)}PARAMETER{celsius=34(degC)cainull=45e-6(mM)mginull=.59(mM)DCa=.233(um2/ms)Dbtc=0.007(um2/ms)Ddmnpe=0.08(um2/ms)Dcbd1=.028(um2/ms)Dcbd2=0(um2/ms)Dpar=.043(um2/ms)BTCnull=0(mM)b1=5.33(/msmM)b2=0.08(/ms)DMNPEnull=0(mM)c1=5.63(/msmM)c2=0.107e-3(/ms)CBnull=.08nf1=43.5(/msmM)nf2=3.58e-2(/ms)ns1=5.5(/msmM)ns2=0.26e-2(/ms)PVnull=.04(mM)m1=1.07e2(/msmM)m2=9.5e-4(/ms)p1=0.8(/msmM)p2=2.5e-2(/ms)kpmp1=3e3(/mM-ms)kpmp2=1.75e1(/ms)kpmp3=7.255e1(/ms)TotalPump=1e-15beta=1(1)vmax=0.1Kp=2.7e-3(mM)}ASSIGNED{diam(um)ica(mA/cm2)ica_pmp(mA/cm2)parea(um)cai(mM)mgi(mM)vrat[Nannuli](um2)}CONSTANT{cao=2(mM)}STATE{ca[Nannuli](mM)mg[Nannuli](mM)<1e-7>CB[Nannuli](mM)CB_f_ca[Nannuli](mM)CB_ca_s[Nannuli](mM)CB_ca_ca[Nannuli](mM)iCB[Nannuli](mM)iCB_f_ca[Nannuli](mM)iCB_ca_s[Nannuli](mM)iCB_ca_ca[Nannuli](mM)PV[Nannuli](mM)PV_ca[Nannuli](mM)PV_mg[Nannuli](mM)pump(mol/cm2)<1e-15>pumpca(mol/cm2)<1e-15>}BREAKPOINT{SOLVEstateMETHODsparse}LOCALfactors_doneINITIAL{if(factors_done==0){factors_done=1factors()}FROMi=0TONannuli-1{ca[i]=cainullmg[i]=mginullCB[i]=0.8*ssCB(kdf(),kds())CB_f_ca[i]=0.8*ssCBfast(kdf(),kds())CB_ca_s[i]=0.8*ssCBslow(kdf(),kds())CB_ca_ca[i]=0.8*ssCBca(kdf(),kds())iCB[i]=0.2*ssCB(kdf(),kds())iCB_f_ca[i]=0.2*ssCBfast(kdf(),kds())iCB_ca_s[i]=0.2*ssCBslow(kdf(),kds())iCB_ca_ca[i]=0.2*ssCBca(kdf(),kds())PV[i]=ssPV(kdc(),kdm())PV_ca[i]=ssPVca(kdc(),kdm())PV_mg[i]=ssPVmg(kdc(),kdm())}parea=PI*diamica=0ica_pmp=0pump=TotalPumppumpca=0}LOCALradii[Nannuli]LOCALfrat[Nannuli]PROCEDUREfactors(){LOCALr,dr2,dr3r=diam/2dr2=0.0368dr3=(r-dr2)/(Nannuli-1)radii[0]=rradii[1]=r-dr2FROMi=2TONannuli-1{radii[i]=radii[i-1]-dr3printf("%f\n",radii[i])}vrat[0]=0frat[0]=2*rFROMi=0TONannuli-2{vrat[i]=PI*((radii[i]*radii[i])-(radii[i+1]*radii[i+1]))}vrat[Nannuli-1]=PI*radii[Nannuli-1]*radii[Nannuli-1]FROMi=1TONannuli-1{if(i==1){frat[i]=2*PI*radii[i]/(dr2+(dr3/2))}elseif(i>1&&i<(Nannuli-1)){frat[i]=2*PI*radii[i]/dr3}elseif(i==(Nannuli-1)){frat[i]=2*PI*radii[i]/((dr3/2)+radii[i])}}}LOCALdsqvolKINETICstate{COMPARTMENTi,vrat[i]{camgCBCB_f_caCB_ca_sCB_ca_caiCBiCB_f_caiCB_ca_siCB_ca_caPVPV_caPV_mg}COMPARTMENT(1e10)*parea{pumppumpca}~ca[0]<<(-ica*PI*diam/(2*FARADAY))FROMi=0TONannuli-1{~ca[i]<<(-beta*vmax*vrat[i]*ca[i]/(ca[i]+kpmp2/kpmp1))}FROMi=0TONannuli-2{~ca[i]<->ca[i+1](DCa*frat[i+1],DCa*frat[i+1])~mg[i]<->mg[i+1](DCa*frat[i+1],DCa*frat[i+1])~CB[i]<->CB[i+1](Dcbd1*frat[i+1],Dcbd1*frat[i+1])~CB_f_ca[i]<->CB_f_ca[i+1](Dcbd1*frat[i+1],Dcbd1*frat[i+1])~CB_ca_s[i]<->CB_ca_s[i+1](Dcbd1*frat[i+1],Dcbd1*frat[i+1])~CB_ca_ca[i]<->CB_ca_ca[i+1](Dcbd1*frat[i+1],Dcbd1*frat[i+1])~PV[i]<->PV[i+1](Dpar*frat[i+1],Dpar*frat[i+1])~PV_ca[i]<->PV_ca[i+1](Dpar*frat[i+1],Dpar*frat[i+1])~PV_mg[i]<->PV_mg[i+1](Dpar*frat[i+1],Dpar*frat[i+1])}FROMi=0TONannuli-1{dsqvol=vrat[i]~ca[i]+CB[i]<->CB_ca_s[i](nf1*dsqvol,nf2*dsqvol)~ca[i]+CB[i]<->CB_f_ca[i](ns1*dsqvol,ns2*dsqvol)~ca[i]+CB_f_ca[i]<->CB_ca_ca[i](nf1*dsqvol,nf2*dsqvol)~ca[i]+CB_ca_s[i]<->CB_ca_ca[i](ns1*dsqvol,ns2*dsqvol)~ca[i]+iCB[i]<->iCB_ca_s[i](nf1*dsqvol,nf2*dsqvol)~ca[i]+iCB[i]<->iCB_f_ca[i](ns1*dsqvol,ns2*dsqvol)~ca[i]+iCB_f_ca[i]<->iCB_ca_ca[i](nf1*dsqvol,nf2*dsqvol)~ca[i]+iCB_ca_s[i]<->iCB_ca_ca[i](ns1*dsqvol,ns2*dsqvol)~ca[i]+PV[i]<->PV_ca[i](m1*dsqvol,m2*dsqvol)~mg[i]+PV[i]<->PV_mg[i](p1*dsqvol,p2*dsqvol)}cai=ca[0]mgi=mg[0]}FUNCTIONssCB(kdf(),kds())(mM){ssCB=CBnull/(1+kdf()+kds()+(kdf()*kds()))}FUNCTIONssCBfast(kdf(),kds())(mM){ssCBfast=(CBnull*kds())/(1+kdf()+kds()+(kdf()*kds()))}FUNCTIONssCBslow(kdf(),kds())(mM){ssCBslow=(CBnull*kdf())/(1+kdf()+kds()+(kdf()*kds()))}FUNCTIONssCBca(kdf(),kds())(mM){ssCBca=(CBnull*kdf()*kds())/(1+kdf()+kds()+(kdf()*kds()))}FUNCTIONkdf()(1){kdf=(cainull*nf1)/nf2}FUNCTIONkds()(1){kds=(cainull*ns1)/ns2}FUNCTIONkdc()(1){kdc=(cainull*m1)/m2}FUNCTIONkdm()(1){kdm=(mginull*p1)/p2}FUNCTIONssPV(kdc(),kdm())(mM){ssPV=PVnull/(1+kdc()+kdm())}FUNCTIONssPVca(kdc(),kdm())(mM){ssPVca=(PVnull*kdc)/(1+kdc+kdm)}FUNCTIONssPVmg(kdc(),kdm())(mM){ssPVmg=(PVnull*kdm())/(1+kdc()+kdm())}