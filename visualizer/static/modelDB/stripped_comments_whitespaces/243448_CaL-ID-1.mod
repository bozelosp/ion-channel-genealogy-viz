NEURON{SUFFIXCaLUSEIONcaREADcai,caoWRITEicaRANGEminf,mtau,hinf,htau,icaRANGEpmax,hca}UNITS{(mA)=(milliamp)(mV)=(millivolt)(mM)=(milli/liter)FARADAY=96489(coul)R=8.314(volt-coul/degC)}PARAMETER{v(mV)celsius(degC)cao(mM)cai0=136e-6(mM)Kd=1e-3(mM)pmax=2.7e-5(cm/s)hca(1)}STATE{mh}ASSIGNED{ica(mA/cm2)cai(mM)mtau(ms)minfhinfhtau(ms)}BREAKPOINT{SOLVEstateMETHODcnexphca=1/(1+(cai/Kd)^4)ica=pmax*m*h*hca*ghk(v,cai,cao,2)}DERIVATIVEstate{rates(v)m'=(minf-m)/mtauh'=(hinf-h)/htau}INITIAL{rates(v)m=minfh=hinfhca=1/(1+(cai/Kd)^4)}FUNCTIONghk(v(mV),ci(mM),co(mM),z)(millicoul/cm3){LOCALe,ww=v*(.001)*z*FARADAY/(R*(celsius+273.16))if(fabs(w)>1e-4){e=w/(exp(w)-1)}else{e=1-w/2}ghk=-(.001)*z*FARADAY*(co-ci*exp(w))*e}PROCEDURErates(v(mV)){UNITSOFFmtau=2.10686+(77.425/(16.02197*sqrt(3.14/2)))*exp(-2*((v+10)/16.022(mV))^2)htau=825.80+(31780.18/(39.75*sqrt(3.14/2)))*exp(-2*((v-0)/39.74938(mV))^2)minf=1/(1+exp((8.45687-v)/(4.26269)))hinf=1/(1+exp((v+42.52246)/(7.47793)))UNITSON}