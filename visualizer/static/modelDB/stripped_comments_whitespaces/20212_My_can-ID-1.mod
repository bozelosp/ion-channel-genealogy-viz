UNITS{(mA)=(milliamp)(mV)=(millivolt)FARADAY=96520(coul)R=8.3134(joule/degK)KTOMV=.0853(mV/degC)}INDEPENDENT{tFROM0TO1WITH1(ms)}NEURON{SUFFIXmycanUSEIONcaREADcai,caoWRITEicaRANGEgcanbar,gcan,hinf,minf,taum,tauh,facm,fach,ica}PARAMETER{dt(ms)v(mV)celsius=6.3(degC)gcanbar=0(mho/cm2)cai=5.e-5(mM)cao=2(mM)tadjmtadjheca=140}STATE{mh}ASSIGNED{ica(mA/cm2)gcan(mho/cm2)minfhinftaumtauhfacmfach}INITIAL{tadjm=0.3*3.55^((celsius-23.5)/10)tadjh=0.4*2.8^((celsius-23.5)/10)rates(v)m=minfh=hinfgcan=gcanbar*m*m*h}BREAKPOINT{SOLVEstatesgcan=gcanbar*m*m*hica=gcan*ghk(v,cai,cao,2)}PROCEDUREstates(){rates(v)m=m+facm*(minf-m)h=h+fach*(hinf-h)VERBATIMreturn0;ENDVERBATIM}PROCEDURErates(v(mV)){taum=15*(0.055*(25.01-v)/(exp((25.01-v)/10)-1)+9.4*exp((-63.01-v)/20))minf=1/(1+exp(-(v+11)/8.3))facm=(1-exp(-dt/taum))tauh=10/(0.01*(10.01-v)/(exp((10.01-v)/10)-1)+20*exp((-110.01-v)/20))hinf=1/(1+exp((v+44)/9.2))fach=(1-exp(-dt/tauh))}FUNCTIONghk(v(mV),ci(mM),co(mM),z)(millicoul/cm3){LOCALe,ww=v*(.001)*z*FARADAY/(R*(celsius+273.16))e=w/(exp(w)-1)if(fabs(w)>1e-4){e=w/(exp(w)-1)}else{e=1-w/2}ghk=-(.001)*z*FARADAY*(co-ci*exp(w))*e}