UNITS{(mA)=(milliamp)(mV)=(millivolt)}PARAMETER{v(mV)ek(mV)celsius(degC)gkdrbar=.003(mho/cm2)vhalfn=13(mV)a0n=0.02(/ms)zetan=-3(1)gmn=0.7(1)nmax=0.10(ms)tau(ms)q10=1}NEURON{SUFFIXkdrUSEIONkREADekWRITEikRANGEgkdr,gkdrbar,tau,ik}STATE{n}ASSIGNED{ik(mA/cm2)ninftaun(ms)gkdr(mho/cm2)}BREAKPOINT{SOLVEstatesMETHODcnexptau=0.7*betn(v)/(0.02*(1+exp(-339.44*(v-13)/(8.315*(273.16+celsius)))))gkdr=gkdrbar*nik=gkdr*(v-ek)}INITIAL{rates(v)n=ninf}FUNCTIONalpn(v(mV)){LOCALArgArg=1.e-3*zetan*(v-vhalfn)*9.648e4/(8.315*(273.16+celsius))if(Arg<-50){alpn=0}elseif(Arg>50){alpn=exp(50)}else{alpn=exp(Arg)}}FUNCTIONbetn(v(mV)){LOCALArgArg=1.e-3*zetan*gmn*(v-13)*9.648e4/(8.315*(273.16+celsius))if(Arg<-50){betn=0}elseif(Arg>50){betn=exp(50)}else{betn=exp(Arg)}}DERIVATIVEstates{rates(v)n'=(ninf-n)/taun}PROCEDURErates(v(mV)){LOCALa,c,qt,Argqt=q10^((celsius-24)/10)a=alpn(v)ninf=1/(1+a)Arg=-339.44*(v-13)/(8.315*(273.16+celsius))if(Arg<-50){c=0}elseif(Arg>50){c=exp(50)}else{c=exp(Arg)}taun=0.7*betn(v)/(qt*a0n*(1+c))if(taun<nmax){taun=nmax}}