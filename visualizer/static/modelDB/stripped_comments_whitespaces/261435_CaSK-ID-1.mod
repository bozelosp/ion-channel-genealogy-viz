UNITS{(molar)=(1/liter)(S)=(siemens)(mA)=(milliamp)(mV)=(millivolt)F=(faraday)(coulomb)R=(molek)(mV-coulomb/degC)(mM)=(millimolar)}NEURON{SUFFIXcaskUSEIONcaWRITEicaUSEIONkWRITEikRANGEica,ik,sinf,shalf,sslope,kc,RHO,gca,gsk,stau,cinit,sinit,km}INDEPENDENT{tFROM0TO1WITH1(ms)}PARAMETER{v(mV)dt(ms)celsius=35.0(degC)gca=0.004e-3(S/cm2)gsk=0.03e-3(S/cm2)alpha=1eca=140.0ek=-75.0RHO=1.5e-4kc=0.00425km=0.5shalf=-40sslope=3.333stau=9400.0cinit=0.1sinit=0}STATE{cs}ASSIGNED{icaiksinf}BREAKPOINT{SOLVEstatesMETHODcnexpica=gca*s*(v-eca)ik=gsk*(v-ek)*c/(c+km)}INITIAL{rates(v)c=cinitif(sinit>0&&sinit<1){s=sinit}else{s=sinf}}DERIVATIVEstates{rates(v)s'=1.0*(sinf-s)/stauc'=RHO*(kc*s*(eca-v)-c)}UNITSOFFPROCEDURErates(vf){sinf=boltz(vf,shalf,sslope)}FUNCTIONboltz(x,y,z){boltz=1/(1+exp(-(x-y)/z))}UNITSON