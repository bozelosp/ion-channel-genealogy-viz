UNITS{(mA)=(milliamp)(mV)=(millivolt)}PARAMETER{currv(mV)ekek2=-80(mV)sh=0(mV)celsius(degC)gbar=.0001(mho/cm2)vhalfl=-42(mV)kl=-4vhalft=-42(mV)a0t=0.04(/ms)zetat=4gmt=.7(1)q10=5b0=60st=1count=1vrun(mV)delta=0vinit=-76.2(mV)alpha=1.06zetat2=4gmt2=.7(1)a0t2=0.04b02=60sh2alphash0=0alphash1=0.15vvrun=0timestep=1000vrun2v0dv0ddvflag=0FK=2PK=1BK=2.11CK=48stim_moltK=1}NEURON{SUFFIXkmdbPOINTERstim_iUSEIONkREADekWRITEikRANGEflag,curr,gbar,ik,sh,taua,taub,ggbar,ek2,vrun,count,vvrun,vrun2,delta2,stim_moltKGLOBALinf,tau,alpha}STATE{m}ASSIGNED{ik(mA/cm2)inftautauataubggbar(mho/cm2)stim_i}INITIAL{vrun=0vvrun=vrunrate(v,sh2)m=inf}BREAKPOINT{SOLVEstateMETHODcnexpggbar=gbar*m^stek2=ek+vvrun*alphaik=gbar*m^st*(v-ek2)}FUNCTIONalpt(v(mV)){alpt=exp(0.0378*zetat*(v-vhalft))}FUNCTIONbett(v(mV)){bett=exp(0.0378*zetat*gmt*(v-vhalft))}FUNCTIONalpt2(v(mV)){alpt2=exp(0.0378*zetat*(v-vhalft))}FUNCTIONbett2(v(mV)){bett2=exp(0.0378*zetat2*gmt2*(v-vhalft))}DERIVATIVEstate{rate(v,sh2)if(m<inf){tau=taua}else{tau=taub}m'=(inf-m)/tau}BEFORESTEP{LOCALiif(stim_i==0&&flag==0){vrun=0vvrun=0}else{flag=1delta=v-vinitif(count<timestep+1){vrun=(delta-vrun)*(FK/(count+1))+vrunvrun2=vrun}else{vrun2=(delta)*(FK/(timestep+1))+vrun2*pow((1-FK/(timestep+1)),PK)}vvrun=(BK*vrun2/(1+vrun2/CK))count=count+1}sh2=sh+alphash1*vvrun}PROCEDURErate(v(mV),sh2){LOCALa,qt,iqt=q10^((celsius-35)/10)inf=(1/(1+exp((v-vhalfl-sh2)/kl)))a=alpt(v-sh2)taua=b0+bett(v-sh2)/(a0t*(1+a))taub=b02+bett2(v-sh2)/(a0t2*(1+alpt2(v-sh2)))}