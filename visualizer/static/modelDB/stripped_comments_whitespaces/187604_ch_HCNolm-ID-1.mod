UNITS{(mA)=(milliamp)(mV)=(millivolt)}NEURON{SUFFIXch_HCNolmUSEIONhREADehWRITEihVALENCE1RANGEgmax,ih,gGLOBALrinf,rexp,tau_rRANGEmyi}INDEPENDENT{tFROM0TO1WITH1(ms)}PARAMETER{v(mV)dt(ms)gmax=0.001385(mho/cm2)g(mho/cm2)eh=-32.9(mV)}STATE{r}ASSIGNED{ih(mA/cm2)rinfrexptau_rmyi(mA/cm2)}BREAKPOINT{SOLVEderivMETHODderivimplicitg=gmax*rih=g*(v-eh)myi=ih}INITIAL{rates(v)r=rinf}DERIVATIVEderiv{rates(v)r'=(rinf-r)/tau_r}PROCEDURErates(v){TABLErinf,tau_r,rexpDEPENDdtFROM-200TO100WITH300rinf=1/(1+exp((v+84.1)/10.2))tau_r=100+1/(exp(-17.9-0.116*v)+exp(-1.84+0.09*v))rexp=1-exp(-dt/(tau_r))}FUNCTIONefun(z){if(fabs(z)<1e-4){efun=1-z/2}else{efun=z/(exp(z)-1)}}UNITSON