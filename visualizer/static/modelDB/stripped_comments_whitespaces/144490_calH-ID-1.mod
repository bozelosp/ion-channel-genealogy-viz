NEURON{SUFFIXcalHUSEIONcaREADecaWRITEicaRANGEgcalbar,m,h,g,gmaxRANGEinf,tau}UNITS{(mA)=(milliamp)(mV)=(millivolt)}PARAMETER{v(mV)celsius=34(degC)gcalbar=0(mho/cm2)eca=140(mV)}STATE{mh}ASSIGNED{ica(mA/cm2)inf[2]tau[2](ms)g(mho/cm2)gmax(mho/cm2)}BREAKPOINT{SOLVEstatesMETHODcnexpg=gcalbar*m*m*m*hica=g*(v-eca)if(g>gmax){gmax=g}}INITIAL{mhn(v)m=inf[0]h=inf[1]ica=gcalbar*m*m*m*h*(v-eca)}DERIVATIVEstates{mhn(v)m'=(inf[0]-m)/tau[0]h'=(inf[1]-h)/tau[1]}FUNCTIONvarss(v(mV),i){if(i==0){varss=1/(1+exp((v+37(mV))/(-1(mV))))}elseif(i==1){varss=1/(1+exp((v+41(mV))/(0.5(mV))))}}FUNCTIONvartau(v(mV),i)(ms){if(i==0){vartau=3.6(ms)}elseif(i==1){vartau=29(ms)}}PROCEDUREmhn(v(mV)){LOCALa,bTABLEinf,tauDEPENDcelsiusFROM-100TO100WITH200FROMi=0TO1{tau[i]=vartau(v,i)inf[i]=varss(v,i)}}