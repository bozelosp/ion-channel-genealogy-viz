NEURON{SUFFIXCa_LVAstUSEIONcaREADeca,cai,caoWRITEicaRANGEgCa_LVAstbar,gCa_LVAst,icaGLOBALuse_ghk}UNITS{(S)=(siemens)(mV)=(millivolt)(mA)=(milliamp)}PARAMETER{gCa_LVAstbar=0.00001(S/cm2)use_ghk=0}ASSIGNED{v(mV)eca(mV)cai(mM)cao(mM)ica(mA/cm2)gCa_LVAst(S/cm2)mInfmTauhInfhTau}STATE{mh}UNITSOFFFUNCTIONghk(v(mV),ci(mM),co(mM))(mV){LOCALnu,ff=KTF(celsius)/2nu=v/fghk=-f*(1.-(ci/co)*exp(nu))*efun(nu)}FUNCTIONKTF(celsius(degC))(mV){KTF=((25./293.15)*(celsius+273.15))}FUNCTIONefun(z){if(fabs(z)<1e-4){efun=1-z/2}else{efun=z/(exp(z)-1)}}UNITSONBREAKPOINT{SOLVEstatesMETHODcnexpgCa_LVAst=gCa_LVAstbar*m*m*hif(use_ghk==0){ica=gCa_LVAst*(v-eca)}if(use_ghk==1){ica=gCa_LVAst*(ghk(v,cai,cao)-106)}}DERIVATIVEstates{rates()m'=(mInf-m)/mTauh'=(hInf-h)/hTau}INITIAL{rates()m=mInfh=hInf}PROCEDURErates(){LOCALqtqt=2.3^((34-21)/10)UNITSOFFv=v+10mInf=1.0000/(1+exp((v--30.000)/-6))mTau=(5.0000+20.0000/(1+exp((v--25.000)/5)))/qthInf=1.0000/(1+exp((v--80.000)/6.4))hTau=(20.0000+50.0000/(1+exp((v--40.000)/7)))/qtv=v-10UNITSON}