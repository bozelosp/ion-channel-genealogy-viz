NEURON{SUFFIXKATPUSEIONatpREADatpiVALENCE-1USEIONkREADekWRITEikRANGEgbar,ik,tauo,oinfGLOBALqdeltat,at,athf,ap,q10}UNITS{(mA)=(milliamp)(mV)=(millivolt)(molar)=(1/liter)(mM)=(millimolar)}PARAMETER{qdeltat=1gbar=0.001(mho/cm2)atpi=0.0003(mM)athf=0.006(mM)ek=-21(mV)at=10ap=3celsius=37(degC)dt(ms)q10=2.3}ASSIGNED{v(mV)ik(mA/cm2)oinftauo(ms)}STATE{o}INITIAL{rate(atpi)o=oinf}BREAKPOINT{SOLVEstatesMETHODcnexpik=gbar*o*(v-ek)}DERIVATIVEstates{rate(atpi)o'=(o-oinf)/tauo}PROCEDURErate(atpi(mM)){LOCALa,qtqt=q10^((celsius-37)/10)oinf=(1/(1+((atpi/athf)^ap)))if(atpi<0.005){tauo=1-(186.67*atpi)/qt}else{tauo=2/qt}tauo=at*(tauo/qdeltat)}FUNCTIONtrap0(v,th,a,q){if(fabs(v-th)>1e-6){trap0=a*(v-th)/(1-exp(-(v-th)/q))}else{trap0=a*q}}