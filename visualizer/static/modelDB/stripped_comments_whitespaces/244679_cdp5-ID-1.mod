NEURON{SUFFIXcdp5USEIONcaREADcao,cai,icaWRITEcaiRANGEica_pmp,TotalPump,kpmp1,kpmp2,kpmp3RANGENannuli,Buffnull2,rf3,rf4,vratRANGEBTCnull,b1,b2,DMNPEnull,d1,d2,CBnull,nf1,nf2,ns1,ns2,PVnull,m1,m2,p1,p2}UNITS{(mol)=(1)(molar)=(1/liter)(mM)=(millimolar)(um)=(micron)(mA)=(milliamp)FARADAY=(faraday)(10000coulomb)PI=(pi)(1)}PARAMETER{Nannuli=10.9495(1)celsius(degC)cainull=45e-6(mM)mginull=.59(mM)Buffnull1=0(mM)rf1=0.0134329(/msmM)rf2=0.0397469(/ms)Buffnull2=60.9091(mM)rf3=0.1435(/msmM)rf4=0.0014(/ms)BTCnull=1(mM)b1=570(/msmM)b2=5.7(/ms)DMNPEnull=0(mM)c1=5.63(/msmM)c2=0.107e-3(/ms)CBnull=.16(mM)nf1=43.5(/msmM)nf2=3.58e-2(/ms)ns1=5.5(/msmM)ns2=0.26e-2(/ms)PVnull=.08(mM)m1=1.07e2(/msmM)m2=9.5e-4(/ms)p1=0.8(/msmM)p2=2.5e-2(/ms)kpmp1=3e-3(/mM-ms)kpmp2=1.75e-5(/ms)kpmp3=7.255e-5(/ms)TotalPump=1e-9(mol/cm2)}ASSIGNED{diam(um)ica(mA/cm2)ica_pmp(mA/cm2)parea(um)parea2(um)cai(mM)cao(mM)mgi(mM)vrat(1)}STATE{ca(mM)mg(mM)<1e-7>Buff1(mM)Buff1_ca(mM)Buff2(mM)Buff2_ca(mM)BTC(mM)BTC_ca(mM)DMNPE(mM)DMNPE_ca(mM)CB(mM)CB_f_ca(mM)CB_ca_s(mM)CB_ca_ca(mM)PV(mM)PV_ca(mM)PV_mg(mM)pump(mol/cm2)<1e-15>pumpca(mol/cm2)<1e-15>}BREAKPOINT{SOLVEstateMETHODsparse}LOCALfactors_doneINITIAL{factors()ca=cainullmg=mginullBuff1=ssBuff1()Buff1_ca=ssBuff1ca()Buff2=ssBuff2()Buff2_ca=ssBuff2ca()BTC=ssBTC()BTC_ca=ssBTCca()DMNPE=ssDMNPE()DMNPE_ca=ssDMNPEca()CB=ssCB(kdf(),kds())CB_f_ca=ssCBfast(kdf(),kds())CB_ca_s=ssCBslow(kdf(),kds())CB_ca_ca=ssCBca(kdf(),kds())PV=ssPV(kdc(),kdm())PV_ca=ssPVca(kdc(),kdm())PV_mg=ssPVmg(kdc(),kdm())parea=PI*diamparea2=PI*(diam-0.2)ica=0ica_pmp=0pump=TotalPumppumpca=0}PROCEDUREfactors(){LOCALr,dr2r=1/2dr2=r/(Nannuli-1)/2vrat=PI*(r-dr2/2)*2*dr2r=r-dr2}LOCALdsq,dsqvolKINETICstate{COMPARTMENTdiam*diam*vrat{camgBuff1Buff1_caBuff2Buff2_caBTCBTC_caDMNPEDMNPE_caCBCB_f_caCB_ca_sCB_ca_caPVPV_caPV_mg}COMPARTMENT(1e10)*parea{pumppumpca}~ca+pump<->pumpca(kpmp1*parea*(1e10),kpmp2*parea*(1e10))~pumpca<->pump(kpmp3*parea*(1e10),0)CONSERVEpump+pumpca=TotalPump*parea*(1e10)ica_pmp=2*FARADAY*(f_flux-b_flux)/parea~ca<<(-ica*PI*diam/(2*FARADAY))dsq=diam*diamdsqvol=dsq*vrat~ca+Buff1<->Buff1_ca(rf1*dsqvol,rf2*dsqvol)~ca+Buff2<->Buff2_ca(rf3*dsqvol,rf4*dsqvol)~ca+BTC<->BTC_ca(b1*dsqvol,b2*dsqvol)~ca+DMNPE<->DMNPE_ca(c1*dsqvol,c2*dsqvol)~ca+CB<->CB_ca_s(nf1*dsqvol,nf2*dsqvol)~ca+CB<->CB_f_ca(ns1*dsqvol,ns2*dsqvol)~ca+CB_f_ca<->CB_ca_ca(nf1*dsqvol,nf2*dsqvol)~ca+CB_ca_s<->CB_ca_ca(ns1*dsqvol,ns2*dsqvol)~ca+PV<->PV_ca(m1*dsqvol,m2*dsqvol)~mg+PV<->PV_mg(p1*dsqvol,p2*dsqvol)cai=camgi=mg}FUNCTIONssBuff1()(mM){ssBuff1=Buffnull1/(1+((rf1/rf2)*cainull))}FUNCTIONssBuff1ca()(mM){ssBuff1ca=Buffnull1/(1+(rf2/(rf1*cainull)))}FUNCTIONssBuff2()(mM){ssBuff2=Buffnull2/(1+((rf3/rf4)*cainull))}FUNCTIONssBuff2ca()(mM){ssBuff2ca=Buffnull2/(1+(rf4/(rf3*cainull)))}FUNCTIONssBTC()(mM){ssBTC=BTCnull/(1+((b1/b2)*cainull))}FUNCTIONssBTCca()(mM){ssBTCca=BTCnull/(1+(b2/(b1*cainull)))}FUNCTIONssDMNPE()(mM){ssDMNPE=DMNPEnull/(1+((c1/c2)*cainull))}FUNCTIONssDMNPEca()(mM){ssDMNPEca=DMNPEnull/(1+(c2/(c1*cainull)))}FUNCTIONssCB(kdf(),kds())(mM){ssCB=CBnull/(1+kdf()+kds()+(kdf()*kds()))}FUNCTIONssCBfast(kdf(),kds())(mM){ssCBfast=(CBnull*kds())/(1+kdf()+kds()+(kdf()*kds()))}FUNCTIONssCBslow(kdf(),kds())(mM){ssCBslow=(CBnull*kdf())/(1+kdf()+kds()+(kdf()*kds()))}FUNCTIONssCBca(kdf(),kds())(mM){ssCBca=(CBnull*kdf()*kds())/(1+kdf()+kds()+(kdf()*kds()))}FUNCTIONkdf()(1){kdf=(cainull*nf1)/nf2}FUNCTIONkds()(1){kds=(cainull*ns1)/ns2}FUNCTIONkdc()(1){kdc=(cainull*m1)/m2}FUNCTIONkdm()(1){kdm=(mginull*p1)/p2}FUNCTIONssPV(kdc(),kdm())(mM){ssPV=PVnull/(1+kdc()+kdm())}FUNCTIONssPVca(kdc(),kdm())(mM){ssPVca=(PVnull*kdc())/(1+kdc()+kdm())}FUNCTIONssPVmg(kdc(),kdm())(mM){ssPVmg=(PVnull*kdm())/(1+kdc()+kdm())}