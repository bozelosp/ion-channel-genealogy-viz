NEURON{POINT_PROCESSpyrD2interD_STFDUSEIONcaREADecaNONSPECIFIC_CURRENTinmda,iampaRANGEinitWRANGECdur_nmda,AlphaTmax_nmda,Beta_nmda,Erev_nmda,gbar_nmda,W_nmda,on_nmda,g_nmdaRANGECdur_ampa,AlphaTmax_ampa,Beta_ampa,Erev_ampa,gbar_ampa,W,on_ampa,g_ampaRANGEeca,ICan,P0n,fCan,tauCa,IcatotalRANGEICaa,P0a,fCaaRANGECainf,pooldiam,zRANGElambda1,lambda2,threshold1,threshold2RANGEfmax,fmin,Wmax,Wmin,maxChange,normW,scaleW,srcid,destid,limitWRANGEpregid,postgid,thr_rpRANGEF,f,tauF,D1,d1,tauD1,D2,d2,tauD2RANGEfacfactorRANGEneuroM,type}UNITS{(mV)=(millivolt)(nA)=(nanoamp)(uS)=(microsiemens)FARADAY=96485(coul)pi=3.141592(1)}PARAMETER{srcid=-1(1)destid=-1(1)type=-1Cdur_nmda=16.7650(ms)AlphaTmax_nmda=.2659(/ms)Beta_nmda=0.008(/ms)Erev_nmda=0(mV)gbar_nmda=.5e-3(uS)Cdur_ampa=0.713(ms)AlphaTmax_ampa=10.1571(/ms)Beta_ampa=0.4167(/ms)Erev_ampa=0(mV)gbar_ampa=1e-3(uS)eca=120Cainf=50e-6(mM)pooldiam=1.8172(micrometer)z=2neuroM=0tauCa=50(ms)P0n=.015fCan=.024P0a=.001fCaa=.024lambda1=8lambda2=.01threshold1=0.35threshold2=0.4initW=1.5fmax=4fmin=.8thr_rp=1facfactor=1f=1(1)<0,1e9>tauF=45(ms)<1e-9,1e9>d1=0.95(1)<0,1>tauD1=40(ms)<1e-9,1e9>d2=0.9(1)<0,1>tauD2=70(ms)<1e-9,1e9>}ASSIGNED{v(mV)inmda(nA)g_nmda(uS)on_nmdaW_nmdaiampa(nA)g_ampa(uS)on_ampalimitWt0(ms)ICan(nA)ICaa(nA)Afactor(mM/ms/nA)Icatotal(nA)dW_ampaWmaxWminmaxChangenormWscaleWpregidpostgidrptsynfaFD1D2}STATE{r_nmdar_ampacapoolconW}INITIAL{on_nmda=0r_nmda=0W_nmda=initWon_ampa=0r_ampa=0W=initWlimitW=1t0=-1Wmax=fmax*initWWmin=fmin*initWmaxChange=(Wmax-Wmin)/10dW_ampa=0capoolcon=CainfAfactor=1/(z*FARADAY*4/3*pi*(pooldiam/2)^3)*(1e6)fa=0F=1D1=1D2=1}BREAKPOINT{if((eta(capoolcon)*(lambda1*omega(capoolcon,threshold1,threshold2)-lambda2*W))>0&&W>=Wmax){limitW=1e-12}elseif((eta(capoolcon)*(lambda1*omega(capoolcon,threshold1,threshold2)-lambda2*W))<0&&W<=Wmin){limitW=1e-12}else{limitW=1}SOLVEreleaseMETHODcnexpif(t0>0){if(rp<thr_rp){if(t-t0<Cdur_ampa){on_ampa=1}else{on_ampa=0}}else{on_ampa=0}}if(neuroM==0){g_nmda=gbar_nmda*r_nmda*facfactor}else{g_nmda=gbar_nmda*r_nmda*facfactor}inmda=W_nmda*g_nmda*(v-Erev_nmda)*sfunc(v)g_ampa=gbar_ampa*r_ampa*facfactoriampa=W*g_ampa*(v-Erev_ampa)ICan=P0n*g_nmda*(v-eca)*sfunc(v)ICaa=P0a*W*g_ampa*(v-eca)/initWIcatotal=ICan+ICaa}DERIVATIVErelease{W'=1e-12*limitW*eta(capoolcon)*(lambda1*omega(capoolcon,threshold1,threshold2)-lambda2*W)r_nmda'=AlphaTmax_nmda*on_nmda*(1-r_nmda)-Beta_nmda*r_nmdar_ampa'=AlphaTmax_ampa*on_ampa*(1-r_ampa)-Beta_ampa*r_ampacapoolcon'=-fCan*Afactor*Icatotal+(Cainf-capoolcon)/tauCa}NET_RECEIVE(dummy_weight){if(flag==0){if((!on_nmda)){t0=ton_nmda=1net_send(Cdur_nmda,1)}elseif(on_nmda==1){net_move(t+Cdur_nmda)t0=t}}if(flag==1){on_nmda=0}if(flag==0){rp=unirand()D1=1-(1-D1)*exp(-(t-tsyn)/tauD1)D2=1-(1-D2)*exp(-(t-tsyn)/tauD2)tsyn=tfacfactor=F*D1*D2F=F*fif(F>2){F=2}if(facfactor<0.7){facfactor=0.7}if(F<0.8){F=0.8}D1=D1*d1D2=D2*d2}}FUNCTIONsfunc(v(mV)){UNITSOFFsfunc=1/(1+0.33*exp(-0.06*v))UNITSON}FUNCTIONeta(Cani(mM)){LOCALtaulearn,P1,P2,P4,CaconP1=0.1P2=P1*1e-4P4=1Cacon=Cani*1e3taulearn=P1/(P2+Cacon*Cacon*Cacon)+P4eta=1/taulearn*0.001}FUNCTIONomega(Cani(mM),threshold1(uM),threshold2(uM)){LOCALr,mid,CaconCacon=Cani*1e3r=(threshold2-threshold1)/2mid=(threshold1+threshold2)/2if(Cacon<=threshold1){omega=0}elseif(Cacon>=threshold2){omega=1/(1+50*exp(-50*(Cacon-threshold2)))}else{omega=-sqrt(r*r-(Cacon-mid)*(Cacon-mid))}}FUNCTIONunirand(){unirand=scop_random()}