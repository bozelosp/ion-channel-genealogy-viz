NEURON{SUFFIXKv12USEIONkREADekWRITEikRANGEgbar,g,iGLOBALinf_n,tau_n,inf_h,tau_h}PARAMETER{ek(mV)gbar=30(pS/um2)gates_n=4vhalf_n=-48.0(mV)slope_n=-6(mV)needAdj=1vhalfA_n=0(mV)slopeA_n=0(mV)v5_adj=0(mV)slp_adj=0(mV)tauA_n=2.54(ms)tauDv_n=0(mV)tauG_n=0.34tauF_n=0tau0_n=1.5(ms)vhalf_h=-71.0(mV)slope_h=-10(mV)sust=0.5tauA_h=300(ms)tauDv_h=0(mV)tauG_h=0.34tauF_h=0tau0_h=50(ms)}STATE{nh}ASSIGNED{v(mV)celsius(degC)ik(mA/cm2)g(pS/um2)i(mA/cm2)inf_ntau_n(ms)inf_htau_h(ms)}BREAKPOINT{SOLVEstatesMETHODcnexpg=0if(n>=0){g=gbar*n^gates_n*(sust+(1-sust)*h)}i=g*(v-ek)*(1e-4)ik=i}INITIAL{needAdj=1rates(v)n=inf_nh=inf_h}UNITS{(mA)=(milliamp)(mV)=(millivolt)(pS)=(picosiemens)(um)=(micrometer)}DERIVATIVEstates{rates(v)n'=(inf_n-n)/tau_nh'=(inf_h-h)/tau_h}PROCEDURErates(v(mV)){if(needAdj>0){needAdj=0ngate_adjust(gates_n,vhalf_n,slope_n)vhalfA_n=v5_adjslopeA_n=slp_adj}inf_n=Boltzmann(v,vhalfA_n,slopeA_n)tau_n=BorgMod_tau(v,vhalfA_n,slopeA_n,tau0_n,tauA_n,tauG_n,tauF_n,tauDv_n)inf_h=Boltzmann(v,vhalf_h,slope_h)tau_h=BorgMod_tau(v,vhalf_h,slope_h,tau0_h,tauA_h,tauG_h,tauF_h,tauDv_h)}FUNCTIONBoltzmann(v(mV),v5(mV),s(mV)){Boltzmann=1/(1+exp((v-v5)/s))}FUNCTIONBorgMod_tau(v(mV),v5(mV),s(mV),tau0(ms),tauA(ms),tauG,tauF,tauDv(mV))(ms){LOCALkc,kr,Dv,wr,kfDv=(v-(v5+tauDv))kf=10^tauFBorgMod_tau=tau0+tauA*4*sqrt(tauG*(1-tauG))/(exp(-Dv*(1-tauG)*kf/s)+exp(Dv*tauG*kf/s))}FUNCTIONBoltz_m1(x,v5(mV),s(mV))(mV){Boltz_m1=s*log(1/x-1)+v5}PROCEDUREngate_adjust(ng,vh(mV),slp(mV)){LOCALx1,x2,v1,v2x1=0.3x2=0.7v1=Boltz_m1(x1,vh,slp)v2=Boltz_m1(x2,vh,slp)slp_adj=(v2-v1)/(log((1/x2)^(1/ng)-1)-log((1/x1)^(1/ng)-1))v5_adj=v1-slp_adj*log(1/x1^(1/ng)-1)}