NEURON{POINT_PROCESSAPAmpRANGEn,thresh,time,firing,max,high}UNITS{(mV)=(millivolt)}PARAMETER{nthresh=-20(mV)time(ms)}ASSIGNED{firingspacehighmax}VERBATIM#ifndefNRN_VERSION_GTEQ_8_2_0externvoidvector_resize();externdouble*vector_vec();externvoid*vector_arg();#endifENDVERBATIMINITIAL{n=0firing=0high=0VERBATIM{IvocVect*vv=*((IvocVect**)(&space));if(vv){vector_resize(vv,0);}}ENDVERBATIMcheck()}BREAKPOINT{SOLVEcheckMETHODafter_cvode}PROCEDUREcheck(){VERBATIMintsize;double*px;if(v>=thresh&&!firing){firing=1;time=t;high=1;max=v;}if(high){if(v<=thresh&&t>time){n+=1.;IvocVect*vv=*((IvocVect**)(&space));if(vv){size=(int)n;vector_resize(vv,size);px=vector_vec(vv);px[size-1]=max;}high=0;}if(v>max){max=v;}}if(firing&&v<thresh&&t>time){firing=0;}ENDVERBATIM}PROCEDURErecord(){VERBATIMIvocVect**vv=(IvocVect**)(&space);*vv=(IvocVect*)0;if(ifarg(1)){*vv=vector_arg(1);}ENDVERBATIM}