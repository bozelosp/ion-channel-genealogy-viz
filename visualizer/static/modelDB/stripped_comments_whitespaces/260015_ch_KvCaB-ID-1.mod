VERBATIM#include<stdlib.h>ENDVERBATIMUNITS{(molar)=(1/liter)}UNITS{(mV)=(millivolt)(mA)=(milliamp)(mM)=(millimolar)}NEURON{SUFFIXch_KvCaBUSEIONkREADekWRITEikUSEIONcaREADcaiVALENCE2RANGEgmax,g,ikRANGEmyiGLOBALoinf,otauTHREADSAFE}UNITS{FARADAY=(faraday)(kilocoulombs)R=8.313424(joule/degC)}PARAMETER{gmax=.01(mho/cm2)d1=.84d2=1.k1=.48e-3(mM)k2=.13e-6(mM)cai(mM)abar=.28(/ms)bbar=.48(/ms)st=1(1)}ASSIGNED{celsius(degC)v(mV)ek(mV)ik(mA/cm2)oinfotau(ms)g(mho/cm2)myi(mA/cm2)}INITIAL{rate(v,cai)o=oinf}STATE{o}BREAKPOINT{SOLVEstateMETHODcnexpg=gmax*o^stik=g*(v-ek)myi=ik}DERIVATIVEstate{rate(v,cai)o'=(oinf-o)/otau}FUNCTIONalp(v(mV),c(mM))(1/ms){alp=c*abar/(c+exp1(k1,d1,v))}FUNCTIONbet(v(mV),c(mM))(1/ms){bet=bbar/(1+c/exp1(k2,d2,v))}FUNCTIONexp1(k(mM),d,v(mV))(mM){exp1=k*exp(-2*d*FARADAY*v/R/(273.15+celsius))}PROCEDURErate(v(mV),c(mM)){LOCALaa=alp(v,c)otau=1/(a+bet(v,c))oinf=a*otau}