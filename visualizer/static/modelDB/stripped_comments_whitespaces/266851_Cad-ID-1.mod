INDEPENDENT{tFROM0TO1WITH1(ms)}NEURON{SUFFIXcadUSEIONcaREADica,caiWRITEcaiRANGEcaGLOBALdepth,cainf,taur}UNITS{(molar)=(1/liter)(mM)=(millimolar)(um)=(micron)(mA)=(milliamp)(msM)=(msmM)FARADAY=(faraday)(coulomb)}PARAMETER{diam(um)depth=.1(um)taur=15(ms)kb=20cainf=100e-6(mM)cai(mM)gamma=1.2(1/ms)}STATE{ca(mM)<1e-5>}INITIAL{ca=cainfcai=ca}ASSIGNED{ica(mA/cm2)drive_channel(mM/ms)}BREAKPOINT{SOLVEstateMETHODeuler}DERIVATIVEstate{depth=diam/4drive_channel=-(10000)*ica/(2*FARADAY*depth)if(drive_channel<=0.){drive_channel=0.}taur=kb/gammaca'=(drive_channel/kb)+((cainf-ca)/taur)cai=ca}