NEURON{SUFFIXkahpUSEIONkREADekWRITEikUSEIONcaREADcaiRANGEgkahp,ik,m,qk}UNITS{(molar)=(1/liter)(mV)=(millivolt)(mA)=(milliamp)(mM)=(millimolar)FARADAY=96485.309(coul/mole)PI=(pi)(1)}INDEPENDENT{tFROM0TO1WITH100(ms)}PARAMETER{gkahp=0.0(mho/cm2)}ASSIGNED{ik(mA/cm2)alpha(/ms)beta(/ms)v(mV)ek(mV)diam(um)cai(mM)}STATE{mqk}BREAKPOINT{SOLVEstatesMETHODcnexpik=gkahp*m*(v-ek)}INITIAL{rates(cai)m=alpha/(alpha+beta)ik=gkahp*m*(v-ek)qk=0}DERIVATIVEstates{rates(cai)m'=alpha*(1-m)-beta*mqk'=(-ik*diam*PI*(1e4)/FARADAY)/(diam*diam*PI/4)}UNITSOFFPROCEDURErates(chi(mM)){if(cai<=1){alpha=cai*30}else{alpha=30}beta=1.0}UNITSON