UNITS{(mA)=(milliamp)(mV)=(millivolt)(S)=(siemens)(molar)=(1/liter)(mM)=(millimolar)R=(k-mole)(joule/degC)FARADAY=(faraday)(coulombs)}NEURON{SUFFIXiAHPsUSEIONkREADekWRITEikUSEIONcaREADcaiRANGEgkbar,gk,iGLOBALminf,mtau,QTHREADSAFE}PARAMETER{gkbar=.0005(S/cm2)<0,1e9>ek=-80(mV)caiNorm=0.0001(mM)}ASSIGNED{v(mV)celsius(degC)Qgk(S/cm2)ik(mA/cm2)i(mA/cm2)cai(mM)minfmtau(ms)}STATE{m}?currentsBREAKPOINT{SOLVEstatesMETHODcnexpgk=gkbar*m*m*mi=gk*(v-ek)ik=i}INITIAL{rates(v,cai)m=minf}?statesDERIVATIVEstates{rates(v,cai)m'=(minf-m)/mtau}?ratesPROCEDURErates(v(mV),cai(mM)){LOCALcacUNITSOFFcac=(cai/(0.00005(mM)))^2Q=3^((celsius-22)/10.)minf=cac/(1+cac)mtau=max(0.5,0.003(/ms)*(1+cac)*Q)UNITSON}FUNCTIONmax(x,y){UNITSOFFif(x>y){max=x}else{max=y}UNITSON}