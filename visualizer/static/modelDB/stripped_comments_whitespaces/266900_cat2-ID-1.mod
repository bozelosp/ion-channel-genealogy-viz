UNITS{(mA)=(milliamp)(mV)=(millivolt)(molar)=(1/liter)(mM)=(millimolar)FARADAY=96520(coul)R=8.3134(joule/degC)KTOMV=.0853(mV/degC)}PARAMETER{currv(mV)sh=0(mV)celsius=34(degC)gcatbar=.003(mho/cm2)cai=50.e-6(mM)cao=2(mM)q10=5mmin=0.2hmin=10a0h=0.015zetah=3.5vhalfh=-75gmh=0.6a0m=0.04zetam=2vhalfm=-28gmm=0.1ki=.001(mM)time1=600time0=100alphash0=0alphash1=0.15sh2count=1vrun(mV)delta=0vinit=-76.2vvrun=0timestep=1000vrun2v0dv0ddvflag=0FCa=2PCa=1BCa=2CCa=50stim_moltCa=1}NEURON{SUFFIXcatPOINTERstim_iUSEIONcaREADcai,caoWRITEicaRANGEflag,curr,gcatbar,ica,gcat,sh,count,delta2,vrun2,stim_moltCaGLOBALhinf,minf,mtau,htau}STATE{mh}ASSIGNED{ica(mA/cm2)gcat(mho/cm2)hinfhtauminfmtaustim_i}INITIAL{rates(v,sh2)m=minfh=hinf}BREAKPOINT{SOLVEstatesMETHODcnexpgcat=gcatbar*m*m*hica=gcat*ghk(v,cai,cao)}DERIVATIVEstates{rates(v,sh2)m'=(minf-m)/mtauh'=(hinf-h)/htau}UNITSOFFFUNCTIONh2(cai(mM)){h2=ki/(ki+cai)}FUNCTIONghk(v(mV),ci(mM),co(mM))(mV){LOCALnu,ff=KTF(celsius)/2nu=v/fghk=-f*(1.-(ci/co)*exp(nu))*efun(nu)}FUNCTIONKTF(celsius(DegC))(mV){KTF=((25./293.15)*(celsius+273.15))}FUNCTIONefun(z){if(fabs(z)<1e-4){efun=1-z/2}else{efun=z/(exp(z)-1)}}FUNCTIONalph(v(mV)){alph=exp(0.0378*zetah*(v-vhalfh))}FUNCTIONbeth(v(mV)){beth=exp(0.0378*zetah*gmh*(v-vhalfh))}FUNCTIONalpmt(v(mV)){alpmt=exp(0.0378*zetam*(v-vhalfm))}FUNCTIONbetmt(v(mV)){betmt=exp(0.0378*zetam*gmm*(v-vhalfm))}BEFORESTEP{LOCALiif(stim_i==0&&flag==0){vrun=0vvrun=0}else{flag=1delta=v-vinitif(count<timestep+1){vrun=(delta-vrun)*(FCa/(count+1))+vrunvrun2=vrun}else{vrun2=(delta)*(FCa/(timestep+1))+vrun2*pow((1-FCa/(timestep+1)),PCa)}vvrun=(BCa*vrun2/(1+vrun2/CCa))count=count+1}sh2=sh+alphash1*vvrun}PROCEDURErates(v(mV),sh2){LOCALa,b,qt,iqt=q10^((celsius-25)/10)a=0.2*(-1.0*v+19.26+sh2)/(exp((-1.0*v+19.26+sh2)/10.0)-1.0)b=0.009*exp(-v+sh2/22.03)minf=a/(a+b)mtau=betmt(v-sh2)/(qt*a0m*(1+alpmt(v-sh2)))if(mtau<mmin){mtau=mmin}a=1.e-6*exp(-v+sh2/16.26)b=1/(exp((-v+29.79+sh2)/10.)+1.)hinf=a/(a+b)htau=beth(v-sh2)/(a0h*(1+alph(v-sh2)))if(htau<hmin){htau=hmin}}