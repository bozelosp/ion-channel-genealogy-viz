NEURON{SUFFIXKv1USEIONkREADekWRITEikRANGEgkv1,ikv1,gbarGLOBALninf,ntau,vShift,ektGLOBALh1inf,h1tauGLOBALh2inf,h2tauGLOBALh3inf,h3tau}UNITS{(mV)=(millivolt)(mA)=(milliamp)(nA)=(nanoamp)(pA)=(picoamp)(S)=(siemens)(nS)=(nanosiemens)(pS)=(picosiemens)(um)=(micron)(molar)=(1/liter)(mM)=(millimolar)}CONSTANT{a1=48.02279a2=42.662b1=58.44509c1=13.44182c2=49.38797a1H1=1.300293e-03a2H1=6.247311b2H1=66.13843c1H1=8.611435c2H1=7.948768a12H2fact=1.554639e-02propH2=0.73157sToMs=0.001}PARAMETER{v(mV)ekt=-88(mV)vShift=0vShift_inact=0gbar(pS/um2)temp=33(degC)q10=3q10h=3celsius(degC)}ASSIGNED{ik(mA/cm2)ikv1(mA/cm2)gkv1(mho/cm2)ek(mV)ninfntau(ms)nalpha(1/ms)nbeta(1/ms)h1infh1tau(ms)h1alpha(1/ms)h1beta(1/ms)h2infh2tau(ms)h2alpha(1/ms)h2beta(1/ms)h3infh3tau(ms)h3alpha(1/ms)h3beta(1/ms)tadjtadjh}STATE{nh1h2}INITIAL{rates(v)n=ninfh1=h1infh2=h2inf}BREAKPOINT{SOLVEstatesMETHODcnexpgkv1=gbar*((1-propH2)*n^8*h1+propH2*n^8*h2)ikv1=(1e-4)*gkv1*(v-ek)ik=ikv1}DERIVATIVEstates{rates(v)n'=(ninf-n)/ntauh1'=(h1inf-h1)/h1tauh2'=(h2inf-h2)/h2tau}PROCEDURErates(v(mV)){tadj=q10^((celsius-temp)/10)tadjh=q10h^((celsius-temp)/10)nalpha=tadj*nalphafkt(v-vShift)nbeta=tadj*nbetafkt(v-vShift)ninf=nalpha/(nalpha+nbeta)ntau=1/(nalpha+nbeta)h1alpha=tadjh*h1alphafkt(v-vShift-vShift_inact)h1beta=tadjh*h1betafkt(v-vShift-vShift_inact)h1inf=h1alpha/(h1alpha+h1beta)h1tau=1/(h1alpha+h1beta)h2alpha=tadjh*h2alphafkt(v-vShift-vShift_inact)h2beta=tadjh*h2betafkt(v-vShift-vShift_inact)h2inf=h2alpha/(h2alpha+h2beta)h2tau=1/(h2alpha+h2beta)}FUNCTIONnalphafkt(v(mV))(1/ms){nalphafkt=sToMs*a1*(-(v+b1))/(exp(-(v+b1)/c1)-1)}FUNCTIONnbetafkt(v(mV))(1/ms){nbetafkt=sToMs*a2*exp(-(v)/c2)}FUNCTIONh1alphafkt(v(mV))(1/ms){h1alphafkt=sToMs*a1H1*exp(-(v)/c1H1)}FUNCTIONh1betafkt(v(mV))(1/ms){h1betafkt=sToMs*a2H1/(exp(-(v+b2H1)/c2H1)+1)}FUNCTIONh2alphafkt(v(mV))(1/ms){h2alphafkt=sToMs*a12H2fact*a1H1*exp(-(v)/c1H1)}FUNCTIONh2betafkt(v(mV))(1/ms){h2betafkt=sToMs*a12H2fact*a2H1/(exp(-(v+b2H1)/c2H1)+1)}