NEURON{POINT_PROCESSMyExp2SynNMDABBRANGEe,i,iNMDA,s,sNMDA,r,tau1NMDA,tau2NMDA,Vwt,smax,sNMDAmax,gNONSPECIFIC_CURRENTiNMDAUSEIONcaREADcai,caoWRITEicaGLOBALfraccaRANGEica}UNITS{(nA)=(nanoamp)(mV)=(millivolt)(uS)=(microsiemens)FARADAY=(faraday)(coulomb)R=(k-mole)(joule/degC)}PARAMETER{tau1NMDA=15(ms)tau2NMDA=150(ms)e=0(mV)r=1smax=1e9(1)sNMDAmax=1e9(1)Vwt=0fracca=0.13}ASSIGNED{v(mV)iNMDA(nA)sNMDA(1)mgblock(1)factor2(1)ica(nA)cai(mM)cao(mM)g(umho)}STATE{A2(1)B2(1)}INITIAL{LOCALtpVwt=0if(tau1NMDA/tau2NMDA>.9999){tau1NMDA=.9999*tau2NMDA}A2=0B2=0tp=(tau1NMDA*tau2NMDA)/(tau2NMDA-tau1NMDA)*log(tau2NMDA/tau1NMDA)factor2=-exp(-tp/tau1NMDA)+exp(-tp/tau2NMDA)factor2=1/factor2}BREAKPOINT{LOCALiTOTSOLVEstateMETHODcnexpmgblock=1.0/(1.0+0.28*exp(-0.062(/mV)*v))sNMDA=B2-A2if(sNMDA>sNMDAmax){sNMDA=sNMDAmax}iNMDA=sNMDA*(v-e)*mgblock*(1-fracca)if(fracca>0.0){ica=sNMDA*ghkg(v,cai,cao,2)*mgblock*fracca}g=sNMDA*mgblock}INCLUDE"ghk.inc"DERIVATIVEstate{A2'=-A2/tau1NMDAB2'=-B2/tau2NMDA}NET_RECEIVE(w(uS)){LOCALwwww=wif(r>=0){A2=A2+factor2*ww*rB2=B2+factor2*ww*r}}