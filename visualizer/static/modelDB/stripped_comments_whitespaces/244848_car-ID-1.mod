NEURON{SUFFIXcarUSEIONcaREADcai,caoWRITEicaRANGEgmax,m,hRANGEminf,hinf,taum,tauhGLOBALq10,taum_exp,z}UNITS{(molar)=(/liter)(mA)=(milliamp)(nA)=(nanoamp)(mV)=(millivolt)(mM)=(millimolar)(S)=(siemens)(uS)=(microsiemens)FARADAY=(faraday)(coulomb)R=(k-mole)(joule/degC)}PARAMETER{gmax=0(S/cm2)<0,1e9>q10=3taum_exp=0.92(ms)z=2}STATE{mOmChOhC}ASSIGNED{v(mV)celsius(degC)cai(mM)cao(mM)ica(mA/cm2)minfhinftaum(ms)tauh(ms)}BREAKPOINT{SOLVEkinMETHODsparseica=gmax*mO*mO*mO*hO*ghkg(v,cai,cao,z)}INITIAL{taum=q10^(-(celsius-22(degC))/10(degC))*taum_exptauh=q10^(-(celsius-22(degC))/10(degC))*53(ms)SOLVEkinSTEADYSTATEsparseica=gmax*mO*mO*mO*hO*ghkg(v,cai,cao,z)}KINETICkin{minf=1/(1+exp(-(v-3(mV))/8.3(mV)))hinf=1/(1+exp((v+39(mV))/9.2(mV)))~mC<->mO(minf/taum,(1-minf)/taum)~hC<->hO(hinf/tauh,(1-hinf)/tauh)CONSERVEmC+mO=1CONSERVEhC+hO=1}FUNCTIONghkg(v(mV),ci(mM),co(mM),z)(mV){LOCALxi,f,exi,fxif=R*(celsius+273.15)/(z*(1e-3)*FARADAY)xi=v/fexi=exp(xi)if(fabs(xi)<1e-4){fxi=1-xi/2}else{fxi=xi/(exi-1)}ghkg=f*((ci/co)*exi-1)*fxi}