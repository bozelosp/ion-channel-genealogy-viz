INDEPENDENT{tFROM0TO1WITH1(ms)}NEURON{SUFFIXcaLUSEIONcaREADcai,caoWRITEicaRANGEO,C,IRANGEa,bGLOBALRa,Rb,q,th,pGLOBALq10,temp,tadj}UNITS{F=(faraday)(coulomb)R=(k-mole)(joule/degC)(mA)=(milliamp)(mV)=(millivolt)(pS)=(picosiemens)(um)=(micron)(mM)=(milli/liter)}PARAMETER{p=0.2e-3(cm/s)v(mV)th=5(mV)q=13(mV)Ra=1.6(/ms)Rb=0.2(/ms)celsius(degC)temp=22(degC)q10=3}ASSIGNED{ica(mA/cm2)cao(mM)cai(mM)a(/ms)b(/ms)tadj}STATE{CO}INITIAL{C=1}BREAKPOINT{rates(v)SOLVEkstatesMETHODsparseica=O*p*ghk(v,cai,cao)}KINETICkstates{~C<->O(a,b)CONSERVEC+O=1}PROCEDURErates(v(mV)){TABLEa,bDEPENDRa,Rb,th,celsius,temp,q10FROM-100TO100WITH200tadj=q10^((celsius-temp)/10(degC))a=Ra/(1+exp(-(v-th)/q))*tadjb=Rb/(1+exp((v-th)/q))*tadj}FUNCTIONghk(v(mV),ci(mM),co(mM))(0.001coul/cm3){LOCALzz=(0.001)*2*F*v/(R*(celsius+273.15))ghk=(.001)*2*F*(ci*efun(-z)-co*efun(z))}FUNCTIONefun(z){if(fabs(z)<1e-4){efun=1-z/2}else{efun=z/(exp(z)-1)}}