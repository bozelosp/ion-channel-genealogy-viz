NEURON{SUFFIXcanchanUSEIONcaREADecaWRITEicaRANGEgcanbar,ica,pool,bpool}PARAMETER{gcanbar=100e-6(mho/cm2)pool=1(1)bpool=1(1)eca(mV)v(mV)}UNITS{(mA)=(milliamp)(mV)=(millivolt)(pS)=(picosiemens)(um)=(micron)}ASSIGNED{ica(mA/cm2)ican(mA/cm2)minfhinfmtau(ms)htau(ms)}STATE{mh}BREAKPOINT{SOLVEstatesMETHODcnexpican=gcanbar*m*m*h*(v-eca)ica=ican}INITIAL{trates(v)m=minfh=hinf}DERIVATIVEstates{trates(v)m'=(minf-m)/mtauh'=(hinf-h)/htau}PROCEDUREtrates(vm){LOCALa,ba=trap0(vm,20,0.1,10)b=0.4*exp(-(vm+25)/18)minf=a/(a+b)mtau=1/(a+b)a=0.01*exp(-(vm+50)/10)b=0.1/(1+exp(-(vm+17)/17))hinf=a/(a+b)htau=1/(a+b)}FUNCTIONtrap0(v,th,a,q){if(fabs(v-th)>1e-6){trap0=a*(v-th)/(1-exp(-(v-th)/q))}else{trap0=a*q}}