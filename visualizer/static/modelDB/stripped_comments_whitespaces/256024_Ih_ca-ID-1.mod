NEURON{THREADSAFESUFFIXh_caNONSPECIFIC_CURRENTiUSEIONcaREADcaiRANGEgmax,i,tau,mGLOBALe,taumin,vhalf,s1,s2}UNITS{(molar)=(1/liter)(mM)=(millimolar)(mA)=(milliamp)(mV)=(millivolt)(msM)=(msmM)}PARAMETER{e=-35(mV)gmax=2e-4(mho/cm2)cac=0.006(mM)k2=0.0001(1/ms)Pc=0.01k4=0.001(1/ms)nca=4nexp=1ginc=2vhalf=-78(mV)vh2=-85(mV)s1=-13(mV)s2=14(mV)taumax=1020(ms)taumin=20(ms)}STATE{c1o1o2p0p1}ASSIGNED{v(mV)cai(mM)i(mA/cm2)h_inftau(ms)alpha(1/ms)beta(1/ms)k1ca(1/ms)k3p(1/ms)m}BREAKPOINT{SOLVEihkinMETHODsparsem=o1+ginc*o2i=gmax*m*(v-e)}KINETICihkin{evaluate_fct(v,cai)~c1<->o1(alpha,beta)~p0<->p1(k1ca,k2)~o1<->o2(k3p,k4)CONSERVEp0+p1=1CONSERVEc1+o1+o2=1}INITIAL{evaluate_fct(v,cai)c1=1-h_info1=h_info2=0p0=1p1=0}UNITSOFFPROCEDUREevaluate_fct(v(mV),cai(mM)){h_inf=1/(1+exp((vhalf-v)/s1))tau=2*taumax/(exp((vh2-v)/s2)+exp((vhalf-v)/s1))+tauminalpha=h_inf/taubeta=(1-h_inf)/tauk1ca=k2*(cai/cac)^ncak3p=k4*(p1/Pc)^nexp}PROCEDUREactivation(v(mV),cai(mM)){LOCALccevaluate_fct(v,cai)cc=1/(1+(cac/cai)^nca)m=(1+ginc*(cc/Pc)^nexp)/(1+beta/alpha)}UNITSON