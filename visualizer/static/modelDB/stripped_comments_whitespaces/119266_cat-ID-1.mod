NEURON{SUFFIXcatUSEIONcaREADcai,ecaWRITEicaRANGEgcatbar,icaGLOBALhinf,minf}UNITS{(mA)=(milliamp)(mV)=(millivolt)(molar)=(1/liter)(mM)=(millimolar)FARADAY=(faraday)(coulomb)R=(k-mole)(joule/degC)}PARAMETER{gcatbar=0(mho/cm2)zetam=-3zetah=5.2vhalfm=-36(mV)vhalfh=-68(mV)tm0=1.5(ms)th0=10(ms)}ASSIGNED{v(mV)celsius(degC)ica(mA/cm2)cai(mM)eca(mV)minfhinf}STATE{mh}INITIAL{rates(v)m=minfh=hinf}BREAKPOINT{SOLVEstatesMETHODcnexpica=gcatbar*m*m*h*(v-eca)}FUNCTIONghk(v(mV),ci(mM),co(mM))(.001coul/cm3){LOCALz,eci,ecoz=(1e-3)*2*FARADAY*v/(R*(celsius+273.15))eco=co*efun(z)eci=ci*efun(-z)ghk=(.001)*2*FARADAY*(eci-eco)}FUNCTIONefun(z){if(fabs(z)<1e-4){efun=1-z/2}else{efun=z/(exp(z)-1)}}DERIVATIVEstates{rates(v)m'=(minf-m)/tm0h'=(hinf-h)/th0}PROCEDURErates(v(mV)){LOCALa,ba=alpm(v)minf=1/(1+a)b=alph(v)hinf=1/(1+b)}FUNCTIONalpm(v(mV)){UNITSOFFalpm=exp(1.e-3*zetam*(v-vhalfm)*9.648e4/(8.315*(273.16+celsius)))UNITSON}FUNCTIONalph(v(mV)){UNITSOFFalph=exp(1.e-3*zetah*(v-vhalfh)*9.648e4/(8.315*(273.16+celsius)))UNITSON}