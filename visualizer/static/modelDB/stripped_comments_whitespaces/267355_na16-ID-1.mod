INDEPENDENT{tFROM0TO1WITH1(ms)}NEURON{SUFFIXna16USEIONnaREADenaWRITEinaUSEIONcaREADecaWRITEicaUSEIONcalWRITEicalVALENCE2RANGEm,h,gna,gbar,ina,ica,icalGLOBALtha,thi1,thi2,qa,qi,qinf,thinf,canaRANGEminf,hinf,mtau,htauGLOBALRa,Rb,Rd,RgGLOBALq10,temp,tadj,vmin,vmax,vshift,thi12,hw,hc}PARAMETER{cana=0gbar=1000(pS/um2)vshift=-2(mV)tha=-44(mV)qa=6.5(mV)Ra=2.1(/ms)Rb=0.17(/ms)thi1=-80(mV)thi12=-35(mV)thi2=-75(mV)qi=5(mV)thinf=-72(mV)qinf=6.2(mV)Rg=0.0091(/ms)Rd=0.024(/ms)temp=23(degC)q10=2.3v(mV)dt(ms)celsius(degC)vmin=-120(mV)vmax=100(mV)hc=0.01hw=0.02}UNITS{(mA)=(milliamp)(mV)=(millivolt)(pS)=(picosiemens)(um)=(micron)}ASSIGNED{ina(mA/cm2)ica(mA/cm2)ical(mA/cm2)eca(mV)gna(pS/um2)ena(mV)minfhinfhinf2mtau(ms)htau(ms)htau2(ms)tadj}STATE{mhh2}INITIAL{trates(v+vshift)m=minfh=hinfh2=hinf2}BREAKPOINT{SOLVEstatesgna=tadj*gbar*m*m*m*h+tadj*gbar*m*m*m*hw*h2ina=(1e-4)*gna*(v-ena)ica=(1e-4)*gna*(v-eca)*cana/100ical=ica}LOCALmexp,hexp,hexp2PROCEDUREstates(){trates(v+vshift)m=m+mexp*(minf-m)h=h+hexp*(hinf-h)h2=h2+hcVERBATIMENDVERBATIM}PROCEDUREtrates(v){LOCALtincTABLEminf,mexp,hinf,hexp,hinf2,hexp2DEPENDdt,celsius,temp,Ra,Rb,Rd,Rg,tha,thi1,thi2,qa,qi,qinfFROMvminTOvmaxWITH199rates(v)tadj=q10^((celsius-temp)/10)tinc=-dt*tadjmexp=1-exp(tinc/mtau)hexp=1-exp(tinc/htau)hexp2=1-exp(tinc/htau2)}PROCEDURErates(vm){LOCALa,ba=trap0(vm,tha,Ra,qa)b=trap0(-vm,-tha,Rb,qa)mtau=1/(a+b)minf=a*mtaua=trap0(vm,thi1,Rd,qi)b=trap0(-vm,-thi2,Rg,qi)htau=1/(a+b)hinf=1/(1+exp((vm-thinf)/qinf))a=trap0(vm,thi12,Rd,qi)b=trap0(-vm,-thi2,Rg,qi)hinf2=hinfhtau2=hc}FUNCTIONtrap0(v,th,a,q){if(fabs(v/th)>1e-6){trap0=a*(v-th)/(1-exp(-(v-th)/q))}else{trap0=a*q}}