UNITS{(mA)=(milliamp)(mV)=(millivolt)}NEURON{SUFFIXKsomaUSEIONkREADekWRITEikRANGEgksoma,ikGLOBALninf,nexp,ntau}INDEPENDENT{tFROM0TO1WITH1(ms)}PARAMETER{v(mV)celsius=24(degC)dt(ms)gksoma=.0319(mho/cm2)ek=-90(mV)}STATE{n}ASSIGNED{ik(mA/cm2)ninfnexpntau(ms)}INITIAL{n=ninf}BREAKPOINT{SOLVEstatesik=gksoma*n*n*n*n*(v-ek)}PROCEDUREstates(){evaluate_fct(v)n=n+nexp*(ninf-n)VERBATIMreturn0;ENDVERBATIM}UNITSOFFPROCEDUREevaluate_fct(v(mV)){LOCALq10,tinc,alpha,betaTABLEninf,nexp,ntauDEPENDdt,celsiusFROM-200TO100WITH300q10=1tinc=-dt*q10alpha=0.018*vtrap(-(v-25),25)beta=0.0036*vtrap(v-35,12)ntau=1/(alpha+beta)ninf=alpha*ntaunexp=1-Exp(tinc/ntau)}FUNCTIONvtrap(x,y){if(fabs(x/y)<1e-6){vtrap=y*(1-x/y/2)}else{vtrap=x/(Exp(x/y)-1)}}FUNCTIONExp(x){if(x<-100){Exp=0}else{Exp=exp(x)}}UNITSON