NEURON{SUFFIXdIN_caUSEIONcaWRITEicaRANGEperm,ica,T,Sin,Sout,caRANGEalpha_A,alpha_B,alpha_C,alpha_D,alpha_ERANGEbeta_A1,beta_B1,beta_C1,beta_D1,beta_E1RANGEbeta_A2,beta_B2,beta_C2,beta_D2,beta_E2}UNITS{(nA)=(nanoamp)(uA)=(microamp)(mA)=(milliamp)(A)=(amp)(mV)=(millivolt)(mS)=(millisiemens)(uS)=(microsiemens)(molar)=(1/liter)(kHz)=(kilohertz)(mM)=(millimolar)(um)=(micrometer)(S)=(siemens)FARADAY=(faraday)(coulomb)R=(k-mole)(joule/kelvin)}PARAMETER{T=300.0(kelvin)z=2Sin=100e-9(moles/cm2)Sout=10e-6(moles/cm2)perm=1.425e-10alpha_A=4.05alpha_B=0.0alpha_C=1.0alpha_D=-15.32alpha_E=-13.57beta_A1=1.24beta_B1=0.093beta_C1=-1.0beta_D1=10.63beta_E1=1.0beta_A2=1.28beta_B2=0.0beta_C2=1.0beta_D2=5.39beta_E2=12.11}ASSIGNED{v(mV)ica(mA/cm2)cainfcatau(ms)}STATE{ca}INITIAL{rates()ca=cainf}BREAKPOINT{SOLVEstatesMETHODcnexpica=pow(ca,2)*ghk()}DERIVATIVEstates{rates()ca'=(cainf-ca)/catau}UNITSOFFPROCEDURErates(){LOCALalpha,betaif(v<-25.0){alpha=(alpha_A+alpha_B*v)/(alpha_C+exp((alpha_D+v)/alpha_E))beta=(beta_A1+beta_B1*v)/(beta_C1+exp((beta_D1+v)/beta_E1))}else{alpha=(alpha_A+alpha_B*v)/(alpha_C+exp((alpha_D+v)/alpha_E))beta=(beta_A2+beta_B2*v)/(beta_C2+exp((beta_D2+v)/beta_E2))}catau=1.0/(alpha+beta)cainf=alpha*catau}FUNCTIONalphabeta(A,B,C,D,E){alphabeta=(A+B*v)/(C+exp((v+D)/E))}FUNCTIONghk(){LOCALcv,ecv=(1e-3)*v*(z*FARADAY)/(R*T)e=exp(-cv)ghk=(1e3)*perm*cv*z*FARADAY*(Sin-Sout*e)/(1-e)}UNITSON