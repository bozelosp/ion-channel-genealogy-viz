INDEPENDENT{tFROM0TO1WITH1(ms)}NEURON{POINT_PROCESSIsinunoisyRANGEamp,i,freq,fr_stm,m,s,tau,x,new_seed,onset,np,shiftELECTRODE_CURRENTi}UNITS{(nA)=(nanoamp)}PARAMETER{dt(ms)m=0.(nA)s=0.(nA)tau=2.(ms)amp=0.(nA)freq=0.(Hz)fr_stm=1e-7shift=0phas=0.(HZ)fr2=5.(Hz)onset=00np=100000000000}ASSIGNED{i(nA)x}INITIAL{i=mx=m}BEFOREBREAKPOINT{if(tau<=0){x=m+s*normrand(0,1)}}BREAKPOINT{SOLVEoupif((t<onset)||(t>onset+(1000/freq)*np)){i=x}else{i=x+amp*sin(0.0062831853071795866*freq*t)*sin_step(sin(0.0062831853071795866*fr_stm*t+shift))}}FUNCTIONsin_step(xt){if(xt>0){sin_step=1}else{sin_step=0}}PROCEDUREoup(){if(tau>0){x=x+(1.-exp(-dt/tau))*(m-x)+sqrt(1.-exp(-2.*dt/tau))*s*normrand(0,1)}}PROCEDUREnew_seed(seed){set_seed(seed)}