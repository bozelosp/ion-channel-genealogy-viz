NEURON{SUFFIXcacumUSEIONcaREADicaWRITEcaiNONSPECIFIC_CURRENTiRANGEdepth,tau,cai0,cmax,gamma}UNITS{(mM)=(milli/liter)(mA)=(milliamp)F=(faraday)(coulombs)}PARAMETER{depth=0.1(um)irest=0(mA/cm2)tau=100(ms)cai0=50e-6(mM)gamma=1}ASSIGNED{ica(mA/cm2)cmaxi(mA/cm2)}STATE{cai(mM)}INITIAL{cai=cai0cmax=cai}BREAKPOINT{SOLVEintegrateMETHODderivimplicitif(cai>cmax){cmax=cai}i=0}DERIVATIVEintegrate{cai'=(1e4)*(gamma*(irest-ica)/(2*F*depth))+(cai0-cai)/tau}