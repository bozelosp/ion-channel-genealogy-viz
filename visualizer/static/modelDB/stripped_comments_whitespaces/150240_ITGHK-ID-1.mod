INDEPENDENT{tFROM0TO1WITH1(ms)}NEURON{SUFFIXitGHKUSEIONcaREADcai,caoWRITEicaRANGEpcabar,m_inf,tau_m,h_inf,tau_h,shift,actshiftGLOBALqm,qh}UNITS{(molar)=(1/liter)(mV)=(millivolt)(mA)=(milliamp)(mM)=(millimolar)FARADAY=(faraday)(coulomb)R=(k-mole)(joule/degC)}PARAMETER{v(mV)celsius=36(degC)pcabar=.2e-3(cm/s)shift=2(mV)actshift=0(mV)cai=2.4e-4(mM)cao=2(mM)qm=5qh=3}STATE{mh}ASSIGNED{ica(mA/cm2)m_inftau_m(ms)h_inftau_h(ms)phi_mphi_h}BREAKPOINT{SOLVEcastateMETHODeulerica=pcabar*m*m*h*ghk(v,cai,cao)}DERIVATIVEcastate{evaluate_fct(v)m'=(m_inf-m)/tau_mh'=(h_inf-h)/tau_h}UNITSOFFINITIAL{phi_m=qm^((celsius-24)/10)phi_h=qh^((celsius-24)/10)evaluate_fct(v)m=m_infh=h_inf}PROCEDUREevaluate_fct(v(mV)){m_inf=1.0/(1+exp(-(v+shift+actshift+57)/6.2))h_inf=1.0/(1+exp((v+shift+81)/4.0))tau_m=(0.612+1.0/(exp(-(v+shift+actshift+132)/16.7)+exp((v+shift+actshift+16.8)/18.2)))/phi_mif((v+shift)<-80){tau_h=exp((v+shift+467)/66.6)/phi_h}else{tau_h=(28+exp(-(v+shift+22)/10.5))/phi_h}}FUNCTIONghk(v(mV),ci(mM),co(mM))(.001coul/cm3){LOCALz,eci,ecoz=(1e-3)*2*FARADAY*v/(R*(celsius+273.15))eco=co*efun(z)eci=ci*efun(-z)ghk=(.001)*2*FARADAY*(eci-eco)}FUNCTIONefun(z){if(fabs(z)<1e-4){efun=1-z/2}else{efun=z/(exp(z)-1)}}FUNCTIONnongat(v,cai,cao){nongat=pcabar*ghk(v,cai,cao)}UNITSON