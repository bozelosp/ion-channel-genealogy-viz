NEURON{POINT_PROCESSAmpaNmdaRANGER,g,mg,inmda,iampa,gnmda,gampaRANGEx,mgid,ggid,srcgid,gmax,trainingNONSPECIFIC_CURRENTiGLOBALCdur,Alpha,Beta,E,Rinf,Rtau,ampatauGLOBALgampafactor,nmdafactorGLOBALltdinvl,ltpinvl,sighalf,sigslope,sigexp}UNITS{(nA)=(nanoamp)(mV)=(millivolt)(umho)=(micromho)(mM)=(milli/liter)}PARAMETER{Cdur=1(ms)Alpha=0.35(/ms)Beta=0.012(/ms)E=0(mV)mg=1(mM)gmax=2(umho)gampafactor=0.001(1)nmdafactor=0.07(1)ltdinvl=250(ms)ltpinvl=33.33(ms)sighalf=25(1)sigslope=5(1)sigexp=4ampatau=3(ms)x=0(um)mgid=-1ggid=-1srcgid=-1training=1}ASSIGNED{v(mV)i(nA)inmda(nA)iampa(nA)gnmda(umho)RinfRtau(ms)synon}STATE{RonRoffgampa(umho)}INITIAL{PROTECTRinf=Alpha/(Alpha+Beta)PROTECTRtau=1/(Alpha+Beta)synon=0gampa=0}BREAKPOINT{SOLVEreleaseMETHODcnexpgnmda=mgblock(v)*(Ron+Roff)*gmax*nmdafactorinmda=gnmda*(v-E)iampa=gampa*(v-E)i=iampa+inmda}DERIVATIVErelease{Ron'=(synon*Rinf-Ron)/RtauRoff'=-Beta*Roffgampa'=-gampa/ampatau}FUNCTIONmgblock(v(mV)){TABLEDEPENDmgFROM-140TO80WITH1000mgblock=1/(1+exp(0.062(/mV)*-v)*(mg/3.57(mM)))}FUNCTIONplast(step(1))(1){plast=(1-1/(1+exp((step-sighalf)/sigslope)))^sigexp}NET_RECEIVE(weight,s,w,tlast(ms),r0,t0(ms)){INITIAL{if(s==0){w=0}else{w=weight*plast(s)}tlast=-1e9(ms)r0=0t0=-1e9(ms)}if(flag==0){if(t-tlast<ltpinvl){if(training){s=s+1if(s>75){s=75}}}elseif(t-tlast>ltdinvl){}else{if(training){s=s-1if(s<0){s=0}}}tlast=tif(s==0){w=0}else{w=weight*plast(s)}gampa=gampa+w*gmax*gampafactorr0=r0*exp(-Beta*(t-t0))t0=tsynon=synon+wRon=Ron+r0Roff=Roff-r0net_send(Cdur,w+1)}else{r0=(flag-1)*Rinf+(r0-(flag-1)*Rinf)*exp(-(t-t0)/Rtau)t0=tsynon=synon-(flag-1)Ron=Ron-r0Roff=Roff+r0}}