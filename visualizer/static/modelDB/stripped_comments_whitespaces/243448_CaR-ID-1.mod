NEURON{SUFFIXCaRUSEIONcaREADcai,caoWRITEicaRANGEminf,mtau,hinf,htau,h2tau,ica,pmax}UNITS{(mA)=(milliamp)(mV)=(millivolt)(mM)=(milli/liter)FARADAY=96489(coul)R=8.314(volt-coul/degC)}PARAMETER{v(mV)celsius(degC)cai(mM)cao(mM)pmax=1e-8(cm/s)}STATE{mhh2}ASSIGNED{ica(mA/cm2)mtau(ms)minfhinfhtau(ms)h2tau(ms)}BREAKPOINT{SOLVEstateMETHODcnexpica=pmax*m*(0.4*h+0.6*h2)*ghk(v,cai,cao,2)}DERIVATIVEstate{rates(v)m'=(minf-m)/mtauh'=(hinf-h)/htauh2'=(hinf-h2)/h2tau}INITIAL{rates(v)m=minfh=hinfh2=hinf}FUNCTIONghk(v(mV),ci(mM),co(mM),z)(millicoul/cm3){LOCALe,ww=v*(.001)*z*FARADAY/(R*(celsius+273.16))if(fabs(w)>1e-4){e=w/(exp(w)-1)}else{e=1-w/2}ghk=-(.001)*z*FARADAY*(co-ci*exp(w))*e}UNITSOFFFUNCTION_TABLEtabmtau(v(mV))(ms)FUNCTION_TABLEtabhtau(v(mV))(ms)FUNCTION_TABLEtabhtau2(v(mV))(ms)PROCEDURErates(v(mV)){minf=1/(1+exp((-5-v)/5))mtau=tabmtau(v)hinf=1/(1+exp((v+51)/12))htau=tabhtau(v)h2tau=tabhtau2(v)}UNITSON