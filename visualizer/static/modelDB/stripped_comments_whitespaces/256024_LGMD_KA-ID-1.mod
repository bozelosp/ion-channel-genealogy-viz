UNITS{(mA)=(milliamp)(mV)=(millivolt)(S)=(siemens)}NEURON{THREADSAFESUFFIXKAUSEIONkREADekWRITEikRANGEgmax,gGLOBALtnmax,tlmax}PARAMETER{gmax=0.01(mho/cm2)vhalfn=-40(mV)vn2=-50(mV)tnmax=3.5(ms)tnmin=0.5(ms)tns=-8(mV)zn=7.5(mV)np=1(1)vhalfl=-45(mV)vl2=-50(mV)tlmax=35(ms)tlmin=3.0(ms)tls=12(mV)zl=-5(mV)}STATE{nl}ASSIGNED{v(mV)ek(mV)ik(mA/cm2)ninf(1)linf(1)taul(ms)taun(ms)i(mA/cm2)g(S/cm2)}BREAKPOINT{SOLVEstatesMETHODcnexpg=gmax*n^np*lik=g*(v-ek)}INITIAL{rates(v)n=ninfl=linf}FUNCTIONalpn(v(mV)){alpn=exp((vhalfn-v)/zn)}FUNCTIONbetn(v(mV)){betn=exp((vn2-v)/tns)}FUNCTIONalpl(v(mV)){alpl=exp((vhalfl-v)/zl)}DERIVATIVEstates{rates(v)n'=(ninf-n)/taunl'=(linf-l)/taul}PROCEDURErates(v(mV)){LOCALaTABLEninf,taun,linf,taulDEPENDvhalfn,vhalfl,tlmax,tnmax,tnmin,tlmin,zn,zlFROM-100TO50WITH600a=alpn(v)ninf=1/(1+a)taun=4*(tnmax-tnmin)/(1+betn(v))*ninf+tnmina=alpl(v)linf=1/(1+a)taul=4*(tlmax-tlmin)/(1+exp((vl2-v)/tls))*linf+tlmin}