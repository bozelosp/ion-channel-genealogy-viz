UNITS{(molar)=(1/liter)(S)=(siemens)(mA)=(milliamp)(mV)=(millivolt)F=(faraday)(coulomb)R=(molek)(mV-coulomb/degC)(mM)=(millimolar)}NEURON{SUFFIXhh3USEIONnaREADnaiWRITEinaUSEIONkWRITEikRANGEgnabar,gkhhbar,gkabar,ina,ikhh,ika,ik,ena,miv,hiv,htv1,htv2GLOBALminf,hinf,ninf}INDEPENDENT{tFROM0TO1WITH1(ms)}PARAMETER{v(mV)dt(ms)nai(mM)celsius=35.0(degC)gnabar=5500.0e-6(S/cm2)gkhhbar=1000.0e-6(S/cm2)gkabar=100.0e-6(S/cm2)miv=44.6(mV)hiv=66.8(mV)htv1=39.0(mV)htv2=59.0(mV)ek=-100(mV)nao=145(mM)}STATE{m<1e-4>h<1e-4>n<1e-4>p<1e-4>q<1e-4>}ASSIGNED{ina(mA/cm2)ik(mA/cm2)ika(mA/cm2)ikhh(mA/cm2)ena(mV)minfhinfninfqinfpinf}BREAKPOINT{SOLVEstatesMETHODcnexpena=R*(celsius+273.15)/F*log(nao/nai)ina=gnabar*m*m*m*h*(v-ena)ikhh=gkhhbar*n*n*n*(v-ek)ika=gkabar*p*p*p*q*(v-ek)ik=ika+ikhh}UNITSOFFINITIAL{m=boltz(v,-miv,6.0)h=boltz(v,-hiv,-7.8)n=boltz(v,-35,12.0)p=boltz(v,-42,4.0)q=boltz(v,-63,-4.0)}DERIVATIVEstates{LOCALminf,hinf,ninf,pinf,qinf,mtau,htau,ntau,ptau,qtauminf=boltz(v,-miv,6.0)hinf=boltz(v,-hiv,-7.8)ninf=boltz(v,-35,12.0)pinf=boltz(v,-42,4.0)qinf=boltz(v,-63,-4.0)mtau=boltz(v,-45.0,-1.5)-boltz(v,-65.0,-0.5)+0.04htau=56.0*boltz(v,-htv1,-4.5)-56.0*boltz(v,-htv2,-2.0)+1.0ntau=150.0ptau=5.5*exp(-(v+42)*(v+42)/100)+4.0qtau=10.0m'=(minf-m)/mtauh'=(hinf-h)/htaun'=(ninf-n)/ntaup'=(pinf-p)/ptauq'=(qinf-q)/qtau}FUNCTIONboltz(x,y,z){boltz=1/(1+exp(-(x-y)/z))}UNITSON