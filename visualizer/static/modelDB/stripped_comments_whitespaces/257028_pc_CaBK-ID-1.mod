NEURON{SUFFIXpcCaBKUSEIONkREADekWRITEikUSEIONcaREADcaiRANGEgkbar,gk,ikGLOBALminf,taum,hinf,tauh,zinf,tauzGLOBALzhalf}UNITS{(mV)=(millivolt)(mA)=(milliamp)(nA)=(nanoamp)(pA)=(picoamp)(S)=(siemens)(nS)=(nanosiemens)(pS)=(picosiemens)(um)=(micron)(molar)=(1/liter)(mM)=(millimolar)}CONSTANT{q10=2.2cvm=28.9(mV)ckm=6.2(mV)ctm=0.000505(s)cvtm1=86.4(mV)cktm1=-10.1(mV)cvtm2=-33.3(mV)cktm2=10(mV)ctauz=1(ms)ch=0.085cvh=32(mV)ckh=-5.8(mV)cth=0.0019(s)cvth1=48.5(mV)ckth1=-5.2(mV)cvth2=-54.2(mV)ckth2=12.9(mV)}PARAMETER{v(mV)celsius(degC)gkbar=0.014(S/cm2)ek(mV)cai(mM)zhalf=0.001(mM)}ASSIGNED{ik(mA/cm2)qtgk(S/cm2)minftaum(ms)hinftauh(ms)zinftauz(ms)}STATE{mFROM0TO1zFROM0TO1hFROM0TO1}INITIAL{qt=q10^((celsius-22(degC))/10(degC))rates(v)m=minfz=zinfh=hinf}BREAKPOINT{SOLVEstatesMETHODcnexpgk=gkbar*m^3*z^2*hik=gk*(v-ek)}DERIVATIVEstates{rates(v)m'=(minf-m)/taumz'=(zinf-z)/tauzh'=(hinf-h)/tauh}PROCEDURErates(v(mV)){v=v+5(mV)minf=1/(1+exp(-(v+cvm)/ckm))taum=(1e3)*(ctm+1(s)/(exp(-(v+cvtm1)/cktm1)+exp(-(v+cvtm2)/cktm2)))/qtzinf=1/(1+zhalf/cai)tauz=ctauz/qthinf=ch+(1-ch)/(1+exp(-(v+cvh)/ckh))tauh=(1e3)*(cth+1(s)/(exp(-(v+cvth1)/ckth1)+exp(-(v+cvth2)/ckth2)))/qt}