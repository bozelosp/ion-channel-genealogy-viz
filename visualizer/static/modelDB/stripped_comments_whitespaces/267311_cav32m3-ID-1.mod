INDEPENDENT{tFROM0TO1WITH1(ms)}NEURON{THREADSAFESUFFIXit_cav32m3USEIONcaREADcai,caoWRITEicaRANGEpcabar,icaGLOBALm_inf,h_inf,tau_m,tau_h}UNITS{(molar)=(1/liter)(mV)=(millivolt)(mA)=(milliamp)(mM)=(millimolar)FARADAY=(faraday)(coulomb)R=(k-mole)(joule/degC)}PARAMETER{v(mV)cai(mM)cao(mM)celsius(degC)pcabar=2e-4(cm/s)}STATE{mh}ASSIGNED{ica(mA/cm2)m_inftau_m(ms)h_inftau_h(ms)}BREAKPOINT{SOLVEcastateMETHODcnexpica=pcabar*m*m*m*h*ghk(v,1e-6,cao)}DERIVATIVEcastate{evaluate_fct(v)m'=(m_inf-m)/tau_mh'=(h_inf-h)/tau_h}INITIAL{evaluate_fct(v)m=m_infh=h_inf}PROCEDUREevaluate_fct(v(mV)){UNITSOFFm_inf=1.0/(1.0+exp(-(v+51.5)/5.8))h_inf=1.0/(1.0+exp((v+73.7)/9.1))tau_m=0.743+5.938/(exp(-(v+70.45)/12.85)+exp((v+70.45)/12.85))tau_h=1.0+11.65*exp(-(v+60.0)/233.0)UNITSON}FUNCTIONghk(v(mV),ci(mM),co(mM))(.001coul/cm3){LOCALz,eci,ecoz=(1e-3)*2*FARADAY*v/(R*(celsius+273.15))eco=co*efun(z)eci=ci*efun(-z)ghk=(.001)*2*FARADAY*(eci-eco)}FUNCTIONefun(z){if(fabs(z)<1e-4){efun=1-z/2}else{efun=z/(exp(z)-1)}}UNITSON