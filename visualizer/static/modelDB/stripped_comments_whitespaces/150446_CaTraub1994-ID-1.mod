NEURON{SUFFIXCaUSEIONcaWRITEicaRANGEgbar,g,i,minfGLOBALVm,Eca}UNITS{(S)=(siemens)(mA)=(milliamp)(mV)=(millivolt)}PARAMETER{gbar=0(S/cm2)Vm=-65(mV)Eca=75(mV)}ASSIGNED{v(mV)ica(mA/cm2)i(mA/cm2)g(S/cm2)minfmtau(ms)}STATE{m}BREAKPOINT{SOLVEstatesMETHODcnexpg=gbar*m^2i=g*(v-Eca)ica=i}INITIAL{rates(v)m=minf}DERIVATIVEstates{rates(v)m'=(minf-m)/mtau}PROCEDURErates(v(mV)){LOCALalpham,betam,smallTABLEminf,mtauFROM-100TO50WITH200UNITSOFFalpham=1.6/(1+exp(-0.072*(v-Vm-65)))small=(v-Vm-51.1)/5if(fabs(small)>1e-6){betam=0.02*(v-Vm-51.1)/(exp((v-Vm-51.1)/5)-1)}else{betam=0.02*5/(1+small/2)}minf=alpham/(alpham+betam)mtau=1/(alpham+betam)UNITSON}