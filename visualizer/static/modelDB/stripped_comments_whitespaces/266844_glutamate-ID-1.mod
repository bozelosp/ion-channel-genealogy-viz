NEURON{POINT_PROCESSglutamateUSEIONcaREADcaiWRITEicaVALENCE2NONSPECIFIC_CURRENTinmda,iampaRANGEe,ntar,local_v,inmda,iampa,ghRANGEgnmdamax,gampamaxRANGEdel,Tspike,NspikeRANGEgnmda,gampaGLOBALn,gama,tau1,tau2,tauh,cahGLOBALtau3,tau4}UNITS{(nA)=(nanoamp)(mV)=(millivolt)(nS)=(nanomho)(mM)=(milli/liter)F=96480(coul)R=8.314(volt-coul/degC)}PARAMETER{gnmdamax=1(nS)gampamax=1(nS)e=0.0(mV)tau1=50(ms)tau2=10(ms)tau3=9(ms)tau4=1(ms)n=0.25(/mM)gama=0.08(/mV)dt(ms)ntar=1v(mV)del=30(ms)Tspike=10(ms)Nspike=1cah=10(/ms)tauh=1000(/ms)}ASSIGNED{inmda(nA)iampa(nA)gnmda(nS)gampa(nS)gh(nS)ica(mA/cm2)local_v(mV)cai(mM)}STATE{A(nS)B(nS)C(nS)D(nS)h(nS)}INITIAL{gnmda=0gampa=0h=0A=0B=0C=0D=0}BREAKPOINT{LOCALcountSOLVEstateMETHODcnexpFROMcount=0TONspike-1{IF(at_time(count*Tspike+del)){state_discontinuity(A,A+gnmdamax)state_discontinuity(B,B+gnmdamax)state_discontinuity(C,C+gampamax/ntar)state_discontinuity(D,D+gampamax/ntar)}}gnmda=(A-B)/(1+n*exp(-gama*v))gh=(exp(-h))inmda=(1e-3)*gnmda*gh*(v-e)ica=inmda/10gampa=C-Diampa=(1e-3)*gampa*(v-e)local_v=v}DERIVATIVEstate{A'=-A/tau1B'=-B/tau2C'=-C/tau3D'=-D/tau4h'=(cah*cai-h)/tauh}