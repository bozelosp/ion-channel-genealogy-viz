UNITS{(S)=(siemens)(mA)=(milliamp)(mV)=(millivolt)}NEURON{SUFFIXcaHVAUSEIONcaREADecaWRITEicaRANGEgcaHVAbar,icaHVA,icaRANGEdHVAinf,fHVAinfRANGEdHVAtau,fHVAtauRANGEvhalfAct,slopeAct,vhalfInact,slopeInactRANGEvhalfTact,slopeTact,vhalfTinact,slopeTinact}PARAMETER{v(mV)dt(ms)gcaHVAbar=0.00004(S/cm2)eca=120(mV)vhalfAct=-22(mV)vhalfInact=-40.0(mV)slopeAct=5.0slopeInact=-7.0vhalfTact=-40.0(mV)vhalfTinact=-39(mV)slopeTact=-3slopeTinact=-2.6}STATE{dHVAfHVA}ASSIGNED{ica(mA/cm2)icaHVA(mA/cm2)dHVAinffHVAinf}BREAKPOINT{SOLVEstatesMETHODcnexpicaHVA=gcaHVAbar*dHVA*fHVA*(v-eca)ica=icaHVA}UNITSOFFINITIAL{dHVA=dHVAinffHVA=fHVAinf}DERIVATIVEstates{LOCALdHVAinf,dHVAtau,fHVAinf,fHVAtaudHVAinf=1/(1+exp(-(v-vhalfAct)/slopeAct))fHVAinf=1/(1+exp(-(v-vhalfInact)/slopeInact))dHVAtau=1/(1+exp(-(v-vhalfTact)/slopeTact))+0.78fHVAtau=77/(1+exp(-(v-vhalfTinact)/slopeTinact))+17dHVA'=(dHVAinf-dHVA)/dHVAtaufHVA'=(fHVAinf-fHVA)/fHVAtau}FUNCTIONboltz(x,y,z){boltz=1/(1+exp(-(x-y)/z))}UNITSON