NEURON{SUFFIXkdrgcUSEIONkREADekWRITEikRANGEgbarGLOBALminf,mtau,hinf,htau}PARAMETER{gbar=0.02(mho/cm2)celsiusek(mV)v(mV)a0m=0.04vhalfm=-30zetam=3gmm=0.8a0h=0.0001vhalfh=-58zetah=4gmh=0.6hmin=700q10=1}UNITS{(mA)=(milliamp)(mV)=(millivolt)(pS)=(picosiemens)(um)=(micron)}ASSIGNED{ik(mA/cm2)minfmtau(ms)hinfhtau(ms)}STATE{mh}BREAKPOINT{SOLVEstatesMETHODcnexpik=gbar*m*m*m*h*(v-ek)}INITIAL{trates(v)m=minfh=hinf}DERIVATIVEstates{trates(v)m'=(minf-m)/mtauh'=(hinf-h)/htau}PROCEDUREtrates(v){LOCALqtqt=q10^((celsius-24)/10)minf=1/(1+exp(-(v-0.2)/9.4))mtau=betm(v)/(a0m*(1+alpm(v)))hinf=1/(1+exp((v+52.3)/7.4))htau=beth(v)/(qt*a0h*(1+alph(v)))if(htau<hmin/qt){htau=hmin/qt}}FUNCTIONalpm(v(mV)){alpm=exp(1.e-3*zetam*(v-vhalfm)*9.648e4/(8.315*(273.16+celsius)))}FUNCTIONbetm(v(mV)){betm=exp(1.e-3*zetam*gmm*(v-vhalfm)*9.648e4/(8.315*(273.16+celsius)))}FUNCTIONalph(v(mV)){alph=exp(1.e-3*zetah*(v-vhalfh)*9.648e4/(8.315*(273.16+celsius)))}FUNCTIONbeth(v(mV)){beth=exp(1.e-3*zetah*gmh*(v-vhalfh)*9.648e4/(8.315*(273.16+celsius)))}