INDEPENDENT{tFROM0TO1WITH1(ms)}NEURON{SUFFIXsscaUSEIONcaREADecaWRITEicaRANGEgca,gamma,eta,deterministicRANGEreff,N,inactF,actFGLOBALminf,mtau,hinf,htauGLOBALvmin,vmax,tadjGLOBALP_am,P_bm,P_ah,P_bh,wflag,vshiftGLOBALDONT_VECTORIZE}UNITS{(mA)=(milliamp)(mV)=(millivolt)(pS)=(picosiemens)(um)=(micron)FARADAY=(faraday)(coulomb)R=(k-mole)(joule/degC)PI=(pi)(1)}PARAMETER{v(mV)dt(ms)areainactF=3actF=1gamma=20(pS)eta=.005(1/um2)vshift=0(mV)cao=2.5(mM)cai(mM)celsius(degC)vmin=-120(mV)vmax=100(mV)DONT_VECTORIZEdeterministic=0}STATE{mhm0h0m0h1m1h0m1h1m2h0m2h1m0h0_m1h0m1h0_m2h0m0h1_m1h1m1h1_m2h1m2h0_m1h0m1h0_m0h0m2h1_m1h1m1h1_m0h1m0h0_m0h1m0h1_m0h0m1h0_m1h1m1h1_m1h0m2h0_m2h1m2h1_m2h0}ASSIGNED{ica(mA/cm2)gca(pS/um2)eca(mV)minfhinfmtau(ms)htau(ms)tadjam(/ms)bm(/ms)ah(/ms)bh(/ms)Nreff(pS/um2)scale_dens(pS/um2)P_amP_bmP_ahP_bhwflag}INITIAL{rates(v+vshift)m=minfh=hinfwflag=1scale_dens=gamma/areaN=floor(eta*area+0.5)reff=eta*gammam1h0=floor(2*m*(1-m)*(1-h)*N+0.5)m2h0=floor(m*m*(1-h)*N+0.5)m0h1=floor((1-m)*(1-m)*h*N+0.5)m1h1=floor(2*m*(1-m)*h*N+0.5)m2h1=floor(m*m*h*N+0.5)m0h0=N-(m1h0+m2h0+m0h1+m1h1+m2h1)m0h0_m1h0=0m1h0_m2h0=0m0h1_m1h1=0m1h1_m2h1=0m2h0_m1h0=0m1h0_m0h0=0m2h1_m1h1=0m1h1_m0h1=0m0h0_m0h1=0m0h1_m0h0=0m1h0_m1h1=0m1h1_m1h0=0m2h0_m2h1=0m2h1_m2h0=0}BREAKPOINT{SOLVEstatesif(deterministic){if(deterministic-1){gca=m*m*h*tadj*reff}else{gca=floor(m*m*h*N+0.5)*scale_dens*tadj}}else{gca=strap(m2h1)*scale_dens*tadj}ica=(1e-4)*gca*(v-eca)}PROCEDUREstates(){VERBATIMexterndoubleBnlDev_RNG();ENDVERBATIMrates(v+vshift)m=m+(1-exp(-dt/mtau))*(minf-m)h=h+(1-exp(-dt/htau))*(hinf-h)P_am=strap(am*dt)P_bm=strap(bm*dt)ChkProb(2.0*P_am)ChkProb(2.0*P_bm)ChkProb(P_bm/(1.0-P_am))m0h0_m1h0=BnlDev_RNG(2.0*P_am,m0h0)m1h0_m2h0=BnlDev_RNG(P_am,m1h0)m1h0_m0h0=BnlDev_RNG(P_bm/(1.0-P_am),m1h0-m1h0_m2h0)m2h0_m1h0=BnlDev_RNG(2.0*P_bm,m2h0)m0h1_m1h1=BnlDev_RNG(2.0*P_am,m0h1)m1h1_m2h1=BnlDev_RNG(P_am,m1h1)m1h1_m0h1=BnlDev_RNG(P_bm/(1.0-P_am),m1h1-m1h1_m2h1)m2h1_m1h1=BnlDev_RNG(2.0*P_bm,m2h1)m0h0=m0h0-m0h0_m1h0+m1h0_m0h0m1h0=m1h0-m1h0_m2h0-m1h0_m0h0+m2h0_m1h0+m0h0_m1h0m2h0=m2h0-m2h0_m1h0+m1h0_m2h0m0h1=m0h1-m0h1_m1h1+m1h1_m0h1m1h1=m1h1-m1h1_m2h1-m1h1_m0h1+m2h1_m1h1+m0h1_m1h1m2h1=m2h1-m2h1_m1h1+m1h1_m2h1P_ah=strap(ah*dt)P_bh=strap(bh*dt)ChkProb(P_ah)ChkProb(P_bh)m0h0_m0h1=BnlDev_RNG(P_ah,m0h0)m0h1_m0h0=BnlDev_RNG(P_bh,m0h1)m1h0_m1h1=BnlDev_RNG(P_ah,m1h0)m1h1_m1h0=BnlDev_RNG(P_bh,m1h1)m2h0_m2h1=BnlDev_RNG(P_ah,m2h0)m2h1_m2h0=BnlDev_RNG(P_bh,m2h1)m0h0=m0h0-m0h0_m0h1+m0h1_m0h0m1h0=m1h0-m1h0_m1h1+m1h1_m1h0m2h0=m2h0-m2h0_m2h1+m2h1_m2h0m0h1=m0h1-m0h1_m0h0+m0h0_m0h1m1h1=m1h1-m1h1_m1h0+m1h0_m1h1m2h1=m2h1-m2h1_m2h0+m2h0_m2h1}PROCEDURErates(vm(mV)){TABLEminf,hinf,mtau,htau,am,bm,ah,bh,tadjDEPENDcelsius,actF,inactFFROM-120TO100WITH199UNITSOFFtadj=2.3^((celsius-23)/10)am=0.055*(-27-vm)/(exp((-27-vm)/3.8)-1)/actFbm=0.94*exp((-75-vm)/17)/actFam=am*tadjbm=bm*tadjmtau=1/(am+bm)minf=am/(am+bm)ah=0.000457*exp((-13-vm)/50)/inactFbh=0.0065/(exp((-vm-15)/28)+1)/inactFah=ah*tadjbh=bh*tadjhtau=1/(ah+bh)hinf=ah/(ah+bh)}UNITSONFUNCTIONstrap(x){if(x<0){strap=0VERBATIMfprintf(stderr,"sca.mod:strap:negativevalueforstate");ENDVERBATIM}else{strap=x}}PROCEDUREChkProb(p){if(p<0.0||p>1.0){if(wflag){VERBATIMfprintf(stderr,"sca.mod:ChkProb:argumentnotaprobability.\n");ENDVERBATIMwflag=0}}}