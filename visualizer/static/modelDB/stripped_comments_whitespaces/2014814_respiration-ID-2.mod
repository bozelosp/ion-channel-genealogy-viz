NEURON{SUFFIXrespirationPOINTERVpointerRANGEbetaO2,c,CaO2,dvolrhs,E1,E2,eta,gamma,gtonic,Hb,Jbt,Jlb,K,Kp,M,m_inf,NT,partial,PO2ext,r,R,SaO2,sigma_h,sigma_m,sigma_mp,sigma_n,taulb,Temp,Tmax,Vol0,volblood,VT}PARAMETER{r=0.001Tmax=1VT=2Kp=5E1=0.0025E2=0.4Vol0=2PO2ext=149.73R=62.364Temp=310taulb=500M=8e-6Hb=150volblood=5betaO2=0.03c=2.5K=26}ASSIGNED{CaO2dvolrhsetagammagtonicJbtJlbNTpartialSaO2sigma_hsigma_msigma_mpsigma_nVpointer}STATE{alphavollungPO2lungPO2blood}BREAKPOINT{SOLVEstatesMETHODderivimplicitgtonic=0.3*(1-tanh((PO2blood-85)/30))}INITIAL{alpha=2.0026e-04vollung=2.0525PO2lung=98.9638PO2blood=97.7927}DERIVATIVEstates{alpha'=calc_alpha(Vpointer,alpha,vollung,PO2lung,PO2blood)vollung'=calc_vollung(Vpointer,alpha,vollung,PO2lung,PO2blood)PO2lung'=calc_PO2lung(Vpointer,alpha,vollung,PO2lung,PO2blood)PO2blood'=calc_PO2blood(Vpointer,alpha,vollung,PO2lung,PO2blood)}FUNCTIONcalc_alpha(Vpointer,alpha,vollung,PO2lung,PO2blood){NT=Tmax/(1+exp(-(Vpointer-VT)/Kp))calc_alpha=r*NT*(1-alpha)-r*alpha}FUNCTIONcalc_vollung(Vpointer,alpha,vollung,PO2lung,PO2blood){dvolrhs=-E1*(vollung-Vol0)+E2*alphaif(dvolrhs<0){dvolrhs=0}calc_vollung=-E1*(vollung-Vol0)+E2*alpha}FUNCTIONcalc_PO2lung(Vpointer,alpha,vollung,PO2lung,PO2blood){calc_PO2lung=(1/vollung)*(PO2ext-PO2lung)*dvolrhs-Jlb*(R*Temp/vollung)}FUNCTIONcalc_PO2blood(Vpointer,alpha,vollung,PO2lung,PO2blood){eta=Hb*1.36gamma=volblood/22400SaO2=pow(PO2blood,c)/(pow(PO2blood,c)+pow(K,c))CaO2=eta*SaO2+betaO2*PO2bloodpartial=(c*pow(PO2blood,(c-1)))*(1/(pow(PO2blood,c)+pow(K,c))-(pow(PO2blood,c))/(pow(pow(PO2blood,c)+pow(K,c),2)))Jlb=(1/taulb)*(PO2lung-PO2blood)*(vollung/(R*Temp))Jbt=M*CaO2*gammacalc_PO2blood=(Jlb-Jbt)/(gamma*(betaO2+eta*partial))}