NEURON{SUFFIXGPeANONSPECIFIC_CURRENTilkUSEIONcaREADcai,caoWRITEica,caiUSEIONkREADki,koWRITEikUSEIONnaREADnai,naoWRITEinaRANGEina,ik,icaRANGEgnabar,ena,m_inf,h_inf,tau_h,tau_mRANGEgkdrbar,ek,n_inf,tau_n,ikDRANGEgl,el,ilkRANGEgcatbar,eca,p_inf,tau_p,q_inf,tau_q,icaTRANGEgkcabar,ek,r_inf,ikAHPRANGEkca,vol,caGain}UNITS{(mA)=(milliamp)(mV)=(millivolt)(S)=(siemens)(molar)=(1/liter)(mM)=(millimolar)FARADAY=(faraday)(coulomb)PI=(pi)(1)}PARAMETER{R=8.31441(Gasconstant)T(Absolutetemp)celsius(degC)gnabar=49e-3(S/cm2)theta_m=-38(mV)theta_h=-45.5(mV)k_m=-7(mV)k_h=6.4(mV)tau_m0=0.001(ms)tau_m1=0.1(ms)tau_h0=0(ms)tau_h1=4.5(ms)tht_m=-53(mV)tht_h1=-50(mV)tht_h2=-50(mV)sig_m=-0.7(mV)sig_h1=-15(mV)sig_h2=16(mV)gkdrbar=57e-3(S/cm2)theta_n=-42(mV)k_n=-14(mV)tau_n0=0(ms)tau_n1=2.4(ms)tht_n1=-40(mV)tht_n2=-40(mV)sig_n1=-40(mV)sig_n2=50(mV)gl=0.35e-3(S/cm2)el=-60(mV)kca=2(1/ms)areavol=3.355e-11(L)caGain=.1gcatbar=5e-3(S/cm2)theta_p=-56(mV)theta_q=-85(mV)k_p=-6.7(mV)k_q=5.8(mV)tau_p0=5(ms)tau_p1=0.33(ms)tau_q0=0(ms)tau_q1=400(ms)tht_p1=-27(mV)tht_p2=-102(mV)tht_q1=-50(mV)tht_q2=-50(mV)sig_p1=-10(mV)sig_p2=15(mV)sig_q1=-15(mV)sig_q2=16(mV)gkcabar=1e-3(S/cm2)theta_r=0.17e-3(mM)k_r=-0.08e-3(mM)tau_r=2(ms)power_r=2}ASSIGNED{v(mV)ina(mA/cm2)ik(mA/cm2)ikD(mA/cm2)ikAHP(mA/cm2)ica(mA/cm2)icaT(mA/cm2)ilk(mA/cm2)h_inftau_h(ms)m_inftau_m(ms)ena(mV)n_inftau_n(ms)ek(mV)p_infq_inftau_p(ms)tau_q(ms)eca(mV)r_inf}STATE{mhnpqcai(mM)<1e-10>cao(mM)<1e-10>nai(mM)<1e-10>nao(mM)<1e-10>ki(mM)<1e-10>ko(mM)<1e-10>r}BREAKPOINT{SOLVEstatesMETHODcnexpT=273+celsius-9.5ena=-(R*T)/FARADAY*log(nai/nao)*1000ek=(R*T)/FARADAY*log(ko/ki)*1000eca=-(R*T)/FARADAY*log(cai/cao)*1000/2ina=gnabar*m*m*m*h*(v-ena)ikD=gkdrbar*n^4*(v-ek)ikAHP=gkcabar*(v-ek)*r^(power_r)ik=ikD+ikAHPilk=gl*(v-el)ica=gcatbar*p*p*q*(v-eca)}DERIVATIVEstates{evaluate_fct(v)h'=(h_inf-h)/tau_hm'=(m_inf-m)/tau_mn'=(n_inf-n)/tau_np'=(p_inf-p)/tau_pq'=(q_inf-q)/tau_qcai'=caGain*(-ica*area*1e-11/(2*FARADAY*vol)-kca*cai)r'=(r_inf-r)/tau_r}UNITSOFFINITIAL{evaluate_fct(v)m=m_infh=h_infn=n_infp=p_infq=q_infr=r_inf}PROCEDUREevaluate_fct(v(mV)){h_inf=1/(1+exp((v-theta_h)/k_h))m_inf=1/(1+exp((v-theta_m)/k_m))tau_h=tau_h0+tau_h1/(exp(-(v-tht_h1)/sig_h1)+exp(-(v-tht_h2)/sig_h2))tau_m=tau_m0+tau_m1/(1+exp(-(v-tht_m)/sig_m))n_inf=1/(1+exp((v-theta_n)/k_n))tau_n=tau_n0+tau_n1/(exp(-(v-tht_n1)/sig_n1)+exp(-(v-tht_n2)/sig_n2))p_inf=1/(1+exp((v-theta_p)/k_p))q_inf=1/(1+exp((v-theta_q)/k_q))tau_p=tau_p0+tau_p1/(exp(-(v-tht_p1)/sig_p1)+exp(-(v-tht_p2)/sig_p2))tau_q=tau_q0+tau_q1/(exp(-(v-tht_q1)/sig_q1)+exp(-(v-tht_q2)/sig_q2))r_inf=1/(1+exp((cai-theta_r)/k_r))}UNITSON