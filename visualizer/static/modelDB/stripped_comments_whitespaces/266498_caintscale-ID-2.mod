NEURON{SUFFIXcaintscaleUSEIONcaREADicaWRITEcaiGLOBALnbRANGEa,ku,kr,Bi,diffOc,SA,Vol,L,nseg}UNITS{(mV)=(millivolt)(um)=(micrometer)(mA)=(milliamp)FARADAY=96500(coulombs)(molar)=(1/liter)(mM)=(millimolar)PI=(pi)(1)}PARAMETER{a=15e-4(cm)ku=100(/mM/ms)kr=0.238(/ms)nb=4Bi=0.001(mM)}ASSIGNED{ica(mA/cm2)L(um)nseg(1)lseg(cm)SA(cm2)Vol(cm3)diam(um)diffOc(/ms)}STATE{cai(mM)Oc}BREAKPOINT{SOLVEstateMETHODderivimplicit}INITIAL{Oc=.05lseg=(1e-4)*L/nsegSA=PI*(1e-4)*diam*lsegVol=(PI*((1e-4)*(diam/2))^2*lseg)}DERIVATIVEstate{LOCALdiffOcdiffOc=ku*cai*(1-Oc)-kr*OcOc'=diffOccai'=-ica*(SA)/Vol/(2*FARADAY)-(nb*Bi*diffOc)}