NEURON{SUFFIXCaUSEIONcaWRITEicaRANGEgtcabar,gncabar,glcabar,gtca,gnca,glcaRANGEainf,taua,binf,taub,e_ca,gbar,iGLOBALca0,cao,taucadiv,B,tauctdiv,Vshift}UNITS{(molar)=(1/liter)(mM)=(millimolar)(mV)=(millivolt)(mA)=(milliamp)(S)=(siemens)F=(faraday)(coulomb)R=(k-mole)(joule/degC)}PARAMETER{ca0=.00007(mM)cao=1.6(mM)tau=9(ms)taucadiv=1tauctdiv=1gtcabar=.01(S/cm2)gncabar=.01(S/cm2)glcabar=.01(S/cm2)B=.26(mM-cm2/mA-ms)Vshift=0(mV)}ASSIGNED{v(mV)e_ca(mV)ica(mA/cm2)i(mA/cm2)gtca(S/cm2)gnca(S/cm2)glca(S/cm2)gbar(S/cm2)celsius(degC)taua(ms)ainftaub(ms)binf}STATE{ca_i(mM)<1e-5>abcde}BREAKPOINT{SOLVEstateMETHODcnexpe_ca=(1000)*(celsius+273.15)*R/(2*F)*log(cao/ca_i)gtca=gtcabar*a*a*bgnca=gncabar*c*c*dglca=glcabar*e*eica=(gtca+gnca+glca)*(v-e_ca)i=ica}DERIVATIVEstate{ca_i'=-B*ica-taucadiv*(ca_i-ca0)/tauainf=alphaa(v)/(alphaa(v)+betaa(v))taua=1/(alphaa(v)+betaa(v))a'=(ainf-a)/tauabinf=alphab(v)/(alphab(v)+betab(v))taub=1/(alphab(v+Vshift)+betab(v+Vshift))b'=(binf-b)/taubc'=alphac(v)*(1-c)-betac(v)*cd'=alphad(v)*(1-d)-betad(v)*de'=alphae(v)*(1-e)-betae(v)*e}INITIAL{ca_i=ca0a=alphaa(v)/(alphaa(v)+betaa(v))b=alphab(v)/(alphab(v)+betab(v))c=alphac(v)/(alphac(v)+betac(v))d=alphad(v)/(alphad(v)+betad(v))e=alphae(v)/(alphae(v)+betae(v))gbar=gtcabar+gncabar+glcabar}FUNCTIONalphaa(v(mV))(/ms){alphaa=f(2,0.1,v,19.26)}FUNCTIONbetaa(v(mV))(/ms){betaa=exponential(0.009,-0.045393,v,0)}FUNCTIONalphab(v(mV))(/ms){alphab=exponential(1e-6,-0.061501,v,0)}FUNCTIONbetab(v(mV))(/ms){betab=logistic(1,-0.1,v,29.79)}FUNCTIONalphac(v(mV))(/ms){alphac=f(1.9,0.1,v,19.88)}FUNCTIONbetac(v(mV))(/ms){betac=exponential(0.046,-0.048239,v,0)}FUNCTIONalphad(v(mV))(/ms){alphad=exponential(1.6e-4,-0.020661,v,0)}FUNCTIONbetad(v(mV))(/ms){betad=logistic(1,-0.1,v,39)}FUNCTIONalphae(v(mV))(/ms){alphae=f(156.9,0.1,v,81.5)}FUNCTIONbetae(v(mV))(/ms){betae=exponential(0.29,-0.092081,v,0)}FUNCTIONf(A,k,v(mV),D)(/ms){LOCALxUNITSOFFx=k*(v-D)if(fabs(x)>1e-6){f=A*x/(1-exp(-x))}else{f=A/(1-0.5*x)}UNITSON}FUNCTIONlogistic(A,k,v(mV),D)(/ms){UNITSOFFlogistic=A/(1+exp(k*(v-D)))UNITSON}FUNCTIONexponential(A,k,v(mV),D)(/ms){UNITSOFFexponential=A*exp(k*(v-D))UNITSON}