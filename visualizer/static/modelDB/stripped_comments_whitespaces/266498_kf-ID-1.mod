NEURON{SUFFIXkfUSEIONkREADekWRITEikRANGEgbar,ek,ikRANGEtau_m,minf,hinf,tau_h,m,h,celsiusT}UNITS{(S)=(siemens)(mV)=(millivolts)(mA)=(milliamp)}PARAMETER{gbar(S/cm2)lj=0(mV)vhm=-5.4(mV)vhh=-49.9(mV)km=16.4(mV)kh=4.6(mV)celsiusTkvot_qtshift=-15(mV)}ASSIGNED{v(mV)ik(mA/cm2)g(S/cm2)tau_m(ms)tau_h(ms)minfhinfek(mV)}STATE{hm}BREAKPOINT{SOLVEstatesMETHODcnexpg=gbar*m*hik=g*(v-ek)}INITIAL{m=(1/(1+exp(-(1/km)*(v-vhm+lj+shift))))^4h=1/(1+exp((1/kh)*(v-vhh+lj+shift)))}DERIVATIVEstates{rates(v)m'=(minf-m)/tau_mh'=(hinf-h)/tau_h}FUNCTIONrates(Vm(mV))(/ms){minf=(1/(1+exp(-(1/km)*(v-vhm+lj+shift))))^4hinf=1/(1+exp((1/kh)*(v-vhh+lj+shift)))tau_m=(0.25+10.04*exp(-((v+24.67)^2)/(2*34.8^2)))tau_h=(20+50*exp(-((v+40)^2)/(2*40^2)))if(tau_h<5){tau_h=5}kvot_qt=1/((3.3^((celsiusT-23)/10)))tau_m=tau_m*kvot_qttau_h=tau_h*kvot_qt}