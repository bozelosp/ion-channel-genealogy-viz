NEURON{SUFFIXkdrcrUSEIONkREADekWRITEikRANGEgkdrbar,ik}UNITS{(mA)=(milliamp)(mV)=(millivolt)(S)=(siemens)}PARAMETER{gkdrbar=0.0338(S/cm2)}ASSIGNED{v(mV)ek(mV)ik(mA/cm2)ninftaun(ms)gk(mho/cm2)}STATE{n}BREAKPOINT{SOLVEstatesMETHODcnexpik=gkdrbar*pow(n,4)*(v-ek)}DERIVATIVEstates{rates(v)n'=(ninf-n)/taun}INITIAL{rates(v)n=ninf}FUNCTIONvtrap(x(mV),y(mV))(1){if(fabs(x/y)<1e-6){vtrap=1(/mV)*y*(1-x/y/2)}else{vtrap=1(/mV)*x/(exp(x/y)-1)}}FUNCTIONalf(v(mV))(/ms){alf=0.018(/ms)*vtrap(-(v-13(mV)),25(mV))}FUNCTIONbet(v(mV))(/ms){bet=0.0054(/ms)*vtrap(v-23(mV),12(mV))}PROCEDURErates(v(mV)){taun=1/(alf(v)+bet(v))ninf=alf(v)*taun}