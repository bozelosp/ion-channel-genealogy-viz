NEURON{SUFFIXfastKUSEIONkREADekWRITEikNONSPECIFIC_CURRENTiflutRANGEgkfbar,gflut,eflutRANGEn_infRANGEtau_n}UNITS{(mA)=(milliamp)(mV)=(millivolt)}PARAMETER{gkfbar=0.04(mho/cm2)gflut(mho/cm2)eflut=-70(mV)}STATE{n}ASSIGNED{v(mV)ek(mV)ik(mA/cm2)iflut(mA/cm2)n_inftau_n(ms)}BREAKPOINT{SOLVEstatesMETHODcnexpik=gkfbar*n*n*n*n*(v-ek)iflut=gflut*(v-eflut)}DERIVATIVEstates{evaluate_fct(v)n'=(n_inf-n)/tau_n}UNITSOFFINITIAL{evaluate_fct(v)n=n_inf}PROCEDUREevaluate_fct(v(mV)){LOCALa,ba=vtrap(v)b=vtrap0(v)tau_n=1/(a+b)n_inf=a/(a+b)}FUNCTIONvtrap(x){if(fabs((x+83.2)/1.1)<1e-6){vtrap=0.0462*1.1}else{vtrap=(0.0462*(x+83.2))/(1-exp(-(x+83.2)/1.1))}}FUNCTIONvtrap0(x){if(fabs((x+66)/10.5)<1e-6){vtrap0=0.0824*10.5}else{vtrap0=(0.0824*(-(x+66)))/(1-exp((x+66)/10.5))}}UNITSON