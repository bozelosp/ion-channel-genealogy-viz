NEURON{SUFFIXcadyn_newUSEIONcaREADcai,icaWRITEcaiRANGEcaGLOBALdepth,cainf,taur}UNITS{(molar)=(1/liter)(mM)=(milli/liter)(um)=(micron)(mA)=(milliamp)(msM)=(msmM)FARADAY=(faraday)(coul)}PARAMETER{depth=.1(um)taur=200(ms)cainf=50e-6(mM)cai(mM)}ASSIGNED{ica(mA/cm2)diam(um)VSR(um)B(mM*cm2/mA)drive_channel(mM/ms)}STATE{ca(mM)}BREAKPOINT{SOLVEstateMETHODeuler}DERIVATIVEstate{drive_channel=-ica*Bif(drive_channel<=0.){drive_channel=0.}ca'=drive_channel/18+(cainf-ca)/taur*11cai=ca}INITIAL{if(2*depth>=diam){VSR=0.25*diam}else{VSR=depth*(1-depth/diam)}B=(1e4)/(2*FARADAY*VSR)ca=cainf}