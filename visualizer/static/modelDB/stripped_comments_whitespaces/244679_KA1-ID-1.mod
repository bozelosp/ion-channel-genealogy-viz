UNITS{(mA)=(milliamp)(mV)=(millivolt)}NEURON{SUFFIXKA1USEIONkWRITEikRANGEgkbar,gk,minf,hinf,mexp,hexp,ik,vh1,vm1,vm2,t1,t2}INDEPENDENT{tFROM0TO1WITH1(ms)}PARAMETER{v(mV)celsius=37(degC)dt(ms)gkbar=.015(mho/cm2)ek=-85(mV)mon=1hon=1vh1=85(mV)vm1(mV)vm2(mV)t1=0.3t2=50}STATE{mh}ASSIGNED{ik(mA/cm2)gkminfhinfmexphexp}BREAKPOINT{SOLVEstatesgk=gkbar*m*m*m*m*hik=gk*(v-ek)}UNITSOFFINITIAL{rates(v,vm1,vm2)m=minfh=hinf}PROCEDUREstates(){rates(v,vm1,vm2)m=mon*(m+mexp*(minf-m))h=hon*(h+hexp*(hinf-h))}PROCEDURErates(v,vm1,vm2){LOCALq10,tinc,alpha,beta,sumq10=3^((celsius-37)/10)tinc=-dt*q10alpha=1.4/(1+exp((v+vm1)/(-12)))beta=0.49/(1+exp((v+vm2)/4))sum=alpha+betaminf=(alpha/sum)*(1/(1+exp(-t1*(v+t2))))mexp=1-exp(tinc*sum)alpha=0.0175/(1+exp((v+vh1)/8))beta=1.3/(1+exp((v+13)/(-10)))sum=(alpha+beta)hinf=alpha/sumhexp=1-exp(tinc*sum)}UNITSON