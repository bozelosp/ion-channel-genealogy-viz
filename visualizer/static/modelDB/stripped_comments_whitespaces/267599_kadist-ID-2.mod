UNITS{(mA)=(milliamp)(mV)=(millivolt)}PARAMETER{celsiusv(mV)gkabar=.008(mho/cm2)vhalfn=-1(mV)vhalfl=-56(mV)a0l=0.05(/ms)a0n=.1(/ms)zetan=-1.8(1)zetal=3(1)gmn=0.39(1)gml=1(1)lmin=2(mS)nmin=0.2(mS)pw=-1(1)tq=-40qq=5q10=5qtl=1ek}NEURON{SUFFIXkadUSEIONkREADekWRITEikRANGEgkabar,gka,vhalfn,vhalfl,iGLOBALninf,linf,taul,taun,lmin}STATE{nl}ASSIGNED{ik(mA/cm2)i(mA/cm2)ninflinftaultaungka}BREAKPOINT{SOLVEstatesMETHODcnexpgka=gkabar*n*li=gka*(v-ek)ik=i}INITIAL{rates(v)n=ninfl=linf}FUNCTIONalpn(v(mV)){LOCALzeta,ArgArg=(v-tq)/qqif(Arg<-50){zeta=zetan+pw}elseif(Arg>50){zeta=zetan}else{zeta=zetan+pw/(1+exp(Arg))}Arg=1.e-3*zeta*(v-vhalfn)*9.648e4/(8.315*(273.16+celsius))if(Arg<-50){alpn=0}elseif(Arg>50){alpn=exp(50)}else{alpn=exp(Arg)}}FUNCTIONbetn(v(mV)){LOCALzeta,ArgArg=(v-tq)/qqif(Arg<-50){zeta=zetan+pw}elseif(Arg>50){zeta=zetan}else{zeta=zetan+pw/(1+exp(Arg))}Arg=1.e-3*zeta*gmn*(v-vhalfn)*9.648e4/(8.315*(273.16+celsius))if(Arg<-50){betn=0}elseif(Arg>50){betn=exp(50)}else{betn=exp(Arg)}}FUNCTIONalpl(v(mV)){LOCALArgArg=1.e-3*zetal*(v-vhalfl)*9.648e4/(8.315*(273.16+celsius))if(Arg<-50){alpl=0}elseif(Arg>50){alpl=exp(50)}else{alpl=exp(Arg)}}FUNCTIONbetl(v(mV)){LOCALArgArg=1.e-3*zetal*gml*(v-vhalfl)*9.648e4/(8.315*(273.16+celsius))if(Arg<-50){betl=0}elseif(Arg>50){betl=exp(50)}else{betl=exp(Arg)}}DERIVATIVEstates{rates(v)n'=(ninf-n)/taunl'=(linf-l)/taul}PROCEDURErates(v(mV)){LOCALa,qtqt=q10^((celsius-24)/10)a=alpn(v)ninf=1/(1+a)taun=betn(v)/(qt*a0n*(1+a))if(taun<nmin){taun=nmin}a=alpl(v)linf=1/(1+a)taul=0.26*(v+50)/qtlif(taul<lmin/qtl){taul=lmin/qtl}}