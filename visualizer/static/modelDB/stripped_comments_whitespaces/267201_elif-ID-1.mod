NEURON{POINT_PROCESSeLIFRANGEV_reset,t_ref,V_th,spikewidth,V_peakRANGEepsilonRANGEg_L,E_0,E_u,E_d,E_fRANGEtau_e,epsilon_0,epsilon_c,delta,alphaNONSPECIFIC_CURRENTi,I_e}UNITS{(mV)=(millivolt)(pA)=(picoamp)(nS)=(nanosiemens)}PARAMETER{V_th=-50(mV)V_reset=-60(mV)V_peak=0.(mV)t_ref=2(ms)gon=1e9(nS)spikewidth=1e-12(ms)E_0=-55.(mV)E_u=-50.(mV)E_d=-35.(mV)E_f=-45.(mV)epsilon_0=0.5epsilon_c=0.15alpha=1.<0,1e9>delta=0.02tau_e=500.(ms)<0,1e9>g_L=30.(nS)I_e=0(pA)}ASSIGNED{i(pA)irefrac(pA)grefrac(nS)refractory}STATE{w(pA)epsilon}INITIAL{grefrac=0net_send(0,4)epsilon=alpha*epsilon_0}FUNCTIONE_L(epsilon)(mV){E_L=E_0+(E_u-E_0)*(1-epsilon/epsilon_0)}BREAKPOINT{SOLVEstatesMETHODderivimplicitirefrac=grefrac*(v-V_reset)i=(g_L*(v-E_L(epsilon))+irefrac-I_e)}DERIVATIVEstates{epsilon'=((1-epsilon/(alpha*epsilon_0))*(1-epsilon/(alpha*epsilon_0))*(1-epsilon/(alpha*epsilon_0))-(v-E_f)/(E_d-E_f))/tau_e}FUNCTIONthreshcrossing(v(mV),epsilon){if((v>V_th)&&(epsilon>epsilon_c)){threshcrossing=1}else{threshcrossing=-1}}NET_RECEIVE(weight){if(flag==1){v=V_peakepsilon=epsilon-deltanet_send(spikewidth,2)net_event(t)}elseif(flag==2){v=V_resetgrefrac=gonif(t_ref>spikewidth){net_send(t_ref-spikewidth,3)}else{grefrac=0}}elseif(flag==3){v=V_resetgrefrac=0}elseif(flag==4){WATCH(threshcrossing(v,epsilon)>0)1}}