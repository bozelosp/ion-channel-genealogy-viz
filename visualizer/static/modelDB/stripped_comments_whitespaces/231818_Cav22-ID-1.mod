NEURON{SUFFIXCav22USEIONcaREADecaWRITEicaUSEIONncaWRITEincaVALENCE0RANGEgbar,gGLOBALvshift,hTau}UNITS{(mV)=(millivolt)(mA)=(milliamp)(S)=(siemens)}ASSIGNED{inca(mA/cm2)v(mV)ica(mA/cm2)g(S/cm2)eca(mV)diam(um)mInf(1)hInf(1)mTau(ms)}PARAMETER{gbar=0(S/cm2)hTau=100(ms)vshift=10(mV)}STATE{mh}BREAKPOINT{rates()SOLVEstateMETHODcnexpg=gbar*m*m*hica=g*(v-eca)inca=ica}DERIVATIVEstate{m'=(mInf-m)/mTauh'=(hInf-h)/hTau}INITIAL{m=mInfh=hInf}PROCEDURErates(){LOCALalpha,betaalpha=f(1.9,0.1,v,19.88+vshift)beta=exponential(0.046,-0.048239,v,vshift)mTau=1/(alpha+beta)mInf=alpha*mTauhInf=1/(1+exp((v+40)/12.5))}FUNCTIONf(A,k(/mV),v(mV),D(mV))(/ms){LOCALxx=k*(v-D)if(fabs(x)>1e-6){f=A*x/(1-exp(-x))}else{f=A/(1-0.5*x)}}FUNCTIONexponential(A,k(/mV),v(mV),D(mV))(/ms){exponential=A*exp(k*(v-D))}