UNITS{(molar)=(1/liter)(S)=(siemens)(mA)=(milliamp)(mV)=(millivolt)(mM)=(millimolar)F=(faraday)(coulomb)R=(molek)(mV-coulomb/degC)}NEURON{SUFFIXcalhhNONSPECIFIC_CURRENTincalUSEIONcaREADcaiWRITEicaRANGEgcalbar,ica,ical,incal,mhalf,mslope,skcoup,pf}INDEPENDENT{tFROM0TO1WITH1(ms)}PARAMETER{v(mV)dt(ms)cai(mM)celsius=35.0(degC)gcalbar=11.196e-6(S/cm2)km=0.0001(mM)kml=0.00045(mM)eca=120(mV)cao=2.0(mM)skcoup=1.0mhalf=-30.0mslope=8.0pf=0.6}STATE{dlhl}ASSIGNED{ica(mA/cm2)ical(mA/cm2)incal(mA/cm2)gcal(S/cm2)dlinfhlinf}BREAKPOINT{SOLVEstatesMETHODcnexpgcal=dl*(1.0-pf+pf*hl)ical=gcalbar*gcal*(v-eca)incal=(1-skcoup)*icalica=(skcoup)*ical}UNITSOFFINITIAL{dl=boltz(v,mhalf,5.0)hl=boltz(v,-55,-2.0)}DERIVATIVEstates{LOCALdlinf,dhvainf,fhvainf,dltau,dhvatau,fhvatau,hltau,hlinfdlinf=boltz(v,mhalf,mslope)hlinf=boltz(v,-55,-2)dltau=gaussian(v,9.0,25.0,70.0,0.30)hltau=100.0+100.0*boltz(v,-30,-5.0)dl'=(dlinf-dl)/dltauhl'=(hlinf-hl)/hltau}FUNCTIONgaussian(v,a,b,c,d){LOCALargarg=a*exp(-(c+v)*(v+c)/(b*b))+dgaussian=arg}FUNCTIONboltz(x,y,z){LOCALargarg=-(x-y)/zif(arg>50){boltz=0}else{if(arg<-50){boltz=1}else{boltz=1.0/(1.0+exp(arg))}}}UNITSON