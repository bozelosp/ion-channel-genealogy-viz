NEURON{SUFFIXsAHPNEUSEIONkREADekWRITEikUSEIONcasREADcasiVALENCE2RANGEik,gk,gsAHPbar}UNITS{(mM)=(milli/liter)(mA)=(milliamp)(mV)=(millivolt)}PARAMETER{NE_start=100NE_stop=600NE_t1=0.7gsAHPbar=2.318144e-05}ASSIGNED{v(mV)ek(mV)casi(mM)ik(mA/cm2)cinfctau(ms)gk(mho/cm2)}STATE{c}BREAKPOINT{SOLVEstatesMETHODcnexpgk=gsAHPbar*cik=gk*(v-ek)*NE1(t)}INITIAL{rate(v,casi)c=cinf}DERIVATIVEstates{rate(v,casi)c'=(cinf-c)/ctau}UNITSOFFFUNCTIONcalf(v(mV),casi(mM))(/ms){LOCALvs,vaUNITSOFFvs=10*log10(1000*casi)calf=0.0048/exp(-0.5*(vs-35))UNITSON}FUNCTIONcbet(v(mV),casi(mM))(/ms){LOCALvs,vbUNITSOFFvs=10*log10(1000*casi)cbet=0.012/exp(0.2*(vs+100))UNITSON}UNITSONPROCEDURErate(v(mV),casi(mM)){LOCALcsum,ca,cbUNITSOFFca=calf(v,casi)cb=cbet(v,casi)csum=ca+cbcinf=ca/csumctau=48UNITSON}FUNCTIONNE1(t){if(t>=NE_start&&t<=NE_stop){NE1=NE_t1}else{NE1=1}}