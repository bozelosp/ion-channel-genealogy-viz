UNITS{(mV)=(millivolt)(mA)=(milliamp)(S)=(siemens)(molar)=(1/liter)(mM)=(millimolar)FARADAY=(faraday)(coulomb)R=(k-mole)(joule/degC)}NEURON{SUFFIXcaqUSEIONcaREADcai,caoWRITEicaRANGEpcaqbar,icaPOINTERmu}PARAMETER{pcaqbar=6.0e-6(cm/s)mvhalf=-9.0(mV)mslope=-6.6(mV)mtau=1.13(ms)mshift=0(mV)qfact=3}ASSIGNED{v(mV)eca(mV)ica(mA/cm2)minfcelsius(degC)cai(mM)cao(mM)mu(1)}STATE{m}BREAKPOINT{SOLVEstatesMETHODcnexpica=ghk(v,cai,cao)*pcaqbar*m*m*(1-(mu-1)*0.5)}INITIAL{settables(v)m=minf}DERIVATIVEstates{settables(v)m'=(minf-m)/(mtau/qfact)}PROCEDUREsettables(v(mV)){TABLEminfDEPENDmshiftFROM-100TO100WITH201minf=1/(1+exp((v-mvhalf-mshift)/mslope))}FUNCTIONghk(v(mV),ci(mM),co(mM))(.001coul/cm3){LOCALz,eci,ecoz=(1e-3)*2*FARADAY*v/(R*(celsius+273.15))eco=co*efun(z)eci=ci*efun(-z)ghk=(.001)*2*FARADAY*(eci-eco)}FUNCTIONefun(z){if(fabs(z)<1e-4){efun=1-z/2}else{efun=z/(exp(z)-1)}}