NEURON{SUFFIXcalHUSEIONcaREADecaWRITEicaRANGEgcalbar,m,h,shRANGEinf,fac,tau,mytau,myhtau}UNITS{(mA)=(milliamp)(mV)=(millivolt)}PARAMETER{v(mV)sh=0(mV)celsius=34(degC)dt(ms)gcalbar=0(mho/cm2)eca=140(mV)mytau=3.6(ms)myhtau=29(ms)}STATE{mh}ASSIGNED{ica(mA/cm2)inf[2]tau[2]}INITIAL{m=0h=1rate(v)}BREAKPOINT{SOLVEstateMETHODcnexpica=gcalbar*m*m*m*h*(v-eca)}DERIVATIVEstate{rate(v)m'=(inf[0]-m)/tau[0]h'=(inf[1]-h)/tau[1]}PROCEDURErate(v(mV)){FROMi=0TO1{tau[i]=vartau(v,i)inf[i]=varss(v,i)}}FUNCTIONvarss(v,i){if(i==0){varss=1/(1+exp((v+37-sh)/(-1)))}elseif(i==1){varss=1/(1+exp((v+41-sh)/(0.5)))}}FUNCTIONvartau(v,i){if(i==0){vartau=mytau}elseif(i==1){vartau=myhtau}}