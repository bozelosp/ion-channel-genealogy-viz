UNITS{(mA)=(milliamp)(mV)=(millivolt)(S)=(siemens)}NEURON{SUFFIXKIUSEIONkREADekWRITEikRANGEgnabar,gkbar,NNa,NK,scale_a,n0,seGLOBALgu_KTHREADSAFE}PARAMETER{se=-1gkbar=.004(S/cm2)<0,1e9>gu_K=20e-12(S)scale_a=1.0}STATE{n1n2n3n4}ASSIGNED{NKarea(micron2)v(mV)celsius(degC)ek(mV)dt(ms)ik(mA/cm2)an(/ms)bn(/ms)stsumNR(/ms)n0}BREAKPOINT{SOLVEstatesMETHODcnexpik=gkbar*n4*(v-ek)}INITIAL{rates(v)NK=floor((1e-8)*gkbar*area/gu_K+0.5)if(se>=0){set_seed(se)}N=an/bnstsum=(1+N)^4n0=1/stsumn1=4*N/stsumn2=6*N^2/stsumn3=4*N^3/stsumn4=N^4/stsumrates(v)}DERIVATIVEstates{rates(v)n1'=(-3*an-bn)*n1+4*an*n0+2*bn*n2n2'=(-2*an-2*bn)*n2+3*an*n1+3*bn*n3n3'=(-an-3*bn)*n3+2*an*n2+4*bn*n4+Rn4'=(-4*bn)*n4+an*n3-Rn0=1-n1-n2-n3-n4}PROCEDURErates(v(mV)){UNITSOFFan=scale_a*.01*vtrap(-(v+55),10)bn=scale_a*.125*exp(-(v+65)/80)R=normrand(0,1/sqrt(NK*dt))*sqrt(fabs(an*n3+4*bn*n4))}FUNCTIONvtrap(x,y){if(fabs(x/y)<1e-6){vtrap=y*(1-x/y/2)}else{vtrap=x/(exp(x/y)-1)}}UNITSON