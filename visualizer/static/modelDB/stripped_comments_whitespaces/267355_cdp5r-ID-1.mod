NEURON{SUFFIXcdp5rUSEIONncaREADincaWRITEncaiVALENCE2USEIONlcaREADilcaWRITElcaiVALENCE2USEIONtcaREADitcaWRITEtcaiVALENCE2RANGEcaiinf,caitot,ncai,lcai,tcai,ecatot,elca,enca,etcaGLOBALcatau}UNITS{(mV)=(millivolt)(molar)=(1/liter)(mM)=(milli/liter)(mA)=(milliamp)FARADAY=96520(coul)R=8.3134(joule/degC)}INDEPENDENT{tFROM0TO100WITH100(ms)}PARAMETER{celsius=6.3(degC)depth=200(nm)catau=0.1(ms)caiinf=50.e-6(mM)caotot=2(mM)ica(mA/cm2)inca(mA/cm2)ilca(mA/cm2)itca(mA/cm2)caitot=50.e-6(mM)}ASSIGNED{enca(mV)elca(mV)etca(mV)ecatot(mV)}STATE{ncai(mM)lcai(mM)tcai(mM)}INITIAL{VERBATIMncai=_ion_ncai;lcai=_ion_lcai;tcai=_ion_tcai;ENDVERBATIMncai=caiinf/3lcai=caiinf/3tcai=caiinf/3caitot=caiinfecatot=ktf()*log(caotot/caiinf)enca=ecatotelca=ecatotetca=ecatot}BREAKPOINT{SOLVEintegrateMETHODderivimplicitcaitot=ncai+lcai+tcaiecatot=ktf()*log(caotot/caitot)enca=ecatotelca=ecatotetca=ecatot}DERIVATIVEintegrate{ncai'=-(inca)/depth/FARADAY*(1e7)+(caiinf/3-ncai)/cataulcai'=-(ilca)/depth/FARADAY*(1e7)+(caiinf/3-lcai)/catautcai'=-(itca)/depth/FARADAY*(1e7)+(caiinf/3-tcai)/catau}FUNCTIONktf()(mV){ktf=(1000)*R*(celsius+273.15)/(2*FARADAY)}