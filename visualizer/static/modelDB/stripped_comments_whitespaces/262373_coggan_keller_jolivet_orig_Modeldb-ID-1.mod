?thismodfilerepresentsaconvertiontoNEURONfromtheMatlabmodeloriginallypublishedbyJolivetetal.,PLoSCompBiol(2015)UNITS{(mA)=(milliamp)(mV)=(millivolt)}NEURON{SUFFIXglia_2013RANGEunit_compartmentRANGEVRANGEFinRANGEJstimgRANGEJstimnRANGEADPnRANGEADPgRANGEO2meancRANGEVv0RANGEJleakNanRANGEJleakNagRANGEJpumpnRANGEJpumpgRANGEJGLCceRANGEJGLCcgRANGEJGLCegRANGEJGLCenRANGEJLACecRANGEJLACcgRANGEJLACegRANGEJLACenRANGEJGLCecRANGEJGLCgcRANGEJGLCgeRANGEJGLCneRANGEJLACceRANGEJLACgcRANGEJLACgeRANGEJLACneRANGEJHKPFKnRANGEJHKPFKgRANGEJPGKnRANGEJPGKgRANGEJPKnRANGEJPKgRANGEJLDHnRANGEJLDHgRANGEJmitoingRANGEJmitoinnRANGEJmitooutgRANGEJmitooutnRANGEJshuttlegRANGEJshuttlenRANGEJCKgRANGEJCKnRANGEJO2mcgRANGEJO2mcnRANGEJO2cRANGEJGLCcRANGEJLACcRANGEILRANGEINaRANGEIKRANGEICaRANGEImAHPRANGEIpumpRANGEFoutRANGEdAMPdATPnRANGEdAMPdATPgRANGEVeRANGEVcapRANGEVgRANGEVnRANGEzetaRANGEqAKRANGEARANGEunRANGEugRANGErenRANGEregRANGErceRANGErcnRANGErcgRANGEIsynRANGEkCKplusnRANGEkCKplusgRANGENan0RANGEF0RANGESmVnRANGESmVgRANGERRANGEFRANGERToverFRANGEpsigRANGENaeRANGEKtGLCenRANGEKtGLCegRANGEKtGLCcgRANGEKtGLCceRANGEKtLACenRANGEKtLACegRANGEKtLACgeRANGEKtLACgcRANGEKtLACcgRANGEKtLACecRANGEKIATPRANGEnH1RANGEKgRANGEKO2RANGEHbOPRANGEnhRANGEKO2mitoRANGECmRANGEgLRANGEgNaRANGEgKRANGEgCaRANGEgmAHPRANGEKDRANGEtauCaRANGECa0RANGEEKRANGEECaRANGEphihRANGEphinRANGEtauvRANGEalphavRANGEO2aRANGEGLCaRANGEgNanRANGEgNagRANGEgKpasRANGEkpumpnRANGEkpumpgRANGEKmpumpRANGECRANGENRANGEKmmitoRANGEkLDHnplusRANGEkLDHnminusRANGEkLDHgplusRANGEkLDHgminusRANGEMcytonRANGEMcytogRANGEMmitonRANGEMmitogRANGEKmADPnRANGEKmADPgRANGEKmNADnRANGEKmNADgRANGEKmNADHnRANGEKmNADHgRANGEkCKnRANGEkCKgRANGEmNADgRANGETmaxGLCenRANGETmaxGLCceRANGETmaxGLCegRANGETmaxGLCcgRANGETmaxLACgcRANGETmaxLACcgRANGETmaxLACenRANGETmaxLACneRANGETmaxLACgeRANGETmaxLACegRANGETmaxLACecRANGEkHKPFKnRANGEkHKPFKgRANGEPScapoverVnRANGEPScapoverVgRANGEVmaxoutnRANGEVmaxoutgRANGEVmaxinnRANGEVmaxingRANGEkPGKnRANGEkPGKgRANGEkPKnRANGEkPKgRANGEJATPasesnRANGEJATPasesgRANGEkCKminusnRANGEkCKminusgRANGETNADHnRANGETNADHgRANGELACaRANGERplusgRANGERminusgRANGERplusnRANGERminusnRANGEhh_alphanRANGEhh_alphamRANGEhh_betamRANGEhh_alphahRANGEhh_betahRANGEhh_betanRANGEhh_minfinityRANGEhh_ninfinityRANGEhh_hinfinityRANGEhh_taunRANGEhh_mCaRANGEhh_tauhRANGEhh_ELRANGEFinprimeRANGEJGLUegRANGEvPumpg0RANGEvnstimRANGEvgstim}PARAMETER{unit_compartment=1.0V=1e-07Fin=0.012Jstimg=0Jstimn=0ADPn=1e-10ADPg=1e-10O2meanc=7.0Vv0=0.021JleakNan=0.0JleakNag=0.0Jpumpn=0.0Jpumpg=0.0JGLCce=1e-10JGLCcg=1e-10JGLCeg=1e-10JGLCen=1e-10JLACec=1e-10JLACcg=1e-10JLACeg=1e-10JLACen=1e-10JGLCec=1e-10JGLCgc=1e-10JGLCge=1e-10JGLCne=1e-10JLACce=1e-10JLACgc=1e-10JLACge=1e-10JLACne=1e-10JHKPFKn=0.0JHKPFKg=0.0JPGKn=0.0JPGKg=0.0JPKn=0.0JPKg=0.0JLDHn=0.0JLDHg=0.0Jmitoing=0Jmitoinn=0Jmitooutg=0Jmitooutn=0Jshuttleg=0.0Jshuttlen=0.0JCKg=0.0JCKn=0.0JO2mcg=1e-10JO2mcn=1e-10JO2c=0.0JGLCc=0.0JLACc=0.0IL=0.0INa=1.0IK=0.0ICa=0.0ImAHP=1e-10Ipump=1e-10Fout=0.012dAMPdATPn=0.0dAMPdATPg=0.0Ve=0.2Vcap=0.0055Vg=0.25Vn=0.45zeta=0.07qAK=0.92A=2.212un=0.0ug=0.0ren=0.4444reg=0.8rce=0.0275rcn=0.0122rcg=0.0220Isyn=0.0kCKplusn=0.0433kCKplusg=0.00135Nan0=8.0F0=0.012SmVn=25000.0SmVg=25000.0R=8.314151F=96485.3RToverF=26.73psig=-70.0Nae=150.0KtGLCen=8.0KtGLCeg=8.0KtGLCcg=8.0KtGLCce=8.0KtLACen=0.74KtLACeg=3.5KtLACge=3.5KtLACgc=1.0KtLACcg=1.0KtLACec=1.0KIATP=1.0nH1=4.0Kg=0.05KO2=0.0361HbOP=8.6nh=2.73KO2mito=0.001Cm=0.001gL=0.02gNa=40.0gK=18.0gCa=0.02gmAHP=6.5KD=0.03tauCa=0.15Ca0=5e-05EK=-80.0ECa=120.0phih=4.0phin=4.0tauv=35.0alphav=0.5O2a=8.35GLCa=4.75gNan=0.0136gNag=0.0061gKpas=0.2035kpumpn=2.2000e-06kpumpg=4.5000e-07Kmpump=0.5C=10.0N=0.212Kmmito=0.04kLDHnplus=72.3000kLDHnminus=0.7200kLDHgplus=1.5900kLDHgminus=0.0710Mcyton=4.9000e-08Mcytog=2.5000e-04Mmiton=393000Mmitog=10600KmADPn=0.00341KmADPg=4.8300e-04KmNADHn=0.0444KmNADHg=0.0269kCKn=0.0433kCKg=0.0014KmNADn=0.4090KmNADg=40.3000TmaxGLCen=0.0410TmaxGLCne=0.0410TmaxGLCce=0.2390TmaxGLCec=0.2390TmaxGLCeg=0.1470TmaxGLCge=0.1470TmaxGLCcg=0.0016TmaxLACcg=0.0026TmaxLACne=24.3000TmaxLACen=24.3000TmaxLACge=106.1000TmaxLACeg=106.1000TmaxLACec=0.2500TmaxLACce=0.2500kHKPFKn=0.050435kHKPFKg=0.1850PScapoverVn=1.6600PScapoverVg=0.8700Vmaxoutn=0.1640Vmaxoutg=0.0640Vmaxinn=0.1303Vmaxing=5.7000kPGKn=3.9700kPGKg=401.7000kPKn=36.7000kPKg=135.2000JATPasesn=0.1695JATPasesg=0.1404kCKminusn=2.8000e-04kCKminusg=1.0000e-05TNADHn=10330TNADHg=150LACa=0.5060Rplusg=0.0Rminusg=0.0Rplusn=0.0Rminusn=0.0hh_alphan=0.0hh_alpham=0.0hh_betam=0.0hh_alphah=0.0hh_betah=0.0hh_betan=0.0hh_minfinity=0.0hh_ninfinity=0.0hh_hinfinity=0.0hh_taun=1.0hh_mCa=0.0hh_tauh=1.0hh_EL=0.0Finprime=0JGLUeg=0vPumpg0=0.0687}STATE{NanNagGLCnGLCgGAPnGAPgPEPnPEPgPYRnPYRgLACnLACgNADHcytonNADHcytogNADHmitonNADHmitogATPnATPgPCrnPCrgO2nO2gO2cGLCcLACcVvHbGLCeLACepsinhnCaVvp}INITIAL{Fout=0.012Vvp=-5.22695e-008Nan=7.9717Nag=15.1060GLCn=1.1952GLCg=1.1917GAPn=0.0046GAPg=0.0046PEPn=0.0164PEPg=0.0142PYRn=0.1739PYRg=0.1630LACn=0.5981LACg=0.6001NADHcyton=0.0062NADHcytog=0.1039ATPn=2.1974ATPg=2.1951PCrn=4.9460PCrg=4.9242O2n=0.0276O2g=0.0276O2c=6.9809GLCc=4.5004LACc=0.5489Vv=0.0210Hb=0.0575GLCe=2.4797LACe=0.5991psin=-73.5928h=0.9937n=0.0185Ca=0.000051NADHmiton=0.1235NADHmitog=0.1248Nan=7.971123690827819Nag=15.105962700710011GLCn=1.195242817701208GLCg=1.191683486104078GAPn=0.004604883633382GAPg=0.004592187611272PEPn=0.016413198236988PEPg=0.014203938186866PYRn=0.173879012167164PYRg=0.162979341543002LACn=0.598139671517830LACg=0.600154193323652NADHcyton=0.006244551091528NADHcytog=0.103869031492734ATPn=2.197379714751472ATPg=2.195100303412994PCrn=4.946145277066859PCrg=4.924205857343780O2n=0.027586286704408O2g=0.027594056563463O2c=6.980872113185740GLCc=4.500386628495174LACc=0.548850780742499Vv=0.021000000000000Hb=0.057503371246198GLCe=2.479691528660544LACe=0.599146935390395psin=-73.578843708782614h=0.993702020434757n=0.018538671314650Ca=0.000051009989197NADHmiton=0.123456504032627NADHmitog=0.124833635085897}BREAKPOINT{SOLVEstatesMETHODeuler?Needtocheckorderinwhichassignments/eventassignmentsshouldbeupdated!!!?AssignmentrulehereRminusn=NADHcyton/(N-NADHcyton)?AssignmentrulehereRplusn=(N-NADHmiton)/NADHmiton?AssignmentrulehereRminusg=NADHcytog/(N-NADHcytog)?AssignmentrulehereRplusg=(N-NADHmitog)/NADHmitog?AssignmentrulehereJleakNag=SmVg/F*gNag*(RToverF*log(Nae/Nag)-psig)?AssignmentrulehereJleakNan=SmVn/F*gNan*(RToverF*log(Nae/Nan)-psin)?AssignmentrulehereJpumpg=SmVg*kpumpg*ATPg*Nag*pow(1+ATPg/Kmpump,-1)?AssignmentrulehereJpumpn=SmVn*kpumpn*ATPn*Nan*pow(1+ATPn/Kmpump,-1)?AssignmentrulehereJGLCce=TmaxGLCce*(GLCc/(GLCc+KtGLCce)-GLCe/(GLCe+KtGLCce))?AssignmentrulehereJGLCcg=TmaxGLCcg*(GLCc/(GLCc+KtGLCcg)-GLCg/(GLCg+KtGLCcg))?AssignmentrulehereJGLCeg=TmaxGLCeg*(GLCe/(GLCe+KtGLCeg)-GLCg/(GLCg+KtGLCeg))?AssignmentrulehereJGLCen=TmaxGLCen*(GLCe/(GLCe+KtGLCen)-GLCn/(GLCn+KtGLCen))?AssignmentrulehereJHKPFKn=kHKPFKn*ATPn*(GLCn/(GLCn+Kg))*pow(1+pow(ATPn/KIATP,nH1),-1)?AssignmentrulehereJHKPFKg=kHKPFKg*ATPg*(GLCg/(GLCg+Kg))*pow(1+pow(ATPg/KIATP,nH1),-1)?AssignmentrulehereADPn=ATPn/2*(pow(qAK*qAK+4*qAK*(A/ATPn-1),0.5)-qAK)?AssignmentrulehereADPg=ATPg/2*(pow(qAK*qAK+4*qAK*(A/ATPg-1),0.5)-qAK)?AssignmentrulehereJPGKn=kPGKn*GAPn*ADPn*((N-NADHcyton)/NADHcyton)?AssignmentrulehereJPGKg=kPGKg*GAPg*ADPg*((N-NADHcytog)/NADHcytog)?AssignmentrulehereJPKn=kPKn*PEPn*ADPn?AssignmentrulehereJPKg=kPKg*PEPg*ADPg?AssignmentrulehereJLDHn=kLDHnplus*PYRn*NADHcyton-kLDHnminus*LACn*(N-NADHcyton)?AssignmentrulehereJLDHg=kLDHgplus*PYRg*NADHcytog-kLDHgminus*LACg*(N-NADHcytog)?AssignmentrulehereJLACec=TmaxLACec*(LACe/(LACe+KtLACec)-LACc/(LACc+KtLACec))?AssignmentrulehereJLACcg=TmaxLACcg*(LACc/(LACc+KtLACcg)-LACg/(LACg+KtLACcg))?AssignmentrulehereJLACeg=TmaxLACeg*(LACe/(LACe+KtLACeg)-LACg/(LACg+KtLACeg))?AssignmentrulehereJLACen=TmaxLACen*(LACe/(LACe+KtLACen)-LACn/(LACn+KtLACen))?AssignmentrulehereJmitoing=Vmaxing*PYRg/(PYRg+Kmmito)*((N-NADHmitog)/(N-NADHmitog+KmNADg))?AssignmentrulehereJmitoinn=Vmaxinn*PYRn/(PYRn+Kmmito)*((N-NADHmiton)/(N-NADHmiton+KmNADn))?AssignmentrulehereJmitooutn=Vmaxoutn*O2n/(O2n+KO2mito)*ADPn/(ADPn+KmADPn)*(NADHmiton/(NADHmiton+KmNADHn))?AssignmentrulehereJmitooutg=Vmaxoutg*O2g/(O2g+KO2mito)*ADPg/(ADPg+KmADPg)*(NADHmitog/(NADHmitog+KmNADHg))?AssignmentrulehereJshuttlen=TNADHn*Rminusn/(Mcyton+Rminusn)*(Rplusn/(Mmiton+Rplusn))?AssignmentrulehereJshuttleg=TNADHg*Rminusg/(Mcytog+Rminusg)*(Rplusg/(Mmitog+Rplusg))?AssignmentrulehereJCKn=kCKplusn*PCrn*ADPn-kCKminusn*(C-PCrn)*ATPn?AssignmentrulehereJCKg=kCKplusg*PCrg*ADPg-kCKminusg*(C-PCrg)*ATPg?AssignmentrulehereJO2mcn=PScapoverVn*(KO2*pow(HbOP/O2c-1,-1/nh)-O2n)?AssignmentrulehereJO2mcg=PScapoverVg*(KO2*pow(HbOP/O2c-1,-1/nh)-O2g)?AssignmentrulehereJO2c=2*Fin/Vcap*(O2a-O2c)?AssignmentrulehereJGLCc=2*Fin/Vcap*(GLCa-GLCc)?AssignmentrulehereJLACc=2*Fin/Vcap*(LACa-LACc)?AssignmentrulehereO2meanc=2*O2c-O2a?Assignmentruleherehh_EL=(gKpas*EK+gNan*RToverF*log(Nae/Nan))/(gKpas+gNan)?AssignmentrulehereIL=gL*(psin-hh_EL)?Assignmentruleherehh_alpham=-0.1*((psin+33)/(exp(-0.1*(psin+33))-1))?Assignmentruleherehh_betam=4*exp((psin+58)/-12)?Assignmentruleherehh_alphah=0.07*exp((0-(psin+50))/10)?Assignmentruleherehh_betah=1/(exp(-0.1*(psin+20))+1)?Assignmentruleherehh_alphan=-0.01*((psin+34)/(exp(-0.1*(psin+34))-1))?Assignmentruleherehh_betan=0.125*exp((0-(psin+44))/25)?Assignmentruleherehh_mCa=1/(exp((psin+20)/-9)+1)?Assignmentruleherehh_tauh=0.001/(hh_alphah+hh_betah)?Assignmentruleherehh_minfinity=hh_alpham/(hh_alpham+hh_betam)?Assignmentruleherehh_ninfinity=hh_alphan/(hh_alphan+hh_betan)?Assignmentruleherehh_hinfinity=hh_alphah/(hh_alphah+hh_betah)?Assignmentruleherehh_taun=0.001/(hh_alphan+hh_betan)?AssignmentrulehereINa=gNa*pow(hh_minfinity,3)*h*(psin-RToverF*log(Nae/Nan))?AssignmentrulehereIK=gK*pow(n,4)*(psin-EK)?AssignmentrulehereICa=gCa*pow(hh_mCa,2)*(psin-ECa)?AssignmentrulehereImAHP=gmAHP*Ca/(Ca+KD)*(psin-EK)?AssignmentrulehereIpump=F*kpumpn*ATPn*(Nan-Nan0)*pow(1+ATPn/Kmpump,-1)?AssignmentrulehereFout=F0*pow(Vv/Vv0,1/alphav)+F0*(tauv/Vv0)*Vvp*pow(Vv/Vv0,-(1/2))?Assignmentrulehereren=Ve/Vn?Assignmentruleherereg=Ve/Vg?Assignmentrulehererce=Vcap/Ve?Assignmentruleherercn=Vcap/Vn?Assignmentruleherercg=Vcap/Vg?AssignmentrulehereJGLCec=0-JGLCce?AssignmentrulehereJGLCgc=0-JGLCcg?AssignmentrulehereJGLCge=0-JGLCeg?AssignmentrulehereJGLCne=0-JGLCen?AssignmentrulehereJLACce=0-JLACec?AssignmentrulehereJLACgc=0-JLACcg?AssignmentrulehereJLACge=0-JLACeg?AssignmentrulehereJLACne=0-JLACen?Assignmentrulehereun=qAK*qAK+4*qAK*(A/ATPn-1)?Assignmentrulehereug=qAK*qAK+4*qAK*(A/ATPg-1)?AssignmentruleheredAMPdATPn=-1+qAK/2+-0.5*pow(un,0.5)+qAK*A/(ATPn*pow(un,0.5))?AssignmentruleheredAMPdATPg=-1+qAK/2+-0.5*pow(ug,0.5)+qAK*A/(ATPg*pow(ug,0.5))}DERIVATIVEstates{Nag'=1/1000*(JleakNag-3*Jpumpg+Jstimg+3*JGLUeg)Nan'=1/1000*(JleakNan-3*Jpumpn+Jstimn-0.310880*INa)GLCn'=1/1000*(JGLCen-JHKPFKn)GLCg'=1/1000*(JGLCcg+JGLCeg-JHKPFKg)GAPg'=1/1000*(2*JHKPFKg-JPGKg)GAPn'=1/1000*(2*JHKPFKn-JPGKn)PEPg'=1/1000*(JPGKg-JPKg)PEPn'=1/1000*(JPGKn-JPKn)PYRg'=1/1000*(JPKg-JLDHg-Jmitoing)PYRn'=1/1000*(JPKn-JLDHn-Jmitoinn)LACn'=1/1000*(JLDHn-JLACne)LACg'=1/1000*(JLDHg-JLACge-JLACgc)NADHcyton'=1/1000*(pow(1-zeta,-1)*(JPGKn-JLDHn-Jshuttlen))NADHcytog'=1/1000*(pow(1-zeta,-1)*(JPGKg-JLDHg-Jshuttleg))NADHmiton'=1/1000*(pow(zeta,-1)*(4*Jmitoinn-Jmitooutn+Jshuttlen))NADHmitog'=1/1000*(pow(zeta,-1)*(4*Jmitoing-Jmitooutg+Jshuttleg))ATPn'=1/1000*((-2*JHKPFKn+JPGKn+JPKn-JATPasesn-1*Jpumpn+3.6*Jmitooutn+JCKn)*pow(1-dAMPdATPn,-1))ATPg'=1/1000*((-2*JHKPFKg+JPGKg+JPKg-JATPasesg-1.75*Jpumpg+0.75*vPumpg0+3.6*Jmitooutg+JCKg)*pow(1-dAMPdATPg,-1))PCrg'=1/1000*(-JCKg)PCrn'=1/1000*(-JCKn)O2n'=1/1000*(JO2mcn-0.625*Jmitooutn)O2g'=1/1000*(JO2mcg-0.625*Jmitooutg)O2c'=1/1000*(JO2c-1/rcn*JO2mcn-1/rcg*JO2mcg)GLCc'=1/1000*(JGLCc-1/rce*JGLCce-1/rcg*JGLCcg)LACc'=1/1000*(JLACc+1/rce*JLACec+1/rcg*JLACgc)Vv'=1/1000*((Fin-Fout))Hb'=1/1000*(Fin*(O2a-O2meanc)*Vv'/(Fout+Vv'))GLCe'=1/1000*(JGLCce-1/reg*JGLCeg-1/ren*JGLCen)LACe'=1/1000*(1/ren*JLACne+1/reg*JLACge-JLACec)psin'=1/1000*(1/Cm*(-IL-INa-IK-ICa-ImAHP-Ipump+Isyn))h'=1/1000*(phih/hh_tauh*(hh_hinfinity-h))n'=1/1000*(phin/hh_taun*(hh_ninfinity-n))Ca'=1/1000*(-SmVn*ICa/F-1/tauCa*(Ca-Ca0))?VvpshouldbethesameasVv',forconstantFin.Vv'=Fin-Fout,soVv'=Fout'.WeworkedthoughtthisandsolvedforVv'',whichissettoVvpinthefollowingequation?Vvp'=(F0*Vv'*(-2*Vv0*pow(Vv/Vv0,(1/2+1/alphav))+alphav*tauv*Vv'))/(2*alphav*Vv*(F0*tauv+Vv0*pow(Vv/Vv0,1/2))))Vvp'=1/1000*((2*alphav*Finprime*Vv0*Vv*pow((Vv/Vv0),1/2)-2*F0*Vv0*pow((Vv/Vv0),(1/2+1/alphav))*Vv'+alphav*F0*tauv*Vv'*Vv')/(2*alphav*Vv*(F0*tauv+Vv0*pow(Vv/Vv0,1/2))))}