NEURON{SUFFIXkcaUSEIONkREADekWRITEikUSEIONcaREADcaiRANGEgbar,ik}UNITS{(mA)=(milliamp)(mV)=(millivolt)(S)=(siemens)(molar)=(1/liter)(mM)=(millimolar)}PARAMETER{gbar=0.01(S/cm2)beta=0.03(1/ms)cac=0.025(mM)taumin=0.5(ms)q10=3(1)}ASSIGNED{v(mV)celsius(degC)ek(mV)cai(mM)gk(S/cm2)ik(mA/cm2)minftaum(ms)}STATE{m}BREAKPOINT{SOLVEstatesMETHODcnexpgk=gbar*pow(m,3)ik=gk*(v-ek)}DERIVATIVEstates{rates(cai)m'=(minf-m)/taum}INITIAL{rates(cai)m=minf}PROCEDURErates(cai(mM)){LOCALcar,tadjtadj=q10^((celsius-22.0(degC))/10(degC))car=(cai/cac)^2minf=car/(1+car)taum=1/beta/(1+car)/tadjif(taum<taumin){taum=taumin}}