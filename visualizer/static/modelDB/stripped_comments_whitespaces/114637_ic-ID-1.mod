NEURON{SUFFIXicnewUSEIONkREADekWRITEikUSEIONcaREADicaGLOBALinfRANGEgkbar,ek,tau_diff,taum,fact,ik,ca_beta}UNITSONUNITS{(mA)=(milliamp)(mV)=(millivolt)}INDEPENDENT{tFROM0TO1WITH1(ms)}PARAMETER{v(mV)dt(ms)gkbar=.045(mho/cm2)ek=-95(mV)tau_diff=0.05(ms)taum=2.0(1/ms)fact=1e-3}CONSTANT{ca_beta=20.0(1/ms)ca_alpha=100.0(mM/ms/mA)}STATE{mcai}ASSIGNED{ik(mA/cm2)ica(mA/cm2)inf[1]tau[1]}INITIAL{cai=0.0(mM)}BREAKPOINT{SOLVEstatesMETHODcnexpik=gkbar*m*m*(v-ek)}DERIVATIVEstates{mhn(cai)m'=(inf[0]-m)/tau[0]cai'=(ca_alpha*(-ica)-ca_beta*cai)*fact}FUNCTIONvarss(ca){varss=ca/(ca+0.040)}FUNCTIONvartau(){vartau=taum}PROCEDUREmhn(ca){tau[0]=vartau()inf[0]=varss(ca)}