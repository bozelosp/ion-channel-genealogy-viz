INDEPENDENT{tFROM0TO1WITH1(ms)}NEURON{SUFFIXrubinUSEIONcaREADcaiUSEIONcalREADcaliRANGEP,V,A,B,D,W}UNITS{(molar)=(1/liter)(mM)=(millimolar)(uM)=(micromolar)}PARAMETER{scale=1pHC=100(uM)pHN=100aHC=28(uM)aHN=3vtheta=35(uM)dtheta=0.36btheta=0.375sigmav=-0.05(uM)sigmad=-0.01sigmab=-0.02tp=50(ms)ta=2(ms)tv=10(ms)td=250(ms)tb=20(ms)tw=500(ms)kp=-0.1kd=-0.002av=2ad=1.0ab=5.0aw=0.8bw=0.6cp=1cd=500p=0.3d=0.01}STATE{AVBDPWcai(mM)cali(mM)}INITIAL{W=0scale_it()}ASSIGNED{asigvsigpsigdsigbsigw1w2catot(mM)}BREAKPOINT{catot=cai+calisettables(catot)SOLVEstateMETHODderivimplicit}DERIVATIVEstate{A'=(asig-A)/taV'=(vsig-V)/tvbsig=ab/(1+exp((A-btheta)/sigmab))B'=(bsig-B-cd*B*V)/tbdsig=ad/(1+exp((B-dtheta)/sigmad))D'=(dsig-D)/tdP'=(psig-cp*A*P)/tpw1=aw/(1+exp((P-p)/kp))w2=bw/(1+exp((D-d)/kd))W'=(w1-w2-W)/tw}PROCEDUREsettables(cai(mM)){TABLEasig,vsig,psigDEPENDaHC,aHN,pHC,pHN,vtheta,sigmav,avFROM0.0005TO0.1WITH200asig=((cai*(1000)/aHC)^aHN)/(1+(cai*(1000)/aHC)^aHN)vsig=av/(1+exp((cai*(1000)-vtheta)/sigmav))psig=10*((cai*(1000)/pHC)^pHN)/(1+(cai*(1000)/pHC)^pHN)}PROCEDUREscale_it(){pHC=4(uM)*scaleaHC=0.6(uM)*scalevtheta=2(uM)*scaledtheta=2.6*scalebtheta=0.55*scale}