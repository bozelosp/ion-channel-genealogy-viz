UNITS{(mV)=(millivolt)(mA)=(milliamp)(S)=(siemens)}NEURON{SUFFIXkv3USEIONkREADekWRITEikRANGEgkbar,gk,ikGLOBALvhninf,kninf,antaul,bntaul,cntaul,dntaul,antaur,bntaur,cntaur,dntaur,brkvntau}PARAMETER{gkbar=0.004(S/cm2)ek=-88(mV)vhninf=-15kninf=8antaul=1bntaul=15cntaul=-50dntaul=10brkvntau=-20antaur=0.15bntaur=10cntaur=-10dntaur=6}ASSIGNED{v(mV)ik(mA/cm2)gk(S/cm2)ninfntau(ms)}STATE{n}BREAKPOINT{SOLVEstatesMETHODcnexpgk=gkbar*n^4ik=gk*(v-ek)}UNITSOFFINITIAL{settables(v)n=ninf}DERIVATIVEstates{settables(v)n'=(ninf-n)/ntau}PROCEDUREsettables(v(mV)){TABLEninf,ntauFROM-100TO100WITH200ninf=1/(1+exp(-(v-vhninf)/kninf))if(v<brkvntau){ntau=antaul+bntaul*exp(-((v-cntaul)/dntaul)^2)}else{ntau=antaur+bntaur*(1/(1+exp((v-cntaur)/dntaur)))}}UNITSON