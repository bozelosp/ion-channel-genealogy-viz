UNITS{(mA)=(milliamp)(mV)=(millivolt)FARADAY=96520(coul)R=8.3134(joule/degK)KTOMV=.0853(mV/degC)}INDEPENDENT{tFROM0TO1WITH1(ms)}NEURON{SUFFIXmycalUSEIONcaREADcai,caoWRITEicaRANGEgcalbar,minf,taum,facm,ica}PARAMETER{dt(ms)v(mV)celsius=22.7(degC)gcalbar=0(mho/cm2)cai=5.e-5(mM)cao=2(mM)tadjmeca=140}STATE{mh}ASSIGNED{ica(mA/cm2)gcal(mho/cm2)minftaumfacm}INITIAL{tadjm=3.55^((celsius-23.5)/10)rates(v)m=minfgcal=gcalbar*m*m}BREAKPOINT{SOLVEstatesgcal=gcalbar*m*mica=gcal*ghk(v,cai,cao,2)}PROCEDUREstates(){rates(v)m=m+facm*(minf-m)VERBATIMreturn0;ENDVERBATIM}PROCEDURErates(v(mV)){taum=15*exp((v+4)/-200)/tadjmminf=1./(1+exp(-(v+4)/6.0))facm=(1-exp(-dt/taum))}FUNCTIONghk(v(mV),ci(mM),co(mM),z)(millicoul/cm3){LOCALe,ww=v*(.001)*z*FARADAY/(R*(celsius+273.16))e=w/(exp(w)-1)if(fabs(w)>1e-4){e=w/(exp(w)-1)}else{e=1-w/2}ghk=-(.001)*z*FARADAY*(co-ci*exp(w))*e}