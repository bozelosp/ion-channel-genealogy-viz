NEURON{SUFFIXkv4_aUSEIONkREADekWRITEikRANGEminf,tm,hinf,th,ik,thRANGEgbarEXTERNALapc_metap,fpc_metapGLOBALVhalf,taumodGLOBALvhm,vcmGLOBALvhh,vchGLOBALvhtm,atm,Ctm,tm0GLOBALvhth,ath,Cth,th0}UNITS{(mA)=(milliamp)(mV)=(millivolt)}PARAMETER{ek(mV)gbar=0.05(S/cm2)Vhalf=-40(mV)taumod=1vhm=-40(mV)vcm=-7(mV)vhh=-73(mV)vch=4.9(mv)vhtm=-56.7(mv)atm=6.22(mV)Ctm=4.83(mV)tm0=1.029(ms)vhth=-68.5(mv)ath=5.95(mV)Cth=78.4(mV)th0=39.04(ms)}STATE{mh}ASSIGNED{v(mV)ik(mA/cm2)minftm(ms)hinfth(ms)}BREAKPOINT{SOLVEstatesMETHODcnexpik=gbar*m^3*h*(v-ek)}DERIVATIVEstates{rates(v)m'=(minf-m)/tmh'=(hinf-h)/th}INITIAL{setVhalf(Vhalf)setTauMod(taumod)rates(v)m=minfh=hinf}PROCEDURErates(v(mV)){LOCALq10q10=3^((celsius-32)/10)minf=(1/(1+exp((v-vhm)/vcm)))^(1/3)hinf=1/(1+exp((v-vhh)/vch))tm=(1/q10)*(tm0+Ctm/(1+exp((v-vhtm)/atm)))th=(1/q10)*(th0+Cth/(1+exp((v-vhth)/ath)))}PROCEDUREsetVhalf(Vhalf(mV)){vhm=Vhalfvhh=Vhalf-33}PROCEDUREsetTauMod(taumod){tm0=1.029*taumodCtm=4.83*taumodth0=39.04*taumodCth=78.4*taumod}