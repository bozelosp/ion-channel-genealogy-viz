NEURON{POINT_PROCESSNMDAeeeRANGEg,Alpha,Beta,e,ica,Cdur,gmaxUSEIONcaREADcai,caoWRITEicaNONSPECIFIC_CURRENTiNMDAGLOBALmg,Cmax,fracca}UNITS{(nA)=(nanoamp)(mV)=(millivolt)(umho)=(micromho)(mM)=(milli/liter)FARADAY=(faraday)(coulomb)R=(k-mole)(joule/degC)}PARAMETER{Cmax=1(mM)Cdur=1(ms)Alpha=4(/ms/mM)Beta=0.0015(/ms)e=0(mV)mg=1(mM)fracca=0.13gmax=1(uS)}ASSIGNED{v(mV)iNMDA(nA)g(umho)RinfRtau(ms)synonBicacai(mM)cao(mM)}STATE{RonRoff}INITIAL{Rinf=Cmax*Alpha/(Cmax*Alpha+Beta)Rtau=1/(Cmax*Alpha+Beta)synon=0}BREAKPOINT{SOLVEreleaseMETHODcnexpB=mgblock(v)g=(Ron+Roff)*B*gmaxiNMDA=g*(v-e)*(1-fracca)if(fracca>0.0){ica=g*ghkg(v,cai,cao,2)*fracca}}INCLUDE"ghk.inc"DERIVATIVErelease{Ron'=(synon*Rinf-Ron)/RtauRoff'=-Beta*Roff}FUNCTIONmgblock(v(mV)){TABLEDEPENDmgFROM-140TO80WITH1000mgblock=1/(1+exp(0.062(/mV)*-v)*(mg/3.57(mM)))}NET_RECEIVE(weight,on,nspike,r0,t0(ms)){if(flag==0){nspike=nspike+1if(!on){r0=r0*exp(-Beta*(t-t0))t0=ton=1synon=synon+weightstate_discontinuity(Ron,Ron+r0)state_discontinuity(Roff,Roff-r0)}net_send(Cdur,nspike)}if(flag==nspike){r0=weight*Rinf+(r0-weight*Rinf)*exp(-(t-t0)/Rtau)t0=tsynon=synon-weightstate_discontinuity(Ron,Ron-r0)state_discontinuity(Roff,Roff+r0)on=0}}