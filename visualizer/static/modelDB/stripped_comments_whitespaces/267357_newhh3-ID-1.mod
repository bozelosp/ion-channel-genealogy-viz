UNITS{(molar)=(1/liter)(S)=(siemens)(mA)=(milliamp)(mV)=(millivolt)F=(faraday)(coulomb)R=(molek)(mV-coulomb/degC)(mM)=(millimolar)}NEURON{SUFFIXhh3USEIONnaWRITEinaUSEIONkWRITEikRANGEgnabar,gkhhbar,gkabar,ina,ikhh,ika,ik,ena,niv,miv,hiv,htv1,htv2,gka,minf,hinf,ninf,htautog,hinit}INDEPENDENT{tFROM0TO1WITH1(ms)}PARAMETER{v(mV)dt(ms)ena=137(mV)nai(mM)celsius=35.0(degC)gnabar=550.0e-6(S/cm2)gkhhbar=665.0e-6(S/cm2)gkabar=266.0e-6(S/cm2)ek=-90.0(mV)nao=145(mM)qv=60.0(mV)qs=5.0(1)hinit=-1htautog=0}STATE{m<1e-4>h<1e-4>n<1e-4>p<1e-4>q<1e-4>}ASSIGNED{ina(mA/cm2)ik(mA/cm2)ika(mA/cm2)ikhh(mA/cm2)gka(S/cm2)minfhinfninfqinfpinf}BREAKPOINT{SOLVEstatesMETHODcnexpena=137ina=gnabar*m*m*m*h*(v-ena)ikhh=gkhhbar*n*n*n*(v-ek)gka=gkabar*pow(p,3)*qika=gka*(v-ek)ik=ika+ikhh}UNITSOFFINITIAL{m=boltz(v,-34.6,6.0)h=boltz(v,-56.8,-7.8)n=boltz(v,-25.0,12.0)p=boltz(v,-43,24.0)q=boltz(v,-qv,-qs)if(0<hinit<1){h=hinit}}DERIVATIVEstates{LOCALminf,hinf,ninf,pinf,qinf,mtau,htau,ntau,ptau,qtauminf=boltz(v,-34.6,6.0)hinf=boltz(v,-56.8,-7.8)ninf=boltz(v,-25,12.0)pinf=boltz(v,-43,24.0)qinf=boltz(v,-qv,-qs)mtau=1*boltz(v,-45.0,-1.5)-1*boltz(v,-65.0,-0.5)+0.04htau=3*56.0*boltz(v,-29.0,-4.5)-3*56.0*boltz(v,-49.0,-2.0)+2.0ntau=19.0/(1.0+exp((v+39.0)/8.0))-0.0/(1.0+exp((v+59.0)/20.0))+1.0ptau=2.*exp(-(v+50)*(v+50)/550)+1.1qtau=20.0m'=(minf-m)/mtauif(htautog>0){h'=0}else{h'=(hinf-h)/htau}n'=(ninf-n)/ntaup'=(pinf-p)/ptauq'=(qinf-q)/qtau}FUNCTIONboltz(x,y,z){boltz=1/(1+exp(-(x-y)/z))}UNITSON