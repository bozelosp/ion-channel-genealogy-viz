UNITS{(mA)=(milliamp)(mV)=(millivolt)(S)=(siemens)(pS)=(picosiemens)(um)=(micrometer)}NEURON{SUFFIXHHstUSEIONnaREADenaWRITEinaUSEIONkREADekWRITEikUSEIONcaREADecaWRITEicaNONSPECIFIC_CURRENTileakRANGEeleak,gleak,NFleakRANGEgnabar,gkbarRANGEgna,gkRANGElm,lh,gl,glbarRANGEtm,th,gt,gtbarRANGEnm,gkmbarRANGEm_exp,h_exp,n_exp,km_exp,lm_exp,tm_exp,lh_exp,th_expGLOBALgamma_na,gamma_k,gamma_km,gamma_l,gamma_tRANGEkm_inf,tau_km,lm_inf,tm_inf,tau_lm,tau_tm,lh_inf,th_inf,tau_lh,tau_thRANGEm_inf,h_inf,n_infRANGEtau_m,tau_h,tau_nRANGEtau_zn,tau_zm,tau_zkm,tau_zt,tau_zlRANGEvar_zn,var_zm,var_zkm,var_zt,var_zlRANGEnoise_zn,noise_zm,noise_zkm,noise_zl,noise_ztRANGENna,Nk,Nkm,Nt,NlGLOBALseed,hslow,hfastRANGEmu_zn,mu_zm,mu_zkm,mu_zt,mu_zlGLOBALvshiftGLOBALtaukm,NFTHREADSAFE}PARAMETER{gnabar=0.12(S/cm2)gkbar=0.036(S/cm2)glbar=0.0003(S/cm2)gtbar=0.0003(S/cm2)gkmbar=.002(S/cm2)gleak=0.00001(S/cm2)eleak=-60(mV)NFleak=1gamma_na=10(pS)gamma_k=10(pS)gamma_km=10(pS)gamma_t=10(pS)gamma_l=10(pS)seed=1vshift=0taukm=1NF=1hslow=100hfast=0.3}STATE{mhnnmtmthlmlhzn[3]zm[6]zkmzt[5]zl[5]zleak}ASSIGNED{ina(mA/cm2)il(mA/cm2)it(mA/cm2)ica(mA/cm2)ikdr(mA/cm2)ikm(mA/cm2)ik(mA/cm2)ileak(mA/cm2)gna(S/cm2)gk(S/cm2)gkm(S/cm2)gl(S/cm2)gt(S/cm2)ena(mV)ek(mV)eca(mV)dt(ms)area(um2)celsius(degC)v(mV)Nna(1)Nk(1)Nkm(1)Nl(1)Nt(1)m_exph_expn_expkm_exptm_explm_expth_explh_expm_infh_infn_infkm_inftm_inflm_infth_inflh_infnoise_zn[3]noise_zm[6]noise_zkmnoise_zt[5]noise_zl[5]var_zn[3]var_zm[6]var_zkmvar_zt[5]var_zl[5]tau_m(ms)tau_h(ms)tau_n(ms)tau_km(ms)tau_lm(ms)tau_tm(ms)tau_th(ms)tau_lh(ms)tau_zn[3]tau_zm[6]tau_zkmtau_zt[5]tau_zl[5]mu_zn[3]mu_zm[6]mu_zkmmu_zt[5]mu_zl[5]}INITIAL{Nna=ceil(((1e-8)*area)*(gnabar)/((1e-12)*gamma_na))Nk=ceil(((1e-8)*area)*(gkbar)/((1e-12)*gamma_k))Nkm=ceil(((1e-8)*area)*(gkmbar)/((1e-12)*gamma_km))Nt=ceil(((1e-8)*area)*(gtbar)/((1e-12)*gamma_t))Nl=ceil(((1e-8)*area)*(glbar)/((1e-12)*gamma_l))rates(v)m=m_infh=h_infn=n_infnm=km_inftm=tm_infth=th_inflm=lm_inflh=lh_infzn[0]=0zn[1]=0zn[2]=0zn[3]=0zm[0]=0.zm[1]=0.zm[2]=0.zm[3]=0.zm[4]=0.zm[5]=0.zm[6]=0.zkm=0zt[0]=0zt[1]=0zt[2]=0zt[3]=0zt[4]=0zl[0]=0zl[1]=0zl[2]=0zl[3]=0zl[4]=0zleak=0set_seed(seed)}BREAKPOINT{SOLVEstatesgna=gnabar*(m*m*m*h+(zm[0]+zm[1]+zm[2]+zm[3]+zm[4]+zm[5]+zm[6]))ina=gna*(v-ena)gk=gkbar*(n*n*n*n+(zn[0]+zn[1]+zn[2]+zn[3]))ikdr=gk*(v-ek)gkm=gkmbar*(nm+zkm)ikm=gkm*(v-ek)ik=ikm+ikdrgt=gtbar*(tm*tm*th+(zt[0]+zt[1]+zt[2]+zt[3]+zt[4]))it=gt*(v-eca)gl=glbar*(lm*lm*lh+(zl[0]+zl[1]+zl[2]+zl[3]+zl[4]))il=gl*(v-eca)ica=il+itileak=gleak*(1+zleak)*(v-eleak)}PROCEDUREstates(){rates(v+vshift)m=m+m_exp*(m_inf-m)h=h+h_exp*(h_inf-h)n=n+n_exp*(n_inf-n)nm=nm+km_exp*(km_inf-nm)tm=tm+tm_exp*(tm_inf-tm)th=th+th_exp*(th_inf-th)lm=lm+lm_exp*(lm_inf-lm)lh=lh+lh_exp*(lh_inf-lh)VERBATIMreturn0;ENDVERBATIM}PROCEDURErates(vm(mV)){LOCALa,b,m3_inf,n4_inf,sum,one_minus_m,one_minus_h,one_minus_n,iUNITSOFFa=-.6*vtrap((vm+30),-10)b=20*(exp((-1*(vm+55))/18))tau_m=1/(a+b)m_inf=a*tau_mone_minus_m=1.-m_infm3_inf=m_inf*m_inf*m_infa=0.4*(exp((-1*(vm+50))/20))b=6/(1+exp(-0.1*(vm+20)))tau_h=hslow/((1+exp((vm+30)/4))+(exp(-(vm+50)/2)))+hfasth_inf=1/(1+exp((vm+44)/4))one_minus_h=1.-h_inftau_zm[0]=tau_htau_zm[1]=tau_mtau_zm[2]=tau_m/2tau_zm[3]=tau_m/3tau_zm[4]=tau_m*tau_h/(tau_m+tau_h)tau_zm[5]=tau_m*tau_h/(tau_m+2*tau_h)tau_zm[6]=tau_m*tau_h/(tau_m+3*tau_h)var_zm[0]=1.0/numchan(Nna)*m3_inf*m3_inf*h_inf*one_minus_hvar_zm[1]=3.0/numchan(Nna)*m3_inf*m_inf*m_inf*h_inf*h_inf*one_minus_mvar_zm[2]=3.0/numchan(Nna)*m3_inf*m_inf*h_inf*h_inf*one_minus_m*one_minus_mvar_zm[3]=1.0/numchan(Nna)*m3_inf*h_inf*h_inf*one_minus_m*one_minus_m*one_minus_mvar_zm[4]=3.0/numchan(Nna)*m3_inf*m_inf*m_inf*h_inf*one_minus_m*one_minus_hvar_zm[5]=3.0/numchan(Nna)*m3_inf*m_inf*h_inf*one_minus_m*one_minus_m*one_minus_hvar_zm[6]=1.0/numchan(Nna)*m3_inf*h_inf*one_minus_m*one_minus_m*one_minus_m*one_minus_hFROMi=0TO6{mu_zm[i]=exp(-dt/tau_zm[i])noise_zm[i]=sqrt(var_zm[i]*(1-mu_zm[i]*mu_zm[i]))*normrand(0,NF)zm[i]=zm[i]*mu_zm[i]+noise_zm[i]}a=-0.02*vtrap((vm+40),-10)b=0.4*(exp((-1*(vm+50))/80))tau_n=1/(a+b)n_inf=a*tau_none_minus_n=1.-n_infn4_inf=n_inf*n_inf*n_inf*n_inftau_zn[0]=tau_ntau_zn[1]=tau_n/2tau_zn[2]=tau_n/3tau_zn[3]=tau_n/4var_zn[0]=4.0/numchan(Nk)*n4_inf*n_inf*n_inf*n_inf*one_minus_nvar_zn[1]=6.0/numchan(Nk)*n4_inf*n_inf*n_inf*one_minus_n*one_minus_nvar_zn[2]=4.0/numchan(Nk)*n4_inf*n_inf*one_minus_n*one_minus_n*one_minus_nvar_zn[3]=1.0/numchan(Nk)*n4_inf*one_minus_n*one_minus_n*one_minus_n*one_minus_nFROMi=0TO3{mu_zn[i]=exp(-dt/tau_zn[i])noise_zn[i]=sqrt(var_zn[i]*(1-mu_zn[i]*mu_zn[i]))*normrand(0,NF)zn[i]=zn[i]*mu_zn[i]+noise_zn[i]}a=-.001/taukm*vtrap((vm+30),-9)b=.001/taukm*vtrap((vm+30),9)tau_km=1/(a+b)km_inf=a*tau_kmtau_zkm=tau_kmvar_zkm=km_inf*(1-km_inf)/numchan(Nkm)mu_zkm=exp(-dt/tau_zkm)noise_zkm=sqrt(var_zkm*(1-mu_zkm*mu_zkm))*normrand(0,NF)zkm=zkm*mu_zkm+noise_zkma=0.055*vtrap(-(vm+27),3.8)b=0.94*exp((-75-vm)/17)tau_lm=1/(a+b)lm_inf=a*tau_lma=0.000457*exp((-13-vm)/50)b=0.0065/(exp((-vm-15)/28)+1)tau_lh=1/(a+b)lh_inf=a*tau_lhtau_zl[0]=tau_lm*tau_lh/(tau_lm+2*tau_lh)tau_zl[1]=tau_lm*tau_lh/(tau_lm+tau_lh)tau_zl[2]=tau_lhtau_zl[3]=tau_lm/2tau_zl[4]=tau_lmvar_zl[0]=1/numchan(Nl)*lm_inf^2*lh_inf*(1-lm_inf)^2*(1-lh_inf)var_zl[1]=2/numchan(Nl)*lm_inf^3*lh_inf*(1-lm_inf)*(1-lh_inf)var_zl[2]=1/numchan(Nl)*lm_inf^4*lh_inf*(1-lh_inf)var_zl[3]=1/numchan(Nl)*lm_inf^2*lh_inf^2*(1-lm_inf)^2var_zl[4]=2/numchan(Nl)*lm_inf^3*lh_inf^2*(1-lm_inf)FROMi=0TO4{mu_zl[i]=exp(-dt/tau_zl[i])noise_zl[i]=sqrt(var_zl[i]*(1-mu_zl[i]*mu_zl[i]))*normrand(0,NF)zl[i]=zl[i]*mu_zl[i]+noise_zl[i]}tau_tm=(4/(exp((vm+25)/20)+exp(-(vm+100)/15)))tm_inf=1/(1+exp(-(vm+50)/7.4))tau_th=(86/(exp((vm+46)/4)+exp(-(vm+405)/50)))th_inf=1.0/(1+exp((vm+78)/5))tau_zt[0]=tau_tm*tau_th/(tau_tm+2*tau_th)tau_zt[1]=tau_tm*tau_th/(tau_tm+tau_th)tau_zt[2]=tau_thtau_zt[3]=tau_tm/2tau_zt[4]=tau_tmvar_zt[0]=1/numchan(Nt)*tm_inf^2*th_inf*(1-tm_inf)^2*(1-th_inf)var_zt[1]=2/numchan(Nt)*tm_inf^3*th_inf*(1-tm_inf)*(1-th_inf)var_zt[2]=1/numchan(Nt)*tm_inf^4*th_inf*(1-th_inf)var_zt[3]=1/numchan(Nt)*tm_inf^2*th_inf^2*(1-tm_inf)^2var_zt[4]=2/numchan(Nt)*tm_inf^3*th_inf^2*(1-tm_inf)FROMi=0TO4{mu_zt[i]=exp(-dt/tau_zt[i])noise_zt[i]=sqrt(var_zt[i]*(1-mu_zt[i]*mu_zt[i]))*normrand(0,NF)zt[i]=zt[i]*mu_zt[i]+noise_zt[i]}zleak=normrand(0,NFleak)m_exp=1-exp(-dt/tau_m)h_exp=1-exp(-dt/tau_h)n_exp=1-exp(-dt/tau_n)km_exp=1-exp(-dt/tau_km)lm_exp=1-exp(-dt/tau_lm)lh_exp=1-exp(-dt/tau_lh)tm_exp=1-exp(-dt/tau_tm)th_exp=1-exp(-dt/tau_th)UNITSON}FUNCTIONvtrap(x,y){if(fabs(exp(x/y)-1)<1e-6){vtrap=y*(1-x/y/2)}else{vtrap=x/(exp(x/y)-1)}}FUNCTIONmulnoise(mean,sd,power){LOCALi,avgavg=1FROMi=1TOpower{avg=avg*normrand(mean,sd)}mulnoise=avg}FUNCTIONnumchan(Nchannels){if(Nchannels>0){numchan=(Nchannels)}else{numchan=1}}