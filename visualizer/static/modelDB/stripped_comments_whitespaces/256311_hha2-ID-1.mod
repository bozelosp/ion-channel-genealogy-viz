NEURON{SUFFIXhha2USEIONnaREADenaWRITEinaUSEIONkREADekWRITEikNONSPECIFIC_CURRENTilRANGEgnabar,gkbar,gl,elRANGEar2,vhalfsRANGEinf,fac,tauRANGEtausRANGEWGLOBALtaumin}UNITS{(mA)=(milliamp)(mV)=(millivolt)}INDEPENDENT{tFROM0TO1WITH1(ms)}PARAMETER{a0r=0.0003(ms)b0r=0.0003(ms)zetar=12zetas=12gmr=0.2ar2=1.0taumin=3(ms)vvs=2(mV)vhalfr=-60(mV)W=0.016(/mV)gnabar=0(mho/cm2)gkbar=0(mho/cm2)gl=0(mho/cm2)ena=60(mV)ek=-77(mV)el=-70.0(mV)celsius=34(degC)v(mV)dt}STATE{mhns}ASSIGNED{ina(mA/cm2)ik(mA/cm2)il(mA/cm2)inf[4]fac[4]tau[4]}BREAKPOINT{SOLVEstatesina=gnabar*m*m*h*s*(v-ena)ik=gkbar*n*n*(v-ek)il=gl*(v-el)}INITIAL{states()s=1ina=gnabar*m*m*h*s*(v-ena)ik=gkbar*n*n*(v-ek)il=gl*(v-el)}PROCEDUREcalcg(){mhn(v*1(/mV))m=m+fac[0]*(inf[0]-m)h=h+fac[1]*(inf[1]-h)n=n+fac[2]*(inf[2]-n)s=s+fac[3]*(inf[3]-s)}PROCEDUREstates(){calcg()VERBATIMreturn0;ENDVERBATIM}FUNCTIONvarss(v,i){if(i==0){varss=1/(1+exp((v+42.5)/(-3)))}elseif(i==1){varss=1/(1+exp((v+49)/(3.5)))}elseif(i==2){varss=1/(1+exp((v+46.3)/(-3)))}else{varss=alpv(v,vhalfr)}}FUNCTIONalpv(v(mV),vh){alpv=(1+ar2*exp((v-vh)/vvs))/(1+exp((v-vh)/vvs))}FUNCTIONalpr(v(mV)){alpr=exp(1.e-3*zetar*(v-vhalfr)*9.648e4/(8.315*(273.16+celsius)))}FUNCTIONbetr(v(mV)){betr=exp(1.e-3*zetar*gmr*(v-vhalfr)*9.648e4/(8.315*(273.16+celsius)))}FUNCTIONvartau(v,i){LOCALtmpif(i==0){vartau=0.05}elseif(i==1){vartau=1}elseif(i==2){vartau=3.5}else{tmp=betr(v)/(a0r+b0r*alpr(v))if(tmp<taumin){tmp=taumin}VERBATIMENDVERBATIMvartau=tmp}}PROCEDUREmhn(v){LOCALa,bFROMi=0TO3{tau[i]=vartau(v,i)inf[i]=varss(v,i)fac[i]=(1-exp(-dt/tau[i]))}}