UNITS{(mA)=(milliamp)(mV)=(millivolt)(mol)=(1)}NEURON{SUFFIXkdrUSEIONkREADekWRITEikRANGEgkdr,gkdrbar,ikRANGEninf,taunGLOBALnscale}PARAMETER{temp=24(degC)gkdrbar=0.003(mho/cm2)vhalfn=13(mV)a0n=0.02(/ms)zetan=-3(1)gmn=0.7(1)nmin=2(ms)nscale=1}STATE{n}ASSIGNED{v(mV)ik(mA/cm2)ninfgkdr(mho/cm2)taun(ms)ek(mV)celsius(degC)}INITIAL{rates(v)n=ninf}BREAKPOINT{SOLVEstatesMETHODcnexpgkdr=gkdrbar*nik=gkdr*(v-ek)}DERIVATIVEstates{rates(v)n'=(ninf-n)/taun}FUNCTIONalpn(v(mV)){alpn=exp(zetan*(v-vhalfn)*1.e-3(V/mV)*9.648e4(coulomb/mol)/(8.315(joule/degC/mol)*(273.16(degC)+celsius)))}FUNCTIONbetn(v(mV)){betn=exp(zetan*gmn*(v-vhalfn)*1.e-3(V/mV)*9.648e4(coulomb/mol)/(8.315(joule/degC/mol)*(273.16(degC)+celsius)))}PROCEDURErates(v(mV)){LOCALaa=alpn(v)ninf=1/(1+a)taun=betn(v)/(a0n*(1+a))if(taun<nmin){taun=nmin}taun=taun/nscale}