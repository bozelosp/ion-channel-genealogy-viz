NEURON{SUFFIXCaDenNONSPECIFIC_CURRENTikcaNONSPECIFIC_CURRENTicalRANGEgkcabar,gcabar,eca,gkcaRANGEtRandG,AmpRandG,O_inf,Warm_Gear,Warm_thresh,tailon,W_tau_d}UNITS{(mA)=(milliamp)(mV)=(millivolt)(molar)=(1/liter)(mM)=(millimolar)FARADAY=(faraday)(coulomb)R=(k-mole)(joule/degC)}PARAMETER{gcabar=0.0003(mho/cm2)eca=60(mV)theta_m=-30(mV)kappa_m=-6(mV)O_tau=20(ms)O_tau2=50(ms)W_tau_d=1200(ms)tailon=1AmpRandG=0.5Warm_Gear=1Warm_thresh=0.27gkcabar=0.37418(mho/cm2)nexp=10(1)kd=0.0005(mM)S_tau=40(ms)caio=0.0001(mM)f=0.01alpha=1(cm2mM/mC)kca=8(1/ms)celsius=36(degC)ek=-80(mV)}STATE{OWScai(mM)}ASSIGNED{dt(ms)v(mV)O_infS_inf(ms)W_infW_tau(ms)W_tau2(ms)tRandGical(mA/cm2)ikca(mA/cm2)gkcadf}BEFOREBREAKPOINT{}BREAKPOINT{SOLVEstatesMETHODcnexpical=gcabar*((O)*(AmpRandG*0.3+1))*(v-eca)gkca=Sikca=gkcabar*gkca*(v-ek)}DERIVATIVEstates{rates(v)S_inf=(1/((kd/(cai-0.00001))^nexp+1))df=d_Flag(O_inf-O)tauCorrection(tRandG)O'=(O_inf-O)*tauFunc(W,df)/(O_tau+O_tau2*df)W'=((W_inf*(1-df))-W)/(W_tau+W_tau2)S'=(S_inf-S)/S_taucai'=f*(-(alpha*(ical))-(kca*cai))}UNITSOFFINITIAL{rates(v)O=O_infW=W_infcai=caioS=0}PROCEDURErates(v(mV)){TABLEO_inf,W_inf,W_tauFROM-200TO100WITH300O_inf=1/(1+exp((v-theta_m)/kappa_m))W_inf=1/(1+exp(-(v+57)/0.8))W_tau=50+(1150/Warm_Gear)/(1+exp((v+32)/7))}FUNCTIONtauFunc(W,df){LOCALW_thresh,observable_WW_thresh=Warm_threshobservable_W=tailon*W*dftauFunc=0.001+0.999/(1+exp((observable_W-W_thresh)/0.006))}PROCEDURERandGenerator(O,O_inf){if(O<0.03&&O_inf>0.025){tRandG=scop_random()AmpRandG=scop_random()}}PROCEDUREtauCorrection(tRandG){LOCALtauCompansatetauCompansate=(W_tau_d*(1-(0.76*tRandG)))-W_tauW_tau2=tauCompansate*df}FUNCTIONd_Flag(Xf){d_Flag=1/(1+expmod(5000*(Xf+0.01)))}FUNCTIONexpmod(x){if(x<(-100)){expmod=0}else{expmod=exp(x)}}UNITSON