NEURON{POINT_PROCESSAmpaCODNONSPECIFIC_CURRENTiRANGEr1FIX,r2,r3,r4,r5,r1,r6,r6FIXRANGEg,gmax,kB,Cdur,ErevRANGEgg1,gg2,gg3,TdiffRANGET,Tmax,TreleaseRANGEtau_1,tau_rec,tau_facil,U,u0RANGEA1,A2,A3,tau_dec1,tau_dec2,tau_dec3RANGEtdelay,ton}UNITS{(nA)=(nanoamp)(mV)=(millivolt)(mM)=(milli/liter)(pS)=(picosiemens)(nS)=(nanosiemens)(um)=(micrometer)PI=(pi)(1)}PARAMETER{r1FIX=5.4(/ms/mM)r2=0.82(/ms)r3=0(/ms)r4=0(/ms)r5=0.013(/ms)r6FIX=1.12(/ms/mM)gmax=700(nS)Cdur=0.3(ms)Erev=0(mV)kB=0.44(mM)A1=0.131837A2=0.0555027A3=0.0135232tau_dec1=3.4958tau_dec2=16.6317tau_dec3=128.983tau_1=3(ms)<1e-9,1e9>tau_rec=35.1(ms)<1e-9,1e9>tau_facil=10.8(ms)<0,1e9>U=0.416(1)<0,1>u0=0(1)<0,1>Tmax=1(mM)}ASSIGNED{v(mV)i(nA)g(pS)r1(/ms)r6(/ms)T(mM)Trelease(mM)Tdiff(mM)tdelay(ms)Tdiff_0(mM)ton(ms)xPRE}STATE{CODgg1gg2gg3sink}INITIAL{C=1O=0D=0T=0(mM)Tdiff=0(mM)Trelease=0(mM)Tdiff_0=0(mM)gg1=0gg2=0gg3=0ton=-1(ms)PRE=0}FUNCTIONSET_tdelay(R,D){tdelay=0.25*R*R/D}BREAKPOINT{if((t-ton)>tdelay){Tdiff=gg1+gg2+gg3Tdiff_0=Tdiff}else{Tdiff=Tdiff_0+(A1+A2+A3)*PRE*(t-ton)/tdelay}Trelease=T+TdiffSOLVEkstatesMETHODsparseg=gmax*Oi=(1e-6)*g*(v-Erev)}KINETICkstates{r1=r1FIX*Trelease^2/(Trelease+kB)^2r6=r6FIX*Trelease^2/(Trelease+kB)^2~C<->O(r1,r2)~O<->D(r3,r4)~D<->C(r5,r6)CONSERVEC+O+D=1~gg1<->sink(1/tau_dec1,0)~gg2<->sink(1/tau_dec2,0)~gg3<->sink(1/tau_dec3,0)}NET_RECEIVE(weight,on,nspike,flagtdel,t0(ms),y,z,u,tsyn(ms)){INITIAL{flagtdel=1nspike=1Tdiff=0y=0z=0u=u0tsyn=t}if(flag==0){nspike=nspike+1if(!on){ton=tt0=ton=1z=z*exp(-(t-tsyn)/tau_rec)z=z+(y*(exp(-(t-tsyn)/tau_1)-exp(-(t-tsyn)/tau_rec))/(tau_1/tau_rec-1))y=y*exp(-(t-tsyn)/tau_1)x=1-y-zif(tau_facil>0){u=u*exp(-(t-tsyn)/tau_facil)u=u+U*(1-u)}else{u=U}y=y+x*uPRE=yT=Tmax*ytsyn=t}net_send(Cdur,nspike)net_send(tdelay,flagtdel)}if(flag==nspike){T=0on=0}if(flag==flagtdel){flagtdel=flagtdel+1state_discontinuity(gg1,gg1+A1*x*u)state_discontinuity(gg2,gg2+A2*x*u)state_discontinuity(gg3,gg3+A3*x*u)}}