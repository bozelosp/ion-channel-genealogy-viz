INDEPENDENT{tFROM0TO1WITH1(ms)}NEURON{SUFFIXspikeUSEIONnaREADenaWRITEinaUSEIONkREADekWRITEikUSEIONcaREADcai,eca,caoWRITEicaRANGEgnabar,gkbar,gabar,gcabar,gkcbar,gkcRANGEm_inf,h_inf,n_inf,p_inf,q_inf,c_infRANGEtau_m,tau_h,tau_n,tau_p,tau_q,tau_c,tau_slowhRANGEm_exp,h_exp,n_exp,p_exp,q_exp,c_exp,slowh_expRANGEidrk,iak,icakGLOBALvshift_ca,ca50,slowhRANGEvshift_na_kGLOBALtausv,tausd,tausb,Nm,Nh,NshRANGEnkm,gkmbarRANGEkm_inf,tau_km}UNITS{(molar)=(1/liter)(mM)=(millimolar)(mA)=(milliamp)(mV)=(millivolt)}PARAMETER{gnabar=0.04(mho/cm2)gkbar=0.012(mho/cm2)gabar=0.036(mho/cm2)gcabar=0.002(mho/cm2)gkcbar=0.00005(mho/cm2)ena=65(mV)ek=-100(mV)eca(mV)cao=1.8(mM)cai=0.0001(mM)dt(ms)v(mV)vshift_na_k=5(mV)vshift_ca=5(mV)ca50=0.2(mM)slowh=1gkmbar=.002(mho/cm2)tausb=0.5taus=50tausv=30tausd=1Nm=3Nh=1Nsh=1}STATE{mhnpqcnkmsh}INITIAL{m=0.0345h=0.8594sh=1n=0.1213p=0.0862q=0.2534c=0.0038nkm=0.0344}ASSIGNED{ina(mA/cm2)ik(mA/cm2)idrk(mA/cm2)iak(mA/cm2)icak(mA/cm2)ikm(mA/cm2)ica(mA/cm2)m_infh_infn_infp_infq_infc_infkm_inftau_mtau_htau_ntau_ptau_qtau_ctau_kmm_exph_expn_expp_expq_expc_expkm_expgkc}BREAKPOINT{SOLVEstatesina=gnabar*m^Nm*h^Nh*sh^Nsh*(v-ena)idrk=gkbar*n*n*n*n*(v-ek)iak=gabar*p*p*p*q*(v-ek)gkc=((cai/ca50)/(1+(cai/ca50)))icak=gkcbar*gkc*(v-ek)ikm=2.3*gkmbar*nkm*(v-ek)ik=idrk+iak+icak+ikmica=gcabar*c*c*c*(v-eca)}PROCEDUREstates(){LOCALsigmasevaluate_fct_nak(v+vshift_na_k)evaluate_fct_ca(v+vshift_ca)m=m+m_exp*(m_inf-m)h=h+h_exp*(h_inf-h)sigmas=1/(1+exp((v+tausv+vshift_na_k)/tausd))sh=sh+(1-exp(-dt/(taus*sigmas+tausb)))*(1/(1+exp((v+44+vshift_na_k)/3))-sh)n=n+n_exp*(n_inf-n)p=p+p_exp*(p_inf-p)q=q+q_exp*(q_inf-q)c=c+c_exp*(c_inf-c)nkm=nkm+km_exp*(km_inf-nkm)VERBATIMreturn0;ENDVERBATIM}UNITSOFFPROCEDUREevaluate_fct_ca(v(mV)){LOCALa,ba=(-0.3*(v+13))/((exp(-0.1*(v+13)))-1)b=10*(exp((-1*(v+38))/18))tau_c=1/(a+b)c_inf=a*tau_cc_exp=1-exp(-dt/tau_c)}PROCEDUREevaluate_fct_nak(v(mV)){LOCALa,ba=(-0.6*(v+30))/((exp(-0.1*(v+30)))-1)b=20*(exp((-1*(v+55))/18))tau_m=1/(a+b)m_inf=a*tau_ma=0.4*(exp((-1*(v+50))/20))b=6/(1+exp(-0.1*(v+20)))tau_h=1/(a+b)h_inf=a*tau_ha=(-0.02*(v+40))/((exp(-0.1*(v+40)))-1)b=0.4*(exp((-1*(v+50))/80))tau_n=1/(a+b)n_inf=a*tau_na=(-0.006*(v+90))/((exp(-0.1*(v+90)))-1)b=0.1*(exp((-1*(v+30))/10))tau_p=1/(a+b)p_inf=a*tau_pa=0.04*(exp((-1*(v+70))/20))b=0.6/(1+exp(-0.1*(v+40)))tau_q=1/(a+b)q_inf=a*tau_qa=0.001*(v+30)/(1-exp(-(v+30)/9))b=-0.001*(v+30)/(1-exp((v+30)/9))tau_km=1/(a+b)km_inf=a*tau_kmm_exp=1-exp(-dt/tau_m)h_exp=1-exp(-dt/tau_h)n_exp=1-exp(-dt/tau_n)p_exp=1-exp(-dt/tau_p)q_exp=1-exp(-dt/tau_q)km_exp=1-exp(-dt*2.3/tau_km)}UNITSON