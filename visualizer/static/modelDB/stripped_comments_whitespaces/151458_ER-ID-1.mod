TITLEEndoplasmicReticulumUNITS{(molar)=(1/liter)(mM)=(millimolar)(nA)=(nanoamp)(mA)=(milliampere)(um)=(micron)FARADAY=(faraday)(coulomb)PI=(pi)(1)}NEURON{RANGEtau,beta,gamma,scale,t1,ical,ip3min,spkcnt,ip3ipUSEIONcalREADcaliWRITEicalPOINTERip3im,ip3id}STATE{cali(mM)caer(mM)Jip3h(1)Jip3m(1)Jip3z(mM/ms)ERrelz(mM/ms)ERfilz(mM/ms)ERlekz(mM/ms)ier(mA/cm2)}PARAMETER{fer=0.0025kerm=0.2e-3(mM)kerrel=3e-12(/s)kerfila=0.75e-12(mM/s)kerfilb=0.2e-3(mM)kerlek=6.15e-14(/s)rhover=0.15caer0=0.20(mM)Jip3h0=0.2Jip3m0=0.2Vip3=1e-9dact=8.2e-5(mM)dinh=1.05e-3(mM)dip3=0.13e-3(mM)ddis=0.94e-3(mM)aip3=0.42e6(1/mM/s)bip3=4.1(1/s)ainh=2e-4(mM/s)}ASSIGNED{diam(um)ical(mA/cm2)ip3ip(mM)ip3id(mM)ip3im(mM)}INITIAL{caer=caer0Jip3h=Jip3h0Jip3m=Jip3m0}BREAKPOINT{SOLVEstatesMETHODderivimplicitip3ip=ip3im+ip3idical=-2*FARADAY*(2e8*Jip3(cali,caer,ip3ip,Vip3,dact,dinh,dip3,ddis)+errel(cali,caer,kerrel,kerm)-erfil(cali,caer,kerfila,kerfilb)+erlek(cali,caer,kerlek))*diam*(1e-7)/4ier=icalJip3z=Jip3(cali,caer,ip3ip,Vip3,dact,dinh,dip3,ddis)ERrelz=errel(cali,caer,kerrel,kerm)ERfilz=erfil(cali,caer,kerfila,kerfilb)ERlekz=erlek(cali,caer,kerlek)}DERIVATIVEstates{caer'=-(0.001)*(Jip3(cali,caer,ip3ip,Vip3,dact,dinh,dip3,ddis)+errel(cali,caer,kerrel,kerm)-erfil(cali,caer,kerfila,kerfilb)+erlek(cali,caer,kerlek))/(rhover/fer)Jip3h'=(Jip3hinf(ip3ip,cali,dinh,dip3,ddis)-Jip3h)/Jip3th(ip3ip,ainh,cali,dinh,dip3,ddis)Jip3m'=(Jip3minf(ip3ip,cali,dip3,dact)-Jip3m)/Jip3tm(cali,bip3,aip3)}FUNCTIONerrel(cali(mM),caer(mM),kerrel(/s),kerm(mM))(mM/s){errel=kerrel*pow((cali/(cali+kerm)),1)*(caer-cali)}FUNCTIONerfil(cali(mM),caer(mM),kerfila(mM/s),kerfilb(mM))(mM/s){erfil=kerfila*pow(cali/(1(mM)),2)/(pow(cali/(1(mM)),2)+pow(kerfilb/(1(mM)),2))}FUNCTIONerlek(cali(mM),caer(mM),kerlek(/s))(mM/s){erlek=kerlek*(caer-cali)}FUNCTIONJip3(cali(mM),caer(mM),ip3ip(mM),Vip3(1/cm2/ms),dact(mM),dinh(mM),dip3(mM),ddis(mM))(mM/s){Jip3=Vip3*pow(Jip3m,3)*pow(Jip3h,3)*(caer-cali)}FUNCTIONJip3minf(ip3ip(mM),cali(mM),dip3(mM),dact(mM)){Jip3minf=(ip3ip/(ip3ip+dip3))*(cali/(cali+dact))}FUNCTIONJip3tm(cali(mM),bip3(1/ms),aip3(1/mM/ms)){Jip3tm=1/(bip3+aip3*cali)}FUNCTIONJip3hinf(ip3ip(mM),cali(mM),dinh(mM),dip3(mM),ddis(mM)){Jip3hinf=Jip3Q(ip3ip,dinh,dip3,ddis)/(Jip3Q(ip3ip,dinh,dip3,ddis)+cali)}FUNCTIONJip3th(ip3ip(mM),ainh(mM/ms),cali(mM),dinh(mM),dip3(mM),ddis(mM)){Jip3th=1/(ainh*Jip3Q(ip3ip,dinh,dip3,ddis)+cali)}FUNCTIONJip3Q(ip3ip(mM),dinh(mM),dip3(mM),ddis(mM)){Jip3Q=dinh*((ip3ip+dip3)/(ip3ip+ddis))}