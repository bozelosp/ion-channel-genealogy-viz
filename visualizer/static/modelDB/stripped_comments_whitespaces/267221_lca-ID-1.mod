NEURON{SUFFIXlcaUSEIONcaREADeca,cai,caoWRITEicaRANGEglcabar,ica}UNITS{(mA)=(milliamp)(mV)=(millivolt)(S)=(siemens)(molar)=(1/liter)(mM)=(millimolar)}PARAMETER{glcabar=0.0(S/cm2)ki=.001(mM)tfa=1(1)}ASSIGNED{v(mV)eca(mV)celsius(degC)ica(mA/cm2)glca(S/cm2)minftaum(ms)cai(mM)cao(mM)}STATE{m}BREAKPOINT{SOLVEstateMETHODcnexpglca=glcabar*pow(m,2)*h2(cai)ica=glca*ghk(v,cai,cao)}DERIVATIVEstate{rates(v)m'=(minf-m)/taum}INITIAL{rates(v)m=minf}FUNCTIONh2(cai(mM)){h2=ki/(ki+cai)}FUNCTIONghk(v(mV),ci(mM),co(mM))(mV){LOCALnu,ff=KTF(celsius)/2nu=v/fghk=-f*(1.-(ci/co)*exp(nu))*efun(nu)}FUNCTIONKTF(celsius(degC))(mV){KTF=(25.(mV)/293.15(degC))*(celsius+273.15(degC))}FUNCTIONefun(z){if(fabs(z)<1e-4){efun=1-z/2}else{efun=z/(exp(z)-1)}}FUNCTIONvtrap(x(mV),y(mV))(1){if(fabs(x/y)<1e-6){vtrap=1(/mV)*y*(1-x/y/2)}else{vtrap=1(/mV)*x/(exp(x/y)-1)}}FUNCTIONalp(v(mV))(/ms){alp=15.69(/ms)*vtrap(-(v-81.5(mV)),10.0(mV))}FUNCTIONbet(v(mV))(/ms){bet=0.29(/ms)*exp(-v/10.86(mV))}PROCEDURErates(v(mV)){taum=1/(tfa*(alp(v)+bet(v)))minf=tfa*alp(v)*taum}