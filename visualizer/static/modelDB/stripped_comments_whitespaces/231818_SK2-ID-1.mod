NEURON{SUFFIXSK2USEIONcaREADcaiUSEIONkREADekWRITEikUSEIONlcaREADlcaiVALENCE0RANGEgkbar,gk,ik,acaiGLOBALdiff,Q10,fac,invc1,invc2,invc3,invo1,invo2,diro1,diro2,dirc2,dirc3,dirc4}UNITS{(mA)=(milliamp)(mV)=(millivolt)(molar)=(1/liter)(mM)=(millimolar)}PARAMETER{gkbar=0.038(mho/cm2)Q10=3(1)diff=3(1)fac=1ocontrt=0invc1=0.08(/ms)invc2=0.08(/ms)invc3=0.2(/ms)invo1=1.0(/ms)invo2=0.1(/ms)diro1=0.16(/ms)diro2=1.2(/ms)dirc2=200(/ms-mM)dirc3=160(/ms-mM)dirc4=80(/ms-mM)}ASSIGNED{v(mV)ek(mV)cai(mM)celsius(degC)gk(mho/cm2)ik(mA/cm2)invc1_t(/ms)invc2_t(/ms)invc3_t(/ms)invo1_t(/ms)invo2_t(/ms)diro1_t(/ms)diro2_t(/ms)dirc2_t(/ms-mM)dirc3_t(/ms-mM)dirc4_t(/ms-mM)tcorr(1)dirc2_t_ca(/ms)dirc3_t_ca(/ms)dirc4_t_ca(/ms)lcai(mM)acai(mM)}STATE{c1c2c3c4o1o2}BREAKPOINT{SOLVEkinMETHODsparsegk=gkbar*(o1+o2)ik=gk*(v-ek)}INITIAL{rate(celsius)SOLVEkinSTEADYSTATEsparse}KINETICkin{acai=(lcai)/diffif(acai<cai){acai=cai}rates(acai)~c1<->c2(dirc2_t_ca,invc1_t)~c2<->c3(dirc3_t_ca,invc2_t)~c3<->c4(dirc4_t_ca,invc3_t)~c3<->o1(diro1_t,invo1_t)~c4<->o2(diro2_t,invo2_t)CONSERVEc1+c2+c3+c4+o2+o1=1}FUNCTIONtemper(Q10,celsius(degC)){temper=Q10^((celsius-23(degC))/10(degC))}PROCEDURErates(c(mM)){dirc2_t_ca=dirc2_t*c*facdirc3_t_ca=dirc3_t*c*facdirc4_t_ca=dirc4_t*c*fac}PROCEDURErate(celsius(degC)){tcorr=temper(Q10,celsius)invc1_t=invc1*tcorrinvc2_t=invc2*tcorrinvc3_t=invc3*tcorrinvo1_t=invo1*tcorrinvo2_t=invo2*tcorrdiro1_t=diro1*tcorrdiro2_t=diro2*tcorrdirc2_t=dirc2*tcorrdirc3_t=dirc3*tcorrdirc4_t=dirc4*tcorr}