UNITS{(mV)=(millivolt)(mA)=(milliamp)(S)=(siemens)(molar)=(1/liter)(mM)=(millimolar)}NEURON{THREADSAFESUFFIXKCaUSEIONcaREADcaiUSEIONkREADekWRITEikRANGEgmax,gGLOBALpwr,tau,kD_ca}PARAMETER{gmax=0.01(S/cm2)kD_ca=0.035(mM)tau=1(ms)minca=5e-4(mM)pwr=1(1)}ASSIGNED{v(mV)cai(mM)ek(mV)ik(mA/cm2)g(S/cm2)}STATE{n}INITIAL{n=(cai-minca)/(cai-minca+kD_ca)}BREAKPOINT{SOLVEstateMETHODderivimplicitif(cai<minca){n=0}g=n^pwr*gmaxik=g*(v-ek)}DERIVATIVEstate{n'=((cai-minca)/(cai-minca+kD_ca)-n)/tau}