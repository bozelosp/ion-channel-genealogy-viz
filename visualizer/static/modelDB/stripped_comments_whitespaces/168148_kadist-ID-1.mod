UNITS{(mA)=(milliamp)(mV)=(millivolt)(mS)=(millisiemens)}INDEPENDENT{tFROM0TO1WITH1(ms)}PARAMETER{dt(ms)v(mV)ekcelsius(degC)gkabar=.008(mho/cm2)vhalfn=-1(mV)vhalfl=-56(mV)a0l=0.05(/ms)a0n=.1(/ms)zetan=-1.8(1)zetal=3(1)gmn=0.39(1)gml=1(1)lmin=2(ms)nmin=0.1(ms)pw=-1(1)tq=-40(mV)qq=5(mV)temp=23(degC)q10=5qtl=1nscale=1lscale=1}NEURON{SUFFIXkadUSEIONkREADekWRITEikRANGEgkabar,gka,ikRANGEninf,linf,taul,taunGLOBALlmin,nscale,lscale}STATE{nl}ASSIGNED{ik(mA/cm2)ninflinftaul(ms)taun(ms)gka(mho/cm2)qt}INITIAL{rates(v)n=ninfl=linfgka=gkabar*n*lik=gka*(v-ek)}BREAKPOINT{SOLVEstatesMETHODcnexpgka=gkabar*n*lik=gka*(v-ek)}DERIVATIVEstates{rates(v)n'=(ninf-n)/taunl'=(linf-l)/taul}FUNCTIONalpn(v(mV)){LOCALzetazeta=zetan+pw/(1+exp((v-tq)/qq))alpn=exp(1.e-3*zeta*(v-vhalfn)*9.648e4(degC/mV)/(8.315*(273.16+celsius)))}FUNCTIONbetn(v(mV)){LOCALzetazeta=zetan+pw/(1+exp((v-tq)/qq))betn=exp(1.e-3*zeta*gmn*(v-vhalfn)*9.648e4(degC/mV)/(8.315*(273.16+celsius)))}FUNCTIONalpl(v(mV)){alpl=exp(1.e-3*zetal*(v-vhalfl)*9.648e4(degC/mV)/(8.315*(273.16+celsius)))}FUNCTIONbetl(v(mV)){betl=exp(1.e-3*zetal*gml*(v-vhalfl)*9.648e4(degC/mV)/(8.315*(273.16+celsius)))}LOCALfacn,faclPROCEDURErates(v(mV)){LOCALa,qtqt=q10^((celsius-temp)/10(degC))a=alpn(v)ninf=1/(1+a)taun=betn(v)/(qt*a0n*(1+a))taun=taun/nscaleif(taun<nmin){taun=nmin}facn=(1-exp(-dt/taun))a=alpl(v)linf=1/(1+a)taul=0.26(ms/mV)*(v+50)/qtltaul=taul/lscaleif(taul<lmin/qtl){taul=lmin/qtl}facl=(1-exp(-dt/taul))}