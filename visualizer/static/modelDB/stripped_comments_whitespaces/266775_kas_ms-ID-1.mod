NEURON{SUFFIXkas_msUSEIONkREADekWRITEikRANGEgbar,gk,ikRANGEdamod,maxMod,level}UNITS{(S)=(siemens)(mV)=(millivolt)(mA)=(milliamp)}PARAMETER{gbar=0.0(S/cm2)a=0.8q=3damod=0maxMod=1level=0}ASSIGNED{v(mV)ek(mV)ik(mA/cm2)gk(S/cm2)minfmtau(ms)hinfhtau(ms)}STATE{mh}BREAKPOINT{SOLVEstatesMETHODcnexpgk=gbar*m*m*(h*a+1-a)*modulation()ik=gk*(v-ek)}DERIVATIVEstates{rates()m'=(minf-m)/mtau*qh'=(hinf-h)/htau*q}INITIAL{rates()m=minfh=hinf}PROCEDURErates(){UNITSOFFminf=1/(1+exp((v-(-27))/(-16)))mtau=3.4+89.2*exp(-((v-(-34.3))/30.1)^2)hinf=1/(1+exp((v-(-33.5))/21.5))htau=548.7*6/(exp((v-(-96))/(-29.01))+exp((v-(-96))/100))UNITSON}FUNCTIONmodulation(){modulation=1+damod*(maxMod-1)*level}