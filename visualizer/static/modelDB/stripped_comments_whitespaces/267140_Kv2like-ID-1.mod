NEURON{SUFFIXKv2likeUSEIONkREADekWRITEikRANGEgbar,g,ik}UNITS{(S)=(siemens)(mV)=(millivolt)(mA)=(milliamp)}PARAMETER{gbar=0.00001(S/cm2)}ASSIGNED{v(mV)ek(mV)ik(mA/cm2)g(S/cm2)celsius(degC)mInfmAlphamBetamTauhInfh1Tauh2Tau}STATE{mh1h2}BREAKPOINT{SOLVEstatesMETHODcnexpg=gbar*m*m*(0.5*h1+0.5*h2)ik=g*(v-ek)}DERIVATIVEstates{rates()m'=(mInf-m)/mTauh1'=(hInf-h1)/h1Tauh2'=(hInf-h2)/h2Tau}INITIAL{rates()m=mInfh1=hInfh2=hInf}PROCEDURErates(){LOCALqtqt=2.3^((celsius-21)/10)UNITSOFFmAlpha=0.12*vtrap(-(v-43),11.0)mBeta=0.02*MyExp(-(v+1.27)/120)mInf=mAlpha/(mAlpha+mBeta)mTau=2.5*(1/(qt*(mAlpha+mBeta)))hInf=1/(1+MyExp((v+58)/11))h1Tau=(360+(1010+23.7*(v+54))*MyExp(-((v+75)/48)^2))/qth2Tau=(2350+1380*MyExp(-0.011*v)-210*MyExp(-0.03*v))/qtUNITSON}FUNCTIONvtrap(x,y){UNITSOFFif(fabs(x/y)<1e-6){vtrap=y}else{vtrap=x/(MyExp(x/y)-1)}UNITSON}FUNCTIONMyExp(x){if(x<-50){MyExp=0}elseif(x>50){MyExp=exp(50)}else{MyExp=exp(x)}}