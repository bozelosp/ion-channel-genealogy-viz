UNITS{(pure)=(1)(mA)=(milliamp)(mV)=(millivolt)(mol)=(1)(nmol)=(nanomol)(molar)=(mol/liter)(mM)=(millimolar)(uM)=(micromolar)(uC)=(microC)(S)=(mho)(uS)=(microS)(pmol)=(picomole)(pC)=(picocoulomb)(J)=(joule)(um)=(micrometer)k=1.381e-23(J/K)q_e=1.602e-19(coulomb)N_A=6.022e23(pure)z_ca=2(pure)}NEURON{SUFFIXcaUSEIONcaREADcao,caiWRITEicaRANGEPbar,h,frac,ica,ghknow}PARAMETER{Pbar=0.0467(nm/ms)}ASSIGNED{v(mV)cao(mM)cai(mM)celsius(degC)ek(mV)minftaum(ms)hfracghknow(uC/cm2/nm)ica(mA/cm2)}STATE{m}BREAKPOINT{SOLVEstate_changeMETHODcnexpfh(cai)ghknow=ghk(v,cai,cao,z_ca)frac=m^3*hica=Pbar*frac*ghknow}DERIVATIVEstate_change{rates(v)m'=(minf-m)/taum}INITIAL{rates(v)m=minf}PROCEDUREfh(cai(mM)){TABLEhFROM0TO0.100WITH10001h=1/(1+(cai/12.57e-3(mM)))}PROCEDURErates(v(mV)){TABLEminf,taumFROM-150TO150WITH301minf=1/(1+exp(-(v+15.2(mV))/15.6(mV)))taum=1.8(ms)+(4.1(ms)-1.8(ms))/(1+exp(-(v+40.2(mV))/20.7(mV)))}FUNCTIONghk(v(mV),ci(mM),co(mM),z)(uC/cm2/nm){LOCALeta,eci,ecoeta=(1e-3)*z*q_e*v/(k*(celsius+273.15))eco=co*efun(eta)eci=ci*efun(-eta)ghk=(1e-7)*(N_A*q_e*z_ca*(eci-eco))}FUNCTIONefun(eta){if(fabs(eta)<1e-4){efun=1-eta/2}else{efun=eta/(exp(eta)-1)}}