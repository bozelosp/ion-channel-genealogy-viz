NEURON{POINT_PROCESSScalInjectSynRANGEEe,Eg,iRANGEEgmax0,EgmaxRANGEHSP_typeRANGEVtrg,VRANGEEtau,EenableRANGEorderPOINTERVsomaRANGEvavg,avgstrtRANGEmavg,mavgstrt,mavgintrvlRANGEtau1,tau2,Enumsyns,id,Eintrvl,NEprocPOINTERproc_numRANGEcontinuous_update,event_windowNONSPECIFIC_CURRENTi}UNITS{(nA)=(nanoamp)(mV)=(millivolt)(uS)=(microsiemens)(nS)=(nanosiemens)}PARAMETER{Ee=0(mV)Egmax0=1(nS)Vtrg=-60(mV)Etau=1e5(ms)Eenable=1order=0HSP_type=1avgstrt=0(ms)mavgstrt=0(ms)mavgintrvl=5000(ms)tau1=.1(ms)<1e-9,1e9>tau2=10(ms)<1e-9,1e9>Enumsyns=1id=0Eintrvl=500(ms)NEproccontinuous_update=1event_window=5(ms)}ASSIGNED{v(mV)i(nA)Eg(uS)Eordervavgstp1stp2mavgvintrvlnVsomaVproc_num}STATE{Egmax(nS)}INITIAL{Egmax=Egmax0Eorder=Egmax^orderif(HSP_type==0){V=Vsoma}elseif(HSP_type==1){V=v}stp1=0stp2=0n=1vavg=0vintrvl=0mavg=v}BREAKPOINT{Eg=Egmaxi=Eg*(v-Ee)SOLVEupdateMETHODafter_cvodeSOLVEstateMETHODcnexp}DERIVATIVEstate{Egmax'=Eenable*Eorder*(Vtrg-V)/Etau}NET_RECEIVE(w){}PROCEDUREupdate(){if(Egmax<0){Egmax=0}Eorder=Egmax^orderif(HSP_type==0){V=Vsoma}elseif(HSP_type==1){V=v}if(t>=avgstrt){vavg=(vavg*stp1+v)/(stp1+1)stp1=stp1+1}if(t>=mavgstrt){vintrvl=vintrvl+vstp2=stp2+1if(t>mavgstrt+n*mavgintrvl-dt/2){if(mavgintrvl>0){mavg=vintrvl/stp2}n=n+1vintrvl=0stp2=0}}}