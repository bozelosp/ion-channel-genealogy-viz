UNITS{(mM)=(milli/liter)(mV)=(millivolt)(mA)=(milliamp)FARADAY=(faraday)(coulomb)R=(k-mole)(joule/degC)}INDEPENDENT{tFROM0TO1WITH1(ms)}NEURON{SUFFIXHVAUSEIONcaREADcai,cao,ecaWRITEicaRANGEgcaN,gcaL,iNCa,iLCaGLOBALinactLtau,inactLmax,rate_k,gmax_k}PARAMETER{v(mV)dt(ms)gcaL=0.002(mho/cm2)gcaN=0.012(mho/cm2)iNCa=0.0(mA/cm2)iLCa=0.0(mA/cm2)inactLtau=1220.0(ms)inactLmax=0.529ecacaicaocelsius}STATE{quh}ASSIGNED{ica(mA/cm2)qinfuinfhinfqtau(ms)utau(ms)htau(ms)rate_kgmax_k}BREAKPOINT{LOCALvghkSOLVEstatesMETHODcnexpvghk=ghkg(v,cai,cao,2)iNCa=gmax_k*(gcaN*u)*q*q*vghkiLCa=gmax_k*(gcaL)*q*q*h*vghkica=iNCa+iLCa}INITIAL{rate_k=2.49gmax_k=2.49settables(v)q=qinfu=uinfsetCadepLinact(cai)h=hinf}DERIVATIVEstates{settables(v)q'=(qinf-q)/qtauu'=(uinf-u)/utausetCadepLinact(cai)h'=(hinf-h)/htau}PROCEDUREsettables(v){TABLEqinf,qtau,uinf,utauDEPENDcelsiusFROM-100TO100WITH400qinf=1.0/(1.0+exp((-16.3547869-v)/11.3))qtau=(1.25/(cosh(-0.031*(v+28.8547869))))/rate_kuinf=1.0/(1.0+exp((v+45.3326653)/12.5))utau=(98.0+cosh(0.021*(24.7673347-v)))/rate_k}PROCEDUREsetCadepLinact(cai){hinf=inactLmax+((1.0-inactLmax)/(1.0+exp((cai-0.7)/0.15)))htau=inactLtau/rate_k}FUNCTIONghkg(v(mV),ci(mM),co(mM),z)(mV){LOCALnu,ff,enu,fnuff=(1.0e3/z)*R*(celsius+273.15)/FARADAYnu=v/ffenu=exp(nu)if(fabs(nu)<1e-4){fnu=1-nu/2}else{fnu=nu/(enu-1)}ghkg=-ff*(1-(ci/co)*enu)*fnu}