UNITS{(mA)=(milliamp)(mV)=(millivolt)(molar)=(1/liter)(mM)=(millimolar)FARADAY=(faraday)(coulomb)R=(k-mole)(joule/degC)}PARAMETER{v(mV)celsius=34(degC)gcalbar=0(mho/cm2)ki=0.001(mM)cai=5.e-5(mM)cao=2(mM)tfa=5eca=140(mV)}NEURON{SUFFIXcalUSEIONcaREADcai,caoWRITEicaRANGEgcalbar,gmax,gcal,minf,taum}STATE{m}ASSIGNED{ica(mA/cm2)gcal(mho/cm2)gmax(mho/cm2)minftaum(ms)}INITIAL{rates(v)m=minfgcal=gcalbar*m*h2(cai)}BREAKPOINT{SOLVEstatesMETHODcnexpgcal=gcalbar*m*h2(cai)ica=gcal*ghk(v,cai,cao)if(gcal>gmax){gmax=gcal}}FUNCTIONh2(cai(mM)){h2=ki/(ki+cai)}FUNCTIONghk(v(mV),ci(mM),co(mM))(mV){LOCALnu,ff=KTF(celsius)/2nu=v/fghk=-f*(1.-(ci/co)*exp(nu))*efun(nu)}FUNCTIONKTF(celsius(degC))(mV){KTF=((25.(mV)/293.15(degC))*(celsius+273.15(degC)))}FUNCTIONefun(z){if(fabs(z)<1e-4){efun=1-z/2}else{efun=z/(exp(z)-1)}}FUNCTIONalpm(v(mV))(/ms){alpm=0.055(/ms/mV)*(-27.01(mV)-v)/(exp((-27.01(mV)-v)/3.8(mV))-1)}FUNCTIONbetm(v(mV))(/ms){betm=0.94(/ms)*exp((-63.01(mV)-v)/17(mV))}DERIVATIVEstates{rates(v)m'=(minf-m)/taum}PROCEDURErates(v(mV)){LOCALaTABLEtaum,minfFROM-150TO150WITH300a=alpm(v)taum=1/(tfa*(a+betm(v)))minf=a/(a+betm(v))}