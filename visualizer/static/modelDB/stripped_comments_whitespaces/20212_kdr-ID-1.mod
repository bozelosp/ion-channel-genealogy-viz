NEURON{SUFFIXborgkdrUSEIONkREADekWRITEikRANGEgkdrbar,gkdr,vhalfl,vhalfnGLOBALninf,linf,taun,taul}UNITS{(mA)=(milliamp)(mV)=(millivolt)}INDEPENDENT{tFROM0TO1WITH1(ms)}PARAMETER{dt(ms)v(mV)ek=-91(mV)celsius=30(degC)gkdrbar=.003(mho/cm2)vhalfn=-40(mV)vhalfl=-60(mV)a0l=0.001(/ms)a0n=0.03(/ms)b0n=0.03(/ms)b0l=0.001(/ms)zetan=-5(1)zetal=2(1)gmn=0.7(1)gml=1.0(1)nmax=0.3(1)}STATE{nl}ASSIGNED{ik(mA/cm2)ninflinfgkdrtauntaul}INITIAL{rates(v,vhalfn,vhalfl)n=ninfl=linfgkdr=gkdrbar*n^3*lik=gkdr*(v-ek)}BREAKPOINT{SOLVEstatesgkdr=gkdrbar*n^3*lik=gkdr*(v-ek)}FUNCTIONalpn(v(mV),vn){alpn=exp(1.e-3*zetan*(v-vn)*9.648e4/(8.315*(273.16+celsius)))}FUNCTIONbetn(v(mV),vn){betn=exp(1.e-3*zetan*gmn*(v-vn)*9.648e4/(8.315*(273.16+celsius)))}FUNCTIONalpl(v(mV),vl){alpl=exp(1.e-3*zetal*(v-vl)*9.648e4/(8.315*(273.16+celsius)))}FUNCTIONbetl(v(mV),vl){betl=exp(1.e-3*zetal*gml*(v-vl)*9.648e4/(8.315*(273.16+celsius)))}LOCALfacn,faclPROCEDUREstates(){rates(v,vhalfn,vhalfl)n=n+facn*(ninf-n)l=l+facl*(linf-l)VERBATIMreturn0;ENDVERBATIM}PROCEDURErates(v(mV),vn,vl){LOCALa,q10q10=3^((celsius-30)/10)a=alpn(v,vn)ninf=1/(1+a)taun=betn(v,vn)/(q10*(a0n+b0n*a))if(taun<nmax){taun=nmax}facn=(1-exp(-dt/taun))a=alpl(v,vl)linf=1/(1+a)taul=betl(v,vl)/(q10*(a0l+b0l*a))facl=(1-exp(-dt/taul))}