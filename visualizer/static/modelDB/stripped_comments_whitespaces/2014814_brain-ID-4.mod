NEURON{SUFFIXbrainPOINTERxrPointer}PARAMETER{tau_a=0.05mu=1e-5gamma=2.4eps0=1e-4eps1=1e-4eps2=1e-4s0=0.5s1=0.5s2=0.25sig0=-1sig1=1sig2=1}ASSIGNED{xrPointer}STATE{a0a1a2}BREAKPOINT{SOLVEstatesMETHODderivimplicit}INITIAL{a0=0.900321164137428a1=0.083551935956201a2=0.000031666995903}DERIVATIVEstates{a0'=compute0()a1'=compute1()a2'=compute2()}FUNCTIONcompute0(){LOCALaIn0,aIn1,aOutaIn0=maximum(a0,0)aIn1=maximum(a1,0)aOut=((aIn0*(1-aIn0-gamma*aIn1)+mu+eps0*(xrPointer-s0)*sig0))/tau_aaOut=(a0>0)*aOut+(a0<=0)*maximum(0,aOut)compute0=(a0<1)*aOut+(a0>=1)*minimum(1,aOut)}FUNCTIONcompute1(){LOCALaIn0,aIn1,aOutaIn0=maximum(a1,0)aIn1=maximum(a2,0)aOut=((aIn0*(1-aIn0-gamma*aIn1)+mu+eps1*(xrPointer-s1)*sig1))/tau_aaOut=(a1>0)*aOut+(a1<=0)*maximum(0,aOut)compute1=(a1<1)*aOut+(a1>=1)*minimum(1,aOut)}FUNCTIONcompute2(){LOCALaIn0,aIn1,aOutaIn0=maximum(a2,0)aIn1=maximum(a0,0)aOut=((aIn0*(1-aIn0-gamma*aIn1)+mu+eps2*(xrPointer-s2)*sig2))/tau_aaOut=(a2>0)*aOut+(a2<=0)*maximum(0,aOut)compute2=(a2<1)*aOut+(a2>=1)*minimum(1,aOut)}FUNCTIONmaximum(a,b){if(a>b){maximum=a}else{maximum=b}}FUNCTIONminimum(a,b){if(a<b){minimum=a}else{minimum=b}}