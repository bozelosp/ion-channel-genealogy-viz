NEURON{SUFFIXcadNUSEIONcanREADican,caniWRITEcaniVALENCE2GLOBALdepth,caninf,taurn}UNITS{(molar)=(1/liter)(mM)=(millimolar)(um)=(micron)(mA)=(milliamp)(msM)=(msmM)FARADAY=(faraday)(coulomb)}PARAMETER{depth=.1(um)taurn=1(ms)caninf=0.8e-4(mM)}STATE{cani(mM)}ASSIGNED{ican(mA/cm2)drive_channel(mM/ms)}BREAKPOINT{SOLVEstateMETHODderivimplicit}DERIVATIVEstate{drive_channel=-(10000)*ican/(2*FARADAY*depth)if(drive_channel<=0.){drive_channel=0.}cani'=drive_channel+(caninf-cani)/taurn}