NEURON{SUFFIXsaccumUSEIONnaREADina,nao,naiWRITEnai,nao,inaUSEIONkREADik,ko,kiWRITEki,ko,ikUSEIONcaREADica,caiWRITEcai,cao,icaVALENCE2USEIONclREADicl,cli,cloWRITEcli,clo,iclVALENCE-1USEIONhco3READhco3o,hco3iVALENCE-1USEIONaREADia,ao,aiWRITEai,aoVALENCE-1RANGEvolin,volout,deltaPOINTERko2,ko3,nao2,nao3GLOBALTotalBuffer}UNITS{(mV)=(millivolt)(mA)=(milliamp)FARADAY=96485.309(coul/mole)(molar)=(1/liter)(mM)=(millimolar)PI=(pi)(1)R=(k-mole)(joule/degC)}PARAMETER{Difna=1.33(um2/ms)Difk=1.96(um2/ms)Difca=0.6(um2/ms)Difcl=2.03(um2/ms)Difa=0(um2/ms)k1buf=0.0008(/ms)TotalBuffer=1100(mM)x0=16(mM)q=-1.25(mM)bf=1nab=140(mM)kb=3.5(mM)clb=135(mM)s=4.4e4sk=4.4e4bath=1nadif=1rad=1narad=1setvolin=1setvolout=1minvol=0.04maxvol=0.9tau=250(ms)swell=1}ASSIGNED{ina(mA/cm2)ik(mA/cm2)ica(mA/cm2)icl(mA/cm2)ia(mA/cm2)diam(um)naflux[2]kflux[2]caflux[2]clflux[2]aflux[2]dif[3]shell[4]naikicaiclihco3iainaokocaoclohco3oaovolinvoloutKd(/mM)B0(mM)delta(mM)ko2(mM)ko3(mM)nao2(mM)nao3(mM)}STATE{na[2]k[2]ca[2]cl[2]a[2]kbufBufferKBuffer(mM)vol[2]<1e-4>}BREAKPOINT{SOLVEstateMETHODsparse}INITIAL{na[0]=naina[1]=naok[0]=kik[1]=koca[0]=caica[1]=caocl[0]=clicl[1]=cloa[0]=aia[1]=aoKd=k2buf(k[1])/k1bufkbuf=0B0=TotalBuffer/(1+Kd*k[1])Buffer=B0KBuffer=TotalBuffer-B0vol[0]=setvolinvol[1]=setvoloutvolin=vol[0]volout=vol[1]}KINETICstate{delta=((nai+ki+cli+cai+hco3i+ai)-(nao+ko+clo+cao+hco3o+ao))/tauIF(vol[1]<=minvol&&delta>0){delta=0}ELSE{IF(vol[0]<=maxvol&&delta<0){delta=0}~vol[0]<<(swell*delta/(diam*diam*PI/4))~vol[1]<<(-swell*delta/(diam*diam*PI/4))}COMPARTMENTi,vol[i]*PI/4*diam*diam{nakcacla}naflux[0]=-delta*na[0]-(ina*diam)*PI*(1e4)/FARADAYkflux[0]=-delta*k[0]-(ik*diam)*PI*(1e4)/FARADAYcaflux[0]=-delta*ca[0]-(ica*diam)*PI*(1e4)/(FARADAY*2)clflux[0]=-delta*cl[0]-(icl*diam)*PI*(1e4)/(FARADAY*-1)aflux[0]=-delta*a[0]naflux[1]=delta*na[1]+(ina*diam)*PI*(1e4)/FARADAYkflux[1]=delta*k[1]+(ik*diam)*PI*(1e4)/FARADAYcaflux[1]=delta*ca[1]+(ica*diam)*PI*(1e4)/(FARADAY*2)clflux[1]=delta*cl[1]+(icl*diam)*PI*(1e4)/(FARADAY*-1)aflux[1]=delta*a[1]dif[0]=nadif*bath*Difna*((geom(diam)/2)/2)*((nab-na[1])/s)*(PI*(diam+dr(diam)))dif[1]=bath*Difk*((geom(diam)/2)/2)*((kb-k[1]-kbuf)/sk)*(PI*(diam+dr(diam)))dif[2]=bath*Difcl*((geom(diam)/2)/2)*((clb-cl[1])/s)*(PI*(diam+dr(diam)))shell[0]=rad*Difk*(geom(diam)/2)*surf(diam)*(ko2-k[1]-kbuf)shell[1]=rad*Difk*(geom(diam)/2)*surf(diam)*(ko3-k[1]-kbuf)shell[2]=narad*Difna*(geom(diam)/2)*surf(diam)*(nao2-na[1])shell[3]=narad*Difna*(geom(diam)/2)*surf(diam)*(nao3-na[1])IF(bf==0){kbuf=0Buffer=0KBuffer=0}ELSE{~kbuf<<(-k2buf(k[1]+kbuf)*(k[1]+kbuf)*Buffer+k1buf*KBuffer)~Buffer<<(-k2buf(k[1]+kbuf)*(k[1]+kbuf)*Buffer+k1buf*KBuffer)~KBuffer<<(k2buf(k[1]+kbuf)*(k[1]+kbuf)*Buffer-k1buf*KBuffer)}~na[0]<<(naflux[0])~k[0]<<(kflux[0])~ca[0]<<(caflux[0])~cl[0]<<(clflux[0])~a[0]<<(aflux[0])~na[1]<<(naflux[1]+dif[0]+shell[2]+shell[3])~k[1]<<(kflux[1]+dif[1]+shell[0]+shell[1])~ca[1]<<(caflux[1])~cl[1]<<(clflux[1]+dif[2])~a[1]<<(aflux[1])volin=vol[0]volout=vol[1]nai=na[0]nao=na[1]ki=k[0]ko=k[1]+kbufcai=ca[0]cao=ca[1]cli=cl[0]clo=cl[1]ai=a[0]ao=a[1]}FUNCTIONk2buf(x(mM)){TABLEFROM0TO199WITH200k2buf=k1buf/(1+exp((x-x0)/(q)))}FUNCTIONdr(x(um)){TABLEFROM0TO15WITH10dr=x*(sqrt(1+setvolout)-1)}FUNCTIONgeom(x(um)){TABLEFROM0TO15WITH10geom=1/dr(x)}FUNCTIONsurf(x(um)){TABLEFROM0TO15WITH10surf=(PI-2*atan2(x+2*dr(x/2),(x/2)))*((x+2*dr(x/2))/sin(atan2(x+2*dr(x/2),(x/2))))}