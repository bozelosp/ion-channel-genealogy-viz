UNITS{(mA)=(milliamp)(mV)=(millivolt)(molar)=(1/liter)(mM)=(millimolar)(S)=(siemens)FARADAY=96520(coul)R=(k-mole)(joule/degC)KTOMV=.0853(mV/degC)}NEURON{SUFFIXiCaTUSEIONcaREADcai,caoWRITEicaVALENCE2RANGEgcatbar,minf,mtau,hinf,htau,i}PARAMETER{gcatbar=0(S/cm2)ki=0.001(mM)cai=5.e-5(mM)cao=2(mM)tfa=1tfi=0.68tBase=23.5(degC)eca=140(mV)}ASSIGNED{v(mV)celsius(degC)gcat(S/cm2)ica(mA/cm2)i(mA/cm2)asdfminfmtau(ms)hinfhtau(ms)}STATE{mh}BREAKPOINT{SOLVEstatesMETHODcnexpgcat=gcatbar*m*m*h*h2(cai)i=gcat*ghk(v,cai,cao)ica=i}INITIAL{rates(v)m=minfh=hinfgcat=gcatbar*m*m*h*h2(cai)}?statesDERIVATIVEstates{rates(v)m'=(minf-m)/mtauh'=(hinf-h)/htau}PROCEDURErates(v(mV)){LOCALaUNITSOFFa=alpm(v)mtau=1.0/(tfa*(a+betm(v)))minf=a/(a+betm(v))a=alph(v)htau=1.0/(tfi*(a+beth(v)))hinf=a/(a+beth(v))UNITSON}UNITSOFFFUNCTIONh2(cai(mM)){h2=ki/(ki+cai)}FUNCTIONghk(v(mV),ci(mM),co(mM))(mV){LOCALnu,ff=KTF(celsius)/2nu=v/fghk=-f*(1.-(ci/co)*exp(nu))*efun(nu)}FUNCTIONKTF(celsius(degC))(mV){KTF=((25./293.15)*(celsius+273.15))}FUNCTIONefun(z){if(fabs(z)<1e-4){efun=1-z/2}else{efun=z/(exp(z)-1)}}FUNCTIONalpm(v(mV)){TABLEFROM-150TO150WITH200alpm=0.1967*(-1.0*v+19.88)/(exp((-1.0*v+19.88)/10.0)-1.0)}FUNCTIONbetm(v(mV)){TABLEFROM-150TO150WITH200betm=0.046*exp(-v/22.73)}FUNCTIONalph(v(mV)){TABLEFROM-150TO150WITH200alph=1.6e-2*exp(-(v+57.0)/19.0)}FUNCTIONbeth(v(mV)){TABLEFROM-150TO150WITH200beth=1.0/(exp((-v+15)/10)+1.0)}UNITSON