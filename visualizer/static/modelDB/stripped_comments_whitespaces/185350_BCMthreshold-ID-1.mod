NEURON{POINT_PROCESSBCMthresholdGLOBALd0,p0,scount0,scounttau,alpha,alpha_scountGLOBALd,p,tspike}UNITS{(mV)=(millivolt)}PARAMETER{d0p0scounttaualphascount0boltzman=0}ASSIGNED{v(mV)flagOLDalpha_scountdpboltzfactorpfoutputtspike(ms)}STATE{scount}INITIAL{tspike=-100000net_send(0,1)flagOLD=1scount=scount0d=d0p=p0alpha_scount=alpha*scountboltzfactor=exp(-1.0/scounttau)if(boltzman==0){pf=1.0/(1-boltzfactor)}else{pf=1.0}output=0}BREAKPOINT{scount=scount+output/pfSOLVEstateMETHODcnexppf=pf*boltzfactor+1.0alpha_scount=alpha*scountif(alpha_scount>0){p=p0/alpha_scount}else{p=p}d=d0*alpha_scountoutput=0}DERIVATIVEstate{scount'=-scount/pf}NET_RECEIVE(w){INITIAL{w=0}if(flag==0){output=0}elseif(flag==2){tspike=toutput=1}else{WATCH(v>0)2}}