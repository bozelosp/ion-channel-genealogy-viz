UNITS{(mA)=(milliamp)(mV)=(millivolt)}PARAMETER{celsius(degC)gkahpbar=.003(mho/cm2)n=4cai=50.e-6(mM)a0=1.3e13(/ms-mM-mM-mM-mM)b0=.5e-2(/ms)v(mV)ek(mV)}NEURON{SUFFIXkahpUSEIONkREADekWRITEikUSEIONcaREADcaiRANGEgkahpbar,gkahpGLOBALinf,tau}STATE{w}ASSIGNED{ik(mA/cm2)gkahp(mho/cm2)inftau}INITIAL{rate(cai)w=inf}BREAKPOINT{SOLVEstateMETHODcnexpgkahp=gkahpbar*wik=gkahp*(v-ek)}FUNCTIONalp(cai(mM)){alp=a0*cai^n}DERIVATIVEstate{rate(cai)w'=(inf-w)/tau}PROCEDURErate(cai(mM)){LOCALaa=alp(cai)tau=1/(a+b0)inf=a*tau}