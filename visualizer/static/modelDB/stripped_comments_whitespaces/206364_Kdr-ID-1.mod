UNITS{(mA)=(milliamp)(mV)=(millivolt)}NEURON{SUFFIXKdrUSEIONkWRITEikRANGEgkbar,gk,minf,hinf,mexp,hexp,ik,alpha2,beta2,gamma2,zeta2}INDEPENDENT{tFROM0TO1WITH1(ms)}PARAMETER{v(mV)celsius=37(degC)dt(ms)gkbar=.6(mho/cm2)ek=-85(mV)}STATE{mh}ASSIGNED{ik(mA/cm2)gkminfhinfmexphexpalpha2beta2gamma2zeta2}BREAKPOINT{SOLVEstatesgk=gkbar*m*m*hik=gk*(v-ek)}UNITSOFFINITIAL{trates(v)m=minfh=hinf}PROCEDUREstates(){trates(v)m=m+mexp*(minf-m)h=h+hexp*(hinf-h)}PROCEDUREtrates(v){rates(v)}PROCEDURErates(vm){LOCALq10,tinc,tauh,alpha,beta,gamma,zeta,taumq10=3^((celsius-37)/10)tinc=-dt*q10alpha=trap0(vm,8,23.5e-3,12)beta=5*exp((vm+127)/(-30))minf=alpha/(alpha+beta)gamma=trap0(vm,-12,23.5e-3,12)zeta=5*exp((vm+147)/(-30))taum=1/(gamma+zeta)mexp=1-exp(tinc/taum)hinf=1.0/(1+exp((vm+25)/4))if(vm<-25){tauh=1200}else{tauh=10}hexp=1-exp(tinc/tauh)alpha2=alphabeta2=betagamma2=gammazeta2=zeta}FUNCTIONtrap0(vn,th,a,q){if(fabs(vn-th)>1e-6){trap0=a*(vn-th)/(1-exp(-(vn-th)/q))}else{trap0=a*q}}UNITSON