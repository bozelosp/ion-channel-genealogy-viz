INDEPENDENT{tFROM0TO1WITH1(ms)}NEURON{SUFFIXicanUSEIONcaREADcaiUSEIONnaWRITEinaRANGEdepth,taur,frac,ica,icanRANGEgbar,m_inf,tau_m,in,mystartRANGEbeta,cac,tauminPOINTERcip3p}UNITS{(mA)=(milliamp)(mV)=(millivolt)(molar)=(1/liter)(mM)=(millimolar)(um)=(micron)(msM)=(msmM)FARADAY=(faraday)(coulomb)}PARAMETER{v(mV)depth=0.08(um)frac=0taur=100(ms)en=-20(mV)eca=140(mV)cai(mM)gbar=0.0001(mho/cm2)beta=0.0001(1/ms)cac=0.15(mM)taumin=0.1(ms)}STATE{can(mM)m}ASSIGNED{cip3p(mA/cm2)ica(mA/cm2)ican(mA/cm2)drive_channel(mM/ms)in(mA/cm2)ina(mA/cm2)m_inftau_m(ms)tadj}BREAKPOINT{SOLVEstatesMETHODderivimplicitin=gbar*m*m*(v-en)ican=gbar*frac*m*m*(v-eca)ina=0.7*in}DERIVATIVEstates{evaluate_fct(v,can)m'=(m_inf-m)/tau_mdrive_channel=-(10000)*(ican-100*cip3p)/(2*FARADAY*depth)if(drive_channel<=0.0){drive_channel=0.0}can'=drive_channel/18+(cai-can)/(taur)}UNITSOFFINITIAL{can=caitadj=3.0^((celsius-22.0)/10)evaluate_fct(v,can)m=m_inf}PROCEDUREevaluate_fct(v(mV),cai(mM)){LOCALalpha2alpha2=beta*(cai/cac)^2if(cai<1.09e-4){alpha2=0}tau_m=1/(alpha2+beta)/tadjm_inf=alpha2/(alpha2+beta)if(tau_m<taumin){tau_m=taumin}}UNITSON