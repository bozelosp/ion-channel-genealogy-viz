NEURON{SUFFIXdcnSKUSEIONcaREADcaiVALENCE2USEIONkREADekWRITEikRANGEgbar,z,ikGLOBALqdeltat}UNITS{(mA)=(milliamp)(mV)=(millivolt)(molar)=(1/liter)(mM)=(millimolar)}PARAMETER{qdeltat=1gbar=1e-5(siemens/cm2)}ASSIGNED{v(mV)ek(mV)ik(mA/cm2)cai(mM)zinftauz(ms)}STATE{z}INITIAL{rate(cai)z=zinf}BREAKPOINT{SOLVEstatesMETHODcnexpik=gbar*z*(v-ek)}DERIVATIVEstates{rate(cai)z'=(zinf-z)/tauz}PROCEDURErate(cai(mM)){TABLEzinf,tauzFROM0TO0.01WITH300zinf=cai*cai*cai*cai/(cai*cai*cai*cai+8.1e-15)if(cai<0.005){tauz=1-(186.67*cai)}else{tauz=0.0667}tauz=tauz/qdeltat}