NEURON{SUFFIXSK2_DPUSEIONcaREADcaiUSEIONca2READca2iVALENCE2USEIONkREADekWRITEikRANGEgkbar,g,ik,tcorrGLOBALfrac1,frac2}UNITS{(mA)=(milliamp)(mV)=(millivolt)(molar)=(1/liter)(mM)=(millimolar)}PARAMETER{celsius(degC)cai(mM)ca2i(mM)gkbar=0.038(mho/cm2)Q10=3diff=3(1)invc1=80e-3(/ms)invc2=80e-3(/ms)invc3=200e-3(/ms)invo1=1(/ms)invo2=100e-3(/ms)diro1=160e-3(/ms)diro2=1.2(/ms)dirc2=200(/ms-mM)dirc3=160(/ms-mM)dirc4=80(/ms-mM)}ASSIGNED{v(mV)ek(mV)g(mho/cm2)ik(mA/cm2)invc1_t(/ms)invc2_t(/ms)invc3_t(/ms)invo1_t(/ms)invo2_t(/ms)diro1_t(/ms)diro2_t(/ms)dirc2_t(/ms-mM)dirc3_t(/ms-mM)dirc4_t(/ms-mM)tcorr(1)dirc2_t_ca(/ms)dirc3_t_ca(/ms)dirc4_t_ca(/ms)frac1frac2}STATE{c1c2c3c4o1o2}BREAKPOINT{SOLVEkinMETHODsparseg=gkbar*(o1+o2)ik=g*(v-ek)}INITIAL{rate(celsius)SOLVEkinSTEADYSTATEsparse}KINETICkin{rates((cai*frac1+ca2i*frac2)/diff)~c1<->c2(dirc2_t_ca,invc1_t)~c2<->c3(dirc3_t_ca,invc2_t)~c3<->c4(dirc4_t_ca,invc3_t)~c3<->o1(diro1_t,invo1_t)~c4<->o2(diro2_t,invo2_t)CONSERVEc1+c2+c3+c4+o2+o1=1}FUNCTIONtemper(Q10,celsius(degC)){temper=Q10^((celsius-23(degC))/10(degC))}PROCEDURErates(cai(mM)){dirc2_t_ca=dirc2_t*caidirc3_t_ca=dirc3_t*caidirc4_t_ca=dirc4_t*cai}PROCEDURErate(celsius(degC)){tcorr=temper(Q10,celsius)invc1_t=invc1*tcorrinvc2_t=invc2*tcorrinvc3_t=invc3*tcorrinvo1_t=invo1*tcorrinvo2_t=invo2*tcorrdiro1_t=diro1*tcorrdiro2_t=diro2*tcorrdirc2_t=dirc2*tcorrdirc3_t=dirc3*tcorrdirc4_t=dirc4*tcorr}