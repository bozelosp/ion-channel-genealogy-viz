NEURON{SUFFIXcacumbUSEIONcaREADicaWRITEcaiNONSPECIFIC_CURRENTiRANGEdepth,tau,cai0,cmax}UNITS{(mM)=(milli/liter)(mA)=(milliamp)F=(faraday)(coulombs)}PARAMETER{depth=0.1(um)irest=0(mA/cm2)tau=100(ms)cai0=50e-6(mM)}ASSIGNED{ica(mA/cm2)cmaxi(mA/cm2)}STATE{cai(mM)}INITIAL{cai=cai0irest=icacmax=cai}BREAKPOINT{SOLVEintegrateMETHODderivimplicitif(cai>cmax){cmax=cai}i=0}DERIVATIVEintegrate{cai'=(irest-ica)/depth/F/2*(1e4)+(cai0-cai)/tau}