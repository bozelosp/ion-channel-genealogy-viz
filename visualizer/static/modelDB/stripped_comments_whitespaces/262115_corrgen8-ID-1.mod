DEFINEMAXCHANNELS25000INDEPENDENT{tFROM0TO1WITH1(ms)}NEURON{POINT_PROCESScorrGen8RANGEN,freq,correl,refract,min_val,max_valRANGEon,latency,shutoffRANGEx,ns,ls,syncRANGEspont,prob,N2}UNITS{(nA)=(nanoamp)(mV)=(millivolt)(umho)=(micromho)(mM)=(milli/liter)}PARAMETER{dt(ms)N=100N2=1freq=40(/s)correl=0refract=1(ms)min_val=-70(mV)max_val=40(mV)on=1latency=0(ms)shutoff=1e6(ms)}ASSIGNED{x[MAXCHANNELS](mV)R[MAXCHANNELS]ns[MAXCHANNELS]ls[MAXCHANNELS]sync[MAXCHANNELS]spontprob}INITIAL{LOCALispont=(0.001)*freq*dtif(spont>0.5){VERBATIMprintf("\n\nERRORincorrelatedrandomgenerator\n");printf("firingprobabilityistoohigh:spont=%g\n",(float)spont);printf("decreaseintegrationstepormeanfiringfrequency\n");exit(-1);ENDVERBATIM}FROMi=0TON-1{ns[i]=0ls[i]=-10000}N2=N+sqrt(correl)*(1-N)go()}BREAKPOINT{SOLVEgo}UNITSOFFPROCEDUREgo(){LOCALi,j,sumFROMi=0TON-1{x[i]=min_val}if((on==1)&&(t>=latency)&&(t<=shutoff)){if(correl==0){FROMi=0TON-1{if(get_random(1)<=spont){x[i]=max_val}else{x[i]=min_val}}}else{FROMi=0TON2-1{if(get_random(1)<=spont){R[i]=max_val}else{R[i]=min_val}}FROMi=0TON-1{j=get_random(N2)x[i]=R[j]}}FROMi=0TON-1{if((t-ls[i])<=refract){x[i]=min_val}if(x[i]==max_val){ns[i]=ns[i]+1ls[i]=t}}}elseif(on==2){FROMi=0TON-1{x[i]=max_valns[i]=ns[i]+1ls[i]=t}on=1}elseif(on==3){FROMi=0TON-1{if(sync[i]){x[i]=max_valns[i]=ns[i]+1ls[i]=t}}on=1}}UNITSONFUNCTIONget_random(maxval){get_random=maxval*random()/(2^31)}PROCEDUREnew_seed(seed){srandom(seed)VERBATIMprintf("Settingrandomgeneratorwithseed=%g\n",_lseed);ENDVERBATIM}PROCEDUREprintvec(){LOCALiVERBATIM{inti;printf("i\tx\tns\tls\n");for(i=0;i<N;i++){printf("%d\t%g\t%g\t%g\n",i,(float)x[i],(float)ns[i],(float)ls[i]);}}ENDVERBATIM}