NEURON{SUFFIXSKCAUSEIONkREADekWRITEikUSEIONcaREADcaiRANGEgbar,gkahp,ik,ninf,taun,gGLOBALCq10,mt}UNITS{(mA)=(milliamp)(mV)=(millivolt)(molar)=(1/liter)(mM)=(millimolar)(pS)=(picosiemens)(um)=(micron)}PARAMETER{gbar=0.01(S/cm2)cai=50.e-6(mM)a0=1.3e4(1/ms-mM-mM-mM-mM)b0=0.06(1/ms)celsius=37(degC)Cq10=2mt=1}STATE{n}ASSIGNED{ik(mA/cm2)g(S/cm2)ninftaun(ms)a(1/ms)v(mV)ek(mV)}BREAKPOINT{SOLVEstateMETHODcnexpg=gbar*nik=g*(v-ek)}INITIAL{rate(cai)n=ninf}DERIVATIVEstate{rate(cai)n'=(ninf-n)/taun}PROCEDURErate(cai(mM)){LOCALq10q10=Cq10^((celsius-22(degC))/10(degC))a=a0*cai^4taun=mt*q10*(0.2*(q10/(a+b0)))ninf=a/(a+b0)}FUNCTIONtrap0(v,th,a,q){if(fabs(v-th)>1e-6){trap0=a*(v-th)/(1-exp(-(v-th)/q))}else{trap0=a*q}}