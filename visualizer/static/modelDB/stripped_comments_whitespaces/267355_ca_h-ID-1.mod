INDEPENDENT{tFROM0TO1WITH1(ms)}NEURON{SUFFIXcahUSEIONcaREADcai,caoWRITEicaUSEIONncaWRITEincaVALENCE2RANGEpbar,minf,taum,hinf,tauh,shifth,t1,t2,shiftm,icaGLOBALqm,qh,shift,mi1,mi2,mi3,ti1,ti2,ti3}UNITS{(molar)=(1/liter)(mV)=(millivolt)(mA)=(milliamp)(mM)=(millimolar)FARADAY=(faraday)(coulomb)R=(k-mole)(joule/degC)}PARAMETER{v(mV)celsius(degC)pbar=.2e-3(cm/s)shift=1.7912(mV)shiftm=2(mV)shifth=0(mV)cai(mM)cao(mM)qm=4qh=2t1=0.1t2=30mi1=1.04mi2=19.406mi3=13.729ti1=1.8177ti2=7.3843e-05ti3=21.51}STATE{mh}ASSIGNED{ica(mA/cm2)minftaum(ms)hinftauh(ms)phimphihcorrinca(mA/cm2)}BREAKPOINT{SOLVEcastateMETHODcnexpica=pbar*m*m*h*ghk(v,cai,cao)inca=ica}DERIVATIVEcastate{evaluatefct(v)m'=(minf-m)/taumh'=(hinf-h)/tauh}UNITSOFFINITIAL{phim=qm^((celsius-24)/10)phih=qh^((celsius-24)/10)evaluatefct(v)m=minfh=hinf}PROCEDUREevaluatefct(v(mV)){minf=mi1/(1+exp(-(v+shift+mi2)/mi3))hinf=0.75/(1+exp((v+shifth+22.63)/6.6))taum=(ti1/(cosh(ti2*(v+shift+ti3))))/phimtauh=(70/(cosh(0.047*(v+shifth-19.73))))/phih}FUNCTIONghk(v(mV),ci(mM),co(mM))(.001coul/cm3){LOCALz,eci,ecoz=(1e-3)*2*FARADAY*v/(R*(celsius+273.15))eco=co*efun(z)eci=ci*efun(-z)ghk=(.001)*2*FARADAY*(eci-eco)}FUNCTIONefun(z){if(fabs(z)<1e-4){efun=1-z/2}else{efun=z/(exp(z)-1)}}FUNCTIONnongat(v,cai,cao){nongat=pbar*ghk(v,cai,cao)}UNITSON