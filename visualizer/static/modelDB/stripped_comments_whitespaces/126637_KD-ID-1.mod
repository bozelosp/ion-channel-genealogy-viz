UNITS{(mA)=(milliamp)(mV)=(millivolt)}NEURON{SUFFIXKDUSEIONkWRITEikRANGEgkbar,ik,gk,minf,hinf,mexp,hexp}INDEPENDENT{tFROM0TO1WITH1(ms)}PARAMETER{v(mV)celsius=37(degC)dt(ms)gkbar=.0045(mho/cm2)ek=-85(mV)mon=1hon=1}STATE{mh}ASSIGNED{ik(mA/cm2)gkminfhinfmexphexp}BREAKPOINT{SOLVEstatesgk=gkbar*m*hik=gk*(v-ek)}UNITSOFFINITIAL{rates(v)m=minfh=hinf}PROCEDUREstates(){rates(v)m=mon*(m+mexp*(minf-m))h=hon*(h+hexp*(hinf-h))}PROCEDURErates(v){LOCALq10,tinc,alpha,beta,sumTABLEminf,mexp,hinf,hexpDEPENDdt,celsiusFROM-400TO300WITH700q10=3^((celsius-37)/10)tinc=-dt*q10alpha=8.5/(1+exp((v+17)/(-12.5)))beta=35/(1+exp((v+99)/14.5))sum=alpha+betaminf=alpha/summexp=1-exp(tinc*sum/10)alpha=0.0015/(1+exp((v+89)/8))beta=0.0055/(1+exp((v+83)/(-8)))sum=alpha+betahinf=alpha/sumhexp=1-exp(tinc*sum*1.6)}UNITSON