UNITS{(mA)=(milliamp)(mV)=(millivolt)(S)=(siemens)(mS)=(millisiemens)(molar)=(1/liter)(uM)=(micromolar)}NEURON{THREADSAFESUFFIXgKahpUSEIONcaREADcaiUSEIONkREADekWRITEikRANGEgmax,g,i,q_inf,tau_q}PARAMETER{gmax=0.0008(mho/cm2)beta_q=0.001}STATE{q}ASSIGNED{g(S/cm2)ek(mV)ik(mA/cm2)q_inf(1)tau_q(ms)i(mA/cm2)cai(uM)}BREAKPOINT{SOLVEstatesMETHODcnexpg=gmax*qi=g*(v-ek)ik=i}INITIAL{rates(cai)q=q_inf}FUNCTIONalpha_q(cai){alpha_q=0.2e-4*caiif(alpha_q>0.01){alpha_q=0.01}}DERIVATIVEstates{rates(cai)q'=(q_inf-q)/tau_q}PROCEDURErates(cai){LOCALalpha,betaTABLEq_inf,tau_qFROM0TO500WITH2000alpha=alpha_q(cai)beta=beta_qtau_q=1/(alpha+beta)q_inf=alpha*tau_q}