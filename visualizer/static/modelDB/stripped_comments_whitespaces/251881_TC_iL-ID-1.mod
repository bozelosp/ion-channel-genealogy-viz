INDEPENDENT{tFROM0TO1WITH1(ms)}NEURON{SUFFIXTC_iLUSEIONcaREADcai,caoWRITEicaRANGEpcabar,m_inf,tau_m,ica,i_rec}UNITS{(mA)=(milliamp)(mV)=(millivolt)(molar)=(1/liter)(mM)=(millimolar)FARADAY=(faraday)(coulomb)R=8.314(volt-coul/degC)}PARAMETER{v(mV)celsius(degC)dt(ms)cai=0.5E-4(mM)cao=2(mM)pcabar=1e-4(cm/s)}STATE{m}ASSIGNED{ica(mA/cm2)i_rec(mA/cm2)tau_m(ms)m_inftcorr}BREAKPOINT{SOLVEstatesMETHODcnexpica=pcabar*m*m*ghk(v,cai,cao)i_rec=ica}DERIVATIVEstates{rates(v)m'=(m_inf-m)/tau_m}INITIAL{rates(v)tcorr=3^((celsius-23.5)/10)m=0}UNITSOFFFUNCTIONghk(v(mV),ci(mM),co(mM))(millicoul/cm3){LOCALz,eci,ecoz=v*(.001)*2*FARADAY/(R*(celsius+273.15))eco=co*efun(z)eci=ci*efun(-z)ghk=(.001)*2*FARADAY*(eci-eco)}FUNCTIONefun(z){if(fabs(z)<1e-4){efun=1-z/2}else{efun=z/(exp(z)-1)}}PROCEDURErates(v(mV)){LOCALa,ba=1.6/(1+exp(-0.072*(v-5)))b=0.02*vtrap(-(v-1.31),5.36)tau_m=1/(a+b)/tcorrm_inf=1/(1+exp((v+10)/-10))}FUNCTIONvtrap(x,c){if(fabs(x/c)<1e-6){vtrap=c+x/2}else{vtrap=x/(1-exp(-x/c))}}UNITSON