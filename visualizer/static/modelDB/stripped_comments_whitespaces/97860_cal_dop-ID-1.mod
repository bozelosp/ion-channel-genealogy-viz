NEURON{SUFFIXcal_dopUSEIONcaREADcai,caoWRITEicaRANGEgbar,ica,g,vfGLOBALvhm,vcm,voffGLOBALCtm,atm,btm,tm0,vhtmGLOBALminf,tau}UNITS{(mA)=(milliamp)(mV)=(millivolt)FARADAY=(faraday)(kilocoulombs)R=(k-mole)(joule/degC)KTOMV=.0853(mV/degC)(S)=(siemens)(mM)=(milli/liter)}PARAMETER{v(mV)voff=0(mV)celsius(degC)gbar=.003(S/cm2)ki=.001(mM)cai(mM)cao(mM)tfa=1vhm=-35(mV)vcm=8(mV)Ctm=3(ms)atm=12(mV)btm=11(mV)tm0=0(ms)vhtm=-2(mV)}STATE{m}ASSIGNED{vf(mV)ica(mA/cm2)g(S/cm2)minftau(ms)a(1/ms)}BREAKPOINT{vf=v-voffSOLVEstateMETHODcnexpg=gbar*m*m*h2(cai)ica=g*ghk(vf,cai,cao)}INITIAL{vf=v-voffrate(vf)m=minf}FUNCTIONh2(cai(mM)){h2=ki/(ki+cai)}FUNCTIONghk(vf(mV),ci(mM),co(mM))(mV){LOCALnu,ff=KTF(celsius)/2nu=vf/fghk=-f*(1.-(ci/co)*exp(nu))*efun(nu)}FUNCTIONKTF(celsius(degC))(mV){KTF=((25(mV)/293.15(degC))*(celsius+273.15(degC)))}FUNCTIONefun(z){if(fabs(z)<1e-4){efun=1-z/2}else{efun=z/(exp(z)-1)}}FUNCTIONalp(vf(mV))(1/ms){TABLEFROM-150TO150WITH200alp=15.69(1/mV-ms)*(-1.0*vf+81.5(mV))/(exp((-1.0*vf+81.5(mV))/10.0(mV))-1.0)}FUNCTIONbet(vf(mV))(1/ms){TABLEFROM-150TO150WITH200bet=0.29(1/ms)*exp(-vf/10.86(mV))}DERIVATIVEstate{rate(vf)m'=(minf-m)/tau}PROCEDURErate(vf(mV)){a=alp(vf)tau=Ctm/(exp((vf-vhtm)/atm)+exp((vhtm-vf)/btm))+tm0minf=1/(1+exp(-(vf-vhm)/vcm))}