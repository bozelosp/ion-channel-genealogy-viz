UNITS{(mA)=(milliamp)(mV)=(millivolt)(molar)=(1/liter)(mM)=(millimolar)(S)=(siemens)}NEURON{THREADSAFESUFFIXKD_ca2USEIONcaREADcaiUSEIONkREADekWRITEikRANGEgmax,g,taun,taul,kD_ca,lGLOBALvhalfn,tnmax,tlmax,tnmin,tauc,cap}PARAMETER{gmax=0.01(mho/cm2)vhalfn=-45(mV)vn2=-60(mV)zn=7.0(mV)tnmax=100(ms)tnmin=3.0(ms)tns=-7.5(mV)vhalfl=-66(mV)zl=-2.0(mV)tlmax=820(ms)tlmin=20(ms)tauc=30(ms)vl2=-63(mV)tls=17(mV)kD_ca=0.0001(mM)cap=0.6lcp=6}STATE{nlvlc}ASSIGNED{v(mV)ek(mV)cai(mM)ik(mA/cm2)lninflinflcinftaul(ms)taun(ms)g(S/cm2)}BREAKPOINT{SOLVEstatesMETHODcnexpl=(1-(1-lc)*(1-lv))*cap+(1-cap)*lvg=gmax*n*lik=g*(v-ek)}INITIAL{rates(v)n=ninflv=linflci(cai)lc=lcinfl=(1-(1-lc)*(1-lv))*cap+(1-cap)*lv}FUNCTIONalpn(v(mV)){alpn=exp((vhalfn-v)/zn)}FUNCTIONbetn(v(mV)){betn=exp((vn2-v)/tns)}FUNCTIONalpl(v(mV)){alpl=exp((vhalfl-v)/zl)}DERIVATIVEstates{rates(v)n'=(ninf-n)/taunlv'=(linf-lv)/taullci(cai)lc'=(lcinf-lc)/tauc}PROCEDURErates(v(mV)){LOCALaTABLEninf,taun,linf,taulDEPENDvhalfn,tlmax,tnmax,tnminFROM-100TO50WITH600a=alpn(v)ninf=1/(1+a)taun=4*(tnmax-tnmin)/(1+betn(v))*ninf+tnmina=alpl(v)linf=(1/(1+a))taul=2*tlmax/(exp((v-vl2)/tls)+exp((vl2-v)/tls))+tlmin}PROCEDURElci(cai(mM)){TABLElcinfDEPENDlcp,kD_caFROM0TO0.01WITH1000lcinf=(1-(cai/(cai+kD_ca))^(lcp/2))^lcp}