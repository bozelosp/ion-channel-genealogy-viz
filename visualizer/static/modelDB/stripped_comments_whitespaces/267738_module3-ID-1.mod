NEURON{SUFFIXfHillRANGEF_norm,Kse,p0_5RANGEg1,g2,g3RANGEa0,b0,c0,d0USEIONmgREADmgiVALENCE2USEIONclREADcli}PARAMETER{Kse=0.16p0_5=100.3g1=-0.0045g2=0.0981g3=0.6211a0=0.4b0=99.7c0=-57.1d0=42.2xm_init=5xce_init=5}STATE{Axcexm}ASSIGNED{F_normFc_normmgicli}BREAKPOINT{LOCALd_xm,d_xce,d_seA=mgixm=cliSOLVEstate_hillMETHODcnexpF_norm=p0_5*Kse*xse(xm,xce)/p0_5}DERIVATIVEstate_hill{Fc_norm=p0_5*g(xm)*A/p0_5xce'=dxdt(F_norm,Fc_norm)}FUNCTIONxse(x,y){LOCALd_xm,d_xce,d_sed_xm=xm-xm_initd_xce=xce-xce_initd_se=d_xm-d_xceif(d_se<=0){xse=0}else{xse=d_se}}FUNCTIONg(x){g=g1*x^2+g2*x+g3}FUNCTIONdxdt(x,xc){LOCALgain_lengthif(x<=xc){dxdt=(10^-3)*(-b0*(xc-x))/(x+a0*xc/p0_5)}else{gain_length=(-d0*(xc-x))/(2*xc-x+c0*xc/p0_5)if(gain_length<=0){dxdt=(10^-3)*1e5}else{dxdt=(10^-3)*gain_length}}}INITIAL{A=0xm=xm_initxce=xce_initF_norm=1e-5}