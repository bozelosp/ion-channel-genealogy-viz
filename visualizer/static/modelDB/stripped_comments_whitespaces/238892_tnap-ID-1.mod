NEURON{SUFFIXtnapUSEIONnaREADenaWRITEinaRANGEminf,hinf,tauh,ina,gnap}ASSIGNED{ina(mA/cm2)ena(mV)v(mV)minfhinftauh}PARAMETER{gnap=0.4taubar=10000thmp=-40sigmp=6thhp=-48sighp=-6vt=-49sig=6phih=0.05}STATE{h}BREAKPOINT{SOLVEstateMETHODderivimplicitina=0.001*(gnap*minf*hinf*(v-ena))}INITIAL{h=0.9751}PROCEDURErates(v(mV)){minf=1./(1.+exp(-(v-thmp)/sigmp))hinf=1./(1.+exp(-(v-thhp)/sighp))tauh=taubar/cosh((v-vt)/(2*sig))}DERIVATIVEstate{rates(v)h'=phih*(hinf-h)/tauh}