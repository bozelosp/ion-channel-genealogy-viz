UNITS{(mA)=(milliamp)(mV)=(millivolt)FARADAY=96520(coul)R=8.3134(joule/degK)KTOMV=.0853(mV/degC)}INDEPENDENT{tFROM0TO1WITH1(ms)}PARAMETER{dt(ms)v(mV)tBase=23.5(degC)celsius=22(degC)gcatbar=0(mho/cm2)ki=.001(mM)cai=5.e-5(mM)cao=2(mM)eca=140VhalfH=-85VhalfM=-47gh=0.4zh=5gm=0.40zm=5aoh=0.3aom=0.03tfi=10tfa=1ktadjtaumtauh}NEURON{SUFFIXmycatUSEIONcaREADcai,caoWRITEicaRANGEgcatbar,hinf,minf,taum,tauh,ica}STATE{mh}ASSIGNED{ica(mA/cm2)gcat(mho/cm2)minfhinf}INITIAL{k=1000*8.3134*(celsius+273.15)/96520tadj=3^((celsius-tBase)/10)rates(v)m=minfh=hinfgcat=gcatbar*m*m*h*h2(cai)}BREAKPOINT{SOLVEstatesgcat=gcatbar*m*m*h*h2(cai)ica=gcat*ghk(v,cai,cao)}UNITSOFFFUNCTIONh2(cai(mM)){h2=ki/(ki+cai)}FUNCTIONghk(v(mV),ci(mM),co(mM))(mV){LOCALnu,ff=KTF(celsius)/2nu=v/fghk=-f*(1.-(ci/co)*exp(nu))*efun(nu)}FUNCTIONKTF(celsius(degC))(mV){KTF=((25./293.15)*(celsius+273.15))}FUNCTIONefun(z){if(fabs(z)<1e-4){efun=1-z/2}else{efun=z/(exp(z)-1)}}FUNCTIONalph(v(mV)){TABLEFROM-150TO150WITH200alph=aoh*exp(-gh*zh*(v-VhalfH)/k)}FUNCTIONbeth(v(mV)){TABLEFROM-150TO150WITH200beth=(aoh/10)*exp((1-gh)*zh*(v-VhalfH)/k)}FUNCTIONalpm(v(mV)){TABLEFROM-150TO150WITH200alpm=aom*exp((1-gm)*zm*(v-VhalfM)/k)}FUNCTIONbetm(v(mV)){TABLEFROM-150TO150WITH200betm=aom*exp(-gm*zm*(v-VhalfM)/k)}UNITSONLOCALfacm,fachPROCEDUREstates(){rates(v)m=m+facm*(minf-m)h=h+fach*(hinf-h)VERBATIMreturn0;ENDVERBATIM}PROCEDURErates(v(mV)){LOCALaa=alpm(v)taum=20minf=a/(a+betm(v))facm=(1-exp(-dt/taum))a=alph(v)tauh=60hinf=a/(a+beth(v))fach=(1-exp(-dt/tauh))}