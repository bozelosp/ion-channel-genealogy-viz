NEURON{SUFFIXCav3_3USEIONcaREADcai,caoWRITEicaRANGEgCav3_3bar,pcabar,ica,tau_l,tau_n,n_inf,l_inf}UNITS{(S)=(siemens)(mV)=(millivolt)(mA)=(milliamp)}PARAMETER{gCav3_3bar=0.00001(S/cm2)vhalfn=-41.5vhalfl=-69.8kn=6.2kl=-6.1q10=2.3pcabar=0.0001z=2F=96520R=8.3134PI=3.14}ASSIGNED{v(mV)ica(mA/cm2)gCav3_3(S/cm2)n_inftau_nl_inftau_lcai(mM)cao(mM)qtTghkw}STATE{nl}BREAKPOINT{SOLVEstatesMETHODcnexpica=gCav3_3bar*pcabar*n*n*l*ghk}DERIVATIVEstates{rates()n'=(n_inf-n)/tau_nl'=(l_inf-l)/tau_l}INITIAL{T=celsius+273.14qt=pow(q10,(celsius-28)/10)rates()n=n_infl=l_inf}PROCEDURErates(){n_inf=1/(1+exp(-(v-vhalfn)/kn))l_inf=1/(1+exp(-(v-vhalfl)/kl))if(v>-60){tau_n=(7.2+0.02*exp(-v/14.7))/qttau_l=(79.5+2.0*exp(-v/9.3))/qt}else{tau_n=(0.875*exp((v+120)/41))/qttau_l=260/qt}w=v*0.001*z*F/(R*T)ghk=-0.001*z*F*(cao-cai*exp(w))*w/(exp(w)-1)}