INDEPENDENT{tFROM0TO1WITH1(ms)}NEURON{SUFFIXitUSEIONcaREADcai,caoWRITEicaRANGEgcabar,m_inf,tau_m,alph1,alph2,KK,shift}UNITS{(molar)=(1/liter)(mM)=(millimolar)(mA)=(milliamp)(mV)=(millivolt)FARADAY=(faraday)(coulomb)R=(k-mole)(joule/degC)}PARAMETER{v(mV)celsius=36(degC)gcabar=.0008(mho/cm2)shift=2(mV)cai=2.4e-4(mM)cao=2(mM)}STATE{mhd}ASSIGNED{ica(mA/cm2)carev(mV)m_inftau_m(ms)alph1(/ms)alph2(/ms)KKphi_mphi_h}BREAKPOINT{SOLVEstatesMETHODrungecarev=(1e3)*(R*(celsius+273.15))/(2*FARADAY)*log(cao/cai)ica=gcabar*m*m*m*h*(v-carev)}DERIVATIVEstates{evaluate_fct(v)m'=(m_inf-m)/tau_mh'=alph1*((1-h-d)-KK*h)d'=alph2*(KK*(1-h-d)-d)}UNITSOFFINITIAL{evaluate_fct(v)m=m_infh=1./(1.+KK+KK*KK)d=KK*KK/(1+KK+KK*KK)phi_m=5.0^((celsius-24)/10)phi_h=3.0^((celsius-24)/10)}PROCEDUREevaluate_fct(v(mV)){LOCALtau2m_inf=1/(1+exp(-(v+shift+63)/7.8))tau_m=m_inf*(1.7+exp(-(v+shift+28.8)/13.5))/phi_malph1=phi_h*exp(-(v+shift+160.3)/17.8)KK=sqrt(0.25+exp((v+shift+83.5)/6.3))-0.5tau2=240.0/(1+exp((v+shift+37.4)/30))/phi_halph2=1/(tau2*(KK+1))}UNITSON