INDEPENDENT{tFROM0TO1WITH1(ms)}NEURON{SUFFIXcatUSEIONcaREADeca,cai,caoWRITEicaRANGEm,h,hs,gcat,gbar,icaEXTERNALapc_metap,fpc_metapGLOBALvhm,vhh,vhhs,km,kh,khsGLOBALtm0,th0,ths0,vhtm,vhth,atm,ath,Ctm,CthRANGEminf,hinf,hsinf,mtau,htau,hstauGLOBALq10,tadjGLOBALVhalf,taumod}PARAMETER{gbar=1(cm/s)Vhalf=-40(mV)taumod=1cai(mM)cao(mM)vhm=-54.5(mV)km=5(mV)vhh=-64.5(mV)kh=-1.6(mV)vhhs=-64.5(mV)khs=-1.6(mV)tm0=3.2th0=76ths0=600vhtm=-40(mV)vhth=-46(mV)atm=4.6ath=8.85Ctm=19Cth=43temp=33(degC)q10=3.0v(mV)dt(ms)celsius(degC)tadj=1}UNITS{(mA)=(milliamp)(mV)=(millivolt)F=9.6485e4(coul)R=8.3145(joule/degC)(S)=(siemens)(mM)=(milli/liter)(pS)=(picosiemens)(um)=(micron)}ASSIGNED{ica(mA/cm2)gca(cm/s)eca(mV)minfhinfhsinfmtau(ms)htau(ms)hstau(ms)T(degC)E(volts)z}STATE{mhhs}INITIAL{setVhalf(Vhalf)setTauMod(taumod)m=minf_cat(v)h=hinf_cat(v)hs=hsinf_cat(v)tadj=tadj_ca_t()}BREAKPOINT{SOLVEstatesMETHODcnexpgca=gbar*m*m*m*((0.6*h)+(0.4*hs))ica=gca*ghk(v,cai,cao)}FUNCTIONghk(v(mV),ci(mM),co(mM))(mV){LOCALnu,ff=KTF(celsius)/2nu=v/fghk=-f*(1.-(ci/co)*exp(nu))*efun(nu)}FUNCTIONKTF(celsius(degC))(mV){KTF=((25.26(mV)/293.15(degC))*(celsius+273.15(degC)))}FUNCTIONefun(z){if(fabs(z)<1e-4){efun=1-z/2}else{efun=z/(exp(z)-1)}}DERIVATIVEstates{m'=-(m-minf_cat(v))/(tadj*taum_cat(v))h'=-(h-hinf_cat(v))/(tadj*tauh_cat(v))hs'=-(hs-hsinf_cat(v))/(tadj*tauhs_cat(v))}FUNCTIONboltz(x,y,z){boltz=1/(1+exp(-(x-y)/z))}FUNCTIONminf_cat(v(mV))(1){minf_cat=boltz(v,vhm,km)}FUNCTIONtaum_cat(v(mV))(1/ms){taum_cat=tm0+Ctm/(1+exp((v-vhtm)/atm))}FUNCTIONhinf_cat(v(mV))(1){hinf_cat=(boltz(v,vhh,kh))}FUNCTIONtauh_cat(v(mV))(1/ms){tauh_cat=th0+Cth/(1+exp((v-vhth)/ath))}FUNCTIONhsinf_cat(v(mV))(1){hsinf_cat=(boltz(v,vhhs,khs))}FUNCTIONtauhs_cat(v(mV))(1/ms){tauhs_cat=ths0}FUNCTIONtadj_ca_t(){tadj_ca_t=1/(q10^((celsius-temp)/10))}PROCEDUREsetVhalf(Vhalf(mV)){vhm=Vhalfvhh=Vhalf-10vhhs=Vhalf-10vhtm=Vhalf+14.5vhth=Vhalf+8.5}PROCEDUREsetTauMod(taumod){tm0=3.2*taumodth0=76*taumodths0=600*taumodCtm=19*taumodCth=43*taumod}