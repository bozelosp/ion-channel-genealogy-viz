NEURON{POINT_PROCESSExp3NMDA2NONSPECIFIC_CURRENTiRANGEtau1_0,a1,tau2_0,a2,tauV,e,i,gVI,st_gVD,v0_gVD,Mg,K0,delta,wfGLOBALinf,tau1,tau2THREADSAFE}UNITS{(nA)=(nanoamp)(mV)=(millivolt)(uS)=(microsiemens)(mM)=(milli/liter)(S)=(siemens)(pS)=(picosiemens)(um)=(micron)(J)=(joules)}PARAMETER{tau1_0=2.2340(ms)a1=0.0896(ms)b1=0.0324(1/mV)tau2_0=62.5808(ms)a2=10.0374(ms)b2=0.0239(1/mV)tauV=7(ms)<1e-9,1e9>st_gVD=0.007(1/mV)v0_gVD=-100(mV)gVI=1(uS)Q10=1.52T0=26(degC)celsius(degC)Mg=1(mM)K0=4.1(mM)delta=0.8(1)e=-0.7(mV)}CONSTANT{T=273.16(degC)F=9.648e4(coul)R=8.315(J/degC)z=2(1)}ASSIGNED{v(mV)dt(ms)i(nA)g(uS)factorwfinf(uS)tau(ms)tau1(ms)tau2(ms)}STATE{ABCgVD(uS)}INITIAL{LOCALtprates(v)if(tau1/tau2>.9999){tau1=.9999*tau2}A=0B=0tp=(tau1*tau2)/(tau2-tau1)*log(tau2/tau1)factor=-exp(-tp/tau1)+exp(-tp/tau2)factor=1/factortau=tauV*Q10^((T0-celsius)/10(degC))gVD=0wf=1Mgblock(v)}BREAKPOINT{SOLVEstateMETHODrungei=(B-A)*(gVI+gVD)*Mgblock(v)*(v-e)}DERIVATIVEstate{rates(v)A'=-A/tau1B'=-B/tau2gVD'=(B/wf)*(inf-gVD)/tau}NET_RECEIVE(weight){wf=weight*factorA=A+wfB=B+wf}FUNCTIONMgblock(v(mV)){Mgblock=1/(1+(Mg/K0)*exp((0.001)*(-z)*delta*F*v/R/(T+celsius)))}PROCEDURErates(v(mV)){tau1=tau1_0+a1*exp(-b1*v)tau2=tau2_0+a2*(1-exp(-b2*v))if(tau1/tau2>.9999){tau1=.9999*tau2}inf=(v-v0_gVD)*st_gVD*gVIif(t>520&&t<590){gVD=0A=0B=0}}