NEURON{SUFFIXnaxPOINTERstim_iUSEIONnaREADenaWRITEinaRANGEflag,curr,gbar,sh,ena2,alpha,vrun,count,vvrun,delta2,vrun2,stim_moltNa,flagGLOBALminf,hinf,mtau,htau,thinf,qinf,sh2}PARAMETER{currsh=0(mV)gbar=0.010(mho/cm2)tha=-30(mV)qa=7.5(mV)Ra=0.4(/ms)Rb=0.124(/ms)thi1=-45(mV)thi2=-45(mV)qd=1.5(mV)qg=1.5(mV)mmin=0.02hmin=0.5q10=2Rg=0.01(/ms)Rd=.03(/ms)thinf=-53(mV)qinf=2(mV)ena(mV)ena2(mV)celsiusv(mV)vinit=-76.2(mV)delta=0count=1time0=100time1=600sh2alphash0=0.1alphash1=0.13alphaena=0.25count2=1vvrun=0timestep=1000vrun2v0dv0ddvflag=0FNa=2PNa=1BNa=2.6CNa=60stim_moltNa=1}UNITS{(mA)=(milliamp)(mV)=(millivolt)(pS)=(picosiemens)(um)=(micron)}ASSIGNED{ina(mA/cm2)thegna(mho/cm2)minfhinfmtau(ms)htau(ms)vrunstim_i}STATE{mh}BREAKPOINT{SOLVEstatesMETHODcnexpthegna=gbar*m*m*m*hena2=ena-alphaena*vvrunina=thegna*(v-ena2)}INITIAL{trates(v,sh2)m=minfh=hinfvrun=0vvrun=vrun}DERIVATIVEstates{trates(v,sh2)m'=(minf-m)/mtauh'=(hinf-h)/htau}BEFORESTEP{LOCALiif(stim_i==0&&flag==0){vrun=0vvrun=0}else{flag=1delta=v-vinitif(count<timestep+1){vrun=(delta-vrun)*(FNa/(count+1))+vrunvrun2=vrun}else{vrun2=(delta)*(FNa/(timestep+1))+vrun2*pow((1-FNa/(timestep+1)),PNa)}vvrun=(BNa*vrun2/(1+vrun2/CNa))count=count+1}sh2=sh+alphash1*vvrun}PROCEDUREtrates(vm,sh2){LOCALa,b,qt,iqt=q10^((celsius-24)/10)a=trap0(vm,tha+sh2,Ra,qa)b=trap0(-vm,-tha-sh2,Rb,qa)mtau=1/(a+b)/qtif(mtau<mmin){mtau=mmin}minf=a/(a+b)a=trap0(vm,thi1+sh2,Rd,qd)b=trap0(-vm,-thi2-sh2,Rg,qg)htau=1/(a+b)/qtif(htau<hmin){htau=hmin}hinf=1/(1+exp((vm-thinf-sh2)/qinf))}FUNCTIONtrap0(v,th,a,q){if(fabs(v-th)>1e-6){trap0=a*(v-th)/(1-exp(-(v-th)/q))}else{trap0=a*q}}