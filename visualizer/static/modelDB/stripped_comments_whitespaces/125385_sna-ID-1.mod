INDEPENDENT{tFROM0TO1WITH1(ms)}NEURON{SUFFIXsnaUSEIONnaREADenaWRITEinaGLOBALminf,hinf,mtau,htau,am,bm,ah,bhRANGEN,reff,eta,gamma,deterministic,gnaGLOBALP_am,P_bm,P_ah,P_bh,hinf_curveGLOBALtha,thi1,thi2,qa,qi,qinf,thinf,vshiftGLOBALRa,Rb,Rd,RgGLOBALvmin,vmax,q10,orig_temp,wflag,tadjGLOBALDONT_VECTORIZE}UNITS{(mA)=(milliamp)(mV)=(millivolt)(pS)=(picosiemens)(um)=(micron)}PARAMETER{v(mV)dt(ms)areavshift=-10(mV)tha=-35(mV)qa=9(mV)Ra=0.182(/ms)Rb=0.124(/ms)thi1=-50(mV)thi2=-75(mV)qi=5(mV)hinf_curve=1thinf=-65(mV)qinf=6.2(mV)Rg=0.0091(/ms)Rd=0.024(/ms)gamma=20(pS)eta=50(1/um2)celsius(degC)orig_temp=23(degC)q10=2.3deterministic=0vmin=-120(mV)vmax=100(mV)DONT_VECTORIZE}ASSIGNED{ina(mA/cm2)gna(pS/um2)ena(mV)am(/ms)bm(/ms)ah(/ms)bh(/ms)minfhinfmtau(ms)htau(ms)tadjNreff(pS/um2)scale_dens(pS/um2)P_amP_bmP_ahP_bhwflag}STATE{mhm0h0m0h1m1h0m1h1m2h0m2h1m3h0m3h1m0h0_m1h0m1h0_m2h0m2h0_m3h0m0h1_m1h1m1h1_m2h1m2h1_m3h1m3h0_m2h0m2h0_m1h0m1h0_m0h0m3h1_m2h1m2h1_m1h1m1h1_m0h1m0h0_m0h1m0h1_m0h0m1h0_m1h1m1h1_m1h0m2h0_m2h1m2h1_m2h0m3h0_m3h1m3h1_m3h0}INITIAL{trates(v+vshift)wflag=1m=minfh=hinfscale_dens=gamma/areareff=gamma*etaN=floor(eta*area+0.5)m1h0=floor(3*m*(1-m)*(1-m)*(1-h)*N+0.5)m2h0=floor(3*m*m*(1-m)*(1-h)*N+0.5)m3h0=floor(m*m*m*(1-h)*N+0.5)m0h1=floor((1-m)*(1-m)*(1-m)*h*N+0.5)m1h1=floor(3*m*(1-m)*(1-m)*h*N+0.5)m2h1=floor(3*m*m*(1-m)*h*N+0.5)m3h1=floor(m*m*m*h*N+0.5)m0h0=N-(m1h0+m2h0+m3h0+m0h1+m1h1+m2h1+m3h1)m0h0_m1h0=0m1h0_m2h0=0m2h0_m3h0=0m0h1_m1h1=0m1h1_m2h1=0m2h1_m3h1=0m3h0_m2h0=0m2h0_m1h0=0m1h0_m0h0=0m3h1_m2h1=0m2h1_m1h1=0m1h1_m0h1=0m0h0_m0h1=0m0h1_m0h0=0m1h0_m1h1=0m1h1_m1h0=0m2h0_m2h1=0m2h1_m2h0=0m3h0_m3h1=0m3h1_m3h0=0}BREAKPOINT{SOLVEstatesif(deterministic){if(deterministic-1){gna=m*m*m*h*reff*tadj}else{gna=floor(m*m*m*h*N+0.5)*scale_dens*tadj}}else{gna=strap(m3h1)*scale_dens*tadj}ina=(1e-4)*gna*(v-ena)}PROCEDUREstates(){VERBATIMexterndoubleBnlDev_RNG();ENDVERBATIMtrates(v+vshift)m=m+(1-exp(-dt/mtau))*(minf-m)h=h+(1-exp(-dt/htau))*(hinf-h)P_am=strap(am*dt)P_bm=strap(bm*dt)ChkProb(3.0*P_am)ChkProb(3.0*P_bm)ChkProb(P_bm/(1.0-2.0*P_am))ChkProb(2.0*P_bm/(1.0-P_am))m0h0_m1h0=BnlDev_RNG(3.0*P_am,m0h0)m1h0_m2h0=BnlDev_RNG(2.0*P_am,m1h0)m1h0_m0h0=BnlDev_RNG(P_bm/(1.0-2.0*P_am),m1h0-m1h0_m2h0)m2h0_m3h0=BnlDev_RNG(P_am,m2h0)m2h0_m1h0=BnlDev_RNG(2.0*P_bm/(1.0-P_am),m2h0-m2h0_m3h0)m3h0_m2h0=BnlDev_RNG(3.0*P_bm,m3h0)m0h1_m1h1=BnlDev_RNG(3.0*P_am,m0h1)m1h1_m2h1=BnlDev_RNG(2.0*P_am,m1h1)m1h1_m0h1=BnlDev_RNG(P_bm/(1.0-2.0*P_am),m1h1-m1h1_m2h1)m2h1_m3h1=BnlDev_RNG(P_am,m2h1)m2h1_m1h1=BnlDev_RNG(2.0*P_bm/(1.0-P_am),m2h1-m2h1_m3h1)m3h1_m2h1=BnlDev_RNG(3.0*P_bm,m3h1)m0h0=m0h0-m0h0_m1h0+m1h0_m0h0m1h0=m1h0-m1h0_m2h0-m1h0_m0h0+m2h0_m1h0+m0h0_m1h0m2h0=m2h0-m2h0_m3h0-m2h0_m1h0+m3h0_m2h0+m1h0_m2h0m3h0=m3h0-m3h0_m2h0+m2h0_m3h0m0h1=m0h1-m0h1_m1h1+m1h1_m0h1m1h1=m1h1-m1h1_m2h1-m1h1_m0h1+m2h1_m1h1+m0h1_m1h1m2h1=m2h1-m2h1_m3h1-m2h1_m1h1+m3h1_m2h1+m1h1_m2h1m3h1=m3h1-m3h1_m2h1+m2h1_m3h1P_ah=strap(ah*dt)P_bh=strap(bh*dt)ChkProb(P_ah)ChkProb(P_bh)m0h0_m0h1=BnlDev_RNG(P_ah,m0h0)m0h1_m0h0=BnlDev_RNG(P_bh,m0h1)m1h0_m1h1=BnlDev_RNG(P_ah,m1h0)m1h1_m1h0=BnlDev_RNG(P_bh,m1h1)m2h0_m2h1=BnlDev_RNG(P_ah,m2h0)m2h1_m2h0=BnlDev_RNG(P_bh,m2h1)m3h0_m3h1=BnlDev_RNG(P_ah,m3h0)m3h1_m3h0=BnlDev_RNG(P_bh,m3h1)m0h0=m0h0-m0h0_m0h1+m0h1_m0h0m1h0=m1h0-m1h0_m1h1+m1h1_m1h0m2h0=m2h0-m2h0_m2h1+m2h1_m2h0m3h0=m3h0-m3h0_m3h1+m3h1_m3h0m0h1=m0h1-m0h1_m0h0+m0h0_m0h1m1h1=m1h1-m1h1_m1h0+m1h0_m1h1m2h1=m2h1-m2h1_m2h0+m2h0_m2h1m3h1=m3h1-m3h1_m3h0+m3h0_m3h1}PROCEDUREtrates(vm){TABLEminf,mtau,hinf,htau,am,bm,ah,bh,tadjDEPENDdt,Ra,Rb,Rd,Rg,tha,thi1,thi2,qa,qi,qinf,q10,orig_temp,celsius,hinf_curveFROMvminTOvmaxWITH199tadj=q10^((celsius-orig_temp)/10)am=SigmoidRate(vm,tha,Ra,qa)am=am*tadjbm=SigmoidRate(-vm,-tha,Rb,qa)bm=bm*tadjmtau=1/(am+bm)minf=am*mtauah=SigmoidRate(vm,thi1,Rd,qi)ah=ah*tadjbh=SigmoidRate(-vm,-thi2,Rg,qi)bh=bh*tadjhtau=1/(ah+bh)if(hinf_curve==0){hinf=ah*htau}else{hinf=1/(1+exp((vm-thinf)/qinf))ah=hinf/htaubh=1/htau-ah}}FUNCTIONSigmoidRate(v,th,a,q){if(fabs(v-th)>1e-6){SigmoidRate=a*(v-th)/(1-exp(-(v-th)/q))}else{SigmoidRate=a*q}}FUNCTIONstrap(x){if(x<0){strap=0if(wflag){VERBATIMfprintf(stderr,"sna.mod:strap:negativevalueforstate");ENDVERBATIMwflag=0}}else{strap=x}}PROCEDUREChkProb(p){if(p<0.0||p>1.0){if(wflag){VERBATIMfprintf(stderr,"sna.mod:ChkProb:argumentnotaprobability.\n");ENDVERBATIMwflag=0}}}