UNITS{(mA)=(milliamp)(mV)=(millivolt)}PARAMETER{flag=0currv(mV)ek(mV)celsius(degC)gkdbar=.0(mho/cm2)vhalfn=-33(mV)a0n=0.01(/ms)zetan=3(1)gmn=0.7(1)nmax=2(1)q10=1sh=0ek2(mV)count=1vrun(mV)vvrun=0vrun2delta=0vinit=0(mV)alpha=1.06sh2=0alphash0=0alphash1=0.15FK=2PK=1BK=2.11CK=48timestep=1000stim_moltK=1}NEURON{SUFFIXkdPOINTERstim_iUSEIONkREADekWRITEikRANGEflag,curr,gkd,gkdbar,sh,ek2,vvrun,vrun2,stim_moltKGLOBALninf,taun,alpha}STATE{n}ASSIGNED{ik(mA/cm2)ninfgkdtaunstim_i}BREAKPOINT{SOLVEstatesMETHODcnexpgkd=gkdbar*nek2=ek+vvrun*alphaik=gkd*(v-ek2)}INITIAL{rates(v)n=ninf}FUNCTIONalpn(v(mV)){alpn=exp(1.e-3*zetan*(v-vhalfn)*9.648e4/(8.315*(273.16+celsius)))}FUNCTIONbetn(v(mV)){betn=exp(1.e-3*zetan*gmn*(v-vhalfn)*9.648e4/(8.315*(273.16+celsius)))}DERIVATIVEstates{rates(v)n'=(ninf-n)/taun}BEFORESTEP{LOCALiif(stim_i==0&&flag==0){vrun=0vvrun=0}else{flag=1delta=v-vinitif(count<timestep+1){vrun=(delta-vrun)*(FK/(count+1))+vrunvrun2=vrun}else{vrun2=(delta)*(FK/(timestep+1))+vrun2*pow((1-FK/(timestep+1)),PK)}vvrun=(BK*vrun2/(1+vrun2/CK))count=count+1}sh2=sh+alphash1*vvrun}PROCEDURErates(v(mV)){LOCALa,qtqt=q10^((celsius-24)/10)a=alpn(v-sh2)ninf=1/(1+a)taun=betn(v-sh2)/(qt*a0n*(1+a))if(taun<nmax){taun=nmax/qt}}