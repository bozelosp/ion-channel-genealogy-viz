INDEPENDENT{tFROM0TO1WITH1(ms)}NEURON{SUFFIXnatUSEIONnaREADenaWRITEinaRANGEm,h,gna,gbar,vshift,vshift2,timefactor_m,timefactor_h,gbarfactor,inaGLOBALtha,thi1,thi2,qa,qi,qinf,thinfRANGEminf,hinf,mtau,htauGLOBALRa,Rb,Rd,RgGLOBALq10,temp,tadj,vmin,vmax}PARAMETER{gbar=0(pS/um2)vshift=0(mV)vshift2=0(mV)tha=-28(mV)qa=9(mV)Ra=0.182(/ms)Rb=0.124(/ms)thi1=-50(mV)thi2=-75(mV)qi=5(mV)thinf=-55(mV)qinf=6.2(mV)Rg=0.0091(/ms)Rd=0.024(/ms)temp=23(degC)q10=2.3v(mV)dt(ms)celsius(degC)vmin=-120(mV)vmax=100(mV)gbarfactor=1timefactor_m=1timefactor_h=1}UNITS{(mA)=(milliamp)(mV)=(millivolt)(pS)=(picosiemens)(um)=(micron)}ASSIGNED{ina(mA/cm2)gna(pS/um2)ena(mV)minfhinfmtau(ms)htau(ms)tadj}STATE{mh}INITIAL{trates(v-vshift-vshift2)m=minfh=hinf}BREAKPOINT{SOLVEstatesMETHODcnexpgna=gbarfactor*tadj*gbar*m*m*m*hina=(1e-4)*gna*(v-ena)}LOCALmexp,hexpDERIVATIVEstates{trates(v-vshift-vshift2)m'=(minf-m)/(timefactor_m*mtau)h'=(hinf-h)/(timefactor_h*htau)}PROCEDUREtrates(v){TABLEminf,hinf,mtau,htauDEPENDcelsius,temp,Ra,Rb,Rd,Rg,tha,thi1,thi2,qa,qi,qinfFROMvminTOvmaxWITH199rates(v)}PROCEDURErates(vm){LOCALa,ba=trap0(vm,tha,Ra,qa)b=trap0(-vm,-tha,Rb,qa)tadj=q10^((celsius-temp)/10)mtau=1/tadj/(a+b)minf=a/(a+b)a=trap0(vm,thi1,Rd,qi)b=trap0(-vm,-thi2,Rg,qi)htau=1/tadj/(a+b)hinf=1/(1+exp((vm-thinf)/qinf))}FUNCTIONtrap0(v,th,a,q){if(fabs(v/th)>1e-6){trap0=a*(v-th)/(1-exp(-(v-th)/q))}else{trap0=a*q}}