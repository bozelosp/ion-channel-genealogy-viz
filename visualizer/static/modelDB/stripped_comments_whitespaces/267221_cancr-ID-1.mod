NEURON{SUFFIXcancrUSEIONcaREADcai,ecaWRITEicaRANGEgcabar,ica}UNITS{(mA)=(milliamp)(mV)=(millivolt)(S)=(siemens)(molar)=(1/liter)(mM)=(millimolar)FARADAY=(faraday)(kilocoulombs)R=(k-mole)(joule/degC)}PARAMETER{gcabar=0(S/cm2)ki=0.025(mM)zetam=-3.4zetah=2vhalfm=-21(mV)vhalfh=-40(mV)cst=1(/ms)tm0=1.5(ms)th0=75(ms)taumin=2(ms)}ASSIGNED{v(mV)celsius(degC)ica(mA/cm2)cai(mM)eca(mV)minf(1)hinf(1)sinf(1)}STATE{mhs}BREAKPOINT{SOLVEstatesMETHODcnexpica=gcabar*pow(m,2)*h*h2(cai)*(v-eca)}DERIVATIVEstates{rates(v,cai)m'=(minf-m)/tm0h'=(hinf-h)/th0s'=(sinf-s)/taumin}INITIAL{rates(v,cai)m=minfh=hinfs=sinf}FUNCTIONh2(ci(mM)){h2=ki/(ki+ci)}FUNCTIONalpm(v(mV))(/ms){alpm=1(/ms)*exp(zetam*(v-vhalfm)*FARADAY/(R*(273.16(degC)+celsius)))}FUNCTIONalph(v(mV))(/ms){alph=1(/ms)*exp(zetah*(v-vhalfh)*FARADAY/(R*(273.16(degC)+celsius)))}PROCEDURErates(v(mV),cai(mM)){minf=cst/(cst+alpm(v))hinf=cst/(cst+alph(v))sinf=(ki/cai)^2/((ki/cai)^2+1)}