UNITS{(mA)=(milliamp)(mV)=(millivolt)}PARAMETER{currv(mV)ehd=-30(mV)celsius(degC)ghdbar=.0001(mho/cm2)vhalfl=-81(mV)kl=-8vhalft=-75(mV)a0t=0.011(/ms)zetat=2.2(1)gmt=.4(1)q10=4.5qtl=1sh=0(mV)time1=600time0=100alphash0=0alphash1=0.13alphahd=0.3ehd2sh2count=1vrun(mV)delta=0vinit=-76.2vvrun=0timestep=1000vrun2v0dv0ddvflag=0FNa=2PNa=1BNa=2.6CNa=60stim_moltNa=1}NEURON{SUFFIXhdPOINTERstim_iNONSPECIFIC_CURRENTiRANGEflag,curr,ghdbar,vhalfl,sh,count,delta2,vrun2,stim_moltNa,ehd2GLOBALlinf,taul}STATE{l}ASSIGNED{i(mA/cm2)linftaulghdstim_i}INITIAL{rate(v,sh2)l=linfvrun=0vvrun=vrun}BREAKPOINT{SOLVEstatesMETHODcnexpghd=ghdbar*lehd2=ehd-alphahd*vvruni=ghd*(v-ehd2)}FUNCTIONalpt(v(mV)){alpt=exp(0.0378*zetat*(v-vhalft))}FUNCTIONbett(v(mV)){bett=exp(0.0378*zetat*gmt*(v-vhalft))}DERIVATIVEstates{rate(v,sh2)l'=(linf-l)/taul}BEFORESTEP{LOCALiif(stim_i==0&&flag==0){vrun=0vvrun=0}else{flag=1delta=v-vinitif(count<timestep+1){vrun=(delta-vrun)*(FNa/(count+1))+vrunvrun2=vrun}else{vrun2=(delta)*(FNa/(timestep+1))+vrun2*pow((1-FNa/(timestep+1)),PNa)}vvrun=(BNa*vrun2/(1+vrun2/CNa))count=count+1}sh2=sh+alphash1*vvrun}PROCEDURErate(v(mV),sh2){LOCALa,qt,iqt=q10^((celsius-33)/10)a=alpt(v-sh2)linf=1/(1+exp(-(v-vhalfl-sh2)/kl))taul=bett(v-sh2)/(qtl*qt*a0t*(1+a))}