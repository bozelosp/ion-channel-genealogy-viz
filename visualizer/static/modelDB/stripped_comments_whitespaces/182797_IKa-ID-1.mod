UNITS{(mA)=(milliamp)(mV)=(millivolt)}NEURON{SUFFIXIkaUSEIONkREADekWRITEikRANGEgbar,ikGLOBALminf,hinf,htau,mtau}PARAMETER{gbar=0.0002(mho/cm2)celsius(degC)ek(mV)v(mV)a0h=0.17vhalfh=-105(mV)q10=3hmin=5(ms)}ASSIGNED{ik(mA/cm2)minfmtau(ms)hinfhtau(ms)}INITIAL{trates(v)m=minfh=hinf}STATE{mh}BREAKPOINT{SOLVEstateMETHODcnexpik=gbar*m*h*(v-ek)}DERIVATIVEstate{trates(v)m'=(minf-m)/mtauh'=(hinf-h)/htau}PROCEDUREtrates(v(mV)){LOCALqtqt=q10^((celsius-23(degC))/10(degC))minf=(1/(1+exp(-(v+41.4(mV))/26.6(mV))))^4mtau=0.5(ms)/qthinf=1/(1+exp((v+78.5(mV))/6(mV)))htau=a0h*1(ms/mV)*(v-vhalfh)/qtif(htau<hmin/qt){htau=hmin/qt}}