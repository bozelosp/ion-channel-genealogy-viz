VERBATIM#include<stdlib.h>ENDVERBATIMUNITS{(molar)=(1/liter)(mM)=(millimolar)(mA)=(milliamp)(mV)=(millivolt)}NEURON{SUFFIXch_KCaSUSEIONkREADekWRITEikVALENCE1USEIONcaREADcaiVALENCE2RANGEg,gmax,qinf,qtau,ikRANGEmyiTHREADSAFE}INDEPENDENT{tFROM0TO1WITH1(ms)}PARAMETER{celsius(degC)v(mV)dt(ms)gmax(mho/cm2)ek(mV)cai(mM)}STATE{q}ASSIGNED{ik(mA/cm2)g(mho/cm2)qinfqtau(ms)qexpmyi(mA/cm2)}BREAKPOINT{SOLVEstateg=gmax*q*qik=g*(v-ek)myi=ik}UNITSOFFINITIAL{rate(cai)q=qinf}PROCEDUREstate(){q=q+(qinf-q)*qexprate(cai)}LOCALq10PROCEDURErate(cai){LOCALalpha,beta,tincq10=3^((celsius-34)/10)alpha=1.25e1*cai*caibeta=0.00025qtau=1/(alpha+beta)/q10qinf=alpha*qtautinc=-dtqexp=1-exp(tinc/qtau)}UNITSON