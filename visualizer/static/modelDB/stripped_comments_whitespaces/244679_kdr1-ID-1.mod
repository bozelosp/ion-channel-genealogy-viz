UNITS{(mA)=(milliamp)(mV)=(millivolt)}NEURON{SUFFIXKdr1USEIONkWRITEikRANGEgkbar,gk,minf,hinf,mexp,hexp,ik,alpha,beta,pdr,vsh1,vsh2,hdr,pp}INDEPENDENT{tFROM0TO1WITH1(ms)}PARAMETER{v(mV)celsius=37(degC)dt(ms)gkbar=.6(mho/cm2)ek=-85(mV)pp=6pdr=1hdr=10vsh1(mV)vsh2(mV)}STATE{mh}ASSIGNED{ik(mA/cm2)gkminfhinfmexphexp}BREAKPOINT{SOLVEstatesgk=gkbar*m*m*hik=gk*(v-ek)}UNITSOFFINITIAL{rates(v,vsh1,vsh2,pdr,hdr,pp)m=minfh=hinf}PROCEDUREstates(){rates(v,vsh1,vsh2,pdr,hdr,pp)m=m+mexp*(minf-m)h=h+hexp*(hinf-h)}PROCEDURErates(v(mV),vsh1(mV),vsh2(mV),pdr,hdr,pp){LOCALq10,tinc,tauh,alpha,beta,gamma,zeta,taum,vshi1,vshi2,corrq10=3^((celsius-37)/10)tinc=-dt*q10vshi1=vsh1+vif(vshi1==8){vshi1=8.0001}alpha=-0.0047*(vshi1-8)/(exp((vshi1-8)/(-12))-0.9999)beta=exp((vshi1+127)/(-30))corr=1/(1+exp(-0.4*(v+35)))minf=(alpha/(alpha+beta))*corrgamma=-0.0047*(vshi1+12)/(exp((vshi1+12)/(-12))-0.9999)zeta=exp((vshi1+147)/(-30))taum=pdr/(gamma+zeta)mexp=1-exp(pp*tinc/taum)vshi2=vsh2+vhinf=1.0/(1+exp((vshi2+25)/4))if(v<-25){tauh=1200/hdr}else{tauh=10/hdr}hexp=1-exp(tinc/tauh)}UNITSON