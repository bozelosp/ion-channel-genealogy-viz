NEURON{SUFFIXkclUSEIONkREADki,koWRITEik,ekVALENCE1USEIONclREADcli,cloWRITEicl,eclVALENCE-1RANGEveq,gsumRANGEik,icl,Pratio,Pk,PclUSEIONnaREADnai,naoWRITEenaVALENCE1}UNITS{(mV)=(millivolt)(mA)=(milliamp)(S)=(siemens)(molar)=(1/liter)(mM)=(millimolar)FARADAY=9.6485e4(coulombs)R=8.3145(voltcoul/kelvin)(um)=(micrometer)}PARAMETER{gsum(S/cm2)veq(mV)zk=1(1)zcl=-1(1)zna=1(1)rnak=1a=150b=5c=3}ASSIGNED{ki(mM)ko(mM)cli(mM)clo(mM)nai(mM)nao(mM)ik(mA/cm2)icl(mA/cm2)Pratio(1)ek(mV)ecl(mV)ena(mV)Pcl(cm/sec)Pk(cm/sec)Gcl(secS/cm3)Gk(secS/cm3)v(mV)celsius(degC)diam(um)T(kelvin)E(volt)beta(1)vt(mV)}INITIAL{T=kelvinfkt(celsius)vt=R*T/FARADAYek=NERNST(ko,ki,zk)ecl=NERNST(clo,cli,zcl)ena=NERNST(nao,nai,zna)beta=exp(veq*(1e-3)*FARADAY/(R*T))Pratio=(cli-beta*clo)/(beta*ki-ko)Gcl=GOLDMAN(veq*(1e-3),cli,clo,zcl)/(veq-ecl)Gk=Pratio*GOLDMAN(veq*(1e-3),ki,ko,zk)/(veq-ek)Pcl=gsum/(Gcl+Gk)Pk=Pratio*Pclif(Pratio<0){Pratio=0Pk=0Pcl=(1e9)*gsum/((FARADAY*FARADAY*FARADAY*veq/(R*R*T*T))*((clo*cli)/(cli-clo)))}}BREAKPOINT{T=kelvinfkt(celsius)vt=R*T/FARADAYE=v*(1e-3)ek=NERNST(ko,ki,zk)ecl=NERNST(clo,cli,zcl)ena=NERNST(nao,nai,zna)beta=exp(veq*(1e-3)*FARADAY/(R*T))Pratio=(cli-beta*clo)/(beta*ki-ko)Gcl=GOLDMAN(veq*(1e-3),cli,clo,zcl)/(veq-ecl)Gk=Pratio*GOLDMAN(veq*(1e-3),ki,ko,zk)/(veq-ek)Pcl=gsum/(Gk+Gcl)Pk=Pratio*Pclif(Pratio<0){Pratio=0Pk=0Pcl=(1e9)*gsum/((FARADAY*FARADAY*FARADAY*veq/(R*R*T*T))*((clo*cli)/(cli-clo)))}ik=Pk*GOLDMAN(E,ki,ko,zk)icl=Pcl*GOLDMAN(E,cli,clo,zcl)}FUNCTIONGOLDMAN(V(volt),ci(mM),co(mM),z(1))(mAsec/cm3){LOCALzeta,ezetazeta=z*V/vtezeta=exp(-zeta)GOLDMAN=(z*FARADAY*zeta)*(1e-3)*(ci-co*ezeta)/(1-ezeta)}FUNCTIONkelvinfkt(t(degC))(kelvin){kelvinfkt=273.19+t}FUNCTIONNERNST(co(mM),ci(mM),z(1))(mV){NERNST=(1e3)*vt/z*log(co/ci)}