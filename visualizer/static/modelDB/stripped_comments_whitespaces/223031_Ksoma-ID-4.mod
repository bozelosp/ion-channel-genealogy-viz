UNITS{(mA)=(milliamp)(mV)=(millivolt)}NEURON{SUFFIXKsomaUSEIONkREADekWRITEikRANGEgksoma,ikGLOBALninf,nexp,ntau}INDEPENDENT{tFROM0TO1WITH1(ms)}PARAMETER{v(mV)celsius(degC)dt(ms)gksoma=.0319(mho/cm2)ek(mV)}STATE{n}ASSIGNED{ik(mA/cm2)ninfnexpntau(ms)}INITIAL{rate(v)n=ninf}BREAKPOINT{SOLVEstateMETHODcnexpik=gksoma*n*n*n*n*(v-ek)}DERIVATIVEstate{rate(v)n'=(ninf-n)/ntau}UNITSOFFPROCEDURErate(v(mV)){LOCALq10,tinc,alpha,betaTABLEninf,nexp,ntauDEPENDcelsiusFROM-200TO100WITH300q10=3^((celsius-24)/10)tinc=-dt*q10alpha=0.018*vtrap(-(v-25),25)beta=0.0036*vtrap(v-35,12)ntau=1/(alpha+beta)ninf=alpha*ntaunexp=1-exp(tinc/ntau)}FUNCTIONvtrap(x,y){if(fabs(x/y)<1e-6){vtrap=y*(1-x/y/2)}else{vtrap=x/(exp(x/y)-1)}}UNITSON