NEURON{SUFFIXfhUSEIONnaREADnai,naoWRITEinaUSEIONkREADki,koWRITEikNONSPECIFIC_CURRENTil,ipRANGEpnabar,pkbar,ppbar,gl,el,il,ipGLOBALinf,tau}UNITS{(molar)=(/liter)(mA)=(milliamp)(mV)=(millivolt)(mM)=(millimolar)FARADAY=(faraday)(coulomb)R=(k-mole)(joule/degC)}PARAMETER{v(mV)celsius(degC)pnabar=8e-3(cm/s)ppbar=.54e-3(cm/s)pkbar=1.2e-3(cm/s)nai(mM)nao(mM)ki(mM)ko(mM)gl=30.3e-3(mho/cm2)el=-69.74(mV)}STATE{mhnp}ASSIGNED{ina(mA/cm2)ik(mA/cm2)ip(mA/cm2)il(mA/cm2)inf[4]tau[4](ms)}INITIAL{mhnp(v*1(/mV))m=inf[0]h=inf[1]n=inf[2]p=inf[3]}BREAKPOINT{LOCALghknaSOLVEstatesMETHODcnexpghkna=ghk(v,nai,nao)ina=pnabar*m*m*h*ghknaip=ppbar*p*p*ghknaik=pkbar*n*n*ghk(v,ki,ko)il=gl*(v-el)}FUNCTIONghk(v(mV),ci(mM),co(mM))(.001coul/cm3){LOCALz,eci,ecoz=(1e-3)*FARADAY*v/(R*(celsius+273.15))eco=co*efun(z)eci=ci*efun(-z)ghk=(.001)*FARADAY*(eci-eco)}FUNCTIONefun(z){if(fabs(z)<1e-4){efun=1-z/2}else{efun=z/(exp(z)-1)}}DERIVATIVEstates{mhnp(v*1(/mV))m'=(inf[0]-m)/tau[0]h'=(inf[1]-h)/tau[1]n'=(inf[2]-n)/tau[2]p'=(inf[3]-p)/tau[3]}UNITSOFFFUNCTIONalp(v(mV),i){LOCALa,b,c,q10v=v+70q10=3^((celsius-20)/10)if(i==0){a=.36b=22.c=3.alp=q10*a*expM1(b-v,c)}elseif(i==1){a=.1b=-10.c=6.alp=q10*a*expM1(v-b,c)}elseif(i==2){a=.02b=35.c=10.alp=q10*a*expM1(b-v,c)}else{a=.006b=40.c=10.alp=q10*a*expM1(b-v,c)}}FUNCTIONbet(v,i){LOCALa,b,c,q10v=v+70q10=3^((celsius-20)/10)if(i==0){a=.4b=13.c=20.bet=q10*a*expM1(v-b,c)}elseif(i==1){a=4.5b=45.c=10.bet=q10*a/(exp((b-v)/c)+1)}elseif(i==2){a=.05b=10.c=10.bet=q10*a*expM1(v-b,c)}else{a=.09b=-25.c=20.bet=q10*a*expM1(v-b,c)}}FUNCTIONexpM1(x,y){if(fabs(x/y)<1e-6){expM1=y*(1-x/y/2)}else{expM1=x/(exp(x/y)-1)}}PROCEDUREmhnp(v){LOCALa,bTABLEinf,tauDEPENDcelsiusFROM-100TO100WITH200FROMi=0TO3{a=alp(v,i)b=bet(v,i)tau[i]=1/(a+b)inf[i]=a/(a+b)}}UNITSON