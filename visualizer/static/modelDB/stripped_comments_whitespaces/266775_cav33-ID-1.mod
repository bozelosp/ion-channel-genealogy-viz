UNITS{(mV)=(millivolt)(mA)=(milliamp)(S)=(siemens)(molar)=(1/liter)(mM)=(millimolar)FARADAY=(faraday)(coulomb)R=(k-mole)(joule/degC)}NEURON{SUFFIXcav33USEIONcalREADcali,caloWRITEicalVALENCE2RANGEpbar,ical,mvhalf,hvhalf,a,p,perm,I}PARAMETER{pbar=6.7e-6(cm/s)mvhalf=-73.5(mV)mslope=-4.4(mV)hvhalf=-73.4(mV)hslope=5.6(mV)a=0.9p=2}ASSIGNED{v(mV)ical(mA/cm2)ecal(mV)celsius(degC)cali(mM)calo(mM)minfhinfmtau(ms)htau(ms)htau2(ms)htot(ms)permI}STATE{mh}BREAKPOINT{SOLVEstatesMETHODcnexpperm=pbar*(m^p)*hical=ghk(v,cali,calo)*permI=ical}INITIAL{rates(v)m=minfh=hinf}DERIVATIVEstates{rates(v)m'=(minf-m)/mtauh'=(hinf-h)/htot}PROCEDURErates(v(mV)){minf=1.0/(1+exp((v-mvhalf)/mslope))hinf=1.0/(1+exp((v-hvhalf)/hslope))mtau=6.0/(1+exp((v+73.0)/14.0))+0.8/(1+exp((v-5.0)/3.0))+0.7htau=5.5/(1+exp(0.06*(v)))+7htau2=90*exp(-(v+68.0)/40.0)+10htot=a*htau+(1-a)*htau2}FUNCTIONghk(v(mV),ci(mM),co(mM))(.001coul/cm3){LOCALz,eci,ecoz=(1e-3)*2*FARADAY*v/(R*(celsius+273.15))if(z==0){z=z+1e-6}eco=co*(z)/(exp(z)-1)eci=ci*(-z)/(exp(-z)-1)ghk=(1e-3)*2*FARADAY*(eci-eco)}