NEURON{SUFFIXaccumUSEIONnaREADina,nao,naiWRITEnai,nao,inaUSEIONkREADik,ko,kiWRITEki,ko,ikUSEIONcaREADica,caiWRITEcai,cao,icaVALENCE2USEIONclREADicl,cli,cloWRITEcli,clo,iclVALENCE-1RANGEvolin,volout,volpyramRANGEnap,kp,cap,clpPOINTERdiamp,inap,ikp,icap,iclpGLOBALsetnap,setkp,setcap,setclp,TotalBuffer}UNITS{(um3)=(liter/1e15)(mV)=(millivolt)(mA)=(milliamp)FARADAY=96485.309(coul/mole)(molar)=(1/liter)(mM)=(millimolar)PI=(pi)(1)R=(k-mole)(joule/degC)}PARAMETER{Difna=0.1(um2/ms)Difk=1.96(um2/ms)Difca=0.6(um2/ms)Difcl=2.03(um2/ms)k1buf=0.0008(/ms)TotalBuffer=500(mM)x0=15(mM)nab=140(mM)kb=3.5(mM)clb=135(mM)s=2e4setvolin=1setvolout=1setvolpyram=1setnapsetkpsetcapsetclp}ASSIGNED{ina(mA/cm2)ik(mA/cm2)ica(mA/cm2)icl(mA/cm2)inap(mA/cm2)ikp(mA/cm2)icap(mA/cm2)iclp(mA/cm2)diam(um)diamp(um)naflux[3]kflux[3]caflux[3]clflux[3]dif[3]naikicaiclinaokocaoclonapkpcapclpvolinvoloutvolpyramKd(/mM)B0(mM)}STATE{na[3]k[3]ca[3]cl[3](mM)<1e-4>kbufBufferKBuffer(mM)vol[3]}BREAKPOINT{SOLVEstateMETHODsparse}INITIAL{na[0]=naina[1]=naona[2]=setnapk[0]=kik[1]=kok[2]=setkpca[0]=caica[1]=caoca[2]=setcapcl[0]=clicl[1]=clocl[2]=setclpKd=k2buf(k[1])/k1bufkbuf=0B0=TotalBuffer/(1+Kd*k[1])Buffer=B0KBuffer=TotalBuffer-B0vol[0]=setvolinvol[1]=setvoloutvol[2]=setvolpyramvolin=vol[0]volout=vol[1]volpyram=vol[2]nap=na[2]kp=k[2]cap=ca[2]clp=cl[2]}KINETICstate{COMPARTMENTi,vol[i]*diam*diam*PI/4{nakcacl}LONGITUDINAL_DIFFUSIONi,Difna*diam*diam*PI*vol[i]/4{na}LONGITUDINAL_DIFFUSIONi,Difk*diam*diam*PI*vol[i]/4{k}LONGITUDINAL_DIFFUSIONi,Difca*diam*diam*PI*vol[i]/4{ca}LONGITUDINAL_DIFFUSIONi,Difcl*diam*diam*PI*vol[i]/4{cl}naflux[0]=-(ina*diam)*PI*(1e4)/FARADAYkflux[0]=-(ik*diam)*PI*(1e4)/FARADAYcaflux[0]=-(ica*diam)*PI*(1e4)/(FARADAY*2)clflux[0]=-(icl*diam)*PI*(1e4)/(FARADAY*-1)naflux[1]=(ina*diam+inap*diamp)*PI*(1e4)/FARADAYkflux[1]=(ik*diam+ikp*diamp)*PI*(1e4)/FARADAYcaflux[1]=(ica*diam+icap*diamp)*PI*(1e4)/(FARADAY*2)clflux[1]=(icl*diam+iclp*diamp)*PI*(1e4)/(FARADAY*-1)naflux[2]=-(inap*diamp)*PI*(1e4)/FARADAYkflux[2]=-(ikp*diamp)*PI*(1e4)/FARADAYcaflux[2]=-(icap*diamp)*PI*(1e4)/(FARADAY*2)clflux[2]=-(iclp*diamp)*PI*(1e4)/(FARADAY*-1)dif[1]=(Difna*geom(diam)*(nab-na[1])/s)*(setvolout*diam*diam*PI/4)dif[2]=(Difk*geom(diam)*(kb-k[1]-kbuf)/s)*(setvolout*diam*diam*PI/4)dif[3]=(Difcl*geom(diam)*(clb-cl[1])/s)*(setvolout*diam*diam*PI/4)~na[0]<<(naflux[0])~k[0]<<(kflux[0])~ca[0]<<(caflux[0])~cl[0]<<(clflux[0])~na[1]<<(naflux[1]+dif[1])~k[1]<<(kflux[1]+dif[2])~kbuf<<(-k2buf(k[1]+kbuf)*(k[1]+kbuf)*Buffer+k1buf*KBuffer)~Buffer<<(-k2buf(k[1]+kbuf)*(k[1]+kbuf)*Buffer+k1buf*KBuffer)~KBuffer<<(k2buf(k[1]+kbuf)*(k[1]+kbuf)*Buffer-k1buf*KBuffer)~ca[1]<<(caflux[1])~cl[1]<<(clflux[1]+dif[3])~na[2]<<(naflux[2])~k[2]<<(kflux[2])~ca[2]<<(caflux[2])~cl[2]<<(clflux[2])volin=vol[0]volout=vol[1]volpyram=vol[2]nai=na[0]nao=na[1]nap=na[2]ki=k[0]ko=k[1]+kbufkp=k[2]cai=ca[0]cao=ca[1]cap=ca[2]cli=cl[0]clo=cl[1]clp=cl[2]}FUNCTIONk2buf(x(mM)){TABLEFROM-150TO150WITH200k2buf=k1buf/(1+exp((x-x0)/(-1.09)))}FUNCTIONdr(x(um)){TABLEFROM0TO15WITH10dr=x*(sqrt(setvolout+1)-1)/2}FUNCTIONgeom(x(um)){TABLEFROM0TO15WITH10geom=PI*(x+2*dr(x))/(dr(x/2)*setvolout*x*x*PI/4)}