VERBATIM#include<stdlib.h>ENDVERBATIMUNITS{(mA)=(milliamp)(mV)=(millivolt)(uF)=(microfarad)(molar)=(1/liter)(nA)=(nanoamp)(mM)=(millimolar)(um)=(micron)FARADAY=96520(coul)R=8.3134(joule/degC)}NEURON{SUFFIXch_KdrfastngfUSEIONkREADekWRITEikVALENCE1RANGEg,gmax,ninf,ntau,ikRANGEmyi,offset5,offset6,slope5,slope6THREADSAFE}PARAMETER{gmax(mho/cm2)offset5=10(mV)offset6=10(mv)slope5=.07(1)slope6=.264(1)}STATE{n}ASSIGNED{g(mho/cm2)ik(mA/cm2)ninfntau(ms)nexpmyi(mA/cm2)ek(mV)v(mV)celsius(degC)dt(ms)}BREAKPOINT{SOLVEstatesg=gmax*n*n*n*nik=g*(v-ek)myi=ik}UNITSOFFINITIAL{trates(v)n=ninf}PROCEDUREstates(){trates(v)n=n+nexp*(ninf-n)}LOCALq10PROCEDURErates(v){LOCALalpha,beta,sum,tincq10=3^((celsius-34)/10)alpha=-1*slope5*vtrap((v+65-47-offset5),-6)beta=slope6/exp((v+65-22-offset6)/40)sum=alpha+betantau=1/sumninf=alpha/sumtinc=-dt*q10nexp=1-exp(tinc/ntau)}PROCEDUREtrates(v){LOCALtincTABLEninf,nexp,ntauDEPENDdt,celsius,slope5,slope6,offset5,offset6FROM-100TO100WITH200rates(v)}FUNCTIONvtrap(x,y){if(fabs(x/y)<1e-6){vtrap=y*(1-x/y/2)}else{vtrap=x/(exp(x/y)-1)}}UNITSON