NEURON{SUFFIXCaHandler2USEIONcaREADcai,icaWRITEcaiGLOBALPmax,beta,Dapp,multRANGEcai_primePOINTERd2cai,cal}UNITS{(mV)=(millivolt)(mA)=(milliamp)(mM)=(milli/liter)(um)=(micrometer)}PARAMETER{Pmax=2(um/ms)beta=0.001mult=1z=2F=9.64846e4(coulomb)Dapp=.02(um2/ms)}ASSIGNED{diam(um)cai(mM)ica(mA/cm2)icalcium(mA/m2)dt(ms)cai_prime(mM/ms)d2cai(mM/um2)cal(mM)}BREAKPOINT{rate()caistep()}INITIAL{rate()cai=cal}PROCEDURErate(){icalcium=ica*1e4(cm2/m2)cai_prime=(Dapp*d2cai)-((icalcium*4*beta*mult)/(z*F*diam))-((Pmax*4*beta*cal)/diam)}PROCEDUREcaistep(){cai=cal+cai_prime*dt}