INDEPENDENT{tFROM0TO1WITH1(ms)}NEURON{SUFFIXtcitNONSPECIFIC_CURRENTitRANGEpcatbar,m_inf,tau_m,h_inf,tau_h,qm,qhRANGEdepth,cainf,taur}UNITS{(molar)=(1/liter)(mM)=(millimolar)(mV)=(millivolt)(mA)=(milliamp)(um)=(micron)FARADAY=(faraday)(coulomb)R=(k-mole)(joule/degC)}PARAMETER{v(mV)celsius(degC)pcatbar=0.0000138(cm/s)cao=2(mM)qm=2.5qh=2.5depth=.1(um)taur=5(ms)cainf=2.4e-4(mM)vshift=3(mV)}STATE{mhcai(mM)}ASSIGNED{it(mA/cm2)m_inftau_m(ms)h_inftau_h(ms)phi_mphi_hdrive_channel(mM/ms)}BREAKPOINT{SOLVEstateMETHODeulerit=pcatbar*m*m*h*ghk(v,cai,cao)}DERIVATIVEstate{evaluate_fct(v)m'=(m_inf-m)/tau_mh'=(h_inf-h)/tau_hcai'=drive_channel+(cainf-cai)/taur}UNITSOFFINITIAL{phi_m=qm^((celsius-23.5)/10)phi_h=qh^((celsius-23.5)/10)evaluate_fct(v)m=m_infh=h_infcai=cainf}PROCEDUREevaluate_fct(v(mV)){drive_channel=-(10000)*it/(2*FARADAY*depth)if(drive_channel<=0.){drive_channel=0.}m_inf=1.0/(1+Exp(-(v+vshift+65)/6.2))h_inf=1.0/(1+Exp((v+vshift+81)/4.0))tau_m=(0.612+1.0/(Exp(-(v+vshift+132)/16.7)+Exp((v+vshift+16.8)/18.2)))/phi_mif(v<-80){tau_h=Exp((v+vshift+467)/66.6)/phi_h}else{tau_h=1.6147*(28+Exp(-(v+vshift+22)/10.5))/phi_h}}FUNCTIONghk(v(mV),ci(mM),co(mM))(.001coul/cm3){LOCALz,eci,ecoz=(1e-3)*2*FARADAY*v/(R*(celsius+273.15))eco=co*efun(z)eci=ci*efun(-z)ghk=(.001)*2*FARADAY*(eci-eco)}FUNCTIONefun(z){if(fabs(z)<1e-4){efun=1-z/2}else{efun=z/(Exp(z)-1)}}FUNCTIONExp(x){if(x<-100){}else{if(x>700){Exp=exp(700)}else{Exp=exp(x)}}}UNITSON