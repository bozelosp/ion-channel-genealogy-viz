UNITS{(mA)=(milliamp)(mV)=(millivolt)FARADAY=96520(coul)R=8.3134(joule/degC)KTOMV=.0853(mV/degC)}PARAMETER{v(mV)celsius=34(degC)gcalbar=0(mho/cm2)ki=.001(mM)cai=100.e-6(mM)cao=2(mM)tfa=5ggkeca=140}NEURON{SUFFIXcalUSEIONcaREADcao,caiWRITEicaRANGEgcalbar,cai,ica,gcal,ggkGLOBALminf,taum}STATE{m}ASSIGNED{ica(mA/cm2)gcal(mho/cm2)minftaum(ms)}INITIAL{rate(v)m=minf}BREAKPOINT{SOLVEstateMETHODcnexpgcal=gcalbar*m*h2(cai)ggk=ghk(v,cai,cao)ica=gcal*ggk}FUNCTIONh2(cai(mM)){h2=ki/(ki+cai)}FUNCTIONMyExp(x){if(x<-50){MyExp=0}elseif(x>50){MyExp=exp(50)}else{MyExp=exp(x)}}FUNCTIONghk(v(mV),ci(mM),co(mM))(mV){LOCALnu,ff=KTF(celsius)/2nu=v/fghk=-f*(1.-(ci/co)*MyExp(nu))*efun(nu)}FUNCTIONKTF(celsius(DegC))(mV){KTF=((25./293.15)*(celsius+273.15))}FUNCTIONefun(z){if(fabs(z)<1e-4){efun=1-z/2}else{efun=z/(MyExp(z)-1)}}FUNCTIONalpm(v(mV)){TABLEFROM-150TO150WITH200alpm=0.055*(-27.01-v)/(MyExp((-27.01-v)/3.8)-1)}FUNCTIONbetm(v(mV)){TABLEFROM-150TO150WITH200betm=0.94*MyExp((-63.01-v)/17)}DERIVATIVEstate{rate(v)m'=(minf-m)/taum}PROCEDURErate(v(mV)){LOCALa,b,qta=alpm(v)taum=1/(tfa*(a+betm(v)))minf=a/(a+betm(v))}