NEURON{SUFFIXB_AUSEIONkREADekWRITEikRANGEgkbar,ikRANGEninf,ntau,hinf,htauRANGEtadj}UNITS{(mA)=(milliamp)(mV)=(millivolt)}INDEPENDENT{tFROM0TO1WITH1(ms)}STATE{nh}PARAMETER{ek=-84(mV)gkbar(mho/cm2)}ASSIGNED{celsius(degC)v(mV)ik(mA/cm2)tadj(1)nalpha(1/ms)nbeta(1/ms)ninf(1)ntau(ms)halpha(1/ms)hbeta(1/ms)hinf(1)htau(ms)}INITIAL{tadj=3^((celsius-23)/10)rates(v)n=ninfh=hinf}BREAKPOINT{SOLVEstatesMETHODcnexpik=gkbar*n*n*n*n*h*(v-ek)}DERIVATIVEstates{rates(v)n'=(ninf-n)/ntauh'=(hinf-h)/htau}FUNCTIONtrap(x,y){if(fabs(x/y)<1e-6){trap=y*(1-x/y/2)}else{trap=x/(exp(x/y)-1)}}PROCEDURErates(v){TABLEninf,ntau,hinf,htauDEPENDtadjFROM-100TO100WITH200nalpha=0.032*trap(-v-64-0,6)nbeta=0.203*exp((-v-40-0)/24)ninf=nalpha/(nalpha+nbeta)ntau=1/(nalpha+nbeta)/tadjhalpha=0.05/(exp((v+86+0)/10)+1)hbeta=0.05/(exp((-v-86-0)/10)+1)hinf=halpha/(halpha+hbeta)htau=1/(halpha+hbeta)/tadj}