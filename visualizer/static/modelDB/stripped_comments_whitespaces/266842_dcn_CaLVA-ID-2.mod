NEURON{SUFFIXdcnCaLVAUSEIONcalREADcali,caloWRITEicalVALENCE2RANGEperm,ical,m,h,caliGLOBALqdeltat}UNITS{(mA)=(milliamp)(mV)=(millivolt)(molar)=(1/liter)(mM)=(millimolar)}PARAMETER{qdeltat=1perm=1(cm/seconds)}ASSIGNED{v(mV)cali(mM)calo(mM)ical(mA/cm2)minfhinftaum(ms)tauh(ms)celsius(degC)T(kelvin)A(1)}STATE{mh}INITIAL{T=273.15+celsiusrate(v)m=minfh=hinf}BREAKPOINT{SOLVEstatesMETHODcnexpA=getGHKexp(v)ical=perm*m*m*h*(4.47814e6*v/T)*((cali/1000)-(calo/1000)*A)/(1-A)}DERIVATIVEstates{rate(v)m'=(minf-m)/taumh'=(hinf-h)/tauh}PROCEDURErate(v(mV)){TABLEminf,taum,hinf,tauhFROM-150TO100WITH300if(fabs(v+56)<1e-6){minf=1/(1+exp((v+56.00001)/-6.2))}else{minf=1/(1+exp((v+56)/-6.2))}taum=0.333/(exp((v+131)/-16.7)+exp((v+15.8)/18.2))+0.204taum=taum/qdeltathinf=1/(1+exp((v+80)/4))if(v<-81){tauh=0.333*exp((v+466)/66)}else{tauh=0.333*exp((v+21)/-10.5)+9.32}tauh=tauh/qdeltat}FUNCTIONgetGHKexp(v(mV)){TABLEDEPENDTFROM-150TO100WITH300getGHKexp=exp(-23.20764929*v/T)}