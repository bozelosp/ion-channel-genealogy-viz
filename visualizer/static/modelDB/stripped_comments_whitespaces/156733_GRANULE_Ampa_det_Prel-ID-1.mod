NEURON{POINT_PROCESSGRANULE_Ampa_det_PrelNONSPECIFIC_CURRENTiRANGEQ10_diff,Q10_channelRANGER,g,icRANGECdur,ErevRANGEr1FIX,r2,r3,r4,r5,gmax,r1,r6,r6FIX,kBRANGEtau_1,tau_rec,tau_facil,URANGEPRE,T,TmaxRANGEdiffuse,Trelease,lamdRANGEM,Diff,RdRANGEtspikeRANGEnd,syntype,gmax_factor}UNITS{(nA)=(nanoamp)(mV)=(millivolt)(umho)=(micromho)(mM)=(milli/liter)(pS)=(picosiemens)(nS)=(nanosiemens)(um)=(micrometer)PI=(pi)(1)}PARAMETER{syntypegmax_factor=1Q10_diff=1.5Q10_channel=2.4gmax=1200(pS)U=0.42(1)<0,1>tau_rec=35.1(ms)<1e-9,1e9>tau_facil=10.8(ms)<0,1e9>M=21.515Rd=1.03(um)Diff=0.223(um2/ms)Cdur=0.3(ms)r1FIX=5.4(/ms/mM)r2=0.82(/ms)r3=0(/ms)r4=0(/ms)r5=0.013(/ms)r6FIX=1.12(/ms/mM)Erev=0(mV)kB=0.44(mM)tau_1=3(ms)<1e-9,1e9>u0=0(1)<0,1>Tmax=1(mM)diffuse=1lamd=20(nm)nd=1celsius(degC)}ASSIGNED{v(mV)i(nA)ic(nA)g(pS)r1(/ms)r6(/ms)T(mM)Trelease(mM)tspike[5000](ms)xtsyn(ms)PRE[5000]Mres(mM)numpulsestzerogbar_Q10(mho/cm2)Q10(1)}STATE{COD}INITIAL{C=1O=0D=0T=0(mM)numpulses=0Trelease=0(mM)tspike[0]=1e12(ms)gbar_Q10=Q10_diff^((celsius-30)/10)Q10=Q10_channel^((celsius-30)/10)Mres=1e3*(1e3*1e15/6.022e23*M)numpulses=0FROMi=1TO5000{PRE[i-1]=0tspike[i-1]=0}tspike[0]=1e12(ms)if(tau_1>=tau_rec){printf("Warningtau_rec=tau_1+1e-5}}FUNCTIONdiffusione(){LOCALDifWave,iDifWave=0FROMi=1TOnumpulses{tzero=tspike[i-1]if(t>tzero){DifWave=DifWave+Mres*exp(-Rd*Rd/(4*Diff*(t-tzero)))/((4*PI*Diff*(1e-3)*lamd)*(t-tzero))^nd}}diffusione=DifWave}BREAKPOINT{if(diffuse&&(t>tspike[0])){Trelease=T+diffusione()}else{Trelease=T}SOLVEkstatesMETHODsparseg=gmax*gbar_Q10*Oi=(1e-6)*g*(v-Erev)*gmax_factoric=i}KINETICkstates{r1=r1FIX*Trelease^2/(Trelease+kB)^2r6=r6FIX*Trelease^2/(Trelease+kB)^2~C<->O(r1*Q10,r2*Q10)~O<->D(r3*Q10,r4*Q10)~D<->C(r5*Q10,r6*Q10)CONSERVEC+O+D=1}NET_RECEIVE(weight,on,nspike,tzero(ms)){INITIAL{nspike=1}if(flag==0){nspike=nspike+1if(!on){tzero=ton=1T=Tmaxtspike[numpulses]=tnumpulses=numpulses+1}net_send(Cdur,nspike)}if(flag==nspike){tzero=tT=0on=0}}