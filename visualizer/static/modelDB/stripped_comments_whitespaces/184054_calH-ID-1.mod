NEURON{SUFFIXcalHUSEIONcaREADecaWRITEicaRANGEgcalbar,m,h,icaRANGEinf,fac,tau}UNITS{(mA)=(milliamp)(mV)=(millivolt)}INDEPENDENT{tFROM0TO1WITH1(ms)}PARAMETER{v(mV)celsius=34(degC)dt(ms)gcalbar=0(mho/cm2)eca=140(mV)}STATE{mh}ASSIGNED{ica(mA/cm2)inf[2]fac[2]tau[2]}BREAKPOINT{SOLVEstatesica=gcalbar*m*m*m*h*(v-eca)}INITIAL{m=0h=1states()ica=gcalbar*m*m*m*h*(v-eca)}PROCEDUREcalcg(){mhn(v*1(/mV))m=m+fac[0]*(inf[0]-m)h=h+fac[1]*(inf[1]-h)}PROCEDUREstates(){calcg()VERBATIMreturn0;ENDVERBATIM}FUNCTIONvarss(v,i){if(i==0){varss=1/(1+exp((v+37)/(-1)))}elseif(i==1){varss=1/(1+exp((v+41)/(0.5)))}}FUNCTIONvartau(v,i){if(i==0){vartau=3.6}elseif(i==1){vartau=29}}PROCEDUREmhn(v){LOCALa,bFROMi=0TO1{tau[i]=vartau(v,i)inf[i]=varss(v,i)fac[i]=(1-exp(-dt/tau[i]))}}