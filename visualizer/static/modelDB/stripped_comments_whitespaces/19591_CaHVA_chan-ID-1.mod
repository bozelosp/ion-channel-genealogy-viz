UNITS{(mA)=(milliamp)(mV)=(millivolt)}NEURON{SUFFIXcahva_chanUSEIONcaREADecaWRITEicaRANGEgbar,iGLOBALminf,hinf,a1m,b1m,c1m,a2m,b2m,c2m,taum_min,a1h,b1h,c1h,d1h,e1h,a2h,b2h,c2h,d2h,e2h,tauh_min}INDEPENDENT{tFROM0TO1WITH1(ms)}PARAMETER{v(mV)dt(ms)gbar=2.9089e-3(mho/cm2)eca(mV)a1m=1.6b1m=-0.072c1m=-5a2m=0.02b2m=0.2c2m=8.9taum_min=1e-3a1h=0.005b1h=0c1h=0.005d1h=-0.05e1h=-60a2h=0b2h=0.005c2h=-0.005d2h=-0.05e2h=-60tauh_min=1e-3}STATE{mh}ASSIGNED{ica(mA/cm2)minfhinfi}LOCALmexp,hexpBREAKPOINT{SOLVEstatesi=gbar*m*m*h*(v-eca)ica=i}UNITSOFFINITIAL{rates(v)m=minfh=hinf}PROCEDUREstates(){rates(v)m=m+mexp*(minf-m)h=h+hexp*(hinf-h)VERBATIMreturn0;ENDVERBATIM}PROCEDURErates(v){LOCALtau,alpha,betaTABLEminf,mexp,hinf,hexpDEPENDdtFROM-100TO100WITH2000alpha=a1m/(1+exp(b1m*(v+c1m)))beta=a2m*(v+c2m)/(exp(b2m*(v+c2m))-1)tau=1/(alpha+beta)minf=alpha*tauif(tau<taum_min){tau=taum_min}mexp=1-exp(-dt/tau)if(v<e1h){alpha=a1h}else{alpha=b1h+c1h*exp(d1h*(v-e1h))}if(v<e2h){beta=a2h}else{beta=b2h+c2h*exp(d2h*(v-e2h))}tau=1/(alpha+beta)hinf=alpha*tauif(tau<tauh_min){tau=tauh_min}hexp=1-exp(-dt/tau)}UNITSON