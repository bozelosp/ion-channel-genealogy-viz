NEURON{SUFFIXsKCaUSEIONcaREADcaiUSEIONkREADki,ekWRITEikRANGEgk,isKCaGLOBALsKCatau,rate_k,gmax_k}UNITS{(mM)=(milli/liter)(mA)=(milliamp)F=(faraday)(coulombs)}PARAMETER{v(mV)dt(ms)gk=0.0001(mho/cm2)isKCa=0.0(mA/cm2)sKCatau=6.1(ms)ekkicaicelsius}ASSIGNED{ica(mA/cm2)ik(mA/cm2)winfwtau(ms)rate_kgmax_k}STATE{w}BREAKPOINT{SOLVEintegrateMETHODcnexpik=(gk*gmax_k)*w*(v-ek)isKCa=ik}UNITSOFFINITIAL{rate_k=1.66gmax_k=1.66setinf(cai)w=winf}DERIVATIVEintegrate{setinf(cai)w'=(winf-w)/wtau}PROCEDUREsetinf(cai){LOCALwcaiwcai=cai*1000winf=0.81/(1+exp((llog(wcai)+0.3)/-0.46))wtau=sKCatau/rate_k}FUNCTIONllog(x){if(x>1e-11){llog=log(x)}else{llog=0}}UNITSON