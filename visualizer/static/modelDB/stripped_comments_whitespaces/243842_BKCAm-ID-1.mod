NEURON{SUFFIXBKCAmUSEIONkREADekWRITEikUSEIONcaREADcaiRANGEik,gkbar,kon,kcoff,kooff,c0o0c,c0c1c,o0c0c,o0o1c,o4c4c,c4o4c,cai,a,b,hva,hvi,sla,sli,o}UNITS{(molar)=(1/liter)(mM)=(millimolar)(S)=(siemens)(mA)=(milliamp)(mV)=(millivolt)}PARAMETER{gkbar=0.024(S/cm2)kon=40633kcoff=11kooff=1.1c0o0c=0.02162c0c1c=4o0c0c=318.1084o0o1c=4o4c4c=0.35c4o4c=0.002hva=35hvi=15.776sla=380sli=330cai=0.0001(mM)}ASSIGNED{v(mV)ek(mV)ik(mA/cm2)aboc0c1(/ms)c1c0(/ms)c1c2(/ms)c2c1(/ms)c2c3(/ms)c3c2(/ms)c3c4(/ms)c4c3(/ms)o0o1(/ms)o1o0(/ms)o1o2(/ms)o2o1(/ms)o2o3(/ms)o3o2(/ms)o3o4(/ms)o4o3(/ms)c0o0(/ms)o0c0(/ms)c1o1(/ms)o1c1(/ms)c2o2(/ms)o2c2(/ms)c3o3(/ms)o3c3(/ms)c4o4(/ms)o4c4(/ms)}STATE{c0c1c2c3c4o0o1o2o3o4}BREAKPOINT{SOLVEkinMETHODsparseo=o0+o1+o2+o3+o4ik=gkbar*o*(v-ek)}INITIAL{SOLVEkinSTEADYSTATEsparse}KINETICkin{rates(v)~c0<->c1(c0c1,c1c0)~c1<->c2(c1c2,c2c1)~c2<->c3(c2c3,c3c2)~c3<->c4(c3c4,c4c3)~o0<->o1(o0o1,o1o0)~o1<->o2(o1o2,o2o1)~o2<->o3(o2o3,o3o2)~o3<->o4(o3o4,o4o3)~c0<->o0(c0o0,o0c0)~c1<->o1(c1o1,o1c1)~c2<->o2(c2o2,o2c2)~c3<->o3(c3o3,o3c3)~c4<->o4(c4o4,o4c4)CONSERVEc0+c1+c2+c3+c4+o0+o1+o2+o3+o4=1}PROCEDURErates(v(mV)){UNITSOFFa=exp(hva*v/sla)b=exp(hvi*v/sli)c0o0=c0o0c*ac1o1=0.000869*ac2o2=0.0000281*ac3o3=0.000781*ac4o4=c4o4c*ao0c0=o0c0c*bo1c1=144.1736*bo2c2=32.6594*bo3c3=0.095312*bo4c4=o4c4c*bUNITSON}PROCEDUREprates(cai(mM)){UNITSOFFc0c1=c0c1c*kon*caic1c2=3*kon*caic2c3=2*kon*caic3c4=kon*caic4c3=4*kcoff*caic3c2=3*kcoff*caic2c1=2*kcoff*caic1c0=kcoff*caio0o1=4*kon*caio1o2=3*kon*caio2o3=2*kon*caio3o4=kon*caio4o3=4*kooff*caio3o2=3*kooff*caio2o1=2*kooff*caio1o0=kooff*caiUNITSON}