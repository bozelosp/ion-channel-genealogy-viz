NEURON{SUFFIXCaNUSEIONcaREADcai,caoWRITEicaRANGEminf,mtau,hinf,htau,icaRANGEpmax,a,hca}UNITS{(mA)=(milliamp)(mV)=(millivolt)(mM)=(milli/liter)FARADAY=96489(coul)R=8.314(volt-coul/degC)}PARAMETER{v(mV)celsius(degC)cao(mM)pmax=2.8e-5(cm/s)a=0.7326(1)cai0=136e-6(mM)Kd=1e-3(mM)hca(1)}STATE{mh}ASSIGNED{ica(mA/cm2)cai(mM)mtau(ms)minfhinfhtau(ms)}BREAKPOINT{SOLVEstateMETHODcnexphca=1/(1+(cai/Kd)^4)ica=pmax*m*(a*h+(1-a))*hca*ghk(v,cai,cao,2)}DERIVATIVEstate{rates(v)m'=(minf-m)/mtauh'=(hinf-h)/htau}INITIAL{rates(v)m=minfh=hinfhca=1/(1+(cai/Kd)^4)}FUNCTIONghk(v(mV),ci(mM),co(mM),z)(millicoul/cm3){LOCALe,ww=v*(.001)*z*FARADAY/(R*(celsius+273.16))if(fabs(w)>1e-4){e=w/(exp(w)-1)}else{e=1-w/2}ghk=-(.001)*z*FARADAY*(co-ci*exp(w))*e}UNITSOFFFUNCTION_TABLEtabhtau(v(mV))(ms)PROCEDURErates(v(mV)){mtau=0.80448+(101.05111/(14.9947*sqrt(3.14/2)))*exp(-2*((v+20)/14.9947)^2)htau=tabhtau(v)minf=1/(1+exp((-6.5-v)/6.5))hinf=1/(1+exp((v+70)/12.5))}UNITSON