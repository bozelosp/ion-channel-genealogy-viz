INDEPENDENT{tFROM0TO1WITH1(MS)}NEURON{SUFFIXtchannelUSEIONcaREADica,cai,caoWRITEicaRANGEpbarRANGEtt_inf,u_infRANGEtau_tt,tau_uRANGEtt_exp,u_expRANGEitt,itmaxRANGEpcabar,qt,vshift,GHKa,GHKb,GHKc,GHKo,it}UNITS{(molar)=(1/liter)(mM)=(millimolar)(mA)=(milliamp)(mV)=(millivolt)(nA)=(nanoamp)FARADAY=(faraday)(coulombs)R=(k-mole)(joule/degC)}PARAMETER{celsius(degC)pbar=.000017(cm/s)<0,1e9>pcabar=.0002(cm/s)<0,1e9>vshift(mV)v(mV)dt(ms)qt=1cai=1e-4(mM)cao=15(mM)GHKoGHKaGHKbGHKc}STATE{ttu}INITIAL{tt=.0003u=.9}ASSIGNED{ica(nA/cm2)itt(nA/cm2)itmax(nA/cm2)it(nA/cm2)tt_infu_inftau_tttau_utt_expu_exp}BREAKPOINT{SOLVEstatesitt=(tt*tt*tt*u*pbar*ghk(v,cai,cao))itmax=(pbar*ghk(v,cai,cao))/10^6ica=itt}FUNCTIONghk(v(mV),ci(mM),co(mM))(.001coul/cm3){LOCALz,eci,ecoz=1e-3*2*FARADAY*v/(R*(celsius+273.18))eco=co*efun(z)eci=ci*efun(-z)ghk=(.001)*2*FARADAY*(eci-eco)}FUNCTIONefun(z){if(fabs(z)<1e-4){efun=1-z/2}else{efun=z/(exp(z)-1)}}PROCEDUREstates(){evaluate_fct(v)tt=tt+tt_exp*(tt_inf-tt)u=u+u_exp*(u_inf-u)VERBATIMreturn0;ENDVERBATIM}UNITSOFFPROCEDUREevaluate_fct(v(mV)){LOCALa,b,y,dqt=2.9^((celsius-18)/10)vshift=(15-cao)*(-.757575)tt_inf=(1.0/(1+exp(((-56.4+vshift)-(v))/13.2)))^3if(v<-60+vshift){tau_tt=(44.2+.8014(v+vshift)+.0049(v+vshift)^2+((9.7*(10^-6))*(v+vshift)^3))*(1/qt)}else{tau_tt=(.5187+.01550(v+vshift)+.0013(v+vshift)^2+((-.4064*10^-6)*(v+vshift)^3))*(1/qt)}u_inf=1.0/(1+exp(((-68.2+vshift)-(v))/-7.63))if(v<=-55+vshift){tau_u=((33.08+(346.6-33.08)/(1+exp((-82.2-(v+vshift))/-3.362))))*(1/qt)}else{tau_u=(((.01149*exp(-.1348*(v-vshift)))+(31.42*exp(-.0007572*(v-vshift)))+(-13.38)))*(1/qt)}tt_exp=1-exp(-dt/tau_tt)u_exp=1-exp(-dt/tau_u)}UNITSON