INDEPENDENT{tFROM0TO1WITH1(ms)}NEURON{SUFFIXcasUSEIONcaREADica,caiWRITEcaiRANGEkd,cainf,taur}UNITS{(molar)=(1/liter)(mM)=(millimolar)(um)=(micron)(mA)=(milliamp)(msM)=(msmM)}CONSTANT{FARADAY=96489(coul)}PARAMETER{diam(micron)taur=1.5(ms)cainf=0.0001(mM)kd=0.0011(mM)}STATE{cai(mM)}INITIAL{cai=kd}ASSIGNED{ica(mA/cm2)drive_channel(mM/ms)}BREAKPOINT{SOLVEstateMETHODderivimplicit}DERIVATIVEstate{drive_channel=-((2*ica)/(FARADAY*diam))if(drive_channel<=0.){drive_channel=0.}cai'=drive_channel-((cai-cainf)/taur)}