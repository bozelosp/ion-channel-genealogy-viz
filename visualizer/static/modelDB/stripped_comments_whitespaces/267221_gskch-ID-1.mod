NEURON{SUFFIXgskchUSEIONkREADekWRITEikUSEIONcaREADcaiRANGEgskbar,ek,ikRANGEbeta,factor,qinf,tauq}UNITS{(mV)=(millivolt)(mA)=(milliamp)(S)=(siemens)(molar)=(1/liter)(mM)=(millimolar)}PARAMETER{gskbar=0(S/cm2)beta=0.00025(/ms)factor=1.25e1(/mM/mM/ms)}ASSIGNED{v(mV)ek(mV)cai(mM)ik(mA/cm2)qinf(1)tauq(ms)}STATE{q}BREAKPOINT{SOLVEstatesMETHODcnexpik=gskbar*pow(q,2)*(v-ek)}DERIVATIVEstates{rates(cai)q'=(qinf-q)/tauq}INITIAL{rates(cai)q=qinf}PROCEDURErates(ca(mM)){LOCALalphaalpha=factor*ca*catauq=1/(alpha+beta)qinf=alpha*tauq}