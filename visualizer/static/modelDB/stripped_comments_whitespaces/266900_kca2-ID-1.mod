NEURON{SUFFIXkcaPOINTERstim_iUSEIONkREADekWRITEikUSEIONcaREADcaiRANGEflag,curr,gk,gbar,m_inf,tau_m,ik,ek2,vrun,count,vvrun,taun2,vrun2,delta2,stim_moltKGLOBALbeta,cac,alpha}UNITS{(mA)=(milliamp)(mV)=(millivolt)(molar)=(1/liter)(mM)=(millimolar)}PARAMETER{currv(mV)celsius=36(degC)ek=-80(mV)ek2=-80(mV)cai=2.4e-5(mM)gbar=0.01(mho/cm2)beta=0.03cac=0.035(mM)taumin=0.5(ms)gkcount=1vrun(mV)delta=0vinit=-76.2alpha=1.06timestep=1000vrun2v0dv0ddvflag=0FK=2PK=1BK=2.11CK=48stim_moltK=1}STATE{m}ASSIGNED{ik(mA/cm2)m_inftau_m(ms)tadjvvruntaun2stim_i}BREAKPOINT{SOLVEstatesMETHODcnexpgk=gbar*m*m*mek2=ek+vvrun*alphaik=gk*(v-ek2)}DERIVATIVEstates{evaluate_fct(v,cai)m'=(m_inf-m)/tau_m}UNITSOFFINITIAL{vrun=0vvrun=vruntadj=3^((celsius-22.0)/10)evaluate_fct(v,cai)m=m_inf}BEFORESTEP{LOCALiif(stim_i==0&&flag==0){vrun=0vvrun=0}else{flag=1delta=v-vinitif(count<timestep+1){vrun=(delta-vrun)*(FK/(count+1))+vrunvrun2=vrun}else{vrun2=(delta)*(FK/(timestep+1))+vrun2*pow((1-FK/(timestep+1)),PK)}vvrun=(BK*vrun2/(1+vrun2/CK))count=count+1}}PROCEDUREevaluate_fct(v(mV),cai(mM)){LOCALcar,icar=(cai/cac)^4m_inf=car/(1+car)tau_m=1/beta/(1+car)/tadjif(tau_m<taumin){tau_m=taumin}}UNITSON