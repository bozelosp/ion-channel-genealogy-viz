NEURON{SUFFIXCa_jsrUSEIONcdWRITEicdVALENCE2USEIONcrREADicr,criWRITEicrVALENCE2USEIONcaREADcai,icaRANGECsqn,Kmcsqn,Vrel,krelGLOBALm_inf,h_inf,n_infGLOBALtau_m,tau_h,tau_nGLOBALm_exp,h_exp,n_exp,TauinactcaGLOBALdummy}UNITS{(mA)=(milliamp)(mV)=(millivolt)(mM)=(milli/liter)(mse-1)=(1/millisec)}PARAMETER{krel=30(mse-1)<0,1e9>Vrel=96.48e-12(cm3)Csqn=10(mM)Kmcsqn=0.8(mM)dt(ms)Tauinactca=1.91(ms)}STATE{mnh}ASSIGNED{v(mV)celsius(degC)ica(mA/cm2)icr(mA/cm2)cai(mM)cri(mM)icd(mA/cm2)dummym_infh_infn_inftau_mtau_htau_nm_exph_expn_exptadj}BREAKPOINT{SOLVEstatesMETHODderivimpliciticr=krel*m*m*n*h*(cri-cai)icd=-icr}INITIAL{evaluate_fct(icr,ica,v)m=m_infn=n_infh=h_inf}DERIVATIVEstates{evaluate_fct(icr,ica,v)m'=(m_inf-m)/tau_mn'=(n_inf-n)/tau_nh'=(h_inf-h)/tau_h}UNITSOFFPROCEDUREevaluate_fct(icr,ica,v){LOCALa,b,q10q10=3.0^((celsius-37)/10)a=1/(1+expMa((Vrel*icr-ica/0.96480*100-3.4175e-1),(13.67e-4)))b=8/(q10*1(/ms))tau_m=bm_inf=aa=(1-1/(1+expMb((Vrel*icr-ica/0.96480*100-6.835e-2),(13.67e-4))))b=q10*1(/ms)*(Tauinactca+2.09/(1+expMa((Vrel*icr-ica/0.96480*100-3.4175e-1),(13.67e-4))))tau_n=bn_inf=aa=(1-1/(1+exp(-(v-40)/17)))b=6*(1-exp(-(v-7.9)/5))/((1+0.3*exp(-(v-7.9)/5))*(v-7.9))/(q10*1(/ms))tau_h=bh_inf=a}FUNCTIONexpMa(x,y){if(fabs(x/y)<1e-6){expMa=(1-x/y/2)}else{expMa=exp(-x/y)}}FUNCTIONexpMb(x,y){if(fabs(x/y)<1e-6){expMb=(1-x/y/2)}else{expMb=exp(-x/y)}}UNITSON