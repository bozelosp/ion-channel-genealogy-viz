VERBATIM#include<stdlib.h>ENDVERBATIMUNITS{(mA)=(milliamp)(mV)=(millivolt)(molar)=(1/liter)(mM)=(millimolar)FARADAY=96520(coul)R=8.3134(joule/degC)}NEURON{SUFFIXch_CavLUSEIONcaREADcai,cao,ecaWRITEicaVALENCE2RANGEgmax,g,cai,ica,ecaRANGEmyiRANGEminf,mtauTHREADSAFE}PARAMETER{v(mV)celsius(degC)gmax(mho/cm2)ki=.001(mM)cai(mM)cao(mM)tfa=1}STATE{m}ASSIGNED{g(mho/cm2)minfmtau(ms)myi(mA/cm2)ica(mA/cm2)eca(mV)}INITIAL{rate(v)m=minf}BREAKPOINT{SOLVEstateMETHODcnexpg=gmax*m*m*h2(cai)ica=g*ghk(v,cai,cao)myi=ica}FUNCTIONh2(cai(mM)){h2=ki/(ki+cai)}FUNCTIONghk(v(mV),ci(mM),co(mM))(mV){LOCALff=KTF(celsius)/2ghk=-f*(1.-(ci/co)*exp(v/f))*vtrap(v,f)/f}FUNCTIONKTF(celsius(DegC))(mV){KTF=((25./293.15)*(celsius+273.15))}FUNCTIONvtrap(x,y){if(fabs(x/y)<1e-6){vtrap=y*(1-x/y/2)}else{vtrap=x/(exp(x/y)-1)}}FUNCTIONalp(v(mV))(1/ms){alp=15.69*vtrap((-1.0*v+81.5),10.0)}FUNCTIONbet(v(mV))(1/ms){bet=0.29*exp(-v/10.86)}DERIVATIVEstate{rate(v)m'=(minf-m)/mtau}PROCEDURErate(v(mV)){LOCALaa=alp(v)mtau=1/(tfa*(a+bet(v)))minf=tfa*a*mtau}