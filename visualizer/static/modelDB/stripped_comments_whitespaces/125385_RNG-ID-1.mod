INDEPENDENT{tFROM0TO1WITH1(ms)}PARAMETER{init_seed=-1DONT_VECTORIZE}NEURON{POINT_PROCESSRNGRANGEinit_seedGLOBALDONT_VECTORIZE}INITIAL{VERBATIMif(init_seed!=-1)set_seed(init_seed);ENDVERBATIM}VERBATIM#include<math.h>#include<limits.h>#definePI3.141592654#definer_ia16807#definer_im2147483647#definer_am(1.0/r_im)#definer_iq127773#definer_ir2836#definer_ntab32#definer_ndiv(1+(r_im-1)/r_ntab)#definer_eps1.2e-7#definer_rnmx(1.0-r_eps)staticdoublegammln(doublexx){doublex,tmp,ser;staticdoublecof[6]={76.18009173,-86.50532033,24.01409822,-1.231739516,0.120858003e-2,-0.536382e-5};intj;x=xx-1.0;tmp=x+5.5;tmp-=(x+0.5)*log(tmp);ser=1.0;for(j=0;j<=5;j++){x+=1.0;ser+=cof[j]/x;}return-tmp+log(2.50662827465*ser);}staticlongidum_RNG=-1;staticlongiy_RNG=0;staticlongiv_RNG[r_ntab];staticvoidset_seed(longseed){intj,k;idum_RNG=fabs(seed);fprintf(stderr,"RNG:seedissetto%ld\n",idum_RNG);for(j=r_ntab+7;j>=0;j--){k=(idum_RNG/r_iq);idum_RNG=r_ia*(idum_RNG-k*r_iq)-r_ir*k;if(idum_RNG<0)idum_RNG+=r_im;if(j<r_ntab)iv_RNG[j]=idum_RNG;}iy_RNG=iv_RNG[0];}staticdoubleuniran1(){intj;longk;doubletemp;k=(idum_RNG/r_iq);idum_RNG=r_ia*(idum_RNG-k*r_iq)-r_ir*k;if(idum_RNG<0)idum_RNG+=r_im;j=iy_RNG/r_ndiv;iy_RNG=iv_RNG[j];iv_RNG[j]=idum_RNG;if((temp=r_am*iy_RNG)>r_rnmx)returnr_rnmx;elsereturntemp;}staticdoublegasdev(){doublefac,r,v1,v2;staticintiset_RNG=0;staticdoublegset_RNG;if(iset_RNG==0){do{v1=2.0*uniran1()-1.0;v2=2.0*uniran1()-1.0;r=v1*v1+v2*v2;}while(r>=1.0||r==0.0);fac=sqrt(-2.0*log(r)/r);gset_RNG=v1*fac;iset_RNG=1;returnv2*fac;}else{iset_RNG=0;returngset_RNG;}}doublebnldev(doubleppr,intnnr){intj;staticintnold=(-1);doubleam,em,g,angle,p,bnl,sq,bt,y;staticdoublepold=(-1.0),pc,plog,pclog,en,oldg;p=(ppr<=0.5?ppr:1.0-ppr);am=nnr*p;if(nnr<25){bnl=0.0;for(j=1;j<=nnr;j++)if(uniran1()<p)bnl+=1.0;}elseif(am<1.0){g=exp(-am);bt=1.0;for(j=0;j<=nnr;j++){bt*=uniran1();if(bt<g)break;}bnl=(j<=nnr?j:nnr);}else{if(nnr!=nold){en=nnr;oldg=gammln(en+1.0);nold=nnr;}if(p!=pold){pc=1.0-p;plog=log(p);pclog=log(pc);pold=p;}sq=sqrt(2.0*am*pc);do{do{angle=PI*uniran1();angle=PI*uniran1();y=tan(angle);em=sq*y+am;}while(em<0.0||em>=(en+1.0));em=floor(em);bt=1.2*sq*(1.0+y*y)*exp(oldg-gammln(em+1.0)-gammln(en-em+1.0)+em*plog+(en-em)*pclog);}while(uniran1()>bt);bnl=em;}if(p!=ppr)bnl=nnr-bnl;returnbnl;}#undefPI#undefr_ia#undefr_im#undefr_am#undefr_iq#undefr_ir#undefr_ntab#undefr_ndiv#undefr_eps#undefr_rnmxENDVERBATIMPROCEDURESetSeedNow(seed){VERBATIMset_seed((long)_lseed);ENDVERBATIM}FUNCTIONUniDev(){VERBATIM_lUniDev=uniran1();ENDVERBATIM}FUNCTIONBnlDev(ppr,nnr){VERBATIM_lBnlDev=bnldev(_lppr,(int)_lnnr);ENDVERBATIM}PROCEDUREtest_ran1(){LOCALj,xVERBATIMFILE*out;out=fopen("test_ran1.out","w");ENDVERBATIMj=0while(j<10000){VERBATIMfprintf(out,"%lg\n",uniran1());ENDVERBATIMj=j+1}VERBATIMfclose(out);ENDVERBATIM}PROCEDUREtest_gasdev(){LOCALj,xVERBATIMFILE*out;out=fopen("test_gasdev.out","w");ENDVERBATIMj=0while(j<10000){VERBATIMfprintf(out,"%lg\n",gasdev());ENDVERBATIMj=j+1}VERBATIMfclose(out);ENDVERBATIM}