NEURON{THREADSAFESUFFIXcaUSEIONcaREADecaWRITEicaRANGEm,h,gca,gbarRANGEminf,hinf,mtau,htauGLOBALq10,temp,tadj,vmin,vmax,vshift}UNITS{(mA)=(milliamp)(mV)=(millivolt)(pS)=(picosiemens)(um)=(micron)(mM)=(milli/liter)FARADAY=(faraday)(coulomb)R=(k-mole)(joule/degC)PI=(pi)(1)}PARAMETER{gbar=0.1(pS/um2)vshift=0(mV)cao=2.5(mM)cai(mM)temp=23(degC)q10=2.3vmin=-120(mV)vmax=100(mV)}ASSIGNED{v(mV)celsius(degC)ica(mA/cm2)gca(pS/um2)eca(mV)minfhinfmtau(ms)htau(ms)tadj}STATE{mh}INITIAL{tadj=q10^((celsius-temp)/(10(degC)))trates(v+vshift)m=minfh=hinf}BREAKPOINT{SOLVEstatesMETHODcnexpgca=tadj*gbar*m*m*hica=(1e-4)*gca*(v-eca)}DERIVATIVEstates{trates(v+vshift)m'=(minf-m)/mtauh'=(hinf-h)/htau}PROCEDUREtrates(v(mV)){TABLEminf,hinf,mtau,htauDEPENDcelsius,tempFROMvminTOvmaxWITH199rates(v)}UNITSOFFPROCEDURErates(vm(mV)){LOCALa,btadj=q10^((celsius-temp)/(10(degC)))a=0.209*efun(-(27+vm)/3.8)b=0.94*exp((-75-vm)/17)mtau=1/tadj/(a+b)minf=a/(a+b)a=0.000457*exp((-13-vm)/50)b=0.0065/(exp((-vm-15)/28)+1)htau=1/tadj/(a+b)hinf=a/(a+b)}UNITSONFUNCTIONefun(z){if(fabs(z)<1e-4){efun=1-z/2}else{efun=z/(exp(z)-1)}}