UNITS{(mA)=(milliamp)(mV)=(millivolt)(uF)=(microfarad)(molar)=(1/liter)(nA)=(nanoamp)(mM)=(millimolar)(um)=(micron)FARADAY=96520(coul)R=8.3134(joule/degC)}NEURON{SUFFIXlcaUSEIONlcaREADelcaWRITEilcaVALENCE2RANGEglcaRANGEglcabarRANGEeinf,etau,ilca}INDEPENDENT{tFROM0TO100WITH100(ms)}PARAMETER{v(mV)celsius=6.3(degC)dt(ms)glcabar(mho/cm2)}STATE{e}ASSIGNED{glca(mho/cm2)ilca(mA/cm2)elca(mV)einfetau(ms)eexp}BREAKPOINT{SOLVEstatesglca=glcabar*e*eilca=glca*(v-elca)}UNITSOFFINITIAL{trates(v)e=einf}PROCEDUREstates(){trates(v)e=e+eexp*(einf-e)VERBATIMreturn0;ENDVERBATIM}LOCALq10PROCEDURErates(v){LOCALalpha,beta,sumq10=3^((celsius-6.3)/10)alpha=-15.69*vtrap(v-81.5,-10)beta=0.29*exp(-v/10.86)sum=alpha+betaetau=1/sumeinf=alpha/sum}PROCEDUREtrates(v){LOCALtincTABLEeinf,eexp,etauDEPENDdt,celsiusFROM-100TO100WITH200rates(v)tinc=-dt*q10eexp=1-exp(tinc/etau)}FUNCTIONvtrap(x,y){if(fabs(x/y)<1e-6){vtrap=y*(1-x/y/2)}else{vtrap=x/(exp(x/y)-1)}}UNITSON