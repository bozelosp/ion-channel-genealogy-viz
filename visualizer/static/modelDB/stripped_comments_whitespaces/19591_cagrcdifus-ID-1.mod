DEFINENANN12INDEPENDENT{tFROM0TO1WITH10(ms)}NEURON{SUFFIXcagrcdifusUSEIONcaREADcao,cai,icaWRITEcaiRANGEvol,farea,pcdc,Buffer0GLOBALCaRest}UNITS{(molar)=(1/liter)(mM)=(millimolar)(um)=(micron)(mA)=(milliamp)FARADAY=(faraday)(coulomb)PI=(pi)(1)}PARAMETER{DFree=.6(um2/ms)cao(mM)ica(mA/cm2)k1buf(/mM-ms)k2buf(/ms)CaRest=6e-5(mM)}ASSIGNED{cai(mM)vol[NANN](cm3)farea[NANN](cm2)pcdc[NANN](cm/ms)}STATE{ca[NANN](mM)CaBuffer[NANN](mM)Buffer[NANN](mM)}BREAKPOINT{SOLVEstateMETHODsparse}LOCALcoord_doneINITIAL{if(coord_done==0){coord_done=1coord()}cai=CaRestFROMi=0TONANN-1{ca[i]=caiCaBuffer[i]=Buffer0/(1+k2buf/k1buf/ca[i])Buffer[i]=Buffer0-CaBuffer[i]}}PROCEDUREcoord(){vol[0]=3.0793e-11vol[1]=2.956e-11vol[2]=2.8354e-11vol[3]=2.7173e-11vol[4]=2.6017e-11vol[5]=4.8665e-11vol[6]=6.4955e-11vol[7]=8.8489e-11vol[8]=6.6497e-11vol[9]=7.9587e-11vol[10]=2.9322e-11vol[11]=4.1888e-12farea[0]=3.094e-06farea[1]=3.0172e-06farea[2]=2.8953e-06farea[3]=2.7759e-06farea[4]=2.659e-06farea[5]=2.5447e-06farea[6]=2.3235e-06farea[7]=2.0106e-06farea[8]=1.5394e-06farea[9]=1.131e-06farea[10]=5.0265e-07farea[11]=1.2566e-07pcdc[0]=0pcdc[1]=1.8103e-09pcdc[2]=1.7372e-09pcdc[3]=1.6656e-09pcdc[4]=1.5954e-09pcdc[5]=1.0179e-09pcdc[6]=5.5764e-10pcdc[7]=3.0159e-10pcdc[8]=1.8473e-10pcdc[9]=9.0478e-11pcdc[10]=3.0159e-11pcdc[11]=5.0266e-12}LOCALdsq,dsqvolKINETICstate{COMPARTMENTi,vol[i]{ca}~ca[0]<<(-ica*farea[0]/(2*FARADAY))FROMi=1TONANN-1{~ca[i-1]<->ca[i](pcdc[i],pcdc[i])}FROMi=0TONANN-1{~ca[i]+Buffer[i]<->CaBuffer[i](k1buf*vol[i],k2buf*vol[i])}cai=ca[0]}