UNITS{(mA)=(milliamp)(mV)=(millivolt)}NEURON{SUFFIXHHUSEIONnaREADenaWRITEinaUSEIONkREADekWRITEikNONSPECIFIC_CURRENTilRANGEgnabar,gkbar,gl,el,m_inf,h_inf,n_inf,tau_m,tau_n,tau_h,ina,ik}PARAMETER{v(mV)celsius(degC)dt(ms)gnabar=0.1(mho/cm2)ena(mV)gkbar=0.01(mho/cm2)ek(mV)gl=0(mho/cm2)el(mV)}STATE{mhn}ASSIGNED{ina(mA/cm2)ik(mA/cm2)il(mA/cm2)m_infh_infn_inftau_mtau_htau_ntadj}BREAKPOINT{SOLVEstatesina=gnabar*m*m*m*h*(v-ena)ik=gkbar*n*n*n*n*(v-ek)il=gl*(v-el)}UNITSOFFINITIAL{tadj=3.0^((celsius-23.5)/10)rates(v)m=m_infh=h_infn=n_inf}PROCEDUREstates(){rates(v)m=m+(1-exp(-dt/tau_m))*(m_inf-m)h=h+(1-exp(-dt/tau_h))*(h_inf-h)n=n+(1-exp(-dt/tau_n))*(n_inf-n)}PROCEDURErates(v){LOCALalpha,beta,q10,tincalpha=.091*vtrap(v+38,5)beta=.062*vtrap(-(v+38),5)tau_m=1/(alpha+beta)/tadjm_inf=alpha/(alpha+beta)alpha=.016*exp(-(v+55)/15)beta=2.07/(1+exp((17-v)/21))tau_h=1/(alpha+beta)/tadjh_inf=alpha/(alpha+beta)alpha=.01*vtrap(v+45,5)beta=.17*exp(-(v+50)/40)tau_n=1/(alpha+beta)/tadjn_inf=alpha/(alpha+beta)}FUNCTIONvtrap(x,b){if(fabs(x/b)<1e-6){vtrap=b+x/2}else{vtrap=x/(1-exp(-x/b))}}UNITSON