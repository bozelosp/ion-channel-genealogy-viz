NEURON{ARTIFICIAL_CELLIntervalFireRANGEtau,m,invl,burst_start,burst_stop,burst_factorPOINTERrRANGEnoutput,ninput}VERBATIM#ifndefNRN_VERSION_GTEQ_8_2_0externvoid*nrn_random_arg(int);externdoublenrn_random_pick(void*);#defineRANDCAST#else#defineRANDCAST(Rand*)#endifENDVERBATIMPARAMETER{tau=5(ms)<1e-9,1e9>invl=10(ms)<1e-9,1e9>burst_start=0(ms)burst_stop=0(ms)burst_factor=1}ASSIGNED{mminft0(ms)rtau1minf1ninputnoutput}INITIAL{ninput=0noutput=0tau1=1/tauminf=1/(1-exp(-invl*tau1))minf1=1/(minf-1)specify_invl()m=0t0=tnet_send(firetime(),1)}FUNCTIONM(){M=minf+(m-minf)*exp(-(t-t0)*tau1)}NET_RECEIVE(w){m=M()t0=tif(flag==0){ninput=ninput+1m=m+wif(m>1){m=0noutput=noutput+1net_event(t)}net_move(t+firetime())}else{net_event(t)noutput=noutput+1m=0specify_invl()net_send(firetime(),1)}}FUNCTIONfiretime()(ms){firetime=tau*log((minf-m)*minf1)}PROCEDUREspecify_invl(){VERBATIM{if(!_p_r){return0.;}invl=nrn_random_pick(RANDCAST_p_r);if(t>=burst_start&&t<=burst_stop){invl*=burst_factor;}}ENDVERBATIMminf=1/(1-exp(-invl*tau1))minf1=1/(minf-1)}PROCEDUREset_rand(){VERBATIM{void**ppr;ppr=(void**)(&(_p_r));*ppr=nrn_random_arg(1);}ENDVERBATIM}