UNITS{(molar)=(1/liter)}UNITS{(mV)=(millivolt)(mA)=(milliamp)(mM)=(millimolar)}INDEPENDENT{tFROM0TO1WITH1(ms)}NEURON{SUFFIXbksUSEIONlcaREADlcaiUSEIONncaREADncaiUSEIONtcaREADtcaiUSEIONkWRITEikRANGEgkbar,gk,zinf,ikGLOBALbkcoef,bkexp,cahco,carco,tin,tinsh,calco}PARAMETER{celsius=37(degC)v(mV)gkbar=.08(mho/cm2)ncai(mM)lcai(mM)tcai(mM)ek=-85(mV)dt(ms)tin=0.02bkcoef=0.023bkexp=7.5cahco=1carco=0calco=1tinsh=400}ASSIGNED{ik(mA/cm2)minfmexpzinfzexpgk}STATE{mz}BREAKPOINT{SOLVEstateik=gkbar*1000*m*z*z*(v-ek)}PROCEDUREstate(){rate(v,lcai,ncai,tcai)m=m+mexp*(minf-m)z=z+zexp*(zinf-z)VERBATIMreturn0;ENDVERBATIM}INITIAL{rate(v,lcai,ncai,tcai)m=minfz=zinf}FUNCTIONalp(v(mV),lcai(mM),ncai(mM),tcai(mM))(1/ms){alp=0.4/((lcai*calco+ncai*cahco+tcai*carco))}FUNCTIONbet(v(mV))(1/ms){bet=0.11/exp((v-55)/14.9)}PROCEDURErate(v(mV),lcai(mM),ncai(mM),tcai(mM)){LOCALa,b,tincaa=alp(v,lcai,ncai,tcai)zinf=1/(1+a)zexp=(1-exp(-dt/4))b=bet(v)minf=8.5/(7.5+b)mexp=(1-exp(-dt*(bkexp+b)))}