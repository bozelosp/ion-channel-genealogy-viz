UNITS{(mA)=(milliamp)(mV)=(millivolt)}PARAMETER{v(mV)ek(mV)celsius(degC)gkdbar=.0(mho/cm2)vhalfn=-33(mV)a0n=0.01(/ms)zetan=3(1)gmn=0.7(1)nmax=2(1)q10=1sh=0}NEURON{SUFFIXkdUSEIONkREADekWRITEikRANGEgkd,gkdbar,i,shGLOBALninf,taun}STATE{n}ASSIGNED{ik(mA/cm2)i(mA/cm2)ninfgkdtaun}BREAKPOINT{SOLVEstatesMETHODcnexpgkd=gkdbar*nik=gkd*(v-ek)i=ik}INITIAL{rates(v)n=ninf}FUNCTIONalpn(v(mV)){alpn=exp(1.e-3*zetan*(v-vhalfn-sh)*9.648e4/(8.315*(273.16+celsius)))}FUNCTIONbetn(v(mV)){betn=exp(1.e-3*zetan*gmn*(v-vhalfn-sh)*9.648e4/(8.315*(273.16+celsius)))}DERIVATIVEstates{rates(v)n'=(ninf-n)/taun}PROCEDURErates(v(mV)){LOCALa,qtqt=q10^((celsius-24)/10)a=alpn(v)if(v<-30){ninf=1/(1+a)}else{ninf=0}taun=betn(v)/(qt*a0n*(1+a))if(taun<nmax){taun=nmax/qt}}