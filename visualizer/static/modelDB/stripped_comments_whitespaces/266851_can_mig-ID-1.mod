UNITS{(mA)=(milliamp)(mV)=(millivolt)FARADAY=96520(coul)R=8.3134(joule/degC)KTOMV=.0853(mV/degC)}PARAMETER{v(mV)celsius(degC)gcanbar=.0003(mho/cm2)ki=.001(mM)cai=50.e-6(mM)cao=2(mM)q10=5mmin=0.2hmin=3a0m=0.03zetam=2vhalfm=-14gmm=0.1USEGHK=1erev=100}NEURON{SUFFIXcanUSEIONcaREADcai,caoWRITEicaRANGEgcanbar,ica,gcanRANGEhinf,minf,taum,tauhGLOBALUSEGHK}STATE{mh}ASSIGNED{ica(mA/cm2)gcan(mho/cm2)minfhinftaumtauh}INITIAL{rates(v)m=minfh=hinf}BREAKPOINT{SOLVEstatesMETHODcnexpgcan=gcanbar*m*m*h*h2(cai)if(USEGHK==1){ica=gcan*ghk(v,cai,cao)}else{ica=gcan*(v-erev)}}UNITSOFFFUNCTIONh2(cai(mM)){h2=ki/(ki+cai)}FUNCTIONghk(v(mV),ci(mM),co(mM))(mV){LOCALnu,ff=KTF(celsius)/2nu=v/fghk=-f*(1.-(ci/co)*exp(nu))*efun(nu)}FUNCTIONKTF(celsius(degC))(mV){KTF=((25./293.15)*(celsius+273.15))}FUNCTIONefun(z){if(fabs(z)<1e-4){efun=1-z/2}else{efun=z/(exp(z)-1)}}FUNCTIONalph(v(mV)){alph=1.6e-4*exp(-v/48.4)}FUNCTIONbeth(v(mV)){beth=1/(exp((-v+39.0)/10.)+1.)}FUNCTIONalpm(v(mV)){alpm=0.1967*(-1.0*v+19.88)/(exp((-1.0*v+19.88)/10.0)-1.0)}FUNCTIONbetm(v(mV)){betm=0.046*exp(-v/20.73)}FUNCTIONalpmt(v(mV)){alpmt=exp(0.0378*zetam*(v-vhalfm))}FUNCTIONbetmt(v(mV)){betmt=exp(0.0378*zetam*gmm*(v-vhalfm))}UNITSONDERIVATIVEstates{rates(v)m'=(minf-m)/taumh'=(hinf-h)/tauh}PROCEDURErates(v(mV)){LOCALa,b,qtqt=q10^((celsius-25)/10)a=alpm(v)b=1/(a+betm(v))minf=a*btaum=betmt(v)/(qt*a0m*(1+alpmt(v)))if(taum<mmin/qt){taum=mmin/qt}a=alph(v)b=1/(a+beth(v))hinf=a*btauh=80if(tauh<hmin){tauh=hmin}}