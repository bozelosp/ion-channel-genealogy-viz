UNITS{(mA)=(milliamp)(mV)=(millivolt)}NEURON{SUFFIXKdendUSEIONkREADekWRITEikRANGEgkdend,ikGLOBALninf,nexp,ntau}INDEPENDENT{tFROM0TO1WITH1(ms)}PARAMETER{v(mV)celsius=24(degC)dt(ms)gkdend=.0230(mho/cm2)ek=-100(mV)}STATE{n}ASSIGNED{ik(mA/cm2)ninfnexpntau(ms)}INITIAL{n=ninf}BREAKPOINT{SOLVEstatesik=gkdend*n*n*n*n*(v-ek)}PROCEDUREstates(){evaluate_fct(v)n=n+nexp*(ninf-n)VERBATIMreturn0;ENDVERBATIM}UNITSOFFPROCEDUREevaluate_fct(v(mV)){LOCALq10,tinc,alpha,betaTABLEninf,nexp,ntauDEPENDdt,celsiusFROM-200TO100WITH300q10=3^((celsius-24)/10)tinc=-dt*q10alpha=0.018*vtrap(-(v-20),21)beta=0.0036*vtrap(v-30,12)ntau=1/(alpha+beta)ninf=alpha*ntaunexp=1-Exp(tinc/ntau)}FUNCTIONvtrap(x,y){if(fabs(x/y)<1e-6){vtrap=y*(1-x/y/2)}else{vtrap=x/(Exp(x/y)-1)}}FUNCTIONExp(x){if(x<-100){Exp=0}else{Exp=exp(x)}}UNITSON