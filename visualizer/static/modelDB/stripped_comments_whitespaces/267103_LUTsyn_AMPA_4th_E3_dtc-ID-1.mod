NEURON{POINT_PROCESSLUTsyn_AMPA_4th_E3_dtcRANGEgain,basis_gain,tau1,tau2,tau3,t3,t2,t1,t0,MEM,scalar,order,open,index,granRANGEg,e,C,B,E,factor,wf,v1RANGEtc1,tc2,tc3,wtc2,wtc3RANGEo1_tc1,o1_tc2,o1_tc3,o2_tc1,o2_tc2,o2_tc3,o3_tc1,o3_tc2,o3_tc3,o4_tc1,o4_tc2,o4_tc3RANGEo1_spks,o2_spks,o3_spks,o4_spksRANGEfactor1,factor2,factor3,factor4POINTERgain_arrayNONSPECIFIC_CURRENTi}UNITS{(nA)=(nanoamp)(mV)=(millivolt)(nS)=(nanosiemens)}ASSIGNED{i(nA)v1(mV)gain_arraybasis_gaingaintau1tau2tau3t3t2t1t0MEMorderindexgfactorwfwtc3o1_spkso2_spkso3_spkso4_spks}PARAMETER{scalar=1gran=1ve=0tc1=0.86(ms)tc2=4.24(ms)tc3=12(ms)wtc2=0.5o1_tc1=1(ms)o1_tc2=1(ms)o1_tc3=1(ms)factor1=1o2_tc1=1(ms)o2_tc2=1(ms)o2_tc3=1(ms)factor2=1o3_tc1=1(ms)o3_tc2=1(ms)o3_tc3=1(ms)factor3=1o4_tc1=1(ms)o4_tc2=1(ms)o4_tc3=1(ms)factor4=1}INITIAL{if(tc1/tc2>.9999){tc1=.9999*tc2}if(tc2/tc3>.9999){tc2=.9999*tc3}wtc3=1-wtc2C=0B=0E=0tau1=-1tau2=-1tau3=-1t3=0t2=0t1=0t0=0o1_spks=0o2_spks=0o3_spks=0o4_spks=0MEM=300/granorder=0index=0basis_gain=basis_gain/fabs(scalar)gain=basis_gain}STATE{CBE}BREAKPOINT{SOLVEstateMETHODcnexpg=wtc2*B+wtc3*E-Ci=g*(v-e)v1=v}DERIVATIVEstate{C'=-C/tc1B'=-B/tc2E'=-E/tc3}NET_RECEIVE(weight(uS)){SOLVEupdate_tausSOLVEfind_gainwf=weight*factor*gainC=C+wfB=B+wfE=E+wf}PROCEDUREupdate_taus(){t3=t2t2=t1t1=t0t0=ttau1=floor((t0-t1)/gran+0.5)tau2=floor((t0-t2)/gran+0.5)tau3=floor((t0-t3)/gran+0.5)}PROCEDUREfind_gain(){if((t0!=0)&&(t1!=0)&&(t2!=0)&&(t3!=0)){if(tau1>(MEM-3)){order=1}elseif(tau2>(MEM-2)){order=2}elseif(tau3>(MEM-1)){order=3}else{order=4}}elseif(t1==0){order=1}elseif(t2==0){if(tau1>(MEM-3)){order=1}else{order=2}}elseif(t3==0){if(tau1>(MEM-3)){order=1}elseif(tau2>(MEM-2)){order=2}else{order=3}}if(order==1){gain=basis_gaintc1=o1_tc1tc2=o1_tc2tc3=o1_tc3factor=factor1o1_spks=o1_spks+1}else{if(order==2){index=convert_index(tau1,MEM-2,MEM-1)tc1=o2_tc1tc2=o2_tc2tc3=o2_tc3factor=factor2o2_spks=o2_spks+1}elseif(order==3){index=convert_index(tau1,tau2,MEM-1)tc1=o3_tc1tc2=o3_tc2tc3=o3_tc3factor=factor3o3_spks=o3_spks+1}elseif(order==4){index=convert_index(tau1,tau2,tau3)tc1=o4_tc1tc2=o4_tc2tc3=o4_tc3factor=factor4o4_spks=o4_spks+1}VERBATIMgain=((double*)_p_gain_array)[(int)index];ENDVERBATIM}}FUNCTIONconvert_index(ind1,ind2,ind3){UNITSOFFconvert_index=(pow(ind3,3)-3*pow(ind3,2)+2*(ind3))/6+(pow(ind2,2)-(ind2))/2+ind1UNITSON}