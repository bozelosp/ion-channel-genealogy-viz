NEURON{SUFFIXxiongUSEIONkREADko,ki,ekWRITEikUSEIONnaREADnai,nao,enaWRITEinaUSEIONcaREADcaoGLOBALtauavg,rmax,ec50,Nh,nRANGEik,ina,g,gpresent,itot}UNITS{(molar)=(1/liter)(mV)=(millivolt)(mA)=(milliamp)(mM)=(millimolar)FARADAY=(faraday)(coulomb)R=(k-mole)(joule/degC)}PARAMETER{celsius(degC)g=1e-3(mho/cm2)tau_ina=100(ms)tau_act=992(ms)rmax=1ec50=.145(mM)Nh=1.4n=4tauavg=300(ms)}ASSIGNED{v(mV)ina(mA/cm2)ik(mA/cm2)ena(mV)ek(mV)cao(mM)kikonainaogpresentitot}STATE{m}BREAKPOINT{SOLVEgatestateMETHODcnexpgpresent=g*m^nina=gpresent*(v-ena)ik=gpresent*(v-ek)itot=ik+ina}INITIAL{m=hill(cao)gpresent=g*m^nina=gpresent*(v-ena)ik=gpresent*(v-ek)itot=ik+ina}DERIVATIVEgatestate{m'=((hill(cao)-m)/tauavg)}FUNCTIONhill(co){TABLEDEPENDrmax,ec50,Nh,nFROM0TO15WITH150hill=(rmax/(1+(co/ec50)^Nh))^(1/n)}FUNCTIONghk(v(mV),ci(mM),co(mM))(.001coul/cm3){LOCALz,eci,ecoz=(1e-3)*1*FARADAY*v/(R*(celsius+273.11247574))eco=co*efun(z)eci=ci*efun(-z)ghk=(.001)*1*FARADAY*(eci-eco)}FUNCTIONefun(z){if(fabs(z)<1e-4){efun=1-z/2}else{efun=z/(exp(z)-1)}}