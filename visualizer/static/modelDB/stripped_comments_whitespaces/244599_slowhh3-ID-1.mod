UNITS{(molar)=(1/liter)(S)=(siemens)(mA)=(milliamp)(mV)=(millivolt)F=(faraday)(coulomb)R=(molek)(mV-coulomb/degC)(mM)=(millimolar)}NEURON{SUFFIXhh3USEIONnaREADnaiWRITEinaUSEIONkWRITEikRANGEsshift,shift,gnabar,gkhhbar,gkabar,ina,ikhh,ika,ik,ena,gk,gna,gkaGLOBALminf,hinf,ninf}INDEPENDENT{tFROM0TO1WITH1(ms)}PARAMETER{v(mV)dt(ms)nai(mM)celsius=35.0(degC)gnabar=550.0e-6(S/cm2)gkhhbar=665.0e-6(S/cm2)gkabar=266.0e-6(S/cm2)ek=-90.0(mV)nao=145(mM)qv=60.0(mV)qs=5.0(1)shift=0(mV)sshift=0(mV)}STATE{m<1e-4>h<1e-4>n<1e-4>p<1e-4>q<1e-4>}ASSIGNED{ina(mA/cm2)ik(mA/cm2)ika(mA/cm2)ikhh(mA/cm2)ena(mV)minfhinfninfqinfpinfgnagkgka}BREAKPOINT{SOLVEstatesMETHODcnexpnai=0.81ena=R*(celsius+273.15)/F*log(nao/nai)gk=n*n*ngna=m*m*m*hgka=p*qina=gnabar*gna*(v-ena)ikhh=gkhhbar*gk*(v-ek)ika=gkabar*gka*(v-ek)ik=ika+ikhh}UNITSOFFINITIAL{m=boltz(v,-30.0-shift,9.0-sshift)h=boltz(v,-35.0-shift,-10.0)n=boltz(v,-25.0,2.0)p=boltz(v,-27.0,6.5)q=1}DERIVATIVEstates{LOCALminf,hinf,ninf,pinf,qinf,mtau,htau,ntau,ptau,qtauminf=boltz(v,-30.0-shift,9.0-sshift)hinf=boltz(v,-35.0-shift,-10.0)ninf=boltz(v,-25,2.0)pinf=boltz(v,-27.0,6.5)qinf=boltz(v,-64.0,-4.9)mtau=1*boltz(v,-45.0,-1.5)-0.5*boltz(v,-65.0,-0.5)+0.01htau=3*56.0*boltz(v,-29.0,-4.5)-3*56.0*boltz(v,-49.0,-2.0)+0.4if(v>-40){ntau=1.0+10.0*exp(-(log(1.0+0.05*(v+40))/0.05*log(1.0+0.05*(v+40))/0.05)/100)}else{ntau=7+4*exp(-((v+40)/10.0)*((v+40)/10.0))}ptau=(1.029+4.83*boltz(v,-56.7,-6.22))qtau=(58.6+117.57*boltz(v,-68.5,-5.95))m'=(minf-m)/mtauh'=(hinf-h)/htaun'=(ninf-n)/ntaup'=(pinf-p)/ptauq'=(qinf-q)/qtau}FUNCTIONboltz(x,y,z){boltz=1/(1+exp(-(x-y)/z))}UNITSON