NEURON{THREADSAFESUFFIXkvUSEIONkREADekWRITEikRANGEn,gk,gbarRANGEninf,ntauGLOBALRa,RbGLOBALq10,temp,tadj,vmin,vmax}UNITS{(mA)=(milliamp)(mV)=(millivolt)(pS)=(picosiemens)(um)=(micron)}PARAMETER{gbar=5(pS/um2)tha=25(mV)qa=9(mV)Ra=0.02(/ms)Rb=0.002(/ms)temp=23(degC)q10=2.3vmin=-120(mV)vmax=100(mV)}ASSIGNED{v(mV)celsius(degC)a(/ms)b(/ms)ik(mA/cm2)gk(pS/um2)ek(mV)ninfntau(ms)tadj}STATE{n}INITIAL{tadj=q10^((celsius-temp)/(10(degC)))trates(v)n=ninf}BREAKPOINT{SOLVEstatesMETHODcnexpgk=gbar*nik=(1e-4)*gk*(v-ek)}DERIVATIVEstates{trates(v)n'=(ninf-n)/ntau}PROCEDUREtrates(v(mV)){TABLEninf,ntauDEPENDcelsius,temp,Ra,Rb,tha,qaFROMvminTOvmaxWITH199rates(v)}UNITSOFFPROCEDURErates(v(mV)){a=Ra*qa*efun((tha-v)/qa)b=Rb*qa*efun((v-tha)/qa)tadj=q10^((celsius-temp)/(10(degC)))ntau=1/tadj/(a+b)ninf=a/(a+b)}FUNCTIONefun(z){if(fabs(z)<1e-6){efun=1-z/2}else{efun=z/(exp(z)-1)}}UNITSON