NEURON{POINT_PROCESSinterD2pyrD_STFDUSEIONcaREADeca,icaNONSPECIFIC_CURRENTigabaRANGEinitWRANGECdur_gaba,AlphaTmax_gaba,Beta_gaba,Erev_gaba,gbar_gaba,W,on_gaba,g_gabaRANGEeca,tauCa,IcatotalRANGEICag,P0g,fCagRANGECainf,pooldiam,zRANGElambda1,lambda2,threshold1,threshold2RANGEfmax,fmin,Wmax,Wmin,maxChange,normW,scaleW,srcid,destid,limitWRANGEpregid,postgid,thr_rpRANGEF,f,tauF,D1,d1,tauD1,D2,d2,tauD2RANGEfacfactorRANGEneuroM,type}UNITS{(mV)=(millivolt)(nA)=(nanoamp)(uS)=(microsiemens)FARADAY=96485(coul)pi=3.141592(1)}PARAMETER{srcid=-1(1)destid=-1(1)type=-1Cdur_gaba=0.7254(ms)AlphaTmax_gaba=1.52(/ms)Beta_gaba=0.14(/ms)Erev_gaba=-75(mV)gbar_gaba=0.6e-3(uS)Cainf=50e-6(mM)pooldiam=1.8172(micrometer)z=2neuroM=0k=0.01tauCa=50(ms)P0g=.01fCag=.024lambda1=1lambda2=.01threshold1=0.5threshold2=0.6initW=5.0fmax=3fmin=.8GAPstart1=96000GAPstop1=196000thr_rp=1facfactor=1f=0(1)<0,1e9>tauF=20(ms)<1e-9,1e9>d1=0.95(1)<0,1>tauD1=40(ms)<1e-9,1e9>d2=0.9(1)<0,1>tauD2=70(ms)<1e-9,1e9>DAstart1=39500DAstop1=40000DAstart2=35900DAstop2=36000DA_t1=0.7DA_t2=1.5DA_t3=1.25DA_S=1.6Beta1=0.001(/ms)Beta2=0.0001(/ms)NEstart1=39500NEstop1=40000NEstart2=35900NEstop2=36000NE_t1=1NE_t2=1NE_t3=1NE_S=1}ASSIGNED{v(mV)eca(mV)ica(nA)igaba(nA)g_gaba(uS)on_gabalimitWt0(ms)ICan(nA)ICag(nA)Afactor(mM/ms/nA)Icatotal(nA)dW_gabaWmaxWminmaxChangenormWscaleWpregidpostgidrptsynfaFD1D2}STATE{r_nmdar_gabacapoolconW}INITIAL{on_gaba=0r_gaba=0W=initWlimitW=1t0=-1Wmax=fmax*initWWmin=fmin*initWmaxChange=(Wmax-Wmin)/10dW_gaba=0capoolcon=CainfAfactor=1/(z*FARADAY*4/3*pi*(pooldiam/2)^3)*(1e6)fa=0F=1D1=1D2=1}BREAKPOINT{if((eta(capoolcon)*(lambda1*omega(capoolcon,threshold1,threshold2)-lambda2*GAP1(GAPstart1,GAPstop1)*W))>0&&W>=Wmax){limitW=1e-12}elseif((eta(capoolcon)*(lambda1*omega(capoolcon,threshold1,threshold2)-lambda2*GAP1(GAPstart1,GAPstop1)*W))<0&&W<=Wmin){limitW=1e-12}else{limitW=1}SOLVEreleaseMETHODcnexpif(neuroM==1){g_gaba=gbar_gaba*r_gaba*facfactor*DA1(DAstart1,DAstop1)*DA2(DAstart2,DAstop2)}elseif(neuroM==2){g_gaba=gbar_gaba*r_gaba*facfactor*NEn(NEstart1,NEstop1)*NE2(NEstart2,NEstop2)}elseif(neuroM==3){g_gaba=gbar_gaba*r_gaba*facfactor*DA1(DAstart1,DAstop1)*DA2(DAstart2,DAstop2)*NEn(NEstart1,NEstop1)*NE2(NEstart2,NEstop2)}else{g_gaba=gbar_gaba*r_gaba*facfactor}igaba=W*g_gaba*(v-Erev_gaba)ICag=P0g*g_gaba*(v-eca)Icatotal=ICag+k*ica*4*pi*((15/2)^2)*(0.01)}DERIVATIVErelease{W'=1e-12*limitW*eta(capoolcon)*(lambda1*omega(capoolcon,threshold1,threshold2)-lambda2*GAP1(GAPstart1,GAPstop1)*W)r_gaba'=AlphaTmax_gaba*on_gaba*(1-r_gaba)-Beta_gaba*r_gabacapoolcon'=-fCag*Afactor*Icatotal+(Cainf-capoolcon)/tauCa}NET_RECEIVE(dummy_weight){if(flag==0){if((!on_gaba)){t0=ton_gaba=1net_send(Cdur_gaba,1)}elseif(on_gaba==1){net_move(t+Cdur_gaba)t0=t}}if(flag==1){on_gaba=0}if(flag==0){rp=unirand()D1=1-(1-D1)*exp(-(t-tsyn)/tauD1)D2=1-(1-D2)*exp(-(t-tsyn)/tauD2)tsyn=tfacfactor=F*D1*D2if(F>3){F=3}if(facfactor<0.7){facfactor=0.7}D1=D1*d1D2=D2*d2}}FUNCTIONeta(Cani(mM)){LOCALtaulearn,P1,P2,P4,CaconP1=0.1P2=P1*1e-4P4=1Cacon=Cani*1e3taulearn=P1/(P2+Cacon*Cacon*Cacon)+P4eta=1/taulearn*0.001}FUNCTIONomega(Cani(mM),threshold1(uM),threshold2(uM)){LOCALr,mid,CaconCacon=Cani*1e3r=(threshold2-threshold1)/2mid=(threshold1+threshold2)/2if(Cacon<=threshold1){omega=0}elseif(Cacon>=threshold2){omega=1/(1+50*exp(-50*(Cacon-threshold2)))}else{omega=-sqrt(r*r-(Cacon-mid)*(Cacon-mid))}}FUNCTIONDA1(DAstart1(ms),DAstop1(ms)){LOCALDAtemp1,DAtemp2,DAtemp3,DAtemp4,DAtemp5,DAtemp6,DAtemp7,DAtemp8,DAtemp9,DAtemp10,DAtemp11,DAtemp12,DAtemp13,DAtemp14,DAtemp15,DAtemp16,DAtemp17,DAtemp18,DAtemp19,DAtemp20,DAtemp21,DAtemp22,DAtemp23,DAtemp24,DAtemp25,DAtemp26,DAtemp27,DAtemp28,DAtemp29,DAtemp30,DAtemp31,DAtemp32,DAtemp33,DAtemp34,sDAtemp1=DAstart1+4000DAtemp2=DAtemp1+4000DAtemp3=DAtemp2+4000DAtemp4=DAtemp3+4000DAtemp5=DAtemp4+4000DAtemp6=DAtemp5+4000DAtemp7=DAtemp6+4000DAtemp8=DAtemp7+4000DAtemp9=DAtemp8+4000DAtemp10=DAtemp9+4000DAtemp11=DAtemp10+4000DAtemp12=DAtemp11+4000DAtemp13=DAtemp12+4000DAtemp14=DAtemp13+4000DAtemp15=DAtemp14+4000+100000DAtemp16=DAtemp15+4000DAtemp17=DAtemp16+4000DAtemp18=DAtemp17+4000DAtemp19=DAtemp18+4000DAtemp20=DAtemp19+4000DAtemp21=DAtemp20+4000DAtemp22=DAtemp21+4000DAtemp23=DAtemp22+4000DAtemp24=DAtemp23+4000DAtemp25=DAtemp24+4000DAtemp26=DAtemp25+4000DAtemp27=DAtemp26+4000DAtemp28=DAtemp27+4000DAtemp29=DAtemp28+4000DAtemp30=DAtemp29+4000DAtemp31=DAtemp30+4000DAtemp32=DAtemp31+4000DAtemp33=DAtemp32+4000DAtemp34=DAtemp33+4000if(t<=DAstart1){DA1=1.0}elseif(t>=DAstart1&&t<=DAstop1){DA1=DA_t1}elseif(t>DAstop1&&t<DAtemp1){DA1=1.0+(DA_t1-1)*exp(-Beta1*(t-DAstop1))}elseif(t>=DAtemp1&&t<=DAtemp1+500){DA1=DA_t1}elseif(t>DAtemp1+500&&t<DAtemp2){DA1=1.0+(DA_t1-1)*exp(-Beta1*(t-(DAtemp1+500)))}elseif(t>=DAtemp2&&t<=DAtemp2+500){DA1=DA_t1}elseif(t>DAtemp2+500&&t<DAtemp3){DA1=1.0+(DA_t1-1)*exp(-Beta1*(t-(DAtemp2+500)))}elseif(t>=DAtemp3&&t<=DAtemp3+500){DA1=DA_t1}elseif(t>DAtemp3+500&&t<DAtemp4){DA1=1.0+(DA_t1-1)*exp(-Beta1*(t-(DAtemp3+500)))}elseif(t>=DAtemp4&&t<=DAtemp4+500){DA1=DA_t1}elseif(t>DAtemp4+500&&t<DAtemp5){DA1=1.0+(DA_t1-1)*exp(-Beta1*(t-(DAtemp4+500)))}elseif(t>=DAtemp5&&t<=DAtemp5+500){DA1=DA_t1}elseif(t>DAtemp5+500&&t<DAtemp6){DA1=1.0+(DA_t1-1)*exp(-Beta1*(t-(DAtemp5+500)))}elseif(t>=DAtemp6&&t<=DAtemp6+500){DA1=DA_t1}elseif(t>DAtemp6+500&&t<DAtemp7){DA1=1.0+(DA_t1-1)*exp(-Beta1*(t-(DAtemp6+500)))}elseif(t>=DAtemp7&&t<=DAtemp7+500){DA1=DA_t1}elseif(t>DAtemp7+500&&t<DAtemp8){DA1=1.0+(DA_t1-1)*exp(-Beta1*(t-(DAtemp7+500)))}elseif(t>=DAtemp8&&t<=DAtemp8+500){DA1=DA_t1}elseif(t>DAtemp8+500&&t<DAtemp9){DA1=1.0+(DA_t1-1)*exp(-Beta1*(t-(DAtemp8+500)))}elseif(t>=DAtemp9&&t<=DAtemp9+500){DA1=DA_t2}elseif(t>DAtemp9+500&&t<DAtemp10){DA1=1.0+(DA_t2-1)*exp(-Beta2*(t-(DAtemp9+500)))}elseif(t>=DAtemp10&&t<=DAtemp10+500){DA1=DA_t2}elseif(t>DAtemp10+500&&t<DAtemp11){DA1=1.0+(DA_t2-1)*exp(-Beta2*(t-(DAtemp10+500)))}elseif(t>=DAtemp11&&t<=DAtemp11+500){DA1=DA_t2}elseif(t>DAtemp11+500&&t<DAtemp12){DA1=1.0+(DA_t2-1)*exp(-Beta2*(t-(DAtemp11+500)))}elseif(t>=DAtemp12&&t<=DAtemp12+500){DA1=DA_t2}elseif(t>DAtemp12+500&&t<DAtemp13){DA1=1.0+(DA_t2-1)*exp(-Beta2*(t-(DAtemp12+500)))}elseif(t>=DAtemp13&&t<=DAtemp13+500){DA1=DA_t2}elseif(t>DAtemp13+500&&t<DAtemp14){DA1=1.0+(DA_t2-1)*exp(-Beta2*(t-(DAtemp13+500)))}elseif(t>=DAtemp14&&t<=DAtemp14+500){DA1=DA_t2}elseif(t>DAtemp14+500&&t<DAtemp15){DA1=1.0+(DA_t2-1)*exp(-Beta2*(t-(DAtemp14+500)))}elseif(t>=DAtemp15&&t<=DAtemp15+500){DA1=DA_t2}elseif(t>DAtemp15+500&&t<DAtemp16){DA1=1.0+(DA_t2-1)*exp(-Beta2*(t-(DAtemp15+500)))}elseif(t>=DAtemp16&&t<=DAtemp16+500){DA1=DA_t2}elseif(t>DAtemp16+500&&t<DAtemp17){DA1=1.0+(DA_t2-1)*exp(-Beta2*(t-(DAtemp16+500)))}elseif(t>=DAtemp17&&t<=DAtemp17+500){DA1=DA_t2}elseif(t>DAtemp17+500&&t<DAtemp18){DA1=1.0+(DA_t2-1)*exp(-Beta2*(t-(DAtemp17+500)))}elseif(t>=DAtemp18&&t<=DAtemp18+500){DA1=DA_t2}elseif(t>DAtemp18+500&&t<DAtemp19){DA1=1.0+(DA_t2-1)*exp(-Beta2*(t-(DAtemp18+500)))}elseif(t>=DAtemp19&&t<=DAtemp19+500){DA1=DA_t3}elseif(t>DAtemp19+500&&t<DAtemp20){DA1=1.0+(DA_t2-1)*exp(-Beta2*(t-(DAtemp19+500)))}elseif(t>=DAtemp20&&t<=DAtemp20+500){DA1=DA_t3}elseif(t>DAtemp20+500&&t<DAtemp21){DA1=1.0+(DA_t2-1)*exp(-Beta2*(t-(DAtemp20+500)))}elseif(t>=DAtemp21&&t<=DAtemp21+500){DA1=DA_t3}elseif(t>DAtemp21+500&&t<DAtemp22){DA1=1.0+(DA_t2-1)*exp(-Beta2*(t-(DAtemp21+500)))}elseif(t>=DAtemp22&&t<=DAtemp22+500){DA1=DA_t3}elseif(t>DAtemp22+500&&t<DAtemp23){DA1=1.0+(DA_t2-1)*exp(-Beta2*(t-(DAtemp22+500)))}elseif(t>=DAtemp23&&t<=DAtemp23+500){DA1=DA_t3}elseif(t>DAtemp23+500&&t<DAtemp24){DA1=1.0+(DA_t2-1)*exp(-Beta2*(t-(DAtemp23+500)))}elseif(t>=DAtemp24&&t<=DAtemp24+500){DA1=DA_t3}elseif(t>DAtemp24+500&&t<DAtemp25){DA1=1.0+(DA_t2-1)*exp(-Beta2*(t-(DAtemp24+500)))}elseif(t>=DAtemp25&&t<=DAtemp25+500){DA1=DA_t3}elseif(t>DAtemp25+500&&t<DAtemp26){DA1=1.0+(DA_t2-1)*exp(-Beta2*(t-(DAtemp25+500)))}elseif(t>=DAtemp26&&t<=DAtemp26+500){DA1=DA_t3}elseif(t>DAtemp26+500&&t<DAtemp27){DA1=1.0+(DA_t2-1)*exp(-Beta2*(t-(DAtemp26+500)))}elseif(t>=DAtemp27&&t<=DAtemp27+500){DA1=DA_t3}elseif(t>DAtemp27+500&&t<DAtemp28){DA1=1.0+(DA_t2-1)*exp(-Beta2*(t-(DAtemp27+500)))}elseif(t>=DAtemp28&&t<=DAtemp28+500){DA1=DA_t3}elseif(t>DAtemp28+500&&t<DAtemp29){DA1=1.0+(DA_t2-1)*exp(-Beta2*(t-(DAtemp28+500)))}elseif(t>=DAtemp29&&t<=DAtemp29+500){DA1=DA_t3}elseif(t>DAtemp29+500&&t<DAtemp30){DA1=1.0+(DA_t2-1)*exp(-Beta2*(t-(DAtemp29+500)))}elseif(t>=DAtemp30&&t<=DAtemp30+500){DA1=DA_t3}elseif(t>DAtemp30+500&&t<DAtemp31){DA1=1.0+(DA_t2-1)*exp(-Beta2*(t-(DAtemp30+500)))}elseif(t>=DAtemp31&&t<=DAtemp31+500){DA1=DA_t3}elseif(t>DAtemp31+500&&t<DAtemp32){DA1=1.0+(DA_t2-1)*exp(-Beta2*(t-(DAtemp31+500)))}elseif(t>=DAtemp32&&t<=DAtemp32+500){DA1=DA_t3}elseif(t>DAtemp32+500&&t<DAtemp33){DA1=1.0+(DA_t2-1)*exp(-Beta2*(t-(DAtemp32+500)))}elseif(t>=DAtemp33&&t<=DAtemp33+500){DA1=DA_t3}elseif(t>DAtemp33+500&&t<DAtemp34){DA1=1.0+(DA_t2-1)*exp(-Beta2*(t-(DAtemp33+500)))}elseif(t>=DAtemp34&&t<=DAtemp34+500){DA1=DA_t3}else{DA1=1.0}}FUNCTIONDA2(DAstart2(ms),DAstop2(ms)){LOCALDA2temp1,DA2temp2,DA2temp3,DA2temp4,DA2temp5,DA2temp6,DA2temp7,DA2temp8,DA2temp9,DA2temp10,DA2temp11,DA2temp12,DA2temp13,DA2temp14,DA2temp15,DA2temp16,sDA2temp1=DAstart2+4000DA2temp2=DA2temp1+4000DA2temp3=DA2temp2+4000DA2temp4=DA2temp3+4000DA2temp5=DA2temp4+4000DA2temp6=DA2temp5+4000DA2temp7=DA2temp6+4000DA2temp8=DA2temp7+4000DA2temp9=DA2temp8+4000DA2temp10=DA2temp9+4000DA2temp11=DA2temp10+4000DA2temp12=DA2temp11+4000DA2temp13=DA2temp12+4000DA2temp14=DA2temp13+4000DA2temp15=DA2temp14+4000if(t<=DAstart2){DA2=1.0}elseif(t>=DAstart2&&t<=DAstop2){DA2=DA_S}elseif(t>DAstop2&&t<DA2temp1){DA2=1.0+(DA_S-1)*exp(-Beta2*(t-(DAstop2+500)))}elseif(t>=DA2temp1&&t<=DA2temp1+100){DA2=DA_S}elseif(t>DA2temp1+100&&t<DA2temp2){DA2=1.0+(DA_S-1)*exp(-Beta2*(t-(DA2temp1+100)))}elseif(t>=DA2temp2&&t<=DA2temp2+100){DA2=DA_S}elseif(t>DA2temp2+100&&t<DA2temp3){DA2=1.0+(DA_S-1)*exp(-Beta2*(t-(DA2temp2+100)))}elseif(t>=DA2temp3&&t<=DA2temp3+100){DA2=DA_S}elseif(t>DA2temp3+100&&t<DA2temp4){DA2=1.0+(DA_S-1)*exp(-Beta2*(t-(DA2temp3+100)))}elseif(t>=DA2temp4&&t<=DA2temp4+100){DA2=DA_S}elseif(t>DA2temp4+100&&t<DA2temp5){DA2=1.0+(DA_S-1)*exp(-Beta2*(t-(DA2temp4+100)))}elseif(t>=DA2temp5&&t<=DA2temp5+100){DA2=DA_S}elseif(t>DA2temp5+100&&t<DA2temp6){DA2=1.0+(DA_S-1)*exp(-Beta2*(t-(DA2temp5+100)))}elseif(t>=DA2temp6&&t<=DA2temp6+100){DA2=DA_S}elseif(t>DA2temp6+100&&t<DA2temp7){DA2=1.0+(DA_S-1)*exp(-Beta2*(t-(DA2temp6+100)))}elseif(t>=DA2temp7&&t<=DA2temp7+100){DA2=DA_S}elseif(t>DA2temp7+100&&t<DA2temp8){DA2=1.0+(DA_S-1)*exp(-Beta2*(t-(DA2temp7+100)))}elseif(t>=DA2temp8&&t<=DA2temp8+100){DA2=DA_S}elseif(t>DA2temp8+100&&t<DA2temp9){DA2=1.0+(DA_S-1)*exp(-Beta2*(t-(DA2temp8+100)))}elseif(t>=DA2temp9&&t<=DA2temp9+100){DA2=DA_S}elseif(t>DA2temp9+100&&t<DA2temp10){DA2=1.0+(DA_S-1)*exp(-Beta2*(t-(DA2temp9+100)))}elseif(t>=DA2temp10&&t<=DA2temp10+100){DA2=DA_S}elseif(t>DA2temp10+100&&t<DA2temp11){DA2=1.0+(DA_S-1)*exp(-Beta2*(t-(DA2temp10+100)))}elseif(t>=DA2temp11&&t<=DA2temp11+100){DA2=DA_S}elseif(t>DA2temp11+100&&t<DA2temp12){DA2=1.0+(DA_S-1)*exp(-Beta2*(t-(DA2temp11+100)))}elseif(t>=DA2temp12&&t<=DA2temp12+100){DA2=DA_S}elseif(t>DA2temp12+100&&t<DA2temp13){DA2=1.0+(DA_S-1)*exp(-Beta2*(t-(DA2temp12+100)))}elseif(t>=DA2temp13&&t<=DA2temp13+100){DA2=DA_S}elseif(t>DA2temp13+100&&t<DA2temp14){DA2=1.0+(DA_S-1)*exp(-Beta2*(t-(DA2temp13+100)))}elseif(t>=DA2temp14&&t<=DA2temp14+100){DA2=DA_S}elseif(t>DA2temp14+100&&t<DA2temp15){DA2=1.0+(DA_S-1)*exp(-Beta2*(t-(DA2temp14+100)))}elseif(t>=DA2temp15&&t<=DA2temp15+100){DA2=DA_S}else{DA2=1.0}}FUNCTIONNEn(NEstart1(ms),NEstop1(ms)){LOCALNEtemp1,NEtemp2,NEtemp3,NEtemp4,NEtemp5,NEtemp6,NEtemp7,NEtemp8,NEtemp9,NEtemp10,NEtemp11,NEtemp12,NEtemp13,NEtemp14,NEtemp15,NEtemp16,NEtemp17,NEtemp18,NEtemp19,NEtemp20,NEtemp21,NEtemp22,NEtemp23,NEtemp24,NEtemp25,NEtemp26,NEtemp27,NEtemp28,NEtemp29,NEtemp30,NEtemp31,NEtemp32,NEtemp33,NEtemp34,sNEtemp1=NEstart1+4000NEtemp2=NEtemp1+4000NEtemp3=NEtemp2+4000NEtemp4=NEtemp3+4000NEtemp5=NEtemp4+4000NEtemp6=NEtemp5+4000NEtemp7=NEtemp6+4000NEtemp8=NEtemp7+4000NEtemp9=NEtemp8+4000NEtemp10=NEtemp9+4000NEtemp11=NEtemp10+4000NEtemp12=NEtemp11+4000NEtemp13=NEtemp12+4000NEtemp14=NEtemp13+4000NEtemp15=NEtemp14+4000+100000NEtemp16=NEtemp15+4000NEtemp17=NEtemp16+4000NEtemp18=NEtemp17+4000NEtemp19=NEtemp18+4000NEtemp20=NEtemp19+4000NEtemp21=NEtemp20+4000NEtemp22=NEtemp21+4000NEtemp23=NEtemp22+4000NEtemp24=NEtemp23+4000NEtemp25=NEtemp24+4000NEtemp26=NEtemp25+4000NEtemp27=NEtemp26+4000NEtemp28=NEtemp27+4000NEtemp29=NEtemp28+4000NEtemp30=NEtemp29+4000NEtemp31=NEtemp30+4000NEtemp32=NEtemp31+4000NEtemp33=NEtemp32+4000NEtemp34=NEtemp33+4000if(t<=NEstart1){NEn=1.0}elseif(t>=NEstart1&&t<=NEstop1){NEn=NE_t1}elseif(t>NEstop1&&t<NEtemp1){NEn=1.0+(NE_t1-1)*exp(-Beta1*(t-NEstop1))}elseif(t>=NEtemp1&&t<=NEtemp1+500){NEn=NE_t1}elseif(t>NEtemp1+500&&t<NEtemp2){NEn=1.0+(NE_t1-1)*exp(-Beta1*(t-NEstop1))}elseif(t>=NEtemp2&&t<=NEtemp2+500){NEn=NE_t1}elseif(t>NEtemp2+500&&t<NEtemp3){NEn=1.0+(NE_t1-1)*exp(-Beta1*(t-(NEtemp2+500)))}elseif(t>=NEtemp3&&t<=NEtemp3+500){NEn=NE_t1}elseif(t>NEtemp3+500&&t<NEtemp4){NEn=1.0+(NE_t1-1)*exp(-Beta1*(t-(NEtemp3+500)))}elseif(t>=NEtemp4&&t<=NEtemp4+500){NEn=NE_t1}elseif(t>NEtemp4+500&&t<NEtemp5){NEn=1.0+(NE_t1-1)*exp(-Beta1*(t-(NEtemp4+500)))}elseif(t>=NEtemp5&&t<=NEtemp5+500){NEn=NE_t1}elseif(t>NEtemp5+500&&t<NEtemp6){NEn=1.0+(NE_t1-1)*exp(-Beta1*(t-(NEtemp5+500)))}elseif(t>=NEtemp6&&t<=NEtemp6+500){NEn=NE_t1}elseif(t>NEtemp6+500&&t<NEtemp7){NEn=1.0+(NE_t1-1)*exp(-Beta1*(t-(NEtemp6+500)))}elseif(t>=NEtemp7&&t<=NEtemp7+500){NEn=NE_t2}elseif(t>NEtemp7+500&&t<NEtemp8){NEn=1.0+(NE_t2-1)*exp(-Beta2*(t-(NEtemp7+500)))}elseif(t>=NEtemp8&&t<=NEtemp8+500){NEn=NE_t2}elseif(t>NEtemp8+500&&t<NEtemp9){NEn=1.0+(NE_t2-1)*exp(-Beta2*(t-(NEtemp8+500)))}elseif(t>=NEtemp9&&t<=NEtemp9+500){NEn=NE_t2}elseif(t>NEtemp9+500&&t<NEtemp10){NEn=1.0+(NE_t2-1)*exp(-Beta2*(t-(NEtemp9+500)))}elseif(t>=NEtemp10&&t<=NEtemp10+500){NEn=NE_t2}elseif(t>NEtemp10+500&&t<NEtemp11){NEn=1.0+(NE_t2-1)*exp(-Beta2*(t-(NEtemp10+500)))}elseif(t>=NEtemp11&&t<=NEtemp11+500){NEn=NE_t2}elseif(t>NEtemp11+500&&t<NEtemp12){NEn=1.0+(NE_t2-1)*exp(-Beta2*(t-(NEtemp11+500)))}elseif(t>=NEtemp12&&t<=NEtemp12+500){NEn=NE_t2}elseif(t>NEtemp12+500&&t<NEtemp13){NEn=1.0+(NE_t2-1)*exp(-Beta2*(t-(NEtemp12+500)))}elseif(t>=NEtemp13&&t<=NEtemp13+500){NEn=NE_t2}elseif(t>NEtemp13+500&&t<NEtemp14){NEn=1.0+(NE_t2-1)*exp(-Beta2*(t-(NEtemp13+500)))}elseif(t>=NEtemp14&&t<=NEtemp14+500){NEn=NE_t2}elseif(t>NEtemp14+500&&t<NEtemp15){NEn=1.0+(NE_t2-1)*exp(-Beta2*(t-(NEtemp14+500)))}elseif(t>=NEtemp15&&t<=NEtemp15+500){NEn=NE_t2}elseif(t>NEtemp15+500&&t<NEtemp16){NEn=1.0+(NE_t2-1)*exp(-Beta2*(t-(NEtemp15+500)))}elseif(t>=NEtemp16&&t<=NEtemp16+500){NEn=NE_t2}elseif(t>NEtemp16+500&&t<NEtemp17){NEn=1.0+(NE_t2-1)*exp(-Beta2*(t-(NEtemp16+500)))}elseif(t>=NEtemp17&&t<=NEtemp17+500){NEn=NE_t2}elseif(t>NEtemp17+500&&t<NEtemp18){NEn=1.0+(NE_t2-1)*exp(-Beta2*(t-(NEtemp17+500)))}elseif(t>=NEtemp18&&t<=NEtemp18+500){NEn=NE_t2}elseif(t>NEtemp18+500&&t<NEtemp19){NEn=1.0+(NE_t2-1)*exp(-Beta2*(t-(NEtemp18+500)))}elseif(t>=NEtemp19&&t<=NEtemp19+500){NEn=NE_t3}elseif(t>NEtemp19+500&&t<NEtemp20){NEn=1.0+(NE_t2-1)*exp(-Beta2*(t-(NEtemp19+500)))}elseif(t>=NEtemp20&&t<=NEtemp20+500){NEn=NE_t3}elseif(t>NEtemp20+500&&t<NEtemp21){NEn=1.0+(NE_t2-1)*exp(-Beta2*(t-(NEtemp20+500)))}elseif(t>=NEtemp21&&t<=NEtemp21+500){NEn=NE_t3}elseif(t>NEtemp21+500&&t<NEtemp22){NEn=1.0+(NE_t2-1)*exp(-Beta2*(t-(NEtemp21+500)))}elseif(t>=NEtemp22&&t<=NEtemp22+500){NEn=NE_t3}elseif(t>NEtemp22+500&&t<NEtemp23){NEn=1.0+(NE_t2-1)*exp(-Beta2*(t-(NEtemp22+500)))}elseif(t>=NEtemp23&&t<=NEtemp23+500){NEn=NE_t3}elseif(t>NEtemp23+500&&t<NEtemp24){NEn=1.0+(NE_t2-1)*exp(-Beta2*(t-(NEtemp23+500)))}elseif(t>=NEtemp24&&t<=NEtemp24+500){NEn=NE_t3}elseif(t>NEtemp24+500&&t<NEtemp25){NEn=1.0+(NE_t2-1)*exp(-Beta2*(t-(NEtemp24+500)))}elseif(t>=NEtemp25&&t<=NEtemp25+500){NEn=NE_t3}elseif(t>NEtemp25+500&&t<NEtemp26){NEn=1.0+(NE_t2-1)*exp(-Beta2*(t-(NEtemp25+500)))}elseif(t>=NEtemp26&&t<=NEtemp26+500){NEn=NE_t3}elseif(t>NEtemp26+500&&t<NEtemp27){NEn=1.0+(NE_t2-1)*exp(-Beta2*(t-(NEtemp26+500)))}elseif(t>=NEtemp27&&t<=NEtemp27+500){NEn=NE_t3}elseif(t>NEtemp27+500&&t<NEtemp28){NEn=1.0+(NE_t2-1)*exp(-Beta2*(t-(NEtemp27+500)))}elseif(t>=NEtemp28&&t<=NEtemp28+500){NEn=NE_t3}elseif(t>NEtemp28+500&&t<NEtemp29){NEn=1.0+(NE_t2-1)*exp(-Beta2*(t-(NEtemp28+500)))}elseif(t>=NEtemp29&&t<=NEtemp29+500){NEn=NE_t3}elseif(t>NEtemp29+500&&t<NEtemp30){NEn=1.0+(NE_t2-1)*exp(-Beta2*(t-(NEtemp29+500)))}elseif(t>=NEtemp30&&t<=NEtemp30+500){NEn=NE_t3}elseif(t>NEtemp30+500&&t<NEtemp31){NEn=1.0+(NE_t2-1)*exp(-Beta2*(t-(NEtemp30+500)))}elseif(t>=NEtemp31&&t<=NEtemp31+500){NEn=NE_t3}elseif(t>NEtemp31+500&&t<NEtemp32){NEn=1.0+(NE_t2-1)*exp(-Beta2*(t-(NEtemp31+500)))}elseif(t>=NEtemp32&&t<=NEtemp32+500){NEn=NE_t3}elseif(t>NEtemp32+500&&t<NEtemp33){NEn=1.0+(NE_t2-1)*exp(-Beta2*(t-(NEtemp32+500)))}elseif(t>=NEtemp33&&t<=NEtemp33+500){NEn=NE_t3}elseif(t>NEtemp33+500&&t<NEtemp34){NEn=1.0+(NE_t2-1)*exp(-Beta2*(t-(NEtemp33+500)))}elseif(t>=NEtemp34&&t<=NEtemp34+500){NEn=NE_t3}else{NEn=1.0}}FUNCTIONNE2(NEstart2(ms),NEstop2(ms)){LOCALNE2temp1,NE2temp2,NE2temp3,NE2temp4,NE2temp5,NE2temp6,NE2temp7,NE2temp8,NE2temp9,NE2temp10,NE2temp11,NE2temp12,NE2temp13,NE2temp14,NE2temp15,NE2temp16,sNE2temp1=NEstart2+4000NE2temp2=NE2temp1+4000NE2temp3=NE2temp2+4000NE2temp4=NE2temp3+4000NE2temp5=NE2temp4+4000NE2temp6=NE2temp5+4000NE2temp7=NE2temp6+4000NE2temp8=NE2temp7+4000NE2temp9=NE2temp8+4000NE2temp10=NE2temp9+4000NE2temp11=NE2temp10+4000NE2temp12=NE2temp11+4000NE2temp13=NE2temp12+4000NE2temp14=NE2temp13+4000NE2temp15=NE2temp14+4000if(t<=NEstart2){NE2=1.0}elseif(t>=NEstart2&&t<=NEstop2){NE2=NE_S}elseif(t>NEstop2&&t<NE2temp1){NE2=1.0+(NE_S-1)*exp(-Beta2*(t-(NEstop2+500)))}elseif(t>=NE2temp1&&t<=NE2temp1+100){NE2=NE_S}elseif(t>NE2temp1+100&&t<NE2temp2){NE2=1.0+(NE_S-1)*exp(-Beta2*(t-(NE2temp1+100)))}elseif(t>=NE2temp2&&t<=NE2temp2+100){NE2=NE_S}elseif(t>NE2temp2+100&&t<NE2temp3){NE2=1.0+(NE_S-1)*exp(-Beta2*(t-(NE2temp2+100)))}elseif(t>=NE2temp3&&t<=NE2temp3+100){NE2=NE_S}elseif(t>NE2temp3+100&&t<NE2temp4){NE2=1.0+(NE_S-1)*exp(-Beta2*(t-(NE2temp3+100)))}elseif(t>=NE2temp4&&t<=NE2temp4+100){NE2=NE_S}elseif(t>NE2temp4+100&&t<NE2temp5){NE2=1.0+(NE_S-1)*exp(-Beta2*(t-(NE2temp4+100)))}elseif(t>=NE2temp5&&t<=NE2temp5+100){NE2=NE_S}elseif(t>NE2temp5+100&&t<NE2temp6){NE2=1.0+(NE_S-1)*exp(-Beta2*(t-(NE2temp5+100)))}elseif(t>=NE2temp6&&t<=NE2temp6+100){NE2=NE_S}elseif(t>NE2temp6+100&&t<NE2temp7){NE2=1.0+(NE_S-1)*exp(-Beta2*(t-(NE2temp6+100)))}elseif(t>=NE2temp7&&t<=NE2temp7+100){NE2=NE_S}elseif(t>NE2temp7+100&&t<NE2temp8){NE2=1.0+(NE_S-1)*exp(-Beta2*(t-(NE2temp7+100)))}elseif(t>=NE2temp8&&t<=NE2temp8+100){NE2=NE_S}elseif(t>NE2temp8+100&&t<NE2temp9){NE2=1.0+(NE_S-1)*exp(-Beta2*(t-(NE2temp8+100)))}elseif(t>=NE2temp9&&t<=NE2temp9+100){NE2=NE_S}elseif(t>NE2temp9+100&&t<NE2temp10){NE2=1.0+(NE_S-1)*exp(-Beta2*(t-(NE2temp9+100)))}elseif(t>=NE2temp10&&t<=NE2temp10+100){NE2=NE_S}elseif(t>NE2temp10+100&&t<NE2temp11){NE2=1.0+(NE_S-1)*exp(-Beta2*(t-(NE2temp10+100)))}elseif(t>=NE2temp11&&t<=NE2temp11+100){NE2=NE_S}elseif(t>NE2temp11+100&&t<NE2temp12){NE2=1.0+(NE_S-1)*exp(-Beta2*(t-(NE2temp11+100)))}elseif(t>=NE2temp12&&t<=NE2temp12+100){NE2=NE_S}elseif(t>NE2temp12+100&&t<NE2temp13){NE2=1.0+(NE_S-1)*exp(-Beta2*(t-(NE2temp12+100)))}elseif(t>=NE2temp13&&t<=NE2temp13+100){NE2=NE_S}elseif(t>NE2temp13+100&&t<NE2temp14){NE2=1.0+(NE_S-1)*exp(-Beta2*(t-(NE2temp13+100)))}elseif(t>=NE2temp14&&t<=NE2temp14+100){NE2=NE_S}elseif(t>NE2temp14+100&&t<NE2temp15){NE2=1.0+(NE_S-1)*exp(-Beta2*(t-(NE2temp14+100)))}elseif(t>=NE2temp15&&t<=NE2temp15+100){NE2=NE_S}else{NE2=1.0}}FUNCTIONGAP1(GAPstart1(ms),GAPstop1(ms)){LOCALsif(t<=GAPstart1){GAP1=1}elseif(t>=GAPstop1){GAP1=1}else{GAP1=1}}FUNCTIONunirand(){unirand=scop_random()}