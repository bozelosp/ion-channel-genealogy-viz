UNITS{(molar)=(1/liter)(mV)=(millivolt)(mA)=(milliamp)(mM)=(millimolar)}INDEPENDENT{tFROM0TO1WITH100(ms)}NEURON{SUFFIXkdrgliaUSEIONkREADekWRITEikRANGEgkbar,gk,ik,qkGLOBALscaletaun,shiftn}UNITS{FARADAY=96485.309(coul)R=(k-mole)(joule/degC)PI=(pi)(1)}PARAMETER{gkbar=0(mho/cm2)scaletaun=1.5shiftn=50(mV)}ASSIGNED{ik(mA/cm2)v(mV)ek(mV)dt(ms)gk(S/cm2)diam(um)}STATE{ncqk}BREAKPOINT{SOLVEkstateMETHODsparsegk=gkbar*n*n*n*nik=gk*(v-ek)}INITIAL{n=n_inf(v)c=1-ngk=gkbar*n*n*n*nik=gk*(v-ek)qk=0}LOCALa1,a2KINETICkstate{a1=a_n(v)a2=a_c(v)~c<->n(a1,a2)CONSERVEn+c=1COMPARTMENTdiam*diam*PI/4{qk}~qk<<(-ik*diam*PI*(1e4)/FARADAY)}FUNCTIONa_n(v(mV)){TABLEDEPENDscaletaun,shiftnFROM-150TO150WITH200a_n=scaletaun*0.016*(35.1-v-shiftn-70)/(exp((35.1-v-shiftn-70)/5)-1)}FUNCTIONa_c(v(mV)){TABLEDEPENDscaletaun,shiftnFROM-150TO150WITH200a_c=scaletaun*0.25*exp((20-v-shiftn-70)/40)}FUNCTIONn_inf(v(mV)){n_inf=a_n(v)/(a_n(v)+a_c(v))}FUNCTIONwindow(v(mV)){window=gkbar*n_inf(v)^4*(v-ek)}