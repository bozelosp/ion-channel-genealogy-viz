NEURON{SUFFIXcarUSEIONcaREADcaoWRITEicaRANGEgcabar,m,h,icaRANGEinf,fac,tau,ica}UNITS{(mA)=(milliamp)(mV)=(millivolt)(molar)=(1/liter)(mM)=(millimolar)FARADAY=(faraday)(coulomb)R=(k-mole)(joule/degC)}ASSIGNED{ica(mA/cm2)inf[2]tau[2](ms)v(mV)celsius(degC)cai(mM)cao(mM)}PARAMETER{gcabar=0(mho/cm2)eca=140(mV)}STATE{mh}INITIAL{rates(v)m=0h=1}BREAKPOINT{SOLVEstatesMETHODcnexpica=gcabar*m*m*m*h*(v-eca)}DERIVATIVEstates{rates(v)m'=(inf[0]-m)/tau[0]h'=(inf[1]-h)/tau[1]}PROCEDURErates(v(mV)){LOCALa,bFROMi=0TO1{tau[i]=vartau(v,i)inf[i]=varss(v,i)}}FUNCTIONvarss(v(mV),i){LOCALArgif(i==0){Arg=(v+48.5)/(-3(mV))if(Arg<-50){varss=1}elseif(Arg>50){varss=0}else{varss=1/(1+exp(Arg))}}elseif(i==1){Arg=(v+53)/(1(mV))if(Arg<-50){varss=1}elseif(Arg>50){varss=0}else{varss=1/(1+exp(Arg))}}}FUNCTIONvartau(v(mV),i)(ms){if(i==0){vartau=5(ms)}elseif(i==1){vartau=50(ms)}}