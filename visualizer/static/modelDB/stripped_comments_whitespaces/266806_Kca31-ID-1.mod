NEURON{THREADSAFESUFFIXKca3_1USEIONkREADekWRITEikUSEIONcaREADcaiRANGEgkbar,ik,Yconcdep,YvdepRANGEYalpha,Ybeta,tauY,Y_inf}UNITS{(mA)=(milliamp)(mV)=(millivolt)(molar)=(1/liter)(mM)=(millimolar)}INDEPENDENT{tFROM0TO1WITH1(ms)}CONSTANT{q10=3}PARAMETER{v(mV)dt(ms)gkbar=0.120(mho/cm2)<0,1e9>Ybeta=0.05(/ms)cai(mM)}STATE{Y}ASSIGNED{ik(mA/cm2)Yalpha(/ms)YvdepYconcdep(/ms)tauY(ms)Y_infek(mV)qt}INITIAL{rate(v,cai)Y=Yalpha/(Yalpha+Ybeta)qt=q10^((celsius-37(degC))/10(degC))}BREAKPOINT{SOLVEstateMETHODcnexpik=gkbar*Y*(v-ek)}DERIVATIVEstate{rate(v,cai)Y'=Yalpha*(1-Y)-Ybeta*Y}PROCEDURErate(v(mV),cai(mM)){vdep(v)concdep(cai)Yalpha=Yvdep*YconcdeptauY=1/(Yalpha+Ybeta)Y_inf=Yalpha/(Yalpha+Ybeta)/qt}PROCEDUREvdep(v(mV)){TABLEYvdepFROM-100TO100WITH100Yvdep=exp((v*1(/mV)+70)/27)}PROCEDUREconcdep(cai(mM)){TABLEYconcdepFROM0TO0.01WITH1000if(cai<0.01){Yconcdep=500(/ms)*(0.015-cai*1(/mM))/(exp((0.015-cai*1(/mM))/0.0013)-1)}else{Yconcdep=500(/ms)*0.005/(exp(0.005/0.0013)-1)}}