NEURON{SUFFIXCa_HVAUSEIONcaREADeca,cai,caoWRITEicaRANGEgCa_HVAbar,gCa_HVA,icaGLOBALuse_ghk}UNITS{(S)=(siemens)(mV)=(millivolt)(mA)=(milliamp)}PARAMETER{gCa_HVAbar=0.00001(S/cm2)use_ghk=0}ASSIGNED{v(mV)eca(mV)ica(mA/cm2)cai(mM)cao(mM)gCa_HVA(S/cm2)mInfmTaumAlphamBetahInfhTauhAlphahBeta}STATE{mh}UNITSOFFFUNCTIONghk(v(mV),ci(mM),co(mM))(mV){LOCALnu,ff=KTF(celsius)/2nu=v/fghk=-f*(1.-(ci/co)*exp(nu))*efun(nu)}FUNCTIONKTF(celsius(degC))(mV){KTF=((25./293.15)*(celsius+273.15))}FUNCTIONefun(z){if(fabs(z)<1e-4){efun=1-z/2}else{efun=z/(exp(z)-1)}}UNITSONBREAKPOINT{SOLVEstatesMETHODcnexpgCa_HVA=gCa_HVAbar*m*m*hif(use_ghk==0){ica=gCa_HVA*(v-eca)}if(use_ghk==1){ica=gCa_HVA*(ghk(v,cai,cao)-106)}}DERIVATIVEstates{rates()m'=(mInf-m)/mTauh'=(hInf-h)/hTau}INITIAL{rates()m=mInfh=hInf}PROCEDURErates(){UNITSOFFif((v==-27)){v=v+0.0001}mAlpha=(0.055*(-27-v))/(exp((-27-v)/3.8)-1)mBeta=(0.94*exp((-75-v)/17))mInf=mAlpha/(mAlpha+mBeta)mTau=1/(mAlpha+mBeta)hAlpha=(0.000457*exp((-13-v)/50))hBeta=(0.0065/(exp((-v-15)/28)+1))hInf=hAlpha/(hAlpha+hBeta)hTau=1/(hAlpha+hBeta)UNITSON}