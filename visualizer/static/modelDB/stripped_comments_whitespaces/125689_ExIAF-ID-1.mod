UNITS{(mV)=(millivolt)(mA)=(milliamp)}INDEPENDENT{tFROM0TO1WITH1(ms)}NEURON{SUFFIXExIAFNONSPECIFIC_CURRENTiGLOBALspikedur,refact,tauAHP,eAHP,gAHPbar,ThrConstRANGEThr,lastspikeRANGEgPAS,ePAS,gAHP,AHPon,gON,gOFF,eON,eOFFRANGESetCa,AvgCa,Ca,tauDCCa,GainRANGEScaleFactor,InductionGLOBALSCALE,GainConstGLOBALtstop,terrorRANGEB}PARAMETER{vi(mA/cm2)gPAS=0.0001ePAS=-60ePASconst=-60ThrConst=-45Thr=-45spikedur=0.6refact=3gONconst=1gOFFconst=1eON=40eOFF=-53tauAHP=0.2gAHPbar=0.00035eAHP=-90SetCa=1tauDCCa=10SCALE=0GainConst=0.1tstopterror}ASSIGNED{lastspikegAHP(mho/cm2)AHPongON(mho/cm2)gOFF(mho/cm2)CaAvgCaScaleFactorInductionGainB}INITIAL{ePAS=ePASconstgAHP=0AHPon=-9e4gON=0gOFF=0terror=dt/10lastspike=-9e4Ca=0Induction=0}BREAKPOINT{SOLVEupdatei=gPAS*(v-ePAS)+gAHP*(v-eAHP)+gON*(v-eON)+gOFF*(v-eOFF)B=mgblock(v)}PROCEDUREupdate(){LOCALq,dvgON=0gOFF=0q=(t-lastspike)-spikedurif(q>refact){if(v>Thr){gON=gONconstlastspike=tCa=Ca+1}}elseif(q<0){gON=gONconst}elseif(v>0){gOFF=gOFFconstgAHP=gAHP+gAHPbarAHPon=t}gAHP=gAHP-gAHP*tauAHP*dtif(t>(tstop-(2*dt)+terror)){if(Induction==0){SOLVEINDUCTION}}}PROCEDUREINDUCTION(){AvgCa=AvgCa+(Ca-AvgCa)/tauDCCaScaleFactor=GainConst*(SetCa-AvgCa)*SCALEInduction=1}FUNCTIONmgblock(v(mV)){TABLEFROM-140TO80WITH1000if(v>-58){mgblock=1/(1+exp((-35-v)/6))}else{mgblock=0}}