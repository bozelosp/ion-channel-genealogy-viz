NEURON{POINT_PROCESStone2pyrDNEUSEIONcaREADecaNONSPECIFIC_CURRENTinmda,iampaRANGEinitWRANGECdur_nmda,AlphaTmax_nmda,Beta_nmda,Erev_nmda,gbar_nmda,W_nmda,on_nmda,g_nmdaRANGECdur_ampa,AlphaTmax_ampa,Beta_ampa,Erev_ampa,gbar_ampa,W,on_ampa,g_ampaRANGEeca,ICa,P0,fCa,tauCa,iCatotalRANGECainf,pooldiam,zRANGElambda1,lambda2,threshold1,threshold2RANGEfmax,fmin,Wmax,Wmin,maxChange,normW,scaleWRANGEpregid,postgid}UNITS{(mV)=(millivolt)(nA)=(nanoamp)(uS)=(microsiemens)FARADAY=96485(coul)pi=3.141592(1)}PARAMETER{Cdur_nmda=16.7650(ms)AlphaTmax_nmda=.2659(/ms)Beta_nmda=0.008(/ms)Erev_nmda=0(mV)gbar_nmda=.5e-3(uS)Cdur_ampa=1.4210(ms)AlphaTmax_ampa=3.8142(/ms)Beta_ampa=0.1429(/ms)Erev_ampa=0(mV)gbar_ampa=1e-3(uS)eca=120Cainf=50e-6(mM)pooldiam=1.8172(micrometer)z=2tauCa=50(ms)P0=.015fCa=.024NEstart1=39500NEstop1=40000NEstart2=35900NEstop2=36000NE_t1=1NE_t2=0.9NE_S=1.3Beta1=0.001(/ms)Beta2=0.0001(/ms)initW=5.5lambda1=80lambda2=.04threshold1=0.40threshold2=0.53fmax=3.6fmin=.8}ASSIGNED{v(mV)inmda(nA)g_nmda(uS)on_nmdaW_nmdaiampa(nA)g_ampa(uS)on_ampaWt0(ms)ICa(mA)Afactor(mM/ms/nA)iCatotal(mA)dW_ampaWmaxWminmaxChangenormWscaleWpregidpostgid}STATE{r_nmdar_ampacapoolcon}INITIAL{on_nmda=0r_nmda=0W_nmda=initWon_ampa=0r_ampa=0W=initWt0=-1Wmax=fmax*initWWmin=fmin*initWmaxChange=(Wmax-Wmin)/10dW_ampa=0capoolcon=CainfAfactor=1/(z*FARADAY*4/3*pi*(pooldiam/2)^3)*(1e6)}BREAKPOINT{SOLVEreleaseMETHODcnexp}DERIVATIVErelease{if(t0>0){if(t-t0<Cdur_nmda){on_nmda=1}else{on_nmda=0}if(t-t0<Cdur_ampa){on_ampa=1}else{on_ampa=0}}r_nmda'=AlphaTmax_nmda*on_nmda*(1-r_nmda)-Beta_nmda*r_nmdar_ampa'=AlphaTmax_ampa*on_ampa*(1-r_ampa)-Beta_ampa*r_ampadW_ampa=eta(capoolcon)*(lambda1*omega(capoolcon,threshold1,threshold2)-lambda2*W)*dtif(fabs(dW_ampa)>maxChange){if(dW_ampa<0){dW_ampa=-1*maxChange}else{dW_ampa=maxChange}}normW=(W-Wmin)/(Wmax-Wmin)if(dW_ampa<0){scaleW=sqrt(fabs(normW))}else{scaleW=sqrt(fabs(1.0-normW))}W=W+dW_ampa*scaleWif(W>Wmax){W=Wmax}elseif(W<Wmin){W=Wmin}g_nmda=gbar_nmda*r_nmda*NEn(NEstart1,NEstop1)*NE2(NEstart2,NEstop2)inmda=W_nmda*g_nmda*(v-Erev_nmda)*sfunc(v)g_ampa=gbar_ampa*r_ampaiampa=W*g_ampa*(v-Erev_ampa)ICa=P0*g_nmda*(v-eca)*sfunc(v)capoolcon'=-fCa*Afactor*ICa+(Cainf-capoolcon)/tauCa}NET_RECEIVE(dummy_weight){t0=t}FUNCTIONsfunc(v(mV)){UNITSOFFsfunc=1/(1+0.33*exp(-0.06*v))UNITSON}FUNCTIONeta(Cani(mM)){LOCALtaulearn,P1,P2,P4,CaconP1=0.1P2=P1*1e-4P4=1Cacon=Cani*1e3taulearn=P1/(P2+Cacon*Cacon*Cacon)+P4eta=1/taulearn*0.001}FUNCTIONomega(Cani(mM),threshold1(uM),threshold2(uM)){LOCALr,mid,CaconCacon=Cani*1e3r=(threshold2-threshold1)/2mid=(threshold1+threshold2)/2if(Cacon<=threshold1){omega=0}elseif(Cacon>=threshold2){omega=1/(1+50*exp(-50*(Cacon-threshold2)))}else{omega=-sqrt(r*r-(Cacon-mid)*(Cacon-mid))}}FUNCTIONNEn(NEstart1(ms),NEstop1(ms)){LOCALNEtemp1,NEtemp2,NEtemp3,NEtemp4,NEtemp5,NEtemp6,NEtemp7,NEtemp8,NEtemp9,NEtemp10,NEtemp11,NEtemp12,NEtemp13,NEtemp14,NEtemp15,NEtemp16,NEtemp17,NEtemp18,sNEtemp1=64000NEtemp2=70000NEtemp3=76000NEtemp4=82000NEtemp5=88000NEtemp6=94000NEtemp7=100000NEtemp8=106000NEtemp9=112000NEtemp10=118000NEtemp11=124000NEtemp12=130000NEtemp13=136000NEtemp14=142000NEtemp15=248000NEtemp16=254000NEtemp17=260000NEtemp18=266000if(t<=NEstart1){NEn=1.0}elseif(t>=NEstart1&&t<=NEstop1){NEn=NE_t1}elseif(t>NEstop1&&t<NEtemp1){NEn=1.0+(NE_t1-1)*exp(-Beta1*(t-NEstop1))}elseif(t>=NEtemp1&&t<=NEtemp1+2000){NEn=NE_t1}elseif(t>NEtemp1+2000&&t<NEtemp2){NEn=1.0+(NE_t1-1)*exp(-Beta1*(t-NEstop1))}elseif(t>=NEtemp2&&t<=NEtemp2+2000){NEn=NE_t1}elseif(t>NEtemp2+2000&&t<NEtemp3){NEn=1.0+(NE_t1-1)*exp(-Beta1*(t-(NEtemp2+2000)))}elseif(t>=NEtemp3&&t<=NEtemp3+2000){NEn=NE_t1}elseif(t>NEtemp3+2000&&t<NEtemp4){NEn=1.0+(NE_t1-1)*exp(-Beta1*(t-(NEtemp3+2000)))}elseif(t>=NEtemp4&&t<=NEtemp4+2000){NEn=NE_t1}elseif(t>NEtemp4+2000&&t<NEtemp5){NEn=1.0+(NE_t1-1)*exp(-Beta1*(t-(NEtemp4+2000)))}elseif(t>=NEtemp5&&t<=NEtemp5+2000){NEn=NE_t1}elseif(t>NEtemp5+2000&&t<NEtemp6){NEn=1.0+(NE_t1-1)*exp(-Beta1*(t-(NEtemp5+2000)))}elseif(t>=NEtemp6&&t<=NEtemp6+2000){NEn=NE_t1}elseif(t>NEtemp6+2000&&t<NEtemp7){NEn=1.0+(NE_t1-1)*exp(-Beta1*(t-(NEtemp6+2000)))}elseif(t>=NEtemp7&&t<=NEtemp7+2000){NEn=NE_t2}elseif(t>NEtemp7+2000&&t<NEtemp8){NEn=1.0+(NE_t2-1)*exp(-Beta2*(t-(NEtemp7+2000)))}elseif(t>=NEtemp8&&t<=NEtemp8+2000){NEn=NE_t2}elseif(t>NEtemp8+2000&&t<NEtemp9){NEn=1.0+(NE_t2-1)*exp(-Beta2*(t-(NEtemp8+2000)))}elseif(t>=NEtemp9&&t<=NEtemp9+2000){NEn=NE_t2}elseif(t>NEtemp9+2000&&t<NEtemp10){NEn=1.0+(NE_t2-1)*exp(-Beta2*(t-(NEtemp9+2000)))}elseif(t>=NEtemp10&&t<=NEtemp10+2000){NEn=NE_t2}elseif(t>NEtemp10+2000&&t<NEtemp11){NEn=1.0+(NE_t2-1)*exp(-Beta2*(t-(NEtemp10+2000)))}elseif(t>=NEtemp11&&t<=NEtemp11+2000){NEn=NE_t2}elseif(t>NEtemp11+2000&&t<NEtemp12){NEn=1.0+(NE_t2-1)*exp(-Beta2*(t-(NEtemp11+2000)))}elseif(t>=NEtemp12&&t<=NEtemp12+2000){NEn=NE_t2}elseif(t>NEtemp12+2000&&t<NEtemp13){NEn=1.0+(NE_t2-1)*exp(-Beta2*(t-(NEtemp12+2000)))}elseif(t>=NEtemp13&&t<=NEtemp13+2000){NEn=NE_t2}elseif(t>NEtemp13+2000&&t<NEtemp14){NEn=1.0+(NE_t2-1)*exp(-Beta2*(t-(NEtemp13+2000)))}elseif(t>=NEtemp14&&t<=NEtemp14+2000){NEn=NE_t2}elseif(t>NEtemp14+2000&&t<NEtemp15){NEn=1.0+(NE_t2-1)*exp(-Beta2*(t-(NEtemp14+2000)))}elseif(t>=NEtemp15&&t<=NEtemp15+2000){NEn=NE_t2}elseif(t>NEtemp15+2000&&t<NEtemp16){NEn=1.0+(NE_t2-1)*exp(-Beta2*(t-(NEtemp15+2000)))}elseif(t>=NEtemp16&&t<=NEtemp16+2000){NEn=NE_t2}elseif(t>NEtemp16+2000&&t<NEtemp17){NEn=1.0+(NE_t2-1)*exp(-Beta2*(t-(NEtemp16+2000)))}elseif(t>=NEtemp17&&t<=NEtemp17+2000){NEn=NE_t2}elseif(t>NEtemp17+2000&&t<NEtemp18){NEn=1.0+(NE_t2-1)*exp(-Beta2*(t-(NEtemp17+2000)))}elseif(t>=NEtemp18&&t<=NEtemp18+2000){NEn=NE_t2}else{NEn=1.0}}FUNCTIONNE2(NEstart2(ms),NEstop2(ms)){LOCALNE2temp1,NE2temp2,NE2temp3,NE2temp4,NE2temp5,NE2temp6,NE2temp7,NE2temp8,NE2temp9,NE2temp10,NE2temp11,NE2temp12,NE2temp13,NE2temp14,NE2temp15,NE2temp16,sNE2temp1=NEstart2+6000NE2temp2=NE2temp1+6000NE2temp3=NE2temp2+6000NE2temp4=NE2temp3+6000NE2temp5=NE2temp4+6000NE2temp6=NE2temp5+6000NE2temp7=NE2temp6+6000NE2temp8=NE2temp7+6000NE2temp9=NE2temp8+6000NE2temp10=NE2temp9+6000NE2temp11=NE2temp10+6000NE2temp12=NE2temp11+6000NE2temp13=NE2temp12+6000NE2temp14=NE2temp13+6000NE2temp15=NE2temp14+6000if(t<=NEstart2){NE2=1.0}elseif(t>=NEstart2&&t<=NEstop2){NE2=NE_S}elseif(t>NEstop2&&t<NE2temp1){NE2=1.0+(NE_S-1)*exp(-Beta2*(t-(NEstop2+2000)))}elseif(t>=NE2temp1&&t<=NE2temp1+200){NE2=NE_S}elseif(t>NE2temp1+200&&t<NE2temp2){NE2=1.0+(NE_S-1)*exp(-Beta2*(t-(NE2temp1+200)))}elseif(t>=NE2temp2&&t<=NE2temp2+200){NE2=NE_S}elseif(t>NE2temp2+200&&t<NE2temp3){NE2=1.0+(NE_S-1)*exp(-Beta2*(t-(NE2temp2+200)))}elseif(t>=NE2temp3&&t<=NE2temp3+200){NE2=NE_S}elseif(t>NE2temp3+200&&t<NE2temp4){NE2=1.0+(NE_S-1)*exp(-Beta2*(t-(NE2temp3+200)))}elseif(t>=NE2temp4&&t<=NE2temp4+200){NE2=NE_S}elseif(t>NE2temp4+200&&t<NE2temp5){NE2=1.0+(NE_S-1)*exp(-Beta2*(t-(NE2temp4+200)))}elseif(t>=NE2temp5&&t<=NE2temp5+200){NE2=NE_S}elseif(t>NE2temp5+200&&t<NE2temp6){NE2=1.0+(NE_S-1)*exp(-Beta2*(t-(NE2temp5+200)))}elseif(t>=NE2temp6&&t<=NE2temp6+200){NE2=NE_S}elseif(t>NE2temp6+200&&t<NE2temp7){NE2=1.0+(NE_S-1)*exp(-Beta2*(t-(NE2temp6+200)))}elseif(t>=NE2temp7&&t<=NE2temp7+200){NE2=NE_S}elseif(t>NE2temp7+200&&t<NE2temp8){NE2=1.0+(NE_S-1)*exp(-Beta2*(t-(NE2temp7+200)))}elseif(t>=NE2temp8&&t<=NE2temp8+200){NE2=NE_S}elseif(t>NE2temp8+200&&t<NE2temp9){NE2=1.0+(NE_S-1)*exp(-Beta2*(t-(NE2temp8+200)))}elseif(t>=NE2temp9&&t<=NE2temp9+200){NE2=NE_S}elseif(t>NE2temp9+200&&t<NE2temp10){NE2=1.0+(NE_S-1)*exp(-Beta2*(t-(NE2temp9+200)))}elseif(t>=NE2temp10&&t<=NE2temp10+200){NE2=NE_S}elseif(t>NE2temp10+200&&t<NE2temp11){NE2=1.0+(NE_S-1)*exp(-Beta2*(t-(NE2temp10+200)))}elseif(t>=NE2temp11&&t<=NE2temp11+200){NE2=NE_S}elseif(t>NE2temp11+200&&t<NE2temp12){NE2=1.0+(NE_S-1)*exp(-Beta2*(t-(NE2temp11+200)))}elseif(t>=NE2temp12&&t<=NE2temp12+200){NE2=NE_S}elseif(t>NE2temp12+200&&t<NE2temp13){NE2=1.0+(NE_S-1)*exp(-Beta2*(t-(NE2temp12+200)))}elseif(t>=NE2temp13&&t<=NE2temp13+200){NE2=NE_S}elseif(t>NE2temp13+200&&t<NE2temp14){NE2=1.0+(NE_S-1)*exp(-Beta2*(t-(NE2temp13+200)))}elseif(t>=NE2temp14&&t<=NE2temp14+200){NE2=NE_S}elseif(t>NE2temp14+200&&t<NE2temp15){NE2=1.0+(NE_S-1)*exp(-Beta2*(t-(NE2temp14+200)))}elseif(t>=NE2temp15&&t<=NE2temp15+200){NE2=NE_S}else{NE2=1.0}}