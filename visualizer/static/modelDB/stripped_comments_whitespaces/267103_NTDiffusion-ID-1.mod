DEFINENDates10NEURON{POINT_PROCESSNTDiffusionRANGERadius,CleftWidth,Diffusivity,BasalNTConcentration,NTi,k,NusedRANGENTConcentrationRANGEcompRANGENTRatioRANGEtDiff}UNITS{(molar)=(1/liter)(mM)=(millimolar)(um)=(micron)(mA)=(milliamp)(msM)=(msmM)}CONSTANT{PI=3.1415926535897932384626433832795028841971693993751058209749445923078164062862089986280348253421170679Nav=6.02214179e23}PARAMETER{Radius=1(um)CleftWidth=0.02(um)Diffusivity=0.33(um.um/ms)BasalNTConcentration=0.0(mM)k=1.0comp=0tRound=0tDiff=0NTRatio=0}ASSIGNED{NTConcentrationNTitr[NDates]Nused}STATE{NT1NT2NT3NT4NT5NT6NT7NT8NT9}INITIAL{NTConcentration=BasalNTConcentrationNTi=0FROMi=0TONDates-1{tr[i]=-1e12}Nused=0}BREAKPOINT{SOLVEstateMETHODcnexpNTConcentration=BasalNTConcentrationFROMi=0TONused-1{if(i==0){NTRatio=NT1tDiff=t-tr[i]}elseif(i==1){NTRatio=NT2}elseif(i==2){NTRatio=NT3}elseif(i==3){NTRatio=NT4}elseif(i==4){NTRatio=NT5}elseif(i==5){NTRatio=NT6}elseif(i==6){NTRatio=NT7}elseif(i==7){NTRatio=NT8}elseif(i==8){NTRatio=NT9}else{NTRatio=0}if(Radius==0){comp=NTRatio*1e18*NTi/(4*PI*CleftWidth*Diffusivity)}else{comp=NTRatio*1e18*NTi/(4*PI*CleftWidth*Diffusivity)*exp(-NTRatio*(Radius*Radius)/(4*Diffusivity))}if(comp>=0.001*NTConcentration){NTConcentration=NTConcentration+comp}elseif(t==tr[i]){NTConcentration=BasalNTConcentration}else{Nused=i}}}DERIVATIVEstate{NT1'=-(NT1*NT1)NT2'=-(NT2*NT2)NT3'=-(NT3*NT3)NT4'=-(NT4*NT4)NT5'=-(NT5*NT5)NT6'=-(NT6*NT6)NT7'=-(NT7*NT7)NT8'=-(NT8*NT8)NT9'=-(NT9*NT9)}NET_RECEIVE(w){if(flag==0){if(Nused<NDates){Nused=Nused+1}else{printf("SizeoftheNTDiffusionGluarraymightbetoosmall")}NTi=k*3000/NavFROMi=1TONused{tr[Nused+1-i]=tr[Nused-i]}tr[0]=tNT9=NT8NT8=NT7NT7=NT6NT6=NT5NT5=NT4NT4=NT3NT3=NT2NT2=NT1NT1=1}}