NEURON{SUFFIXkapUSEIONkREADekWRITEikRANGEgkabar,ik}UNITS{(mA)=(milliamp)(mV)=(millivolt)(S)=(siemens)}PARAMETER{gkabar=0.0(S/cm2)}STATE{nl}ASSIGNED{v(mV)ek(mV)gka(S/cm2)ik(mA/cm2)ninflinftaul(ms)taun(ms)}BREAKPOINT{SOLVEstatesMETHODcnexpgka=gkabar*pow(n,4)*lik=gka*(v-ek)}DERIVATIVEstates{rates(v)n'=(ninf-n)/taunl'=(linf-l)/taul}INITIAL{rates(v)n=ninfl=linf}FUNCTIONvtrap(x(mV),y(mV))(1){if(fabs(x/y)<1e-6){vtrap=1(/mV)*y*(1-x/y/2)}else{vtrap=1(/mV)*x/(exp(x/y)-1)}}FUNCTIONalpn(v(mV))(/ms){alpn=0.01(/ms)*vtrap(-(v+21.3(mV)),35(mV))}FUNCTIONbetn(v(mV))(/ms){betn=0.01(/ms)*vtrap(v+21.3(mV),35(mV))}FUNCTIONalpl(v(mV))(/ms){alpl=-0.01(/ms)*vtrap(v+58(mV),8.2(mV))}FUNCTIONbetl(v(mV))(/ms){betl=-0.01(/ms)*vtrap(-(v+58(mV)),8.2(mV))}PROCEDURErates(v(mV)){ninf=alpn(v)/(alpn(v)+betn(v))taun=0.2linf=alpl(v)/(alpl(v)+betl(v))if(v>-20){taul=5(ms)+2.6(ms)*(v+20(mV))/10(mV)}else{taul=5}}