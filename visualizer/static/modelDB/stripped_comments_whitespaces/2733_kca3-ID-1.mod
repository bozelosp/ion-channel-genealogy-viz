NEURON{SUFFIXkca3USEIONkREADekWRITEikUSEIONcaREADcaiRANGEgkbar,ik,Yconcdep,YvdepGLOBALYalpha,Ybeta,vshift}UNITS{(mA)=(milliamp)(mV)=(millivolt)(molar)=(1/liter)(mM)=(millimolar)}INDEPENDENT{tFROM0TO1WITH1(ms)}PARAMETER{v(mV)dt(ms)gkbar=0.120(mho/cm2)<0,1e9>ek=-70(mV)Ybeta=0.05(/ms)cai(mM)vshift=-10(mV)}STATE{Y}ASSIGNED{ik(mA/cm2)Yalpha(/ms)YvdepYconcdep(/ms)}INITIAL{rate(v,cai)Y=Yalpha/(Yalpha+Ybeta)}BREAKPOINT{SOLVEstateMETHODcnexpik=gkbar*Y*(v-(ek+vshift))}DERIVATIVEstate{rate(v,cai)Y'=Yalpha*(1-Y)-Ybeta*Y}PROCEDURErate(v(mV),cai(mM)){vdep(v)concdep(cai)Yalpha=Yvdep*Yconcdep}PROCEDUREvdep(v(mV)){TABLEYvdepFROM-100TO100WITH100Yvdep=exp((v*1(/mV)+70)/27)}PROCEDUREconcdep(cai(mM)){TABLEYconcdepFROM0TO0.01WITH1000if(cai<0.01){Yconcdep=500(/ms)*(0.015-cai*1(/mM))/(exp((0.015-cai*1(/mM))/0.0013)-1)}else{Yconcdep=500(/ms)*0.005/(exp(0.005/0.0013)-1)}}