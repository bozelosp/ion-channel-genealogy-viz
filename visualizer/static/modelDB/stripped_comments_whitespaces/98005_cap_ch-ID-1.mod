NEURON{SUFFIXcap_chUSEIONcaREADcai,caoWRITEicaRANGEgbar,icaGLOBALminf,mtauGLOBALmonovalConc,monovalPerm}UNITS{(mV)=(millivolt)(mA)=(milliamp)(mM)=(milli/liter)F=9.6485e4(coul)R=8.3145(joule/degC)}PARAMETER{v(mV)gbar=.00005(cm/s)monovalConc=140(mM)monovalPerm=0cai(milli/liter)cao(milli/liter)}ASSIGNED{ica(mA/cm2)minfmtau(ms)T(degC)E(volts)}STATE{m}INITIAL{rates(v)m=minf}BREAKPOINT{SOLVEstatesMETHODcnexpica=(1e3)*gbar*m*ghk(v,cai,cao,2)}DERIVATIVEstates{rates(v)m'=(minf-m)/mtau}FUNCTIONghk(v(mV),ci(mM),co(mM),z)(coul/cm3){LOCALCiT=22+273.19E=(1e-3)*vCi=ci+(monovalPerm)*(monovalConc)if(fabs(1-exp(-z*(F*E)/(R*T)))<1e-6){ghk=(1e-6)*z*F*(Ci-co*exp(-z*(F*E)/(R*T)))*(1-(z*(F*E)/(R*T)))}else{ghk=(1e-6)*z^2*(E*F^2)/(R*T)*(Ci-co*exp(-z*(F*E)/(R*T)))/(1-exp(-z*(F*E)/(R*T)))}}PROCEDURErates(v(mV)){UNITSOFFminf=1/(1+exp(-(v-(-19))/5.5))mtau=(mtau_func(v))*1e3UNITSON}FUNCTIONmtau_func(v(mV))(ms){UNITSOFFif(v>-50){mtau_func=.000191+.00376*exp(-((v-(-41.9))/27.8)^2)}else{mtau_func=.00026367+.1278*exp(.10327*v)}UNITSON}