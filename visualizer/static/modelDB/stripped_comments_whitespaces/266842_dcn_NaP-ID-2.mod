NEURON{SUFFIXdcnNaPUSEIONnaREADenaWRITEinaRANGEgbar,ina,m,hGLOBALqdeltat}UNITS{(mA)=(milliamp)(mV)=(millivolt)}PARAMETER{qdeltat=1gbar=1e-5(siemens/cm2)}ASSIGNED{v(mV)ena(mV)ina(mA/cm2)minfhinftaum(ms)tauh(ms)}STATE{mh}INITIAL{rate(v)taum=50/qdeltatm=minfh=hinf}BREAKPOINT{SOLVEstatesMETHODcnexpina=gbar*m*m*m*h*(v-ena)}DERIVATIVEstates{rate(v)m'=(minf-m)/taumh'=(hinf-h)/tauh}PROCEDURErate(v(mV)){TABLEminf,hinf,tauhFROM-150TO100WITH300if(fabs(v+70)<1e-6){minf=1/(1+exp((v+70.00001)/-4.1))}else{minf=1/(1+exp((v+70)/-4.1))}hinf=1/(1+exp((v+80)/4))tauh=(1750/(1+exp((v+65)/-8)))+250tauh=tauh/qdeltat}