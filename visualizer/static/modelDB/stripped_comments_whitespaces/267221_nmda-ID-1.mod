NEURON{POINT_PROCESSNMDANONSPECIFIC_CURRENTiRANGEg,a,b,gNMDAmax,iRANGEtauD,tauF,util,tcon,tcoff,enmda}UNITS{(uS)=(microsiemens)(nA)=(nanoamp)(mV)=(millivolt)}PARAMETER{tcon=2.3(ms)tcoff=95.0(ms)enmda=0(mV)gNMDAmax=1(uS)tauD=800(ms)tauF=800(ms)util=.3}ASSIGNED{v(mV)i(nA)g(1)factor}STATE{ab}BREAKPOINT{LOCALsSOLVEstatesMETHODcnexps=1.50265/(1+0.33*exp(-0.0625(/mV)*v))g=b-ai=gNMDAmax*g*s*(v-enmda)}DERIVATIVEstates{a'=-a/tconb'=-b/tcoff}INITIAL{a=0b=0factor=tcon*tcoff*1(/ms)/(tcoff-tcon)}NET_RECEIVE(wgt,R,u,tlast(ms),nspike){LOCALxif(nspike==0){R=1u=util}else{if(tauF>0){u=util+(1-util)*u*exp(-(t-tlast)/tauF)}if(tauD>0){R=1+(R*(1-u)-1)*exp(-(t-tlast)/tauD)}}x=wgt*factor*R*ustate_discontinuity(a,a+x)state_discontinuity(b,b+x)tlast=tnspike=nspike+1}