VERBATIM#include<stdlib.h>ENDVERBATIMUNITS{(mA)=(milliamp)(mV)=(millivolt)(uF)=(microfarad)(molar)=(1/liter)(nA)=(nanoamp)(mM)=(millimolar)(um)=(micron)FARADAY=96520(coul)R=8.3134(joule/degC)}NEURON{SUFFIXch_KvGroupUSEIONkREADekWRITEikVALENCE1RANGEg,gmax,ninf,ntau,ikRANGEmyiTHREADSAFE}PARAMETER{v(mV)celsius(degC)dt(ms)ek(mV)gmax(mho/cm2)}STATE{n}ASSIGNED{g(mho/cm2)ik(mA/cm2)ninfntau(ms)nexpmyi(mA/cm2)}BREAKPOINT{SOLVEstatesg=gmax*nik=g*(v-ek)myi=ik}UNITSOFFINITIAL{trates(v)n=ninf}PROCEDUREstates(){trates(v)n=n+nexp*(ninf-n)}LOCALq10PROCEDURErates(v){LOCALalpha,beta,sumq10=3^((celsius-34)/10)alpha=0.0189324*vtrap(-(v-4.18371),6.42606)beta=0.015857*exp(-v/25.4834)sum=alpha+betantau=1/sumninf=alpha/sum}PROCEDUREtrates(v){LOCALtincTABLEninf,nexp,ntauDEPENDdt,celsiusFROM-100TO100WITH200rates(v)tinc=-dt*q10nexp=1-exp(tinc/ntau)}FUNCTIONvtrap(x,y){if(fabs(x/y)<1e-6){vtrap=y*(1-x/y/2)}else{vtrap=x/(exp(x/y)-1)}}UNITSON