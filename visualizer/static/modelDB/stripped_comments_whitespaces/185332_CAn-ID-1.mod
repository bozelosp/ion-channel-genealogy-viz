NEURON{SUFFIXCAnUSEIONcaREADcai,caoWRITEicaRANGEgbar,ica,vshiftm,vshifth,timefactor_m,timefactor_hGLOBALhinf,minf,taum,tauh,kiNONSPECIFIC_CURRENTicont}UNITS{(mA)=(milliamp)(mV)=(millivolt)FARADAY=(faraday)(kilocoulombs)R=(k-mole)(joule/degC)KTOMV=.0853(mV/degC)}PARAMETER{v(mV)celsius(degC)vshiftm=0(mV)vshifth=0(mV)timefactor_h=1timefactor_m=1gbar=.0003(mho/cm2)ki=.001(mM)cai=5.e-5(mM)cao=10(mM)}STATE{mh}ASSIGNED{ica(mA/cm2)icont(mA/cm2)gcan(mho/cm2)minfhinftaumtauh}BREAKPOINT{SOLVEstatesMETHODcnexpgcan=gbar*m*m*h*h2(cai)ica=gcan*ghk(v,cai,cao)icont=-ica}INITIAL{rates(v,vshiftm,vshifth)m=minfh=hinf}UNITSOFFFUNCTIONh2(cai(mM)){h2=ki/(ki+cai)}FUNCTIONghk(v(mV),ci(mM),co(mM))(mV){LOCALnu,ff=KTF(celsius)/2nu=v/fghk=-f*(1.-(ci/co)*exp(nu))*efun(nu)}FUNCTIONKTF(celsius(degC))(mV){KTF=((25./293.15)*(celsius+273.15))}FUNCTIONefun(z){if(fabs(z)<1e-4){efun=1-z/2}else{efun=z/(exp(z)-1)}}FUNCTIONalph(v(mV)){TABLEFROM-150TO1000WITH1600alph=1.6e-4*exp(-v/48.4)}FUNCTIONbeth(v(mV)){TABLEFROM-150TO1000WITH1600beth=1/(exp((-v+39.0)/10.)+1.)}FUNCTIONalpm(v(mV)){TABLEFROM-150TO1000WITH1600alpm=0.1967*(-1.0*v+19.88)/(exp((-1.0*v+19.88)/10.0)-1.0)}FUNCTIONbetm(v(mV)){TABLEFROM-150TO1000WITH1600betm=0.046*exp(-v/20.73)}UNITSONDERIVATIVEstates{rates(v,vshiftm,vshifth)m'=(minf-m)/(taum*timefactor_m)h'=(hinf-h)/(tauh*timefactor_h)}PROCEDURErates(v(mV),vshiftm(mV),vshifth(mV)){LOCALaa=alpm(v-vshiftm)taum=1/(a+betm(v-vshiftm))minf=a*tauma=alph(v-vshifth)tauh=1/(a+beth(v-vshifth))hinf=a*tauh}