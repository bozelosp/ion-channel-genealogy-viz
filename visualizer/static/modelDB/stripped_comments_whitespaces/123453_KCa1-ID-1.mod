NEURON{SUFFIXKCa1USEIONkREADekWRITEikUSEIONcaREADcaiNONSPECIFIC_CURRENTiRANGEgbar,g,ik,i,igate,ncGLOBALminf,taum,hinf,tauh,zinf,tauzGLOBALzhalfGLOBALgateCurrent,gunit}UNITS{(mV)=(millivolt)(mA)=(milliamp)(nA)=(nanoamp)(pA)=(picoamp)(S)=(siemens)(nS)=(nanosiemens)(pS)=(picosiemens)(um)=(micron)(molar)=(1/liter)(mM)=(millimolar)}CONSTANT{e0=1.60217646e-19(coulombs)q10=2.7(1)cvm=28.9(mV)ckm=6.2(mV)ctm=0.000505(s)cvtm1=86.4(mV)cktm1=-10.1(mV)cvtm2=-33.3(mV)cktm2=10(mV)ctauz=1(ms)ch=0.085cvh=32(mV)ckh=-5.8(mV)cth=0.0019(s)cvth1=48.5(mV)ckth1=-5.2(mV)cvth2=-54.2(mV)ckth2=12.9(mV)zm=4.1023(1)zh=-4.3852(1)}PARAMETER{gateCurrent=0(1)gbar=0.007(S/cm2)gunit=182(pS)zhalf=0.001(mM)}ASSIGNED{celsius(degC)v(mV)ik(mA/cm2)i(mA/cm2)igate(mA/cm2)g(S/cm2)ek(mV)cai(mM)nc(1/cm2)qt(1)minf(1)taum(ms)hinf(1)tauh(ms)zinf(1)tauz(ms)}STATE{mFROM0TO1zFROM0TO1hFROM0TO1}INITIAL{nc=(1e12)*gbar/gunitqt=q10^((celsius-22(degC))/10(degC))rates(v)m=minfz=zinfh=hinf}BREAKPOINT{SOLVEstatesMETHODcnexpg=gbar*m^3*z^2*hik=g*(v-ek)igate=nc*(1e6)*e0*(3*zm*mgateFlip()+zh*hgateFlip())if(gateCurrent!=0){i=igate}}DERIVATIVEstates{rates(v)m'=(minf-m)/taumz'=(zinf-z)/tauzh'=(hinf-h)/tauh}PROCEDURErates(v(mV)){v=v+5(mV)minf=1/(1+exp(-(v+cvm)/ckm))taum=(1e3)*(ctm+1(s)/(exp(-(v+cvtm1)/cktm1)+exp(-(v+cvtm2)/cktm2)))/qtzinf=1/(1+zhalf/cai)tauz=ctauz/qthinf=ch+(1-ch)/(1+exp(-(v+cvh)/ckh))tauh=(1e3)*(cth+1(s)/(exp(-(v+cvth1)/ckth1)+exp(-(v+cvth2)/ckth2)))/qt}FUNCTIONmgateFlip()(1/ms){mgateFlip=(minf-m)/taum}FUNCTIONhgateFlip()(1/ms){hgateFlip=(hinf-h)/tauh}