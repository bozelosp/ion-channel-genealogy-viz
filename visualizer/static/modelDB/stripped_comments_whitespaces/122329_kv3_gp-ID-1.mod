NEURON{SUFFIXkv3_gpUSEIONkREADekWRITEikRANGEg,ik,an,bn,gbarGLOBALa1,a2,a3GLOBALb1,b2,b3GLOBALCq10}UNITS{(mV)=(millivolt)(S)=(siemens)(mA)=(milliamp)}PARAMETER{gbar=1(S/cm2)celsius(degC)a1=0.05(1/ms)a2=8(mV)a3=8(mV)b1=0.07(1/ms)b2=-12(mV)b3=-15(mV)Cq10=3}ASSIGNED{v(mV)ek(mV)g(S/cm2)ik(mA/cm2)an(1/ms)bn(1/ms)kf1(1/ms)kb1(1/ms)kf2(1/ms)kb2(1/ms)q10}STATE{co}BREAKPOINT{SOLVEkinMETHODsparseg=gbar*oik=g*(v-ek)}INITIAL{SOLVEkinSTEADYSTATEsparse}KINETICkin{rates(v)~c<->o(an,bn)CONSERVEc+o=1}PROCEDURErates(v(mV)){q10=Cq10^((celsius-22(degC))/10(degC))an=q10*a1*exp((v-a2)/a3)bn=q10*b1*exp((v-b2)/b3)kf1=2*ankb1=bnkf2=ankb2=2*bn}