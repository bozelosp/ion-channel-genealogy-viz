NEURON{POINT_PROCESSNK1_DynSynUSEIONcaWRITEicaRANGEtau_rise,tau_decayRANGEU1,tau_rec,tau_fac,stpRANGEi,g,e,iNK1R,ica,ca_ratioNONSPECIFIC_CURRENTiNK1R}UNITS{(nA)=(nanoamp)(mV)=(millivolt)(molar)=(1/liter)(mM)=(millimolar)}PARAMETER{tau_rise=10.0(ms)tau_decay=5000.0(ms)U1=1.0(1)tau_rec=0.1(ms)tau_fac=0.1(ms)e=0.0(mV)ca_ratio=0.1(1)stp=1.0(1)}ASSIGNED{v(mV)i(nA)g(umho)factor(1)ica(nA)iNK1R(nA)}STATE{AB}INITIAL{LOCALtpA=0B=0tp=(tau_rise*tau_decay)/(tau_decay-tau_rise)*log(tau_decay/tau_rise)factor=-exp(-tp/tau_rise)+exp(-tp/tau_decay)factor=1/factor}BREAKPOINT{SOLVEstateMETHODcnexpg=B-Ai=g*(v-e)ica=ca_ratio*iiNK1R=i-ica}DERIVATIVEstate{A'=-A/tau_riseB'=-B/tau_decay}NET_RECEIVE(weight,Pv,P,Use,t0(ms)){INITIAL{P=1Use=0t0=t}if(stp){Use=Use*exp(-(t-t0)/tau_fac)Use=Use+U1*(1-Use)P=1-(1-P)*exp(-(t-t0)/tau_rec)Pv=Use*PP=P-Use*Pt0=tA=A+weight*factor*PvB=B+weight*factor*Pv}else{A=A+weight*factorB=B+weight*factor}}