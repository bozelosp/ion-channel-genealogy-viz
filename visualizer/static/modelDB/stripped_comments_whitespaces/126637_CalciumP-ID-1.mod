INDEPENDENT{tFROM0TO1WITH1(ms)}NEURON{SUFFIXcadUSEIONcaREADica,caiWRITEcaiRANGEdepth,kt,kd,cainf,taur,icaadjust,camolflux,cabuff,capump}UNITS{(molar)=(1/liter)(mM)=(millimolar)(um)=(micron)(mA)=(milliamp)(msM)=(msmM)}CONSTANT{FARADAY=96489(coul)}PARAMETER{depth=.1(um)taur=1e10(ms)cainf=2.4e-4(mM)kt=1e-4(mM/ms)kd=1e-4(mM)icaadjust=1cainit=1e-4(mM)capump=1cabuff=1camolflux=1}STATE{cai(mM)}INITIAL{cai=cainit}ASSIGNED{ica(mA/cm2)drive_channel(mM/ms)drive_pump(mM/ms)}BREAKPOINT{SOLVEstateMETHODderivimplicit}DERIVATIVEstate{drive_channel=-(10000)*(ica*icaadjust)/(2*FARADAY*depth)if(drive_channel<=0.){drive_channel=0.}drive_pump=-kt*cai/(cai+kd)cai'=(camolflux*drive_channel)+(capump*drive_pump)+(cabuff*((cainf-cai)/taur))}