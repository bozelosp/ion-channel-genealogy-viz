INDEPENDENT{tFROM0TO1WITH1(ms)}NEURON{SUFFIXicalUSEIONCaREADCai,CaoWRITEiCaVALENCE2RANGEpcabar,gGLOBALm_inf,tau_m,sh1,sh2,rat}UNITS{(mA)=(milliamp)(mV)=(millivolt)(molar)=(1/liter)(mM)=(millimolar)FARADAY=(faraday)(coulomb)R=(k-mole)(joule/degC)}PARAMETER{v(mV)celsius=36(degC)eCa=120(mV)Cai=.00005(mM)Cao=2(mM)pcabar=.003(mho/cm2)sh1=0sh2=0rat=1}STATE{m}INITIAL{tadj=3^((celsius-21.0)/10)evaluate_fct(v)m=m_inf}ASSIGNED{iCa(mA/cm2)g(mho/cm2)m_inftau_m(ms)tadj}BREAKPOINT{SOLVEstatesMETHODcnexpg=pcabar*m*miCa=g*ghk(v,Cai,Cao)}DERIVATIVEstates{evaluate_fct(v)m'=(m_inf-m)/tau_m}UNITSOFFPROCEDUREevaluate_fct(v(mV)){LOCALa,ba=1.6/(1+exp(-0.072*(v+sh1+5)))b=0.02*(v+sh2-1.31)/(exp((v+sh2-1.31)/5.36)-1)tau_m=1.0/(a+b)/tadjm_inf=a/(a+b)}FUNCTIONghk(v(mV),ci(mM),co(mM))(.001coul/cm3){LOCALz,eci,ecoz=(1e-3)*2*FARADAY*v/(R*(celsius+273.15))eco=co*efun(z)*rateci=ci*efun(-z)ghk=(.001)*2*FARADAY*(eci-eco)}FUNCTIONefun(z){if(fabs(z)<1e-4){efun=1-z/2}else{efun=z/(exp(z)-1)}}UNITSON