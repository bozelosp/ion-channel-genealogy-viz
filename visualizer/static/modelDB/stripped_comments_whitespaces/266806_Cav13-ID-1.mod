NEURON{SUFFIXCav13USEIONcaREADcai,ecaWRITEicaUSEIONlcaWRITEilcaVALENCE0RANGEgbar,gGLOBALkf,h2Tau,VDI}UNITS{(molar)=(1/liter)(mM)=(millimolar)(mV)=(millivolt)(mA)=(milliamp)(S)=(siemens)(um)=(micrometer)}ASSIGNED{ilca(mA/cm2)v(mV)ica(mA/cm2)g(S/cm2)eca(mV)diam(um)cai(mM)mInf(1)hInf(1)h2Inf(1)mTau(ms)}PARAMETER{hTau=44.3(ms)h2Tau=0.5(ms)gbar=0(S/cm2)vshift=0(mV)kf=0.0005(mM)VDI=1}STATE{mhh2}INITIAL{rates()m=mInfh=hInfh2=h2Inf}BREAKPOINT{rates()SOLVEstateMETHODcnexpg=gbar*m*h*h2ica=(g)*(v-eca)ilca=ica}DERIVATIVEstate{m'=(mInf-m)/mTauh'=(hInf-h)/hTauh2'=(h2Inf-h2)/h2Tau}PROCEDURErates(){LOCALmA,mBmA=(39800*(v+67.24))/(exp((v+67.24)/15.005)-1.0)mB=3500*exp(v/31.4)mTau=(1/(mA+mB))mInf=1.0/((exp((v-(-40.0))/(-5)))+1.0)hInf=VDI/((exp((v-(-37))/(5)))+1.0)+(1-VDI)h2Inf=kf/(kf+cai)}