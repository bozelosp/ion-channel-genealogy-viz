NEURON{SUFFIXCaLUSEIONcaREADecaWRITEicaVALENCE2RANGEgcal,et,ct,mt,x,y,ki,icalRANGEvhfa,slpa,vhfi,slpiGLOBALcinf,ctau,cvinf,cvtau,dcinf,dctau,q10,eca}UNITS{(mA)=(milliamp)(mV)=(millivolt)(pS)=(picosiemens)(um)=(micron)FARADAY=(faraday)(coulomb)R=(k-mole)(joule/degC)}PARAMETER{gcal=0.0004(mho/cm2)celsius(degC)v(mV)ki=.001(mM)et=1ct=1mt=1vhfa=-9(mV)slpa=8(mV)vhfi=30(mV)slpi=13(mV)q10=2.3cai=0.00015(mM)eca=51(mV)x=1y=4}ASSIGNED{ica(mA/cm2)ical(mA/cm2)cinfctau(ms)cvinfcvtau(ms)dctau(ms)dcinf}STATE{ccvdc}INITIAL{rates(v)c=cinfcv=cvinfdc=dcinf}BREAKPOINT{SOLVEstatesMETHODcnexpica=(gcal*c^x*cv*dc*(v-eca))ical=ica}DERIVATIVEstates{rates(v)c'=(cinf-c)/ctaucv'=(cvinf-cv)/cvtaudc'=(dcinf-dc)/dctau}PROCEDURErates(v(mV)){LOCALa,qtqt=q10^((celsius-37)/10)cinf=1/(1+exp((vhfa-v)/slpa))ctau=mt*qt*(0.001/(1+exp(-(v+22)/30)))cvinf=1/(1+exp((vhfi+v)/slpi))dcinf=ki/(ki+cai)dctau=ct*20cvtau=et*(90*(1.0-(1.0/(1.0+exp((v+14)/45)))*(1.0/(1.0+exp(-(v+9.8)/8.89)))))}FUNCTIONtrap0(v,th,a,q){if(fabs(v-th)>1e-6){trap0=a*(v-th)/(1-exp(-(v-th)/q))}else{trap0=a*q}}