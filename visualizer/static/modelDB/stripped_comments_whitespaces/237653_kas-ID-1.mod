NEURON{THREADSAFESUFFIXkasUSEIONkREADekWRITEikRANGEgbar,gk,ik,base,factorPOINTERpka}UNITS{(S)=(siemens)(mV)=(millivolt)(mA)=(milliamp)}PARAMETER{gbar=0.0(S/cm2)q=3a=0.2base=0.0factor=0.0}ASSIGNED{v(mV)ek(mV)ik(mA/cm2)gk(S/cm2)minfmtau(ms)hinfhtau(ms)pka(1)}STATE{mh}BREAKPOINT{SOLVEstatesMETHODcnexpgk=modulation()*gbar*m*m*hik=gk*(v-ek)}DERIVATIVEstates{rates()m'=(minf-m)/mtau*qh'=(hinf-h)/htau*q}INITIAL{rates()m=minfh=hinf}PROCEDURErates(){LOCALalpha,beta,sumUNITSOFFalpha=0.25/(1+exp((v-50)/(-20)))beta=0.05/(1+exp((v-(-90))/35))sum=alpha+betaminf=alpha/summtau=1/sumalpha=0.0025/(1+exp((v-(-95))/16))beta=0.002/(1+exp((v-50)/(-70)))sum=alpha+betahinf=a+(alpha/sum)*(1-a)htau=1/sumUNITSON}FUNCTIONmodulation(){modulation=1+factor*(pka-base)}