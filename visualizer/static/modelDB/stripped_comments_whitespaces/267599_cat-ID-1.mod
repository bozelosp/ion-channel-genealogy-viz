UNITS{(mA)=(milliamp)(mV)=(millivolt)(molar)=(1/liter)(mM)=(millimolar)FARADAY=96520(coul)R=8.3134(joule/degC)KTOMV=.0853(mV/degC)}NEURON{SUFFIXcatUSEIONcaREADcai,caoWRITEicaRANGEgcat,gcatbar,hinf,minf,taum,tauh,ica,cainit}PARAMETER{v(mV)tBase=23.5(degC)celsius=22(degC)gcatbar=0(mho/cm2)ki=0.001(mM)cai=100e-6(mM)cao=2(mM)tfa=1tfi=0.68eca=140}STATE{mh}ASSIGNED{ica(mA/cm2)gcat(mho/cm2)hinftauhminftaum}INITIAL{rates(v)m=minfh=hinfgcat=gcatbar*m*m*h*h2(cai)}BREAKPOINT{SOLVEstatesMETHODcnexpgcat=gcatbar*m*m*h*h2(cai)ica=gcat*ghk(v,cai,cao)}DERIVATIVEstates{rates(v)m'=(minf-m)/taumh'=(hinf-h)/tauh}UNITSOFFFUNCTIONh2(cai(mM)){h2=ki/(ki+cai)}FUNCTIONghk(v(mV),ci(mM),co(mM))(mV){LOCALnu,ff=KTF(celsius)/2nu=v/fghk=-f*(1.-(ci/co)*exp(nu))*efun(nu)}FUNCTIONKTF(celsius(DegC))(mV){KTF=((25./293.15)*(celsius+273.15))}FUNCTIONMyExp(x){if(x<-50){MyExp=0}elseif(x>50){MyExp=exp(50)}else{MyExp=exp(x)}}FUNCTIONefun(z){if(fabs(z)<1e-4){efun=1-z/2}else{efun=z/(MyExp(z)-1)}}FUNCTIONalph(v(mV)){TABLEFROM-150TO150WITH200alph=1.6e-4*MyExp(-(v+57)/19)}FUNCTIONbeth(v(mV)){TABLEFROM-150TO150WITH200beth=1/(MyExp((-v+15)/10)+1.0)}FUNCTIONalpm(v(mV)){TABLEFROM-150TO150WITH200alpm=0.1967*(-1.0*v+19.88)/(MyExp((-1.0*v+19.88)/10.0)-1.0)}FUNCTIONbetm(v(mV)){TABLEFROM-150TO150WITH200betm=0.046*MyExp(-v/22.73)}PROCEDURErates(v(mV)){LOCALaa=alpm(v)taum=1/(tfa*(a+betm(v)))minf=a/(a+betm(v))a=alph(v)tauh=1/(tfi*(a+beth(v)))hinf=a/(a+beth(v))}