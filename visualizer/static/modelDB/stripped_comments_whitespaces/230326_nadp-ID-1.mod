NEURON{THREADSAFESUFFIXnadpUSEIONnaREADnao,nai,inaWRITEnai,ina,enaNONSPECIFIC_CURRENTik_pumpRANGEina_pmp,TotalPump,ik_ratio,na,pump,pumpna,k4_coeff,DNa_coeff,initial_naGLOBALvrat,DNa,k1,k2,k3,k4,change_ena,fix_na}UNITS{(molar)=(1/liter)(mM)=(millimolar)(um)=(micron)(mA)=(milliamp)(mV)=(millivolt)FARADAY=(faraday)(10000coulomb)R=(k-mole)(joule/degC)PI=(pi)(1)(mol)=(1)}PARAMETER{DNa=0.6(um2/ms)k1=1.0(/mM3-ms)k2=0.001(/ms)k3=0.3(/ms)TotalPump=1e-14(mol/cm2)ik_ratio=-0.66666666(1)change_ena=1(1)k4_coeff=1.0(1)DNa_coeff=1.0(1)fix_na=0(1)}ASSIGNED{diam(um)L(um)ina(mA/cm2)nai(mM)k4(/mM3-ms)nao(mM)ena(mV)ina_pmp(mA/cm2)parea(um)ik_pump(mA/cm2)celsiusinitial_na(mM)}CONSTANT{volo=1e10(um2)}STATE{na(mM)<1e-3>pump(mol/cm2)pumpna(mol/cm2)}BREAKPOINT{SOLVEstateMETHODsparseina=ina_pmpik_pump=ik_ratio*ina_pmp}LOCALfactors_doneINITIAL{MUTEXLOCKk4=(((nai/nao)^3)*k1*k3)/k2parea=PI*diamvrat=PI*0.25pump=TotalPump/(1+(nai*k1/k2))pumpna=TotalPump-pumpna=naiinitial_na=naiMUTEXUNLOCK}KINETICstate{COMPARTMENTdiam*diam*vrat{na}COMPARTMENT(1e10)*parea{pumppumpna}COMPARTMENTvolo{nao}LONGITUDINAL_DIFFUSIONDNa*DNa_coeff*diam*diam*vrat{na}~3na+pump<->pumpna(k1*parea*(1e10),k2*parea*(1e10))~pumpna<->pump+3nao(k3*parea*(1e10),k4*k4_coeff*parea*(1e10))CONSERVEpump+pumpna=TotalPump*parea*(1e10)ina_pmp=FARADAY*(f_flux-b_flux)/parea~na<<(-(ina-ina_pmp)*PI*diam/(FARADAY))if(fix_na){na=initial_na}nai=naif(change_ena==1){ena=((R*(273.15+celsius))/(FARADAY*10))*log(nao/nai)}else{ena=60.}}