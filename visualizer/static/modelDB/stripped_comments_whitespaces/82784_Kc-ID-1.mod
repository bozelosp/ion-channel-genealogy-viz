NEURON{SUFFIXKcUSEIONkREADki,koWRITEikUSEIONcaREADcaiRANGEgk,gKcbar}UNITS{(mM)=(milli/liter)(mA)=(milliamp)(mV)=(millivolt)}PARAMETER{cai(mM)gKcbar=0.0022(mho/cm2)}ASSIGNED{v(mV)ik(mA/cm2)cinfctau(ms)gk(mho/cm2)ek(mV)ki(mM)ko(mM)}STATE{c}INITIAL{rate(v)c=cinf}BREAKPOINT{SOLVEstatesMETHODderivimplicitgk=gKcbar*c*cek=25*log(ko/ki)ik=gk*(v-ek)}DERIVATIVEstates{rate(v)c'=(cinf-c)/ctau}UNITSOFFFUNCTIONcalf(v(mV),cai(mM))(/ms){LOCALvs,vavs=v+40*log10(1000*cai)va=vs+18if(fabs(va)<1e-04){calf=-0.0064*(-12-va*0.5)}else{calf=(-0.0064*vs-0.1152)/(-1+exp(-va/12))}}FUNCTIONcbet(v(mV),cai(mM))(/ms){LOCALvsvs=v+40*log10(cai*1000)+152cbet=1.7*exp(-vs/30)}PROCEDURErate(v){LOCALcsum,ca,cbca=calf(v,cai)cb=cbet(v,cai)csum=ca+cbcinf=ca/csumctau=1/csumif(ctau<1.1){ctau=1.1}}UNITSON