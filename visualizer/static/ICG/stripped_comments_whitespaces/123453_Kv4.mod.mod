NEURON{SUFFIXKv4USEIONkREADekWRITEikNONSPECIFIC_CURRENTiRANGEgbar,g,ik,i,igate,ncGLOBALninf,taun,hinf,tauhGLOBALgateCurrent,gunit}UNITS{(mV)=(millivolt)(mA)=(milliamp)(nA)=(nanoamp)(pA)=(picoamp)(S)=(siemens)(nS)=(nanosiemens)(pS)=(picosiemens)(um)=(micron)(molar)=(1/liter)(mM)=(millimolar)}CONSTANT{e0=1.60217646e-19(coulombs)q10=2.7can=0.15743(1/ms)cvan=57(mV)ckan=-32.19976(mV)cbn=0.15743(1/ms)cvbn=57(mV)ckbn=37.51346(mV)cah=0.01342(1/ms)cvah=60(mV)ckah=-7.86476(mV)cbh=0.04477(1/ms)cvbh=54(mV)ckbh=11.3615(mV)zn=1.4736(1)zh=-5.4726(1)}PARAMETER{gateCurrent=0(1)gbar=0.004(S/cm2)<0,1e9>gunit=16(pS)}ASSIGNED{celsius(degC)v(mV)ik(mA/cm2)i(mA/cm2)igate(mA/cm2)ek(mV)g(S/cm2)nc(1/cm2)qt(1)ninf(1)taun(ms)alphan(1/ms)betan(1/ms)hinf(1)tauh(ms)alphah(1/ms)betah(1/ms)}STATE{nh}INITIAL{nc=(1e12)*gbar/gunitqt=q10^((celsius-22(degC))/10(degC))rates(v)n=ninfh=hinf}BREAKPOINT{SOLVEstatesMETHODcnexpg=gbar*n^4*hik=g*(v-ek)igate=nc*(1e6)*e0*(4*zn*ngateFlip()+zh*hgateFlip())if(gateCurrent!=0){i=igate}}DERIVATIVEstates{rates(v)n'=(ninf-n)/taunh'=(hinf-h)/tauh}PROCEDURErates(v(mV)){alphan=alphanfkt(v)betan=betanfkt(v)ninf=alphan/(alphan+betan)taun=1/(qt*(alphan+betan))alphah=alphahfkt(v)betah=betahfkt(v)hinf=alphah/(alphah+betah)tauh=1/(qt*(alphah+betah))}FUNCTIONalphanfkt(v(mV))(1/ms){alphanfkt=can*exp(-(v+cvan)/ckan)}FUNCTIONbetanfkt(v(mV))(1/ms){betanfkt=cbn*exp(-(v+cvbn)/ckbn)}FUNCTIONalphahfkt(v(mV))(1/ms){alphahfkt=cah/(1+exp(-(v+cvah)/ckah))}FUNCTIONbetahfkt(v(mV))(1/ms){betahfkt=cbh/(1+exp(-(v+cvbh)/ckbh))}FUNCTIONngateFlip()(1/ms){ngateFlip=(ninf-n)/taun}FUNCTIONhgateFlip()(1/ms){hgateFlip=(hinf-h)/tauh}