UNITS{(mA)=(milliamp)(mV)=(millivolt)(molar)=(1/liter)(mM)=(millimolar)FARADAY=96520(coul)R=8.3134(joule/degC)KTOMV=.0853(mV/degC)F=96485(coul)}PARAMETER{v(mV)celsius=6.3(degC)PcaTbar=.000011(cm/s)cai(mM)cao(mM)q10Ampl=3.3q10m=3.55q10h=2.8}NEURON{SUFFIXcatUSEIONcaREADcai,caoWRITEicaRANGEPcaTbar,cai}STATE{mh}ASSIGNED{ica(mA/cm2)PcaT(cm/s)}INITIAL{m=minf(v)h=hinf(v)}UNITSOFFBREAKPOINT{SOLVEstatesMETHODcnexpPcaT=PcaTbar*m*m*hica=PcaT*ghk(v,cai,cao)}DERIVATIVEstates{m'=(minf(v)-m)/m_tau(v)h'=(hinf(v)-h)/h_tau(v)}FUNCTIONghk(v(mV),ci(mM),co(mM))(mV){LOCALa,qtAmplqtAmpl=q10Ampl^((celsius-23)/10)a=2*F*v/(R*(celsius+273.15)*1000)ghk=qtAmpl*2*F/1000*(co-ci*exp(a))*func(a)}FUNCTIONfunc(a){if(fabs(a)<1e-4){func=-1+a/2}else{func=a/(1-exp(a))}}FUNCTIONhinf(v(mV)){TABLEFROM-150TO150WITH3000hinf=1/(1+exp((v+72)/3.7))}FUNCTIONminf(v(mV)){TABLEFROM-150TO150WITH3000minf=(1/(1+exp(-(v+31.4)/8.8)))^0.5}FUNCTIONm_tau(v(mV))(ms){LOCALf1,f2,qtmTABLEFROM-150TO150WITH3000qtm=q10m^((celsius-23)/10)f1=1/(1+exp(-(v-7.63)/28.47))+0.01f2=62.82/(1+exp((v+37.02)/5.27))+3.78m_tau=f1*f2/qtm}FUNCTIONh_tau(v(mV))(ms){LOCALalphah,localhinf,qthTABLEFROM-150TO150WITH3000qth=q10h^((celsius-23)/10)localhinf=1/(1+exp((v+72)/3.7))alphah=0.0021/(1+exp((v+65.77)/4.32))h_tau=localhinf/(qth*alphah)}UNITSON