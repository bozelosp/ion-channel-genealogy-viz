UNITS{(molar)=(1/liter)}UNITS{(mV)=(millivolt)(mA)=(milliamp)(mM)=(millimolar)}INDEPENDENT{tFROM0TO1WITH100(ms)}NEURON{SUFFIXcachanUSEIONcaREADcai,caoWRITEicaRANGEpcabar,ica}UNITS{FARADAY=(faraday)(coulomb)R=(k-mole)(joule/degC)}PARAMETER{taufactor=.5celsius=20(degC)v(mV)pcabar=.2e-3(cm/s)cai=1e-3(mM)cao=10(mM)}ASSIGNED{ica(mA/cm2)}STATE{oca}BREAKPOINT{SOLVEcastateMETHODeulerica=pcabar*oca*oca*ghk(v,cai,cao)}DERIVATIVEcastate{oca'=(oca_ss(v)-oca)/oca_tau(v)}INITIAL{oca=oca_ss(v)}FUNCTIONghk(v(mV),ci(mM),co(mM))(.001coul/cm3){LOCALz,eci,ecoz=(1e-3)*2*FARADAY*v/(R*(celsius+273.15))eco=co*efun(z)eci=ci*efun(-z)ghk=(.001)*2*FARADAY*(eci-eco)}FUNCTIONefun(z){if(fabs(z)<1e-4){efun=1-z/2}else{efun=z/(exp(z)-1)}}FUNCTIONoca_ss(v(mV)){LOCALa,bTABLEFROM-150TO150WITH200v=v+65a=1(1/ms)*efun(.1(1/mV)*(25-v))b=4(1/ms)*exp(-v/18(mV))oca_ss=a/(a+b)}FUNCTIONoca_tau(v(mV))(ms){LOCALa,bTABLEFROM-150TO150WITH200v=v+65a=1(1/ms)*efun(.1(1/mV)*(25-v))b=4(1/ms)*exp(-v/18(mV))oca_tau=taufactor/(a+b)}