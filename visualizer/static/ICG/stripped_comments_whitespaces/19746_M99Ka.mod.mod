UNITS{(mA)=(milliamp)(mV)=(millivolt)}NEURON{SUFFIXM99KaUSEIONkREADekWRITEikRANGEgkbar,gk,ik,tmfac,afac,bfac,thfac,vms,vhs,minf,hinf,mexp,hexp,thmin}INDEPENDENT{tFROM0TO1WITH1(ms)}PARAMETER{v(mV)celsius=35(degC)dt(ms)gkbar=0.048(mho/cm2)tmfac=4(1)thfac=1(1)thmin=2(ms)afac=1.5(1)bfac=0.825(1)vms=0(mV)vhs=0(mV)}STATE{mh}ASSIGNED{ek(mV)ik(mA/cm2)minfhinfmexphexp}BREAKPOINT{SOLVEstatesik=gkbar*m*h*(v-ek)}UNITSOFFINITIAL{rates(v)m=minfh=hinf}PROCEDUREstates(){rates(v)m=m+mexp*(minf-m)h=h+hexp*(hinf-h)}PROCEDURErates(v){LOCALalpha,beta,sum,tauTABLEminf,mexp,hinf,hexpDEPENDdt,vms,vhs,tmfac,afac,bfac,thfac,thminFROM-100TO100WITH200alpha=exp(-0.038*(afac+1/(1+exp((v-vms+40)/5)))*(v-vms-11))beta=exp(-0.038*(bfac+1/(1+exp((v-vms+40)/5)))*(v-vms-11))sum=1+alphaminf=1/sumtau=tmfac*beta/sumif(tau<0.1){tau=0.1}mexp=1-exp(-dt/tau)alpha=exp(0.11*(v-vhs+56))hinf=1/(1+alpha)tau=thfac*0.26*(v+50)if(tau<thmin){tau=thmin}hexp=1-exp(-dt/tau)}UNITSON