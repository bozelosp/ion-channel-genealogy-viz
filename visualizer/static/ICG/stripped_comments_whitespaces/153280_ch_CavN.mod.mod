VERBATIM#include<stdlib.h>ENDVERBATIMUNITS{(mA)=(milliamp)(mV)=(millivolt)(molar)=(1/liter)(mM)=(millimolar)FARADAY=96520(coul)R=8.3134(joule/degC)}NEURON{SUFFIXch_CavNUSEIONcaREADecaWRITEicaVALENCE2RANGEgRANGEgmaxRANGEcinf,ctau,dinf,dtauRANGEmyiTHREADSAFE}INDEPENDENT{tFROM0TO100WITH100(ms)}PARAMETER{v(mV)celsius(degC)gmax=1.0(mho/cm2)}STATE{cd}ASSIGNED{dt(ms)ica(mA/cm2)g(mho/cm2)eca(mV)cinfdinfctau(ms)dtau(ms)cexpdexpmyi(mA/cm2)}BREAKPOINT{SOLVEstatesg=gmax*c*c*dica=g*(v-eca)myi=ica}UNITSOFFINITIAL{trates(v)c=cinfd=dinf}?statesPROCEDUREstates(){trates(v)c=c+cexp*(cinf-c)d=d+dexp*(dinf-d)}LOCALq10PROCEDURErates(v){LOCALalpha,beta,sumq10=3^((celsius-34)/10)alpha=-0.19*vtrap(v-19.88,-10)beta=0.046*exp(-v/20.73)sum=alpha+betactau=1/sumcinf=alpha/sumalpha=0.00016*exp(-v/48.4)beta=1/(exp((-v+39)/10)+1)sum=alpha+betadtau=1/sumdinf=alpha/sum}PROCEDUREtrates(v){LOCALtincTABLEcinf,cexp,dinf,dexp,ctau,dtauDEPENDdt,celsiusFROM-100TO100WITH200rates(v)tinc=-dt*q10cexp=1-exp(tinc/ctau)dexp=1-exp(tinc/dtau)}FUNCTIONvtrap(x,y){if(fabs(x/y)<1e-6){vtrap=y*(1-x/y/2)}else{vtrap=x/(exp(x/y)-1)}}UNITSON