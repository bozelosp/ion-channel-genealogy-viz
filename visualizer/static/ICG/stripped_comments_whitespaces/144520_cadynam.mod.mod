INCLUDE"Unit.inc"INCLUDE"Volume.inc"NEURON{SUFFIXCadynamUSEIONcaREADica,caiWRITEcaiVALENCE2USEIONcrREADcriWRITEcriVALENCE2USEIONcuREADcuiWRITEcuiVALENCE2RANGEIrel,Iup,Itr,m_a,m_b}ASSIGNED{v(mV)ica(mA/cm2)Iup(mM/ms)Irel(mM/ms)Itr(mM/ms)m_a(/ms)m_b(/ms)}PARAMETER{cumx=5(mM)Kmca=0.001(mM)tauup=0.025(s)taurel=0.05(s)tautr=2(s)p=1}STATE{caiSTART5e-5(mM)criSTART1(mM)cuiSTART2(mM)m}LOCALViF,VrF,VuFINITIAL{VERBATIMcai=_ion_cai;cri=_ion_cri;cui=_ion_cui;ENDVERBATIMm=m_a/(m_a+m_b)ViF=(1e-3)*Vi*F/S}BREAKPOINT{SOLVEstateMETHODderivimplicit}DERIVATIVEstate{rate(v)m'=m_a*(1-m)-m_b*mIup=(0.001)*cai*(1-cui/cumx)/tauupItr=(0.001)*m*(cui-cri)/tautrIrel=(0.001)*cri*cai^2/taurel/(cai^2+Kmca^2)cui'=Iup*(Vi/Vup)-Itr*(Vrel/Vup)cri'=(Itr-Irel)cai'=-ica/(2*ViF)-Iup+Irel*Vrel/Vi}PROCEDURErate(v(mV)){m_a=(0.001)*0.625(/mV/s)*(v+34)/(exp((v+34)/4(mV))-1)m_b=(0.001)*5(/s)/(1+exp(-(v+34)/4(mV)))}