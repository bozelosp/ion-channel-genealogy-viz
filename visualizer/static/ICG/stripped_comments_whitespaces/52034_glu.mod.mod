INDEPENDENT{tFROM0TO1WITH1(ms)}DEFINEpspMAX15NEURON{POINT_PROCESSgluPOINTERpreRANGEgmax,i,g,delayRANGEdelta,flag,erevNONSPECIFIC_CURRENTiGLOBALtau,PreThresh}ASSIGNED{pspSTACK[pspMAX]psp0psp1pspNpreflagdelta}UNITS{(nA)=(nanoamp)(mV)=(millivolt)(umho)=(micromho)(mM)=(milli/liter)}PARAMETER{gmax=0.005(umho)erev=0(mV)tau=1.0delay=1.5(ms)PreThresh=-20(mV)v(mV)dt(ms)}STATE{XY}INITIAL{LOCALiX=0Y=0flag=0delta=0g=0pspN=0psp0=0psp1=0FROMi=0TOpspMAX{pspSTACK[i]=0}}ASSIGNED{i(nA)g(umho)}BREAKPOINT{SOLVEdstatesMETHODcnexpg=gmax*Y/(tau*0.36787944)i=g*(v-erev)}DERIVATIVEdstates{CheckThresh()CheckTime()X'=delta-X/tauY'=X-Y/tau}PROCEDURECheckThresh(){if(flag){if(pre<PreThresh){flag=0}}else{if(pre>PreThresh){flag=1AddSpike()}}}PROCEDUREAddSpike(){if(pspN<pspMAX){pspN=pspN+1if(psp1>=pspMAX){psp1=0}pspSTACK[psp1]=t+delay-dtpsp1=psp1+1}else{printf("ERROR}PROCEDURECheckTime(){delta=0if((pspSTACK[psp0]>0)&&(t>pspSTACK[psp0])){delta=1/dtpspN=pspN-1pspSTACK[psp0]=0psp0=psp0+1if(psp0>=pspMAX){psp0=0}}}