NEURON{ARTIFICIAL_CELLNStimRANGEinterval,number,start,endRANGEnoise,type,id}PARAMETER{interval=10(ms)<1e-9,1e9>number=10<0,1e9>start=50(ms)noise=0<0,1>end=1e9(ms)}ASSIGNED{event(ms)onendt(ms)typeid}CONSTRUCTOR{VERBATIM{if(ifarg(2)){id=*getarg(2);}else{id=-1;}if(ifarg(3)){type=*getarg(3);}else{type=1;}}ENDVERBATIM}PROCEDUREseed(x){set_seed(x)}INITIAL{on=0if(noise<0){noise=0}if(noise>1){noise=1}if(interval<=0.){interval=.01(ms)}if(start>=0&&number>0&&end>0){event=start+invl(interval)-interval*(1.-noise)if(event<0){event=0}net_send(event,3)}}PROCEDUREinit_sequence(t(ms)){if(number>0){on=1event=tendt=t+1e-6+interval*(number-1)}}FUNCTIONinvl(mean(ms))(ms){if(noise==0){invl=mean}else{invl=(1.-noise)*mean+noise*mean*exprand(1)}}NET_RECEIVE(w){if(flag==0){if(w>0&&on==0){init_sequence(t)net_send(0,1)}elseif(w<0&&on==1){on=0}}if(flag==3){if(on==0){init_sequence(t)net_send(0,1)}}if(flag==1&&on==1){net_event(t)event=event+invl(interval)if(event>endt||event>end){on=0}else{net_send(event-t,1)}}}FUNCTIONfflag(){fflag=1}