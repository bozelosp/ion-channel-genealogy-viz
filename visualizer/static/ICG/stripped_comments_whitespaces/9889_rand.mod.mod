INDEPENDENT{tFROM0TO1WITH1(ms)}NEURON{SUFFIXnothing}VERBATIM#include<stdlib.h>#include<math.h>#include<limits.h>#if!defined(MAXLONG)#include<limits.h>#defineMAXLONGLONG_MAX#endifexterndoublemy_drand48();externvoidmy_srand48();#undefdrand48#undefsrand48#definedrand48my_drand48#definesrand48my_srand48externdoubledrand48();#definerandom()drand48()*MAXLONG#defineinitstate(c1,c2,c3)srand48(c1)staticlongstate2[32]={470594912,650447616,310934240,695012864,850358912,61088076,481306752,786902080,224042800,805177664,938284096,145937936,622867968,160207584,977329216,716234240,127727624,415316352,870137472,18664444,330872224,93728752,914779200,736261248,643647616,755802688,213052336,410240448,218974736,109419280,178026128,689569664};ENDVERBATIMFUNCTIONfseed(seed){VERBATIMinitstate((unsigned)_lseed,(char*)state2,32);_lfseed=_lseed;ENDVERBATIM}FUNCTIONn_rand(){VERBATIM_ln_rand=((double)random())/(((double)MAXLONG)+1.);ENDVERBATIM}FUNCTIONfran(l,h){VERBATIM{intlow,high;doublenum,imax,*getarg();low=(int)_ll;high=(int)_lh;imax=high-low+1;_lfran=(double)(low+(int)(imax*n_rand()));}ENDVERBATIM}FUNCTIONu_rand(){VERBATIM_lu_rand=(((double)random())/((double)MAXLONG));ENDVERBATIM}FUNCTIONnorm(){VERBATIM{staticintiset=0;staticfloatgset;floatfac,r,v1,v2;doublesqrt();if(iset==0){do{v1=2.0*n_rand()-1.0;v2=2.0*n_rand()-1.0;r=v1*v1+v2*v2;}while(r>=1.0);fac=(float)sqrt(-2.0*log(r)/r);gset=v1*fac;iset=1;_lnorm=v2*fac;}else{iset=0;_lnorm=(double)gset;}}ENDVERBATIM}FUNCTIONpois(mean){VERBATIM_lpois=-_lmean*log(((double)random()+1.)/((double)MAXLONG+1.));ENDVERBATIM}FUNCTIONpoisint(mean){poisint=poisrand(mean)}VERBATIM#defineN16#defineMASK((unsigned)(1<<(N-1))+(1<<(N-1))-1)#defineLOW(x)((unsigned)(x)&MASK)#defineHIGH(x)LOW((x)>>N)#defineMUL(x,y,z){longl=(long)(x)*(long)(y);\(z)[0]=LOW(l);(z)[1]=HIGH(l);}#defineCARRY(x,y)((long)(x)+(long)(y)>MASK)#defineADDEQU(x,y,z)(z=CARRY(x,(y)),x=LOW(x+(y)))#defineX00x330E#defineX10xABCD#defineX20x1234#defineA00xE66D#defineA10xDEEC#defineA20x5#defineC0xB#defineSET3(x,x0,x1,x2)((x)[0]=(x0),(x)[1]=(x1),(x)[2]=(x2))#defineSEED(x0,x1,x2)(SET3(x,x0,x1,x2),SET3(a,A0,A1,A2),c=C)staticunsignedx[3]={X0,X1,X2},a[3]={A0,A1,A2},c=C;staticunsignedshortlastx[3];staticvoidnext();doublemy_drand48(){staticdoubletwo16m=1.0/(1L<<N);next();return(two16m*(two16m*(two16m*x[0]+x[1])+x[2]));}staticvoidnext(){unsignedp[2],q[2],r[2],carry0,carry1;MUL(a[0],x[0],p);ADDEQU(p[0],c,carry0);ADDEQU(p[1],carry0,carry1);MUL(a[0],x[1],q);ADDEQU(p[1],q[0],carry0);MUL(a[1],x[0],r);x[2]=LOW(carry0+carry1+CARRY(p[1],r[0])+q[1]+r[1]+a[0]*x[2]+a[1]*x[1]+a[2]*x[0]);x[1]=LOW(p[1]+r[0]);x[0]=LOW(p[0]);}voidmy_srand48(seedval)longseedval;{SEED(X0,LOW(seedval),HIGH(seedval));}#if0#ifdefDRIVER#include<stdio.h>main(){inti;for(i=0;i<80;i++){printf("%4d",(int)(4096*my_drand48()));printf("%.4X%.4X%.4X\n",x[2],x[1],x[0]);}}#endif#endifENDVERBATIM