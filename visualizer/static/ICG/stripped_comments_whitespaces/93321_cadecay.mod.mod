INDEPENDENT{tFROM0TO1WITH1(ms)}NEURON{SUFFIXcadUSEIONcaREADica,caiWRITEcaiRANGEica,channel_flow,depth,BGLOBALcai,tau,cainf,setB}UNITS{(mA)=(milliamp)(mV)=(millivolt)(molar)=(1/liter)(mM)=(millimolar)(um)=(micron)}CONSTANT{FARADAY=96485.309}PARAMETER{dt(ms)depth=1(um)tau=20(ms)cainf=5e-5(mM)ica(mA/cm2)setB=-4.7e-2(cm2mM/mA/ms)}STATE{cai(mM)}INITIAL{cai=cainfB=-4.7e-2}ASSIGNED{channel_flow(mM/ms)B(mMcm2/ms/mA)}BREAKPOINT{SOLVEstateMETHODcnexp}DERIVATIVEstate{B=setBchannel_flow=B*icaif(channel_flow<=0.0){channel_flow=0.0}cai'=channel_flow-(cai-cainf)/tau}