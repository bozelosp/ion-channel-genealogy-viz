DEFINESSIZE501DEFINERSIZE500INDEPENDENT{tFROM0TO1WITH1(ms)}NEURON{POINT_PROCESSCOHRANGET,ntot,Ttot,spikeGLOBALKC,KO}UNITS{(mA)=(milliamp)(mV)=(millivolt)(mM)=(milli/liter)}PARAMETER{dt(ms)rseed=0pv0=0.5(1)n0=1(1)ke=8(/mM/ms)kd=0.0002(/ms)Camp=0.1(mM)Cres=0(mM)Cdur=1(ms)Cnamp=0.01(mM)Cnres=0(mM)Cndur=2(ms)Tamp=1(mM)Tdur=1(ms)}ASSIGNED{spike[SSIZE](ms)indextspike(ms)trel[RSIZE](ms)ntot(1)Ttot(mM)km(/ms)KO[2](/mM/ms)KC[2](/ms)inf[2]tau[2]fac[2]}STATE{n[RSIZE](1)R(1)RO[2](1)T[RSIZE](mM)C(mM)Cn(mM)pv[RSIZE](1)Ccount(1)Cncount(1)Tcnt[RSIZE](1)}INITIAL{index=0FROMi=0TORSIZE-1{n[i]=n0T[i]=0trel[i]=0pv[i]=pv0}R=0C=CresCn=Cnresntot=0Ttot=0set_seed(rseed)km=n0*kdKO[0]=150KO[1]=1KC[0]=30KC[1]=0.1}BREAKPOINT{SOLVErelease}PROCEDURErelease(){if(index<SSIZE&&t>=spike[index]&&C<Camp){C=Campindex=index+1tspike=tCcount=Cdur/dtTtot=0}prel()ntot=0FROMi=0TORSIZE-1{if(unirand()<dt*km){n[i]=n[i]+1}if(n[i]>0&&unirand()<dt*kd){n[i]=n[i]-1}if(Cn>0){if(unirand()<dt*ke*Cn){n[i]=n[i]+1}}onerel(i)if(T[i]>0){Tcnt[i]=Tcnt[i]-1if(Tcnt[i]<0){T[i]=0}}ntot=ntot+n[i]}if(C>Cres){Ccount=Ccount-1if(Ccount<0){C=CresCn=CnampCncount=Cndur/dt}}if(Cn>Cnres){Cncount=Cncount-1if(Cncount<0){Cn=Cnres}}VERBATIMreturn0;ENDVERBATIM}PROCEDUREonerel(i){if(trel[i]<tspike){if(n[i]>0&&unirand()<R*pv[i]*n[i]*dt*40){n[i]=n[i]-1T[i]=TampTcnt[i]=Tdur/dttrel[i]=tTtot=Ttot+1}}}PROCEDUREprel(){rates(C)R=1FROMi=0TO1{RO[i]=RO[i]+fac[i]*(inf[i]-RO[i])R=R*RO[i]}}PROCEDURErates(C){LOCALa,bTABLEinf,fac,tauDEPENDdtFROM0TO0.2WITH200FROMj=0TO1{a=KO[j]*Cb=KC[j]tau[j]=1/(a+b)inf[j]=a/(a+b)fac[j]=(1-exp(-dt/tau[j]))}}FUNCTIONunirand(){return(scop_random())}