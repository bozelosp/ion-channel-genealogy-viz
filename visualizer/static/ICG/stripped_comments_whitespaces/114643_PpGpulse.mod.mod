INDEPENDENT{tFROM0TO1WITH1(ms)}NEURON{POINT_PROCESSpGpulseRANGEactiveRANGEg_e,g_i,g_eout,g_iout,del,dur,i0,amp_ge,amp_gi,pfreq,pdur,E_e,E_iUSEIONzREADezWRITEizVALENCE1POINTERvcell}UNITS{(nA)=(nanoamp)(mV)=(millivolt)(umho)=(micromho)}PARAMETER{active=0del=0(ms)dur=10000(ms)E_e=0(mV)E_i=-75(mV)amp_ge=0(umho)amp_gi=0(umho)pfreq=10(Hz)pdur=500(ms)}ASSIGNED{vcell(mV)iz(nA)ez(mV)Npulsespstart(ms)pstop(ms)g_e(umho)g_i(umho)g_eout(umho)g_iout(umho)}INITIAL{iz=0g_e=0g_i=0Npulses=0pstart=delpstop=pstart+pdurVERBATIMprintf("%f\n",pstart);ENDVERBATIM}BREAKPOINT{if(active){if((t>=pstart)&&(t<dur)){VERBATIMprintf("%f\n",active);ENDVERBATIMg_e=amp_geNpulses=Npulses+1pstart=del+Npulses*1000/pfreqif(1000/pfreq<=pdur){pstop=del+dur}}elseif(t>=pstop){g_e=0pstop=pstart+pdur}}else{g_e=0}iz=g_e*(vcell-E_e)g_eout=50000.0*g_e}PROCEDUREUpdate(){VERBATIMNpulses=(int)((t-del)*pfreq/1000);ENDVERBATIMpstart=del+Npulses*1000/pfreqif(1000/pfreq<=pdur){pstop=del+dur}else{pstop=pstart+pdur}}