NEURON{SUFFIXkcaUSEIONkREADekWRITEikUSEIONcaREADcaiRANGEgk,gbar,m_inf,tau_m,gmaxGLOBALbeta,cac}UNITS{(mA)=(milliamp)(mV)=(millivolt)(molar)=(1/liter)(mM)=(millimolar)}PARAMETER{v(mV)celsius=36(degC)ek=-80(mV)cai=2.4e-5(mM)gbar=0.01(mho/cm2)beta=0.03(1/ms)cac=0.025(mM)taumin=0.5(ms)}STATE{m}ASSIGNED{ik(mA/cm2)m_inftau_m(ms)tadjgk(mho/cm2)gmax(mho/cm2)}BREAKPOINT{SOLVEstatesMETHODderivimplicitgk=gbar*m*m*mik=gk*(v-ek)if(gk>gmax){gmax=gk}}DERIVATIVEstates{evaluate_fct(v,cai)m'=(m_inf-m)/tau_m}INITIAL{tadj=3^((celsius-22.0(degC))/10(degC))evaluate_fct(v,cai)m=m_infgk=gbar*m*m*mgmax=gk}PROCEDUREevaluate_fct(v(mV),cai(mM)){LOCALcarcar=(cai/cac)^2m_inf=car/(1+car)tau_m=1/beta/(1+car)/tadjif(tau_m<taumin){tau_m=taumin}}