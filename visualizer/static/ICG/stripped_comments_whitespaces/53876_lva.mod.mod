NEURON{SUFFIXlvaUSEIONcaREADecaWRITEicaRANGEg,gbarRANGEk,tee,alpha_1,alpha_2}UNITS{(S)=(siemens)(mV)=(millivolt)(mA)=(milliamp)}PARAMETER{gbar=166e-6(S/cm2)<0,1e9>}ASSIGNED{eca(mV)ica(mA/cm2)v(mV)g(S/cm2)kteealpha_1alpha_2}STATE{mhd}BREAKPOINT{SOLVEstatesMETHODcnexpg=gbar*m^3*hica=g*(v-eca)}INITIAL{LOCALC,Erates(v)m=alpham(v)/(alpham(v)+betam(v))C=beta1(v)/alpha1(v)E=alpha2(v)/beta2(v)h=E/(E*C+E+C)d=1-(1+C)*h}DERIVATIVEstates{rates(v)m'=alpham(v)*(1-m)-betam(v)*mh'=alpha1(v)*(1-h-d)-beta1(v)*hd'=beta2(v)*(1-h-d)-alpha2(v)*d}FUNCTIONalpham(Vm(mV))(/ms){UNITSOFFalpham=3.3/(1.7+exp(-(Vm+28.8)/13.5))UNITSON}FUNCTIONbetam(Vm(mV))(/ms){UNITSOFFbetam=3.3*exp(-(Vm+63)/7.8)/(1.7+exp(-(Vm+28.8)/13.5))UNITSON}FUNCTIONalpha1(Vm(mV))(/ms){UNITSOFFalpha1=alpha_1UNITSON}FUNCTIONbeta1(Vm(mV))(/ms){UNITSOFFbeta1=k*alpha_1UNITSON}FUNCTIONalpha2(Vm(mV))(/ms){UNITSOFFalpha2=alpha_2UNITSON}FUNCTIONbeta2(Vm(mV))(/ms){UNITSOFFbeta2=k*alpha_2UNITSON}PROCEDURErates(Vm(mV)){k=(0.25+exp((Vm+83.5)/6.3))^0.5-0.5tee=240.0/(1+exp((Vm+37.4)/30))alpha_1=2.5/(tee*(1+k))alpha_2=2.5*exp(-(Vm+160.3)/17.8)}