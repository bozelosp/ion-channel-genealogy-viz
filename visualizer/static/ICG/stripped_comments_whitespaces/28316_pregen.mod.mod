NEURON{POINT_PROCESSSpikeGeneratorRANGEx,spk,lastspkRANGEfast_invl,slow_invl,burst_len,start,endRANGEnoiseGLOBALdummy}PARAMETER{fast_invl=1(ms)slow_invl=200(ms)burst_len=1start=100(ms)end=1e10(ms)noise=0}ASSIGNED{xburstevent(ms)burst_off(ms)burst_on(ms)toff(ms)dummy}PROCEDUREseed(x){set_seed(x)}INITIAL{toff=1e9x=-90burst=0event=start-slow_invlevent_time()while(event<0){event_time()}generate()}BREAKPOINT{SOLVEgenerateMETHODcvode_t}FUNCTIONinterval(mean(ms))(ms){if(mean<=0.){mean=.01(ms)}if(noise==0){interval=mean}else{interval=(1.-noise)*mean+noise*mean*exprand(1)}}PROCEDUREevent_time(){if(slow_invl==0||(burst!=0.&&burst_len>1)){event=event+interval(fast_invl)if(event>burst_on+burst_off){burst=0.}}else{burst=1.event=event+interval(slow_invl)burst_on=eventburst_off=interval((burst_len-1)*fast_invl)-1e-6}if(event>end){event=-1e5}}PROCEDUREgenerate(){if(at_time(event)){x=20toff=event+.1event_time()}if(at_time(toff)){x=-90}}