NEURON{SUFFIXcalUSEIONcaREADcai,ecaWRITEicaRANGEgcalbar,ica,poGLOBALinf,s_inf,tau_m}UNITS{(mA)=(milliamp)(mV)=(millivolt)(molar)=(1/liter)(mM)=(millimolar)FARADAY=(faraday)(coulomb)R=(k-mole)(joule/degC)}PARAMETER{ki=0.025(mM)gcalbar=1(mho/cm2)taumin=180(ms)vhalf=-1(mV)zeta=-4.6t0=1.5(ms)b=0.03ba=0.01(mM)bo=8}ASSIGNED{v(mV)celsius(degC)cai(mM)ica(mA/cm2)eca(mV)poinfs_inftau_m(ms)}STATE{ms}INITIAL{rates(v,cai)m=infs=s_inf}FUNCTIONh2(cai(mM)){h2=ki/(ki+cai)}BREAKPOINT{SOLVEstatesMETHODcnexppo=m*m*h2(cai)ica=gcalbar*(po+s*s*bo)*(v-eca)}DERIVATIVEstates{rates(v,cai)m'=(inf-m)/t0s'=(s_inf-s)/tau_m}FUNCTIONalp(v(mV)){UNITSOFFalp=exp(1.e-3*zeta*(v-vhalf)*9.648e4/(8.315*(273.16+celsius)))UNITSON}PROCEDURErates(v(mV),cai(mM)){LOCALa,alpha2a=alp(v)inf=1/(1+a)alpha2=(cai/b)^2s_inf=alpha2/(alpha2+1)tau_m=taumin+1(ms)*1(mM)/(cai+ba)}