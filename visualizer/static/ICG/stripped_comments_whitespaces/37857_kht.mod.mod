UNITS{(mA)=(milliamp)(mV)=(millivolt)(nA)=(nanoamp)}NEURON{SUFFIXkhtUSEIONkREADekWRITEikRANGEgkhtbar,gkht,ikGLOBALninf,pinf,ntau,ptau}INDEPENDENT{tFROM0TO1WITH1(ms)}PARAMETER{v(mV)celsius=22(degC)dt(ms)ek=-77(mV)gkhtbar=0.01592(mho/cm2)<0,1e9>nf=0.85<0,1>}STATE{np}ASSIGNED{ik(mA/cm)gkht(mho/cm2)pinfninfptau(ms)ntau(ms)}LOCALnexp,pexpBREAKPOINT{SOLVEstatesgkht=gkhtbar*(nf*(n^2)+(1-nf)*p)ik=gkht*(v-ek)}UNITSOFFINITIAL{trates(v)p=pinfn=ninf}PROCEDUREstates(){trates(v)n=n+nexp*(ninf-n)p=p+pexp*(pinf-p)VERBATIMreturn0;ENDVERBATIM}LOCALq10PROCEDURErates(v){q10=3^((celsius-22)/10)ninf=(1+exp(-(v+15)/5))^-0.5pinf=1/(1+exp(-(v+23)/6))ntau=(100/(11*exp((v+60)/24)+21*exp(-(v+60)/23)))+0.7ptau=(100/(4*exp((v+60)/32)+5*exp(-(v+60)/22)))+5}PROCEDUREtrates(v){LOCALtincTABLEninf,nexp,pinf,pexpDEPENDdt,celsiusFROM-150TO150WITH300rates(v)tinc=-dt*q10nexp=1-exp(tinc/ntau)pexp=1-exp(tinc/ptau)}FUNCTIONvtrap(x,y){if(fabs(x/y)<1e-6){vtrap=y*(1-x/y/2)}else{vtrap=x/(exp(x/y)-1)}}UNITSON