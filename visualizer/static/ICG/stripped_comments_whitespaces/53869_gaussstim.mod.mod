NEURON{POINT_PROCESSGaussStimRANGExRANGEinterval,number,start,factor,refracRANGEN_backward,N_forward,N_normal,N_totalRANGErndRANGErand}PARAMETER{interval=10(ms)<1e-9,1e9>number=10000<0,1e9>start=10(ms)factor=4refrac=0.5<0,3>}ASSIGNED{xevent(ms)onend(ms)m(ms)diff(ms)N_forwardN_backwardN_normalN_totalrndrand}PROCEDUREseed(x){set_seed(x)}INITIAL{on=0x=0diff=0m=interval/2N_forward=0N_backward=0N_normal=0N_total=0if(start>=0&&number>0){event=start+invl(m)if(event<0){event=0}net_send(event,3)}}PROCEDUREinit_sequence(t(ms)){if(number>0){on=1event=tend=t+1e-6+interval*(number-1)}}FUNCTIONinvl(mean(ms))(ms){LOCALstdif(mean<=0.){mean=.01(ms)}std=mean/factorinvl=normrand(mean,std)if(invl>=interval){invl=fmod(invl,interval)N_forward=N_forward+1}elseif(invl<0){invl=fmod(invl,interval)+intervalN_backward=N_backward+1}else{N_normal=N_normal+1}diff=interval-invl}PROCEDUREevent_time(){LOCALdiff2,Tdiff2=diffif(number>0){T=invl(m)rnd=Tif(T==0&&diff2==0){T=T+dt}event=T+event+diff2N_total=N_total+1}if(event>end){on=0}}NET_RECEIVE(w){if(flag==0){if(w>0&&on==0){init_sequence(t)net_send(0,1)}elseif(w<0&&on==1){on=0}}if(flag==3){if(on==0){init_sequence(t)net_send(0,1)}}if(flag==1&&on==1){if(x==0){rand=scop_random()x=randnet_event(t)event_time()if(event-t<=refrac+dt&&event-t>=refrac){event=event+dt}if(on==1){net_send(event-t,1)}net_send(refrac,2)}elseif(x!=0){net_event(t)event_time()if(on==1){net_send(event-t,1)}}}if(flag==2){x=0}}