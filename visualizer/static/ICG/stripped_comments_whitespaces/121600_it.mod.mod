INDEPENDENT{tFROM0TO1WITH1(ms)}NEURON{SUFFIXiTUSEIONcaREADcai,caoWRITEicaRANGEpcabar,m_inf,h_inf,tau_m,tau_h}UNITS{(mA)=(milliamp)(mV)=(millivolt)(mM)=(milli/liter)FARADAY=96480(coul)R=8.314(volt-coul/degC)}PARAMETER{v(mV)celsius(degC)dt(ms)cai(mM)cao(mM)pcabar=0.0001(cm/s)}STATE{mh}ASSIGNED{ica(mA/cm2)tau_m(ms)tau_h(ms)m_infh_inftadjmtadjh}BREAKPOINT{SOLVEstateica=pcabar*m*m*h*ghk(v,cai,cao,2)}PROCEDUREstate(){rates(v)m=m+(1-exp(-dt/tau_m))*(m_inf-m)h=h+(1-exp(-dt/tau_h))*(h_inf-h)}UNITSOFFINITIAL{tadjm=3.55^((celsius-23.5)/10)tadjh=2.8^((celsius-23.5)/10)rates(v)m=m_infh=h_inf}FUNCTIONghk(v(mV),ci(mM),co(mM),z)(millicoul/cm3){LOCALe,ww=v*(.001)*z*FARADAY/(R*(celsius+273.16))if(fabs(w)>1e-4){e=w/(exp(w)-1)}else{e=1-w/2}ghk=-(.001)*z*FARADAY*(co-ci*exp(w))*e}UNITSOFFPROCEDURErates(v(mV)){tau_m=(1/(exp((v+131.6)/-16.7)+exp((v+16.8)/18.2))+0.612)/tadjmm_inf=1/(1+exp((v+60.5)/-6.2))if(v<-80){tau_h=exp((v+467)/66.6)/tadjh}else{tau_h=(exp((v+21.88)/-10.52)+28)/tadjh}h_inf=1/(1+exp((v+84)/4.03))}UNITSON