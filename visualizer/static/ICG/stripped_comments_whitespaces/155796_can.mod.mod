NEURON{SUFFIXcanUSEIONcaREADecaWRITEicaRANGEgbarGLOBALminf,hinf,mtau,htauTHREADSAFEminf,hinf,mtau,htau}PARAMETER{gbar=4e-2(mho/cm2)mafac=0.1mamid=-15maslope=5mbfac=0.5mbmid=-5mbslope=10hafac=0.01hamid=50haslope=15hbfac=0.2hbmid=40hbslope=17eca(mV)v(mV)}UNITS{(mA)=(milliamp)(mV)=(millivolt)(pS)=(picosiemens)(um)=(micron)}ASSIGNED{ica(mA/cm2)minfhinfmtau(ms)htau(ms)}STATE{mh}BREAKPOINT{SOLVEstatesMETHODcnexpica=gbar*m*m*h*(v-eca)}INITIAL{trates(v)m=minfh=hinf}DERIVATIVEstates{trates(v)m'=(minf-m)/mtauh'=(hinf-h)/htau}PROCEDUREtrates(vm){LOCALa,ba=trap0(vm,mamid,mafac,maslope)b=mbfac*exp(-(vm+mbmid)/mbslope)minf=a/(a+b)mtau=1/(a+b)a=hafac*exp(-(vm+hamid)/haslope)b=hbfac/(1+exp(-(vm+hbmid)/hbslope))hinf=a/(a+b)htau=1/(a+b)}FUNCTIONtrap0(v,th,a,q){if(fabs(v-th)>1e-6){trap0=a*(v-th)/(1-exp(-(v-th)/q))}else{trap0=a*q}}