INDEPENDENT{tFROM0TO1WITH1(ms)}NEURON{SUFFIXiarUSEIONhREADehWRITEihVALENCE1USEIONcaREADcaiRANGEghbar,h_inf,tau_s,m,shiftGLOBALk2,cac,k4,Pc,nca,nexp,ginc,taum}UNITS{(molar)=(1/liter)(mM)=(millimolar)(mA)=(milliamp)(mV)=(millivolt)(msM)=(msmM)}PARAMETER{eh=-40(mV)celsius=36(degC)ghbar=2e-5(mho/cm2)cac=0.002(mM)k2=0.0004(1/ms)Pc=0.01k4=0.001(1/ms)nca=4nexp=1ginc=2taum=20(ms)shift=0(mV)}STATE{c1o1o2p0p1}ASSIGNED{v(mV)cai(mM)ih(mA/cm2)gh(mho/cm2)h_inftau_s(ms)alpha(1/ms)beta(1/ms)k1ca(1/ms)k3p(1/ms)mtadj}BREAKPOINT{SOLVEihkinMETHODsparsem=o1+ginc*o2ih=ghbar*m*(v-eh)}KINETICihkin{evaluate_fct(v,cai)~c1<->o1(alpha,beta)~p0<->p1(k1ca,k2)~o1<->o2(k3p,k4)CONSERVEp0+p1=1CONSERVEc1+o1+o2=1}INITIAL{tadj=3.0^((celsius-36(degC))/10(degC))evaluate_fct(v,cai)c1=1o1=0o2=0p0=1p1=0}UNITSOFFPROCEDUREevaluate_fct(v(mV),cai(mM)){h_inf=1/(1+exp((v+75-shift)/5.5))tau_s=(taum+1000/(exp((v+71.5-shift)/14.2)+exp(-(v+89-shift)/11.6)))/tadjalpha=h_inf/tau_sbeta=(1-h_inf)/tau_sk1ca=k2*(cai/cac)^ncak3p=k4*(p1/Pc)^nexp}PROCEDUREactivation(v(mV),cai(mM)){LOCALccevaluate_fct(v,cai)cc=1/(1+(cac/cai)^nca)m=1/(1+beta/alpha+(cc/Pc)^nexp)m=(1+ginc*(cc/Pc)^nexp)*m}UNITSON