UNITS{(mA)=(milliamp)(mV)=(millivolt)(S)=(siemens)(pS)=(picosiemens)(um)=(micrometer)}NEURON{SUFFIXHHcnfUSEIONnaREADenaWRITEinaUSEIONkREADekWRITEikNONSPECIFIC_CURRENTilRANGEel,glRANGEgnabar,gkbarRANGEgna,gkRANGEgamma_na,gamma_kRANGEm_inf,h_inf,n_infRANGEtau_m,tau_h,tau_n,tau_y,tau_zRANGEvar_y,var_zRANGEnoise_y,noise_zRANGENna,NkRANGEseedRANGEmu_y,mu_zTHREADSAFE}PARAMETER{gnabar=0.12(S/cm2)gkbar=0.036(S/cm2)gl=0.0003(S/cm2)el=-54.3(mV)gamma_na=20(pS)gamma_k=15(pS)seed=5061983}STATE{mhnyyzz}ASSIGNED{ina(mA/cm2)ik(mA/cm2)il(mA/cm2)gna(S/cm2)gk(S/cm2)ena(mV)ek(mV)dt(ms)area(um2)celsius(degC)v(mV)Nna(1)Nk(1)m_infh_infn_infnoise_ynoise_zvar_y(ms2)var_z(ms2)tau_m(ms)tau_h(ms)tau_n(ms)tau_y(ms)tau_z(ms)mu_ymu_z}INITIAL{Nna=ceil(((1e-8)*area)*(gnabar)/((1e-12)*gamma_na))Nk=ceil(((1e-8)*area)*(gkbar)/((1e-12)*gamma_k))rates(v)m=m_infh=h_infn=n_infyy=0.zz=0.set_seed(seed)}BREAKPOINT{SOLVEstatesgna=gnabar*(m*m*m*h+zz)if(gna<0){gna=0}gk=gkbar*(n*n*n*n+yy)if(gk<0){gk=0}ina=gna*(v-ena)ik=gk*(v-ek)il=gl*(v-el)}PROCEDUREstates(){rates(v)m=m+dt*(m_inf-m)/tau_mh=h+dt*(h_inf-h)/tau_hn=n+dt*(n_inf-n)/tau_nyy=yy*mu_y+noise_yzz=zz*mu_z+noise_zVERBATIMreturn0;ENDVERBATIM}PROCEDURErates(Vm(mV)){LOCALa,b,m3_inf,n4_inf,q10,sum,var_z1,var_z2,var_z3,var_z4,var_z5,var_z6,var_z7,tau_z1,tau_z2,tau_z3,tau_z4,tau_z5,tau_z6,tau_z7,var_y1,var_y2,var_y3,var_y4,one_minus_m,one_minus_h,one_minus_nUNITSOFFq10=3.^((celsius-6.3)/10.)a=alpham(Vm)b=betam(Vm)sum=a+btau_m=1./(q10*sum)m_inf=a/sumone_minus_m=1.-m_infm3_inf=m_inf*m_inf*m_infa=alphah(Vm)b=betah(Vm)sum=a+btau_h=1./(q10*sum)h_inf=a/sumone_minus_h=1.-h_inftau_z1=tau_htau_z2=tau_mtau_z3=tau_m/2tau_z4=tau_m/3tau_z5=tau_m*tau_h/(tau_m+tau_h)tau_z6=tau_m*tau_h/(tau_m+2*tau_h)tau_z7=tau_m*tau_h/(tau_m+3*tau_h)var_z1=1.0/Nna*m3_inf*m3_inf*h_inf*one_minus_hvar_z2=3.0/Nna*m3_inf*m_inf*m_inf*h_inf*h_inf*one_minus_mvar_z3=3.0/Nna*m3_inf*m_inf*h_inf*h_inf*one_minus_m*one_minus_mvar_z4=1.0/Nna*m3_inf*h_inf*h_inf*one_minus_m*one_minus_m*one_minus_mvar_z5=3.0/Nna*m3_inf*m_inf*m_inf*h_inf*one_minus_m*one_minus_hvar_z6=3.0/Nna*m3_inf*m_inf*h_inf*one_minus_m*one_minus_m*one_minus_hvar_z7=1.0/Nna*m3_inf*h_inf*one_minus_m*one_minus_m*one_minus_m*one_minus_htau_z=(var_z1+var_z2+var_z3+var_z4+var_z5+var_z6+var_z7)/(var_z1/tau_z1+var_z2/tau_z2+var_z3/tau_z3+var_z4/tau_z4+var_z5/tau_z5+var_z6/tau_z6+var_z7/tau_z7)var_z=1.0/Nna*m3_inf*h_inf*(1.0-m3_inf*h_inf)mu_z=exp(-dt/tau_z)noise_z=sqrt(var_z*(1-mu_z*mu_z))*normrand(0,1)a=alphan(Vm)b=betan(Vm)sum=a+btau_n=1./(q10*sum)n_inf=a/sumone_minus_n=1.-n_infn4_inf=n_inf*n_inf*n_inf*n_infvar_y1=4.0/Nk*n4_inf*n_inf*n_inf*n_inf*one_minus_nvar_y2=6.0/Nk*n4_inf*n_inf*n_inf*one_minus_n*one_minus_nvar_y3=4.0/Nk*n4_inf*n_inf*one_minus_n*one_minus_n*one_minus_nvar_y4=1.0/Nk*n4_inf*one_minus_n*one_minus_n*one_minus_n*one_minus_ntau_y=(var_y1+var_y2+var_y3+var_y4)/(var_y1/tau_n+var_y2/tau_n/2+var_y3/tau_n/3+var_y4/tau_n/4)var_y=1.0/Nk*n4_inf*(1.0-n4_inf)mu_y=exp(-dt/tau_y)noise_y=sqrt(var_y*(1-mu_y*mu_y))*normrand(0,1)UNITSON}PROCEDUREconsistency(){if(m>1){m=1}if(m<0){m=0}if(h>1){h=1}if(h<0){h=0}if(n>1){n=1}if(n<0){n=0}}FUNCTIONvtrap(x,y){if(fabs(x/y)<1e-6){vtrap=y*(1-x/y/2)}else{vtrap=x/(exp(x/y)-1)}}FUNCTIONalpham(Vm(mV))(/ms){UNITSOFFalpham=.1*vtrap(-(Vm+40),10)UNITSON}FUNCTIONbetam(Vm(mV))(/ms){UNITSOFFbetam=4*exp(-(Vm+65)/18)UNITSON}FUNCTIONalphah(Vm(mV))(/ms){UNITSOFFalphah=.07*exp(-(Vm+65)/20)UNITSON}FUNCTIONbetah(Vm(mV))(/ms){UNITSOFFbetah=1/(exp(-(Vm+35)/10)+1)UNITSON}FUNCTIONalphan(Vm(mV))(/ms){UNITSOFFalphan=.01*vtrap(-(Vm+55),10)UNITSON}FUNCTIONbetan(Vm(mV))(/ms){UNITSOFFbetan=.125*exp(-(Vm+65)/80)UNITSON}