NEURON{ARTIFICIAL_CELLIntFireCurRANGEtau,m,refrac,minf,gid}PARAMETER{tau=5(ms)<1e-9,1e9>refrac=5(ms)<0,1e9>minf=0gid=-1}ASSIGNED{mt0(ms)oncnt}INITIAL{m=0t0=ton=1net_send(firetime(),1)}FUNCTIONM(){if(on){M=minf+(m-minf)*exp(-(t-t0)/tau)}else{M=0}}NET_RECEIVE(w){m=M()t0=tif(flag==1){if(m>=.999999){net_event(t)m=0on=0net_send(refrac+1e-6,2)}else{net_send(firetime(),1)}}elseif(flag==2){on=1m=0net_send(firetime(),1)}else{if(on){m=m+wif(m>=1){net_move(t)}else{net_move(t+firetime())}}}}FUNCTIONfiretime()(ms){if(minf>1){firetime=tau*log((minf-m)/(minf-1))}else{firetime=1e20}}