INDEPENDENT{tFROM0TO1WITH1(ms)}NEURON{SUFFIXca12dZUyUSEIONcaREADcai,caoWRITEicaRANGEC0,C1,C2,C3,C4,O,I0,I1,I2,I3,I4,IoRANGEkv,kv0,k_v,k_v0,ko,k_o,ki,k_iRANGEf,h,pRANGEvkv,vk_vGLOBALvmin,vmax,vshift}UNITS{F=(faraday)(coulomb)R=(k-mole)(joule/degC)(mA)=(milliamp)(mV)=(millivolt)(pS)=(picosiemens)(um)=(micron)(mM)=(milli/liter)}PARAMETER{p=7e-6(cm/s)v(mV)kv0=3.7(/ms)k_v0=18e-3(/ms)ko=20(/ms)k_o=1.65(/ms)ki=62e-3(/ms)k_i=0.13e-3(/ms)f=0.224h=0.125vkv=25.5(mV)vk_v=-15.3(mV)vshift=0(mV)celsius(degC)vmin=-200(mV)vmax=200(mV)}ASSIGNED{ica(mA/cm2)cao(mM)cai(mM)kv(1/ms)k_v(1/ms)}STATE{C0C1C2C3C4OI0I1I2I3I4Io}INITIAL{C0=0.0076057097C1=0.0095551048C2=0.0045015537C3=0.00094255543C4=7.4008676e-05O=0.00089707485I0=7.9627334e-05I1=0.0035727272I2=0.060113056I3=0.44952644I4=0.035296445Io=(1-C0-C1-C2-C3-C4-O-I0-I1-I2-I3-I4)}BREAKPOINT{rates(v)SOLVEkstatesMETHODsparseica=O*p*ghk(v,cai,cao)}KINETICkstates{~C0<->C1(4*kv,k_v)~C1<->C2(3*kv,2*k_v)~C2<->C3(2*kv,3*k_v)~C3<->C4(kv,4*k_v)~C4<->O(ko,k_o)~I0<->I1(4*kv/f,h*k_v)~I1<->I2(3*kv/f,2*h*k_v)~I2<->I3(2*kv/f,3*h*k_v)~I3<->I4(kv,4*k_v)~I4<->Io(ko,k_o)~C0<->I0(f*f*f*ki,k_i/h/h/h)~C1<->I1(f*f*ki,k_i/h/h)~C2<->I2(f*ki,k_i/h)~C3<->I3(ki,k_i)~C4<->I4(ki,k_i)~O<->Io(ki,k_i)CONSERVEC0+C1+C2+C3+C4+O+I0+I1+I2+I3+I4+Io=1}PROCEDURErates(v(mV)){TABLEkv,k_vDEPENDkv0,k_v0,vkv,vk_vFROMvminTOvmaxWITH401kv=kv0*exp((v-vshift)/vkv)k_v=k_v0*exp((v-vshift)/vk_v)}FUNCTIONghk(v(mV),ci(mM),co(mM))(0.001coul/cm3){LOCALzz=(0.001)*2*F*v/(R*(celsius+273.15))ghk=(0.001)*2*F*(ci*efun(-z)-co*efun(z))}FUNCTIONefun(z){if(fabs(z)<1e-4){efun=1-z/2}else{efun=z/(exp(z)-1)}}