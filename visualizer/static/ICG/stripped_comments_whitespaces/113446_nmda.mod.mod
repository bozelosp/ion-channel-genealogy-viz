UNITS{(molar)=(1/liter)(mV)=(millivolt)(mA)=(milliamp)(mM)=(millimolar)FARADAY=96485.309(coul)R=(k-mole)(joule/degC)PI=(pi)(1)}INDEPENDENT{tFROM0TO1WITH100(ms)}NEURON{SUFFIXnmdaUSEIONkREADko,ki,ekWRITEikUSEIONnaREADnai,nao,enaWRITEinaUSEIONcaREADcai,cao,ecaWRITEicaVALENCE2GLOBALmg,act_99,act_01,ina_99,ina_01,gbar,tau_ina,tau_act,scalecaRANGEik,ina,itot,ica,qna,qk}PARAMETER{celsius=36(degC)gbar=1e-3(mho/cm2)tau_ina=2000(ms)tau_act=2(ms)act_99=20(mM)act_01=10(mM)ina_99=3.5(mM)ina_01=10(mM)mg=1.2(mM)scaleca=1}ASSIGNED{v(mV)itot(mA/cm2)ik(mA/cm2)ina(mA/cm2)ica(mA/cm2)ki(mM)ko(mM)ek(mV)nai(mM)nao(mM)ena(mV)cai(mM)cao(mM)eca(mV)diam(um2)}STATE{mambhahbqnaqk}BREAKPOINT{SOLVEsynstateMETHODsparseina=gbar*ma*ha*(v-ena)/(1+(mg/3)*exp(-.07*(70+v-60)))ik=gbar*ma*ha*(v-ek)/(1+(mg/3)*exp(-.07*(70+v-60)))ica=gbar*scaleca*ma*ha*(v-eca)/(1+(mg/3)*exp(-.07*(70+v-60)))itot=ina+ik+ica}INITIAL{ma=m_inf(ko)mb=1-maha=h_inf(ko)hb=1-haqna=0qk=0ina=gbar*ma*ha*(v-ena)/(1+(mg/3)*exp(-.07*(70+v-60)))ik=gbar*ma*ha*(v-ek)/(1+(mg/3)*exp(-.07*(70+v-60)))ica=gbar*scaleca*ma*ha*(v-eca)/(1+(mg/3)*exp(-.07*(70+v-60)))itot=ina+ik+ica}LOCALa1,a2,b1,b2KINETICsynstate{a1=m_a(ko)a2=m_b(ko)b1=h_a(ko)b2=h_b(ko)~mb<->ma(a1,a2)~hb<->ha(b1,b2)COMPARTMENTdiam*diam*PI/4{qnaqk}~qna<<(-ina*PI*diam*(1e4)/FARADAY)~qk<<(-ik*PI*diam*(1e4)/FARADAY)}FUNCTIONm_a(ko){TABLEDEPENDact_99,act_01,tau_actFROM0TO150WITH150m_a=m_inf(ko)/tau_act}FUNCTIONm_b(ko){TABLEDEPENDact_99,act_01,tau_actFROM0TO150WITH150m_b=(1-m_inf(ko))/tau_act}FUNCTIONm_inf(ko){LOCALkh,hTABLEDEPENDact_99,act_01,tau_actFROM0TO150WITH150kh=(act_99+act_01)/2h=-(kh-act_99)/4.59m_inf=1/(1+(exp((kh-ko)/h)))}FUNCTIONh_a(ko){TABLEDEPENDina_99,ina_01,tau_inaFROM0TO150WITH150h_a=h_inf(ko)/tau_ina}FUNCTIONh_b(ko){TABLEDEPENDina_99,ina_01,tau_inaFROM0TO150WITH150h_b=(1-h_inf(ko))/tau_ina}FUNCTIONh_inf(ko){LOCALkh,hTABLEDEPENDina_99,ina_01,tau_inaFROM0TO150WITH150kh=(ina_99+ina_01)/2h=-(ina_99-kh)/4.59h_inf=1/(1+(exp((ko-kh)/h)))}FUNCTIONghk(v(mV),ci(mM),co(mM))(.001coul/cm3){LOCALz,eci,ecoz=(1e-3)*1*FARADAY*v/(R*(celsius+273.11247574))eco=co*efun(z)eci=ci*efun(-z)ghk=(.001)*1*FARADAY*(eci-eco)}FUNCTIONefun(z){if(fabs(z)<1e-4){efun=1-z/2}else{efun=z/(exp(z)-1)}}