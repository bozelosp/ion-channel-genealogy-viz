NEURON{POINT_PROCESSNMDARANGEgbar,ca_ratio,tau_r,tau_d,scale,spkcnt,countflag,mg,i,ical,t1,itmp,qfactNONSPECIFIC_CURRENTiUSEIONcalWRITEicalVALENCE2}UNITS{(nA)=(nanoamp)(mV)=(millivolt)(umho)=(micromho)(mM)=(milli/liter)}PARAMETER{gbar=12.2e-5(umho)tau_r=5.63(ms)tau_d=320(ms)Erev=0(mV)saturation=7.0qfact=2mg=1(mM)ca_ratio=0.1}ASSIGNED{g(umho)v(mV)itmp(nA)i(nA)ical(nA)t1(ms)y1_add(/ms)y1_loc(/ms)spkcntcountflagBscale}STATE{y1(/ms)y2}INITIAL{y1_add=0B=mgblock(v)scale=1spkcnt=0countflag=0t1=0y1_loc=0}BREAKPOINT{SOLVEbetadynMETHODcnexpmgblock(v)g=gbar*y2itmp=scale*g*B*(v-Erev)i=(1-ca_ratio)*itmpical=ca_ratio*itmp}DERIVATIVEbetadyn{y1'=-y1/(tau_d/qfact)y2'=y1-y2/(tau_r/qfact)}NET_RECEIVE(weight,y1_loc(/ms)){y1_loc=y1_loc*exp(-(t-t1)/(tau_d/qfact))y1_add=(1-y1_loc/saturation)y1_loc=y1_loc+y1_addy1=y1+y1_addt1=tspkcnt=spkcnt+1scale=weight}PROCEDUREmgblock(v(mV)){TABLEBDEPENDmgFROM-100TO100WITH201B=1/(1+exp(0.062(/mV)*-v)*(mg/3.57(mM)))}