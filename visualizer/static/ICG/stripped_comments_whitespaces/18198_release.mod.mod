INDEPENDENT{tFROM0TO1WITH1(ms)}NEURON{SUFFIXrelUSEIONcaREADica,caiWRITEcaiRANGET,FA,CA,Fmax,Ves,b,u,k1,k2,k3,nt,khRANGEdepth,kt,kd,cainf,taur}UNITS{(mA)=(milliamp)(mV)=(millivolt)(mM)=(milli/liter)(molar)=(1/liter)(um)=(micron)(msM)=(msmM)}CONSTANT{FARADAY=96489(coul)}PARAMETER{Ves=0.1(mM)Fmax=0.001(mM)b=1e16(/mM4-ms)u=0.1(/ms)k1=1000(/mM-ms)k2=0.1(/ms)k3=4(/ms)nt=10000kh=10(/ms)depth=.1(um)taur=700(ms)cainf=1e-8(mM)kt=1(mM/ms)kd=5e-4(mM)}ASSIGNED{ica(mA/cm2)drive_channel(mM/ms)drive_pump(mM/ms)}STATE{FA(mM)VA(mM)T(mM)cai(mM)}INITIAL{FA=0VA=0T=0cai=kd}BREAKPOINT{SOLVEstateMETHODderivimplicit}LOCALbfc,kfvDERIVATIVEstate{bfc=b*(Fmax-FA-VA)*cai^4kfv=k1*FA*VesFA'=bfc-u*FA-kfv+k2*VAVA'=kfv-(k2+k3)*VAT'=nt*k3*VA-kh*Tdrive_channel=-(10000)*ica/(2*FARADAY*depth)if(drive_channel<=0.){drive_channel=0.}drive_pump=-kt*cai/(cai+kd)cai'=-bfc+4*u*FA+drive_channel+drive_pump+(cainf-cai)/taur}