UNITS{(mA)=(milliamp)(mV)=(millivolt)}NEURON{SUFFIXKAUSEIONkREADekWRITEikRANGEgkbar,gk,minf,hinf,mexp,hexp,ikGLOBALek}INDEPENDENT{tFROM0TO1WITH1(ms)}PARAMETER{v(mV)celsius=37(degC)dt(ms)gkbar=.015(mho/cm2)ek(mV)}STATE{mh}ASSIGNED{ik(mA/cm2)gkminfhinfmexphexp}BREAKPOINT{SOLVEstatesgk=gkbar*m*m*m*m*hik=gk*(v-ek)}UNITSOFFINITIAL{rates(v)m=minfh=hinf}PROCEDUREstates(){rates(v)m=m+mexp*(minf-m)h=h+hexp*(hinf-h)}PROCEDURErates(v){LOCALq10,tinc,alpha,beta,sumTABLEminf,mexp,hinf,hexpDEPENDdt,celsiusFROM-100TO100WITH200q10=3^((celsius-37)/10)tinc=-dt*q10alpha=1.4/(1+exp((v+27)/(-12)))beta=0.49/(1+exp((v+30)/4))sum=alpha+betaminf=alpha/summexp=1-exp(tinc*sum)alpha=0.0175/(1+exp((v+50)/8))beta=1.3/(1+exp((v+13)/(-10)))sum=alpha+betahinf=alpha/sumhexp=1-exp(tinc*sum)}UNITSON