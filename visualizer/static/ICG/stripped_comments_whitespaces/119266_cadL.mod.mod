NEURON{SUFFIXcadLUSEIONcalREADical,caliWRITEcaliVALENCE2GLOBALdepth,calinf,taurl}UNITS{(molar)=(1/liter)(mM)=(millimolar)(um)=(micron)(mA)=(milliamp)(msM)=(msmM)FARADAY=(faraday)(coulomb)}PARAMETER{depth=.1(um)taurl=2.5(ms)calinf=1e-4(mM)}STATE{cali(mM)}ASSIGNED{ical(mA/cm2)drive_channel(mM/ms)}BREAKPOINT{SOLVEstateMETHODderivimplicit}DERIVATIVEstate{drive_channel=-(10000)*ical/(2*FARADAY*depth)if(drive_channel<=0.){drive_channel=0.}cali'=drive_channel+(calinf-cali)/taurl}