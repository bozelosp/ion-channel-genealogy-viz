NEURON{SUFFIXkaUSEIONkREADekWRITEikRANGEgbarGLOBALminf,hinf,htau,mtau}PARAMETER{gbar=0.0002(mho/cm2)celsiusek(mV)v(mV)a0h=0.17vhalfh=-105q10=3hmin=5}UNITS{(mA)=(milliamp)(mV)=(millivolt)(pS)=(picosiemens)(um)=(micron)}ASSIGNED{ik(mA/cm2)minfmtau(ms)hinfhtau(ms)}STATE{mh}BREAKPOINT{SOLVEstatesMETHODcnexpik=gbar*m*h*(v-ek)}INITIAL{trates(v)m=minfh=hinf}DERIVATIVEstates{trates(v)m'=(minf-m)/mtauh'=(hinf-h)/htau}PROCEDUREtrates(v){LOCALqtqt=q10^((celsius-23)/10)minf=(1/(1+exp(-(v+41.4)/26.6)))^4mtau=0.5/qthinf=1/(1+exp((v+78.5)/6))htau=a0h*(v-vhalfh)/qtif(htau<hmin/qt){htau=hmin/qt}}