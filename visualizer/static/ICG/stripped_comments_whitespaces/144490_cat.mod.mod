UNITS{(mA)=(milliamp)(mV)=(millivolt)(molar)=(1/liter)(mM)=(millimolar)FARADAY=(faraday)(coulomb)R=(k-mole)(joule/degC)}PARAMETER{v(mV)tBase=23.5(degC)celsius=22(degC)gcatbar=1.0(mho/cm2)ki=0.001(mM)cai=5.e-5(mM)cao=2(mM)tfa=1tfi=0.68eca=140}NEURON{SUFFIXcatUSEIONcaREADcai,caoWRITEicaRANGEgcatbar,hinf,minf,taum,tauh,iCa,gmax}STATE{mh}ASSIGNED{ica(mA/cm2)gcat(mho/cm2)gmax(mho/cm2)minfhinftaum(ms)tauh(ms)}INITIAL{rates(v)m=minfh=hinfgcat=gcatbar*m*m*h*h2(cai)gmax=gcat}BREAKPOINT{SOLVEstatesMETHODcnexpgcat=gcatbar*m*m*h*h2(cai)ica=gcat*ghk(v,cai,cao)if(gcat>gmax){gmax=gcat}}FUNCTIONh2(cai(mM)){h2=ki/(ki+cai)}FUNCTIONghk(v(mV),ci(mM),co(mM))(mV){LOCALnu,ff=KTF(celsius)/2nu=v/fghk=-f*(1.-(ci/co)*exp(nu))*efun(nu)}FUNCTIONKTF(celsius(degC))(mV){KTF=((25(mV)/293.15(degC))*(celsius+273.15(degC)))}FUNCTIONefun(z){if(fabs(z)<1e-4){efun=1-z/2}else{efun=z/(exp(z)-1)}}FUNCTIONalph(v(mV))(/ms){alph=1.6e-4(/ms)*exp(-(v+57(mV))/19(mV))}FUNCTIONbeth(v(mV))(/ms){beth=1(/ms)/(exp((-v+15(mV))/10(mV))+1.0)}FUNCTIONalpm(v(mV))(/ms){alpm=0.1967(/ms)*(-1.0(/mV)*v+19.88)/(exp((-1.0*v+19.88(mV))/10.0(mV))-1.0)}FUNCTIONbetm(v(mV))(/ms){betm=0.046(/ms)*exp(-v/22.73(mV))}DERIVATIVEstates{rates(v)m'=(minf-m)/taumh'=(hinf-h)/tauh}PROCEDURErates(v(mV)){LOCALaTABLEtaum,minf,tauh,hinfFROM-150TO150WITH300a=alpm(v)taum=1/(tfa*(a+betm(v)))minf=a/(a+betm(v))a=alph(v)tauh=1/(tfi*(a+beth(v)))hinf=a/(a+beth(v))}