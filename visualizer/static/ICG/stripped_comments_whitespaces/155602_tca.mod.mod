UNITS{(mA)=(milliamp)(mV)=(millivolt)FARADAY=96520(coul)R=8.3134(joule/degC)KTOMV=.0853(mV/degC)}PARAMETER{v(mV)celsius=6.3(degC)gcatbar=.003(mho/cm2)cai(mM)cao(mM)}NEURON{SUFFIXcatUSEIONcaREADcai,caoWRITEicaRANGEgcatbar,cai,ica,etca}STATE{mh}ASSIGNED{ica(mA/cm2)gcat(mho/cm2)etca(mV)}INITIAL{m=minf(v)h=hinf(v)VERBATIMcai=_ion_cai;ENDVERBATIM}BREAKPOINT{SOLVEstatesMETHODcnexpgcat=gcatbar*m*m*hica=gcat*ghk(v,cai,cao)}DERIVATIVEstates{m'=(minf(v)-m)/m_tau(v)h'=(hinf(v)-h)/h_tau(v)}FUNCTIONghk(v(mV),ci(mM),co(mM))(mV){LOCALnu,ff=KTF(celsius)/2nu=v/fghk=-f*(1.-(ci/co)*exp(nu))*efun(nu)}FUNCTIONKTF(celsius(DegC))(mV){KTF=((25./293.15)*(celsius+273.15))}FUNCTIONefun(z){if(fabs(z)<1e-4){efun=1-z/2}else{efun=z/(exp(z)-1)}}FUNCTIONhinf(v(mV)){LOCALa,bTABLEFROM-150TO150WITH200a=1.e-6*exp(-v/16.26)b=1/(exp((-v+29.79)/10)+1)hinf=a/(a+b)}FUNCTIONminf(v(mV)){LOCALa,bTABLEFROM-150TO150WITH200a=0.2*(-1.0*v+19.26)/(exp((-1.0*v+19.26)/10.0)-1.0)b=0.009*exp(-v/22.03)minf=a/(a+b)}FUNCTIONm_tau(v(mV))(ms){LOCALa,bTABLEFROM-150TO150WITH200a=0.2*(-1.0*v+19.26)/(exp((-1.0*v+19.26)/10.0)-1.0)b=0.009*exp(-v/22.03)m_tau=1/(a+b)}FUNCTIONh_tau(v(mV))(ms){LOCALa,bTABLEFROM-150TO150WITH200a=1.e-6*exp(-v/16.26)b=1/(exp((-v+29.79)/10.)+1.)h_tau=1/(a+b)}