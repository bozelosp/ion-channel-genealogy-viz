UNITS{(mV)=(millivolt)(mA)=(milliamp)(molar)=(1/liter)(mM)=(millimolar)}NEURON{SUFFIXnakpumpUSEIONnaREADnai,naoWRITEinaUSEIONkREADki,koWRITEikRANGEimax,nai,kiRANGEy,inak}PARAMETER{celsius(degC)inakmax=1(mA/cm2)R=8.314472(j/(K.molar)F=96.4853(C/mol)nao=145(mM)ko=5(mM)Nai_inf=5(mM)Ki_inf=14(mM)ouabain=0(mM)KdNao=69.8KdKo=0.258KdNai=4.05KdKi=32.88ATPi=6.97(mM)k2=0.04k3=0.01k4=0.165y0=0}ASSIGNED{v(mV)inak(mA/cm2)ina(mA/cm2)ik(mA/cm2)nai(mM)ki(mM)pE1NapE1KpE2NapE2KalfaybetayNaeff(mM)k1drugblockkelvin(degK)}STATE{y}BREAKPOINT{SOLVEstatesMETHODcnexpsettables(nai,ki,v,celsius,ATPi,ouabain)inak=inakmax*0.001*11.5*(k1*pE1Na*y-k2*pE2Na*(1-y))*drugblockina=3*inakik=-2*inak}INITIAL{settables(Nai_inf,Ki_inf,v,celsius,ATPi,ouabain)y=.6224}DERIVATIVEstates{settables(nai,ki,v,celsius,ATPi,ouabain)y'=alfay*(1-y)-betay*y}UNITSOFFPROCEDUREsettables(nai,ki,v,celsius,ATPi){drugblock=1/(1+ouabain/0.0006)k1=0.37*(1/(1+0.094/ATPi))kelvin=celsius+273.16Naeff=nao*exp(-0.82*F*v/R/kelvin)alfay=k2*pE2Na+k4*pE2Kbetay=k1*pE1Na+k3*pE1KpE1Na=1/(1+(KdNai/nai)^1.06*(1+(ki/KdKi)^1.12))pE1K=1/(1+(KdKi/ki)^1.12*(1+(nai/KdNai)^1.06))pE2Na=1/(1+(KdNao/Naeff)^1.06*(1+(ko/KdKo)^1.12))pE2K=1/(1+(KdKo/ko)^1.12*(1+(Naeff/KdNao)^1.06))}UNITSON