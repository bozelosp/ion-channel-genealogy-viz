NEURON{SUFFIXkv4hhUSEIONkREADekWRITEikRANGEminf,tm,hinf,thf,ths,ik,alpha,thRANGEgbarGLOBALvhm,vcmGLOBALvhh,vch,pGLOBALvhtm,atm,btm,Ctm,tm0GLOBALvhthf,athf,bthf,Cthf,thf0GLOBALvhths,aths,bths,Cths,ths0GLOBALvha,vca,a0}UNITS{(mA)=(milliamp)(mV)=(millivolt)}PARAMETER{ek(mV)gbar=1(mho/cm2)vhm=-59vcm=-21vhh=-86.4vch=9.6p=0.02vhtm=-55atm=24.8btm=6.4Ctm=2.75tm0=1.21vhthf=-70athf=15bthf=15Cthf=20thf0=20vhths=-70aths=15bths=15Cths=150ths0=150vha=-30vca=15a0=0.36}STATE{mh1h2}ASSIGNED{v(mV)ik(mA/cm2)minftm(ms)hinfthf(ms)ths(ms)alpha}BREAKPOINT{SOLVEstatesMETHODcnexpik=gbar*m^3*(alpha*h1+(1-alpha)*h2)*(v-ek)}DERIVATIVEstates{rates()m'=(minf-m)/tmh1'=(hinf-h1)/thfh2'=(hinf-h2)/ths}UNITSOFFINITIAL{rates(v)m=minfh1=hinfh2=hinf}PROCEDURErates(v(mV)){LOCALq10UNITSOFFq10=3^((celsius-22)/10)minf=1/(1+exp((v-vhm)/vcm))^3hinf=p+((1-p)/(1+exp((v-vhh)/vch)))tm=(1/q10)*(tm0+Ctm/(exp((v-vhtm)/atm)+exp(-(v-vhtm)/btm)))thf=(1/q10)*(thf0+Cthf/(exp((v-vhthf)/athf)+exp(-(v-vhthf)/bthf)))ths=(1/q10)*(ths0+Cths/(exp((v-vhths)/aths)+exp(-(v-vhths)/bths)))alpha=a0+((1-a0)/(1+exp((v-vha)/vca)))}UNITSON