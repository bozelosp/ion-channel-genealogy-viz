NEURON{SUFFIXpkdrdUSEIONkREADekWRITEikRANGEgkdr,gk,ik,qk}UNITS{(molar)=(1/liter)(mV)=(millivolt)(mA)=(milliamp)(mM)=(millimolar)FARADAY=96485.309(coul/mole)PI=(pi)(1)}INDEPENDENT{tFROM0TO1WITH100(ms)}PARAMETER{gkdr=1e-3(mho/cm2)}ASSIGNED{ik(mA/cm2)v(mV)ek(mV)gk(mho/cm2)diam(um)ki(mM)}STATE{ncqk}BREAKPOINT{SOLVEkstateMETHODsparsegk=gkdr*n*nik=gk*(v-ek)}INITIAL{n=n_inf(v)c=1-ngk=gkdr*n*nik=gk*(v-ek)qk=0}LOCALa1,a2KINETICkstate{a1=a_n(v)a2=a_c(v)~c<->n(a1,a2)CONSERVEn+c=1COMPARTMENTdiam*diam*PI/4{qk}~qk<<(-ik*diam*PI*(1e4)/FARADAY)}FUNCTIONa_n(v(mV)){TABLEFROM-150TO150WITH200a_n=n_inf(v)/tau_act(v)}FUNCTIONa_c(v(mV)){TABLEFROM-150TO150WITH200a_c=(1-n_inf(v))/tau_act(v)}FUNCTIONn_inf(v(mV)){n_inf=1/(1+exp((-4.8-v-15)/13.6))}FUNCTIONtau_act(v(mV)){tau_act=1.6/(0.0338338*exp(-v/40)+(0.016*exp(v/5)*(64.9+v))/(-0.00000230599+exp(v/5)))}