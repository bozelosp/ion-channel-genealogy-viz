UNITS{(molar)=(1/liter)}UNITS{(mV)=(millivolt)(mA)=(milliamp)(mM)=(millimolar)}INDEPENDENT{tFROM0TO1WITH1(ms)}NEURON{SUFFIXK23USEIONcaREADcaiUSEIONkREADekWRITEikRANGEgkbar,gk,zinf,ik}PARAMETER{celsius=37(degC)v(mV)gkbar=.00039(mho/cm2)cai=.04e-3(mM)dt(ms)}ASSIGNED{ek(mV)ik(mA/cm2)minfmexpzinfzexpgk}STATE{mz}BREAKPOINT{SOLVEstateik=gkbar*m*z*z*(v-ek)}PROCEDUREstate(){rate(v,cai)m=m+mexp*(minf-m)z=z+zexp*(zinf-z)VERBATIMreturn0;ENDVERBATIM}INITIAL{rate(v,cai)m=minfz=zinf}FUNCTIONalp(v(mV),ca(mM))(1/ms){alp=20/(ca*1000)}FUNCTIONbet(v(mV))(1/ms){bet=0.075/exp((v+5)/10)}PROCEDURErate(v(mV),ca(mM)){LOCALa,ba=alp(v,ca)zinf=1/(1+a)zexp=(1-exp(-dt/10))b=bet(v)minf=25/(25+b)mexp=(1-exp(-dt*(25+b)))}