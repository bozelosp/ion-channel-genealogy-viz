NEURON{SUFFIXCadepKUSEIONcaREADicaUSEIONkREADekWRITEikRANGEgbkbar,gskbarGLOBALca0,tau,stau}UNITS{(molar)=(1/liter)(mM)=(millimolar)(mV)=(millivolt)(mA)=(milliamp)(S)=(siemens)B=.26(mM-cm2/mA-ms)}PARAMETER{gbkbar=.01(S/cm2)gskbar=.01(S/cm2)ca0=.00007(mM)tau=9(ms)alphar=7.5(/ms)stau=10(ms)}ASSIGNED{v(mV)ek(mV)ik(mA/cm2)ica(mA/cm2)area(microm2)gbk(S/cm2)gsk(S/cm2)}STATE{ca_i(mM)qrs}BREAKPOINT{SOLVEstateMETHODcnexpgbk=gbkbar*r*s*sgsk=gskbar*q*qik=(gbk+gsk)*(v-ek)}DERIVATIVEstate{ca_i'=-B*ica-(ca_i-ca0)/tauq'=alphaq(ca_i)*(1-q)-betaq(ca_i)*qr'=alphar*(1-r)-betar(v)*rs'=(sinf(ca_i)-s)/stau}INITIAL{ca_i=ca0q=alphaq(ca_i)/(alphaq(ca_i)+betaq(ca_i))r=alphar/(alphar+betar(v))s=sinf(ca_i)}FUNCTIONexp1(A(/ms),d,k,x(mM))(/ms){UNITSOFFexp1=A/exp((12*log10(x)+d)/k)UNITSON}FUNCTIONalphaq(x(mM))(/ms){alphaq=exp1(0.00246,28.48,-4.5,x)}FUNCTIONbetaq(x(mM))(/ms){betaq=exp1(0.006,60.4,35,x)}FUNCTIONbetar(v(mV))(/ms){UNITSOFFbetar=0.11/exp((v-35)/14.9)UNITSON}FUNCTIONsinf(x(mM)){UNITSOFFsinf=1/(1+4/(1000*x))UNITSON}