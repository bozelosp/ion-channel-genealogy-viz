INDEPENDENT{tFROM0TO1WITH1(ms)}NEURON{SUFFIXcadspineUSEIONcaREADica,caiWRITEcaiRANGEcaGLOBALdepth,cainf,taur,cadend,D,lneck,sneck,vspine}UNITS{(molar)=(1/liter)(mM)=(millimolar)(um)=(micron)(mA)=(milliamp)(msM)=(msmM)FARADAY=(faraday)(coulomb)}PARAMETER{depth=0.125(um)taur=15(ms)cainf=5e-7(mM)cai(mM)D=0.22(um2/ms)cadend(mM)lneck(um)sneck(um2)vspine(um3)}STATE{ca(mM)}INITIAL{ca=cainfcai=ca}ASSIGNED{ica(mA/cm2)drive_channel(mM/ms)}BREAKPOINT{SOLVEstateMETHODderivimplicit}DERIVATIVEstate{drive_channel=-(10000)*ica/(2*FARADAY*depth*18.0)if(drive_channel<=0.){drive_channel=0.}ca'=drive_channel+(cainf-ca)/taur-D*(ca-cadend)*sneck/(lneck*vspine)cai=ca}