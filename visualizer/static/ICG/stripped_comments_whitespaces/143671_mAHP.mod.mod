NEURON{SUFFIXmAHPUSEIONkREADekWRITEikUSEIONcaREADecaWRITEicaRANGEn,gkcamax,gcamax,ik,cai,ica,depth,taurGLOBALfKCa,bKCa,caix}UNITS{(mA)=(milliamp)(mV)=(millivolt)(S)=(siemens)(um)=(micron)(molar)=(1/liter)(mM)=(millimolar)(msM)=(msmM)FARADAY=(faraday)(coulomb)}PARAMETER{gkcamax=0.03(S/cm2)gcamax=3e-5(S/cm2)mvhalfca=-30(mV)mslpca=4(mV)mtauca=1(ms)caix=2cainf=0.0001(mM)depth=.1(um)taur=20(ms)fKCa=0.1bKCa=0.1celsius(degC)}ASSIGNED{ik(mA/cm2)v(mV)ica(mA/cm2)ek(mV)eca(mV)ninfntau(ms)minfcadrive_channel}STATE{mcancai(mM)}INITIAL{cai=cainfrates(cai)mcarate(v)n=ninfmca=minfca}BREAKPOINT{SOLVEstatesMETHODcnexpica=gcamax*mca*(v-eca)ik=gkcamax*n*(v-ek)}DERIVATIVEstates{drive_channel=-(10000)*ica/(2*FARADAY*depth)if(drive_channel<=0.){drive_channel=0.}cai'=drive_channel+(cainf-cai)/taurrates(cai)n'=(ninf-n)/ntaumcarate(v)mca'=(minfca-mca)/mtauca}PROCEDURErates(cai(mM)){LOCALa,bUNITSOFFa=fKCa*(1e3*(cai-cainf))^caixb=bKCantau=1/(a+b)ninf=a*ntauUNITSON}PROCEDUREmcarate(v(mV)){TABLEminfcaDEPENDmvhalfca,mslpcaFROM-100TO100WITH200minfca=1/(1+exp(-(v-mvhalfca)/mslpca))}