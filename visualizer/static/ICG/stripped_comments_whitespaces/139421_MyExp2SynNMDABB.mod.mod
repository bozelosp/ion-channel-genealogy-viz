NEURON{POINT_PROCESSMyExp2SynNMDABBRANGEtau1,tau2,e,i,iNMDA,s,sNMDA,r,tau1NMDA,tau2NMDA,Vwt,smax,sNMDAmaxNONSPECIFIC_CURRENTi,iNMDA}UNITS{(nA)=(nanoamp)(mV)=(millivolt)(uS)=(microsiemens)}PARAMETER{tau1=0.1(ms)<1e-9,1e9>tau2=10(ms)<1e-9,1e9>tau1NMDA=15(ms)tau2NMDA=150(ms)e=0(mV)mg=1r=1smax=1e9(1)sNMDAmax=1e9(1)Vwt=0}ASSIGNED{v(mV)i(nA)iNMDA(nA)s(1)sNMDA(1)mgblock(1)factor(1)factor2(1)etime(ms)}STATE{A(1)B(1)A2(1)B2(1)}INITIAL{LOCALtpVwt=0if(tau1/tau2>.9999){tau1=.9999*tau2}A=0B=0tp=(tau1*tau2)/(tau2-tau1)*log(tau2/tau1)factor=-exp(-tp/tau1)+exp(-tp/tau2)factor=1/factorif(tau1NMDA/tau2NMDA>.9999){tau1NMDA=.9999*tau2NMDA}A2=0B2=0tp=(tau1NMDA*tau2NMDA)/(tau2NMDA-tau1NMDA)*log(tau2NMDA/tau1NMDA)factor2=-exp(-tp/tau1NMDA)+exp(-tp/tau2NMDA)factor2=1/factor2}BREAKPOINT{SOLVEstateMETHODcnexpmgblock=1.0/(1.0+0.28*exp(-0.062(/mV)*v))s=B-AsNMDA=B2-A2if(s>smax){s=smax}if(sNMDA>sNMDAmax){sNMDA=sNMDAmax}i=s*(v-e)iNMDA=sNMDA*(v-e)*mgblock}DERIVATIVEstate{A'=-A/tau1B'=-B/tau2A2'=-A2/tau1NMDAB2'=-B2/tau2NMDA}NET_RECEIVE(w(uS)){LOCALwwww=wif(r>=0){A=A+factor*wwB=B+factor*wwA2=A2+factor2*ww*rB2=B2+factor2*ww*r}else{if(r>-1000){A2=A2-factor2*ww*rB2=B2-factor2*ww*r}}}