INDEPENDENT{tFROM0TO1WITH1(ms)}NEURON{SUFFIXcatUSEIONcaREADcai,caoWRITEicaRANGEgcatbarGLOBALshiftm,shifth,tauh}UNITS{(mA)=(milliamp)(mV)=(millivolt)(mM)=(milli/liter)FARADAY=96480(coul)R=8.314(volt-coul/degC)}PARAMETER{celsius(degC)gcatbar=0.0001(cm/s)shiftm=20(mV)shifth=20(mV)tauh=40(ms)}STATE{mh}ASSIGNED{icavcai(mM)cao(mM)tadjmtadjh}BREAKPOINT{SOLVEstateMETHODcnexpica=gcatbar*m*m*h*ghk(v,cai,cao,2)}DERIVATIVEstate{m'=(m_inf(v)-m)/tau_m(v)h'=(h_inf(v)-h)/tauh}INITIAL{tadjm=3.55^((celsius-23.5)/10)tadjh=2.8^((celsius-23.5)/10)m=m_inf(v)h=h_inf(v)}FUNCTIONghk(v(mV),ci(mM),co(mM),z)(millicoul/cm3){LOCALe,ww=v*(.001)*z*FARADAY/(R*(celsius+273.16))if(fabs(w)>1e-4){e=w/(exp(w)-1)}else{e=1-w/2}ghk=-(.001)*z*FARADAY*(co-ci*exp(w))*e}FUNCTIONtau_m(v){tau_m=(1/(exp((v-shiftm+131.6)/-16.7)+exp((v-shiftm+16.8)/18.2))+0.612)/tadjm}FUNCTIONm_inf(v){m_inf=1/(1+exp((v-shiftm+60.5)/-6.2))}FUNCTIONh_inf(v){h_inf=1/(1+exp((v-shifth+84)/4.03))}