NEURON{SUFFIXkca2USEIONkREADekWRITEikUSEIONcaREADcaiRANGEn,g,ik,cai,ica,icaL,depth1,taur1,depth2,taur2GLOBALRa,Rb,caix}UNITS{(mA)=(milliamp)(mV)=(millivolt)(S)=(siemens)(um)=(micron)(molar)=(1/liter)(mM)=(millimolar)(msM)=(msmM)FARADAY=(faraday)(coulomb)}PARAMETER{g=0.03(S/cm2)v(mV)cai(mM)caix=2cainf=0.0001depth1=.1(um)taur1=20(ms)depth2=10(um)taur2=200(ms)Ra=0.1Rb=0.1celsius(degC)}ASSIGNED{ik(mA/cm2)ica(mA/cm2)icaL(mA/cm2)ek(mV)ninfntau(ms)drive_channel1(mM/ms)drive_channel2(mM/ms)}STATE{nca(mM)caL(mM)}INITIAL{ca=cainfcaL=0cai=cainfrates(cai)n=ninf}BREAKPOINT{SOLVEstatesMETHODcnexpik=g*n*(v-ek)}DERIVATIVEstates{rates(cai)n'=(ninf-n)/ntau}PROCEDURErates(cai(mM)){LOCALa,bUNITSOFFa=Ra*(1e3*(cai-cainf))^caixb=Rbntau=1/(a+b)ninf=a*ntauUNITSON}