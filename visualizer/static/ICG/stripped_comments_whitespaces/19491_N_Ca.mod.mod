INDEPENDENT{tFROM0TO1WITH1(ms)}NEURON{SUFFIXN_CaUSEIONcaREADecaWRITEicaRANGEgcabarRANGEm_inf,h_inf}UNITS{(mA)=(milliamp)(mV)=(millivolt)}PARAMETER{gcabar=.0005(mho/cm2)eca=80(mV)dt(ms)tau_m=4(ms)tau_h=40(ms)v(mV)theta_m=-20(mV)kappa_m=-5(mV)theta_h=-45(mV)kappa_h=5(mV)}STATE{mh}ASSIGNED{ica(mA/cm2)m_infh_inf}BREAKPOINT{SOLVEstatesMETHODcnexpica=gcabar*m*m*h*(v-eca)}DERIVATIVEstates{evaluate_fct(v)m'=(m_inf-m)/tau_mh'=(h_inf-h)/tau_h}UNITSOFFINITIAL{evaluate_fct(v)m=m_infh=h_inf}PROCEDUREevaluate_fct(v(mV)){m_inf=1/(1+(Exp((v-theta_m)/kappa_m)))h_inf=1/(1+(Exp((v-theta_h)/kappa_h)))}FUNCTIONvtrap(x,y){if(fabs(x/y)<1e-6){vtrap=y*(1-x/y/2)}else{vtrap=x/(Exp(x/y)-1)}}FUNCTIONExp(x){if(x<-100){Exp=0}else{Exp=exp(x)}}