INDEPENDENT{tFROM0TO1WITH10(ms)}NEURON{SUFFIXkcaUSEIONcaREADcaiUSEIONkREADekWRITEikRANGEgmax,i,o_rate,c_rate,oGLOBALcadep,maxc_rate,cainit}UNITS{(molar)=(1/liter)(mM)=(millimolar)(mA)=(milliamp)(mV)=(millivolt)}PARAMETER{gmax=0.015(mho/cm2)cadep=2maxc_rate=0.1(1/ms)v(mV)o_rate=0(1/ms)c_rate=0(1/ms)cainit=5e-5(mM)}ASSIGNED{cai(mM)ek(mV)ik(mA/cm2)i(mA/cm2)o}STATE{c}BREAKPOINT{rates(cai)SOLVEstateMETHODderivimplicito=1-ci=gmax*o*(v-ek)ik=i}DERIVATIVEstate{c'=(c_rate*o)-(o_rate*c)}PROCEDURErates(cai){TABLEo_rate,c_rateDEPENDcainit,cadep,maxc_rateFROMcainitTO0.1WITH200o_rate=(cai-cainit)*cadepif(o_rate>0){c_rate=1/o_rateif(c_rate>maxc_rate){c_rate=maxc_rate}}else{c_rate=maxc_rate}}INITIAL{rates(cai)o=o_rate/(o_rate+c_rate)c=1-o}