UNITS{(mA)=(milliamp)(mV)=(millivolt)}NEURON{SUFFIXCA1CaGUSEIONcaREADecaWRITEicaRANGEgcabar,gcaGLOBALminf,hinf,mexp,hexp,tc}INDEPENDENT{tFROM0TO1WITH1(ms)}PARAMETER{v(mV)celsius=36(degC)dt(ms)gcabar=0.01(mho/cm2)tc=1(1)}STATE{mh}ASSIGNED{eca(mV)ica(mA/cm2)minfhinfmexphexp}BREAKPOINT{SOLVEstatesica=gcabar*m*m*h*(v-eca)}UNITSOFFINITIAL{rates(v)m=minfh=hinf}PROCEDUREstates(){rates(v)m=m+mexp*(minf-m)h=h+hexp*(hinf-h)}PROCEDURErates(v){LOCALalpha,beta,sumTABLEminf,mexp,hinf,hexpDEPENDdt,tcFROM-100TO100WITH200alpha=-0.16*vtrap(v+26,-4.5)beta=0.04*vtrap(v+12,10)sum=alpha+betaminf=alpha/summexp=1-exp(-dt*sum)alpha=2/exp((v+94)/10)beta=8/(exp(-(v-68)/27)+1)sum=alpha+betahinf=alpha/sumhexp=1-exp(-dt*sum/tc)}FUNCTIONvtrap(x,y){if(fabs(x/y)<1e-6){vtrap=y*(1-x/y/2)}else{vtrap=x/(exp(x/y)-1)}}UNITSON