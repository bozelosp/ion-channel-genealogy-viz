INDEPENDENT{tFROM0TO1WITH1(ms)}NEURON{SUFFIXparak75USEIONkREADekWRITEikRANGEgkbar,ekRANGEn_infRANGEtau_n}UNITS{(mA)=(milliamp)(mV)=(millivolt)}PARAMETER{gkbar=0.01(mho/cm2)ek(mV)celsius(degC)dt(ms)v(mV)vshift=5(mV)anA=0.00798anB=93.2anC=1.1bnA=0.0142bnB=76bnC=10.5}STATE{n}ASSIGNED{ik(mA/cm2)n_inftau_nq10}BREAKPOINT{SOLVEstatesMETHODcnexpik=gkbar*n*n*n*n*(v-ek)}DERIVATIVEstates{evaluate_fct(v)n'=(n_inf-n)/tau_n}UNITSOFFINITIAL{q10=3.0^((celsius-20)/10)evaluate_fct(v)n=n_inf}PROCEDUREevaluate_fct(v(mV)){LOCALa,b,v2v2=v-vshifta=q10*vtrap1(v2)b=q10*vtrap2(v2)tau_n=1/(a+b)n_inf=a/(a+b)}FUNCTIONvtrap1(x){if(fabs((x+anB)/anC)<1e-6){vtrap1=anA*anC}else{vtrap1=(anA*(x+anB))/(1-Exp(-(x+anB)/anC))}}FUNCTIONvtrap2(x){if(fabs((x+bnB)/bnC)<1e-6){vtrap2=bnA*bnC}else{vtrap2=(bnA*(-(x+bnB)))/(1-Exp((x+bnB)/bnC))}}FUNCTIONExp(x){if(x<-100){Exp=0}else{Exp=exp(x)}}UNITSON