NEURON{POINT_PROCESSAmpaNONSPECIFIC_CURRENTiRANGECdur,Erev,g,gmax,kBRANGEr1FIX,r6FIX,r1,r2,r5,r6RANGEtau_1,tau_rec,tau_facil,URANGET,Tmax,TreleaseRANGEM,Diff,R,lamdRANGEtspike,PRERANGENTdiffusionRANGExview,yview,zview,Pview}UNITS{(nA)=(nanoamp)(mV)=(millivolt)(umho)=(micromho)(mM)=(milli/liter)(pS)=(picosiemens)(nS)=(nanosiemens)(um)=(micrometer)PI=(pi)(1)}PARAMETER{gmax=1200(pS)Cdur=0.3(ms)Erev=0(mV)kB=0.44(mM)r1FIX=5.4(/ms/mM)r6FIX=1.12(/ms/mM)r2=0.82(/ms)r5=0.013(/ms)tau_1=3(ms)<1e-9,1e9>tau_rec=35.1(ms)<1e-9,1e9>tau_facil=10.8(ms)<0,1e9>U=0.416(1)<0,1>u0=0(1)<0,1>Tmax=1(mM)M=21500R=1.033(um)Diff=0.223(um2/ms)lamd=20(nm)}ASSIGNED{v(mV)i(nA)g(pS)T(mM)r1(/ms)r6(/ms)Trelease(mM)tspike[50](ms)xtsyn(ms)PRE[50]Mres(mM)NTdiffusion(mM)numpulsesxviewyviewzviewPview}STATE{COD}INITIAL{C=1O=0D=0T=0(mM)Trelease=0(mM)tspike[0]=1e12(ms)Mres=(1e3*1e15/6.022e23*M)numpulses=0xview=1yview=0zview=0Pview=0}FUNCTIONNTdiffWave(){LOCALijk,t0NTdiffusion=0FROMijk=1TOnumpulses{t0=tspike[ijk-1]if(t>t0){NTdiffusion=NTdiffusion+PRE[ijk-1]*Mres*exp(-R*R/(4*Diff*(t-t0)))/(4*PI*Diff*((1e-3)*lamd)*(t-t0))}}NTdiffWave=NTdiffusion}BREAKPOINT{Trelease=T+NTdiffWave()SOLVEkstatesMETHODsparseg=gmax*Oi=(1e-6)*g*(v-Erev)}KINETICkstates{r1=r1FIX*Trelease^2/(Trelease+kB)^2r6=r6FIX*Trelease^2/(Trelease+kB)^2~C<->O(r1,r2)~D<->C(r5,r6)CONSERVEC+O+D=1}NET_RECEIVE(weight,on,nspike,t0(ms),y,z,u,tsyn(ms)){INITIAL{y=0z=0u=u0tsyn=tnspike=1}if(flag==0){nspike=nspike+1if(!on){t0=ton=1z=z*exp(-(t-tsyn)/tau_rec)z=z+(y*(exp(-(t-tsyn)/tau_1)-exp(-(t-tsyn)/tau_rec))/((tau_1/tau_rec)-1))y=y*exp(-(t-tsyn)/tau_1)x=1-y-zif(tau_facil>0){u=u*exp(-(t-tsyn)/tau_facil)u=u+U*(1-u)}else{u=U}y=y+x*uxview=xyview=yPview=uT=Tmax*yPRE[numpulses]=ytspike[numpulses]=tnumpulses=numpulses+1tsyn=t}net_send(Cdur,nspike)}if(flag==nspike){t0=tT=0on=0}}