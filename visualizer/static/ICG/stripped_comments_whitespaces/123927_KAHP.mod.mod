UNITS{(mA)=(milliamp)(mV)=(millivolt)(S)=(siemens)(molar)=(1/liter)}NEURON{SUFFIXKAHPUSEIONkREADekWRITEikUSEIONcaREADcaiRANGEgAHPbar,gAHPGLOBALqinf,qtau}PARAMETER{gAHPbar=0.0033(S/cm2)<0,1e9>qtau=48(ms)}STATE{q}ASSIGNED{ek(mV)v(mV)celsius(degC)gAHP(S/cm2)ik(mA/cm2)qinfcai(millimolar)}BREAKPOINT{SOLVEstatesMETHODcnexpgAHP=gAHPbar*qik=gAHP*(v-ek)}INITIAL{rates(v)q=qinf}DERIVATIVEstates{rates(v)q'=(qinf-q)/qtau}LOCALq10PROCEDURErates(v(mV)){LOCALalpha,beta,sumUNITSOFFq10=3^((celsius-6.3)/10)alpha=0.0048/exp((10*log10(cai*1000)-35)/-2)beta=0.012/exp((10*log10(cai*1000)+100)/5)sum=alpha+betaqinf=alpha/sum}FUNCTIONvtrap(x,y){if(fabs(x/y)<1e-6){vtrap=y*(1-x/y/2)}else{vtrap=x/(exp(x/y)-1)}}UNITSON