UNITS{(molar)=(1/liter)(S)=(siemens)(mA)=(milliamp)(mV)=(millivolt)(mM)=(millimolar)F=(faraday)(coulomb)R=(molek)(mV-coulomb/degC)}NEURON{SUFFIXcachanUSEIONcaREADecaWRITEicaRANGEgcalbar,gcanbar,gcahvabar,ica,ical,icahva,ican,kml,kmnGLOBALdlinf,dhvainf,fhvainf}INDEPENDENT{tFROM0TO1WITH1(ms)}PARAMETER{v(mV)dt(ms)celsius=35.0(degC)gcahvabar=0.0e-6(S/cm2)gcalbar=11.196e-6(S/cm2)kmn=0.0001(mM)kml=0.00045(mM)cao=2.0(mM)}STATE{dhvadlfhva}ASSIGNED{eca(mV)ica(mA/cm2)ical(mA/cm2)ican(mA/cm2)icahva(mA/cm2)dlinfdhvainffhvainf}BREAKPOINT{SOLVEstatesMETHODcnexpical=gcalbar*dl*(v-eca)icahva=gcahvabar*dhva*fhva*(v-eca)ica=ical+icahva}UNITSOFFINITIAL{dl=boltz(v,-45.0,5.0)dhva=boltz(v,-10.0,10.0)fhva=boltz(v,-48.0,-5.0)}DERIVATIVEstates{LOCALdlinf,dhvainf,fhvainf,dltau,dhvatau,fhvataudlinf=boltz(v,-45.0,5.0)dhvainf=boltz(v,-10.0,10.0)fhvainf=boltz(v,-48.0,-5.0)dltau=gaussian(v,18.0,25.0,70.0,0.30)dhvatau=gaussian(v,0.1,13.0,62.0,0.05)fhvatau=gaussian(v,0.5,18.0,55.6,0.5)dl'=(dlinf-dl)/dltaudhva'=(dhvainf-dhva)/dhvataufhva'=(fhvainf-fhva)/fhvatau}FUNCTIONgaussian(v,a,b,c,d){LOCALargarg=a*exp(-(c+v)*(v+c)/(b*b))+dgaussian=arg}FUNCTIONboltz(x,y,z){LOCALargarg=-(x-y)/zif(arg>50){boltz=0}else{if(arg<-50){boltz=1}else{boltz=1.0/(1.0+exp(arg))}}}UNITSON