NEURON{SUFFIXkahpUSEIONkREADekWRITEikUSEIONcaREADcaiRANGEgbarRANGEninf,ntauGLOBALalpha_n,beta_nGLOBALtoffset_n,exp_nGLOBALexp_ca}UNITS{(mA)=(milliamp)(mV)=(millivolt)}ASSIGNED{ek(mV)v(mV)ik(mA/cm2)cai(mM)ninfntau(/ms)exp_nexp_ca}PARAMETER{alpha_n=0(/ms/mM^4)beta_n=0(/ms)toffset_n=0(ms)gbar=1.0(mho/cm2)}STATE{n}BREAKPOINT{rates(v)SOLVEstatesMETHODcnexpik=gbar*do_exp(n,exp_n)*(v-ek)}INITIAL{rates(v)n=ninfik=gbar*do_exp(n,exp_n)*(v-ek)}DERIVATIVEstates{n'=(ninf-n)/ntau}PROCEDURErates(v){LOCALcai_to_powercai_to_power=do_exp(cai,exp_ca)ninf=(alpha_n*cai_to_power)/(alpha_n*cai_to_power+beta_n)ntau=1/(alpha_n*cai_to_power+beta_n)+toffset_n}FUNCTIONdo_exp(var,gexp){do_exp=1.0FROMi=1TOgexp{do_exp=do_exp*var}}