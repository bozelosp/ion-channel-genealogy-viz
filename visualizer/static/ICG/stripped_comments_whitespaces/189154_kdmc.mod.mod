NEURON{THREADSAFESUFFIXkdmcUSEIONkREADekWRITEikRANGEgbar,minf,mtau,hinf,htauGLOBALtaumin}PARAMETER{gbar=0.002(mho/cm2)celsiusek(mV)v(mV)vhalfmt=-25km=14vhalfh=-5zetah=0.02gmh=0.2a0h=0.00058taumin=0.1(ms)vhalfht=-100kh=8q10=3}UNITS{(mA)=(milliamp)(mV)=(millivolt)(pS)=(picosiemens)(um)=(micron)}ASSIGNED{ik(mA/cm2)minfmtau(ms)hinfhtau(ms)}STATE{mh}BREAKPOINT{SOLVEstatesMETHODcnexpik=gbar*m*h*(v-ek)}INITIAL{trates(v)m=minfh=hinf}DERIVATIVEstates{trates(v)m'=(minf-m)/mtauh'=(hinf-h)/htau}PROCEDUREtrates(v){LOCALqtqt=q10^((celsius-34)/10)minf=1/(1+exp(-(v-vhalfmt)/km))mtau=1hinf=1/(1+exp((v-vhalfht)/kh))htau=exp(zetah*gmh*(v-vhalfh))/(qt*a0h*(1+exp(zetah*(v-vhalfh))))if(htau<taumin){htau=taumin}}