UNITS{(mA)=(milliamp)(mV)=(millivolt)(uF)=(microfarad)(molar)=(1/liter)(nA)=(nanoamp)(mM)=(millimolar)(um)=(micron)FARADAY=96520(coul)R=8.3134(joule/degC)}?interfaceNEURON{SUFFIXncaUSEIONcaREADecaWRITEicaRANGEgncaRANGEgncabarRANGEcinf,ctau,dinf,dtau,ica}INDEPENDENT{tFROM0TO100WITH100(ms)}PARAMETER{v(mV)celsius=6.3(degC)dt(ms)gncabar=1.0(mho/cm2)}STATE{cd}ASSIGNED{gnca(mho/cm2)ica(mA/cm2)eca(mV)cinfdinfctau(ms)dtau(ms)cexpdexp}?currentsBREAKPOINT{SOLVEstatesgnca=gncabar*c*c*dica=gnca*(v-eca)}UNITSOFFINITIAL{trates(v)c=cinfd=dinf}?statesPROCEDUREstates(){trates(v)c=c+cexp*(cinf-c)d=d+dexp*(dinf-d)VERBATIMreturn0;ENDVERBATIM}LOCALq10?ratesPROCEDURErates(v){LOCALalpha,beta,sumq10=3^((celsius-6.3)/10)alpha=-0.19*vtrap(v-19.88,-10)beta=0.046*exp(-v/20.73)sum=alpha+betactau=1/sumcinf=alpha/sumalpha=0.00016/exp(-v/48.4)beta=1/(exp((-v+39)/10)+1)sum=alpha+betadtau=1/sumdinf=alpha/sum}PROCEDUREtrates(v){LOCALtincTABLEcinf,cexp,dinf,dexp,ctau,dtauDEPENDdt,celsiusFROM-100TO100WITH200rates(v)tinc=-dt*q10cexp=1-exp(tinc/ctau)dexp=1-exp(tinc/dtau)}FUNCTIONvtrap(x,y){if(fabs(x/y)<1e-6){vtrap=y*(1-x/y/2)}else{vtrap=x/(exp(x/y)-1)}}UNITSON