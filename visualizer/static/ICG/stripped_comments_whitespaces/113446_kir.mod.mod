NEURON{SUFFIXkirUSEIONkREADko,ekWRITEikRANGEgbar,ik,qkGLOBALvs}UNITS{(molar)=(1/liter)(mV)=(millivolt)(mA)=(milliamp)(mM)=(millimolar)FARADAY=96485.309(coul)R=(k-mole)(joule/degC)PI=(pi)(1)}STATE{qk}PARAMETER{gbar=1.0(mho/cm2)vs=1vh=0(mV)}ASSIGNED{ik(mA/cm2)v(mV)ek(mV)ko(mM)diam(um)}BREAKPOINT{ik=gbar*pkir((v),ko,ek)*(v-ek)SOLVEkaccumMETHODsparse}KINETICkaccum{COMPARTMENTdiam*diam*PI/4{qnaqk}~qk<<(-ik*PI*diam*(1e4)/FARADAY)}FUNCTIONpkir(vm,kout,erev){pkir=1/(sqrt(kout)*(1+exp((vm-vh-erev)/vs)))}