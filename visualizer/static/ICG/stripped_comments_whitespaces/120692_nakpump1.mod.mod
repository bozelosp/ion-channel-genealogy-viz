NEURON{SUFFIXnakpumpUSEIONnaREADinaWRITEnai,nao,inaUSEIONkREADikWRITEki,ko,ikRANGEinapump,ikpumpRANGEatpactRANGEnain,naout,kin,kout,atp,p,adpRANGErf,rb}UNITS{(l)=(liter)(mol)=(1)(mmol)=(millimol)(mM)=(mmol/l)(uA)=(microamp)(mA)=(milliamp)(mV)=(millivolt)(um)=(micron)F=(faraday)(kilocoulombs)R=(k-mole)(joule/degC)PI=(pi)(1)}PARAMETER{nasrcrate=0(/ms)ksrcrate=0(/ms)atpsrcrate=1e9(/ms)totalpump=1.25e-13(mol/cm2)nain=9.6(mmol/l)naout=140(mmol/l)kin=150.4(mmol/l)kout=5.4(mmol/l)atp=4.99(mmol/l)p=4.95(mmol/l)adp=0.06(mmol/l)T=310(K)f1=2.5e11(l3/mol3-s)b1=1e5(/s)f2=1e4(/s)b2=1e5(l/mol-s)f3=172(/s)b3=1.72e4(l3/mol3-s)f4=1.5e7(l2/mol2-s)b4=2e5(l/mol-s)f5=2e6(l/mol-s)b5=30(/s)f6=1.15e4(/s)b6=6e8(l2/mol2-s)beta=.5a3=0(1)a5=1(1)iter=1}ASSIGNED{diam(um)v(mV)ina(mA/cm2)ik(mA/cm2)inapump(mA/cm2)ikpump(mA/cm2)inapumplast(mA/cm2)ikpumplast(mA/cm2)atpact(uA/cm2)rf[7](uA/cm2)rb[7](uA/cm2)}STATE{eatp(mol/cm2)na3eatp(mol/cm2)na3ep(mol/cm2)ep(mol/cm2)k2e(mol/cm2)k2eatp(mol/cm2)nai(mM)ki(mM)nao(mM)ko(mM)atps(mmol/l)}LOCALvolin,volout,surfINITIAL{LOCALa1,a2,a3,a4,a5volin=PI*diam*diam/4volout=1(um2)surf=PI*diam*(1e7)nai=nainki=kinnao=naoutko=koutatps=atpa1=nasrcratea2=ksrcratea3=atpsrcratenasrcrate=1e9ksrcrate=1e9atpsrcrate=1e9ina=0ik=0inapump=0ikpump=0inapumplast=0ikpumplast=0FROMi=1TOiter{SOLVEschemeSTEADYSTATEsparse}nasrcrate=a1ksrcrate=a2atpsrcrate=a3}BREAKPOINT{SOLVEschemeMETHODsparseinapumplast=inapumpikpumplast=ikpumpinapump=3*atpact*(1e-3)ikpump=-2*atpact*(1e-3)ina=inapumpik=ikpump}KINETICscheme{LOCALvdi,vdo,a3i,a3o,a5i,a5o,x,ix=F/surf*(1e9)i=1a3i=exp(a3*(1-beta)*F*v/R/T)a3o=exp(-a3*beta*F*v/R/T)a5i=exp(a5*(1-beta)*F*v/R/T)a5o=exp(-a5*beta*F*v/R/T)COMPARTMENTvolin{naikiatpsadpp}COMPARTMENTvolout{naoko}COMPARTMENTsurf*(1e3){eatpna3eatpna3epepk2ek2eatp}~eatp+3nai<->na3eatp(f1*surf*(1e-9),b1*surf*(1e0))rf[i]=f_flux*xrb[i]=b_flux*xi=i+1~na3eatp<->na3ep+adp(f2*surf*(1e0),b2*surf*(1e-3))rf[i]=f_flux*xrb[i]=b_flux*xi=i+1~na3ep<->ep+3naout(a3i*f3*surf*(1e0),a3o*b3*surf*(1e-9))rf[i]=f_flux*xrb[i]=b_flux*xi=i+1~ep+2kout<->k2e+p(f4*surf*(1e-6),b4*surf*(1e-3))rf[i]=f_flux*xrb[i]=b_flux*xi=i+1~k2e+atps<->k2eatp(a5i*f5*surf*(1e-3),a5o*b5*surf*(1e0))rf[i]=f_flux*xrb[i]=b_flux*xi=i+1~k2eatp<->eatp+2ki(f6*surf*(1e0),b6*surf*(1e-6))rf[i]=f_flux*xrb[i]=b_flux*xi=i+1atpact=(f_flux-b_flux)*xCONSERVEeatp+na3eatp+na3ep+ep+k2e+k2eatp=totalpump*surf*(1e3)COMPARTMENTvolin{nainkinatp}~nain<->nai(nasrcrate*volin,nasrcrate*volin)~kin<->ki(ksrcrate*volin,ksrcrate*volin)~atp<->atps(atpsrcrate*volin,atpsrcrate*volin)~nai<<(-(ina-inapumplast)/x*(1e3))~ki<<(-(ik-ikpumplast)/x*(1e3))COMPARTMENTvolout{naoutkout}~naout<->nao(1e9(/ms)*volout,1e9(/ms)*volout)~kout<->ko(1e9(/ms)*volout,1e9(/ms)*volout)}