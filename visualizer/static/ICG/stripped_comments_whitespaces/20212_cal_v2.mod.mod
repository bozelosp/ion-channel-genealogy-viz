INDEPENDENT{tFROM0TO1WITH1(ms)}NEURON{SUFFIXcalUSEIONcaREADcai,caoWRITEicaRANGEpcabar,m_inf,tau_m,ica}UNITS{(mA)=(milliamp)(mV)=(millivolt)(mM)=(milli/liter)FARADAY=96480(coul)R=8.314(volt-coul/degK)}PARAMETER{v(mV)celsius=23(degC)dt(ms)cai=5.e-05(mM)cao=2(mM)pcabar=0.000276(cm/s)}STATE{m}ASSIGNED{ica(mA/cm2)tau_m(ms)m_inftadj}BREAKPOINT{SOLVEstatesica=pcabar*m*m*ghk(v,cai,cao,2)}PROCEDUREstates(){rates(v)m=m+(1-exp(-dt/tau_m))*(m_inf-m)}UNITSOFFINITIAL{tadj=3^((celsius-23.5)/10)rates(v)m=m_inf}FUNCTIONghk(v(mV),ci(mM),co(mM),z)(millicoul/cm3){LOCALe,ww=v*(.001)*z*FARADAY/(R*(celsius+273.16))if(fabs(w)>1e-4){e=w/(exp(w)-1)}else{e=1-w/2}ghk=-(.001)*z*FARADAY*(co-ci*exp(w))*e}UNITSOFFPROCEDURErates(v(mV)){LOCALa,ba=1.6/(1+exp(-0.072*(v-15)))b=0.02*vtrap(-(v-1.31),5.36/2)tau_m=1/(a+b)/(tadj*1.43)m_inf=1/(1+exp((v+9)/-6))}FUNCTIONvtrap(x,c){if(fabs(x/c)<1e-6){vtrap=c+x/2}else{vtrap=x/(1-exp(-x/c))}}UNITSON