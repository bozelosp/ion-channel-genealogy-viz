NEURON{SUFFIXKv3USEIONkREADekWRITEikNONSPECIFIC_CURRENTiRANGEgbar,g,ik,i,igate,ncGLOBALninf,tauGLOBALgateCurrent,gunit}UNITS{(mV)=(millivolt)(mA)=(milliamp)(nA)=(nanoamp)(pA)=(picoamp)(S)=(siemens)(mS)=(millisiemens)(nS)=(nanosiemens)(pS)=(picosiemens)(um)=(micron)(molar)=(1/liter)(mM)=(millimolar)}CONSTANT{e0=1.60217646e-19(coulombs)q10=2.7ca=0.22(1/ms)cva=16(mV)cka=-26.5(mV)cb=0.22(1/ms)cvb=16(mV)ckb=26.5(mV)zn=1.9196(1)}PARAMETER{gateCurrent=0(1)gbar=0.005(S/cm2)<0,1e9>gunit=16(pS)}ASSIGNED{celsius(degC)v(mV)ik(mA/cm2)igate(mA/cm2)i(mA/cm2)ek(mV)g(S/cm2)nc(1/cm2)qt(1)ninf(1)tau(ms)alpha(1/ms)beta(1/ms)}STATE{n}INITIAL{nc=(1e12)*gbar/gunitqt=q10^((celsius-22(degC))/10(degC))rateConst(v)n=ninf}BREAKPOINT{SOLVEstateMETHODcnexpg=gbar*n^4ik=g*(v-ek)igate=nc*(1e6)*e0*4*zn*ngateFlip()if(gateCurrent!=0){i=igate}}DERIVATIVEstate{rateConst(v)n'=alpha*(1-n)-beta*n}PROCEDURErateConst(v(mV)){alpha=qt*alphaFkt(v)beta=qt*betaFkt(v)ninf=alpha/(alpha+beta)tau=1/(alpha+beta)}FUNCTIONalphaFkt(v(mV))(1/ms){alphaFkt=ca*exp(-(v+cva)/cka)}FUNCTIONbetaFkt(v(mV))(1/ms){betaFkt=cb*exp(-(v+cvb)/ckb)}FUNCTIONngateFlip()(1/ms){ngateFlip=(ninf-n)/tau}