INDEPENDENT{tFROM0TO1WITH1(ms)}NEURON{SUFFIXnewCaP_DPUSEIONcaREADcai,caoWRITEicaRANGEpcabar,ica,gk,vhalfm,cvm,vshiftGLOBALfrac1,frac2}UNITS{(mV)=(millivolt)(mA)=(milliamp)(nA)=(nanoamp)(pA)=(picoamp)(S)=(siemens)(nS)=(nanosiemens)(pS)=(picosiemens)(um)=(micron)(molar)=(1/liter)(mM)=(millimolar)}CONSTANT{q10=3F=9.6485e4(coulombs)R=8.3145(joule/kelvin)}PARAMETER{v(mV)celsius(degC)cai(mM)cao(mM)vhalfm=-29.458(mV)cvm=8.429(mV)vshift=0(mV)pcabar=0.00049568(cm/s)}ASSIGNED{qtica(mA/cm2)minftaum(ms)gk(coulombs/cm3)T(kelvin)E(volt)zetafrac1frac2}STATE{mh}INITIAL{qt=q10^((celsius-23(degC))/10(degC))T=kelvinfkt(celsius)rates(v)m=minf}BREAKPOINT{SOLVEstatesMETHODcnexpica=(1e3)*pcabar*m*m*m*gk}DERIVATIVEstates{rates(v)m'=(minf-m)/taum}FUNCTIONghk(v(mV),ci(mM),co(mM),z)(coulombs/cm3){E=(1e-3)*vzeta=(z*F*E)/(R*T)if(fabs(1-exp(-zeta))<1e-6){ghk=(1e-6)*(z*F)*(ci-co*exp(-zeta))*(1+zeta/2)}else{ghk=(1e-6)*(z*zeta*F)*(ci-co*exp(-zeta))/(1-exp(-zeta))}}PROCEDURErates(v(mV)){minf=1/(1+exp(-(v-vhalfm-vshift)/cvm))taum=taumfkt(v-vshift)/qtgk=ghk(v-vshift,cai,cao,2)}FUNCTIONkelvinfkt(t(degC))(kelvin){UNITSOFFkelvinfkt=273.19+tUNITSON}FUNCTIONtaumfkt(v(mV))(ms){UNITSOFFif(v>=-40){taumfkt=0.2702+1.1622*exp(-(v+26.798)*(v+26.798)/164.19)}else{taumfkt=0.6923*exp(v/1089.372)}UNITSON}