INDEPENDENT{tFROM0TO1WITH1(ms)}NEURON{SUFFIXcadUSEIONcaREADica,caiWRITEcaiRANGEica,channel_flow,depth,BGLOBALcai,tau,cainf}UNITS{(mA)=(milliamp)(mV)=(millivolt)(molar)=(1/liter)(mM)=(millimolar)(um)=(micron)}CONSTANT{FARADAY=96154(coul)}PARAMETER{dt(ms)depth=1(um)tau=10(ms)cainf=1e-5(mM)ica(mA/cm2)f=1.0}STATE{cai(mM)}INITIAL{cai=cainf}ASSIGNED{channel_flow(mM/ms)B(mMcm2/ms/mA)}BREAKPOINT{SOLVEstateMETHODcnexp}DERIVATIVEstate{B=-f*(1e4)/(2*FARADAY*depth)channel_flow=B*icaif(channel_flow<=0.0){channel_flow=0.0}cai'=channel_flow-(cai-cainf)/tau}