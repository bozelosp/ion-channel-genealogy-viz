INDEPENDENT{tFROM0TO1WITH1(ms)}NEURON{SUFFIXiarUSEIONotherWRITEiotherVALENCE1USEIONcaREADcaiRANGEghbar,gh,iGLOBALk2,cac,nexp,h_inf,tau_s,tau_f,controls,controlf}UNITS{(molar)=(1/liter)(mM)=(millimolar)(mA)=(milliamp)(mV)=(millivolt)(msM)=(msmM)}PARAMETER{eh=-43(mV)celsius=36(degC)ghbar=.0001(mho/cm2)cac=1e-4(mM)k2=0.001(1/ms)nexp=2controls=1controlf=1}STATE{s1s2f1f2}ASSIGNED{v(mV)cai(mM)i(mA/cm2)iother(mA/cm2)gh(mho/cm2)h_inftau_s(ms)tau_f(ms)alpha1(1/ms)alpha2(1/ms)beta1(1/ms)beta2(1/ms)kk(1/ms)fderiv(1/ms)tadj}BREAKPOINT{SOLVEstatesMETHODrungeif(controls==0){gh=ghbar*(f1+f2)}elseif(controlf==0){gh=ghbar*(s1+s2)}else{gh=ghbar*(s1+s2)*(f1+f2)}i=gh*(v-eh)iother=i}DERIVATIVEstates{LOCALs0,f0evaluate_fct(v)s0=1-s1-s2f0=1-f1-f2kk=k2*(5e-5/cac)^nexpfderiv=kk*s1-k2*s2s1'=alpha1*s0-beta1*s1-fderivs2'=fderivfderiv=kk*f1-k2*f2f1'=alpha2*f0-beta2*f1-fderivf2'=fderiv}UNITSOFFINITIAL{tadj=3.0^((celsius-36)/10)evaluate_fct(v)kk=k2*(cai/cac)^nexps1=alpha1*k2/(alpha1*kk+alpha1*k2+beta1*k2)s2=alpha1*kk/(alpha1*kk+alpha1*k2+beta1*k2)f1=alpha2*k2/(alpha2*kk+alpha2*k2+beta2*k2)f2=alpha2*kk/(alpha2*kk+alpha2*k2+beta2*k2)}PROCEDUREevaluate_fct(v(mV)){h_inf=1/(1+exp((v+68.9)/6.5))tau_s=exp((v+183.6)/15.24)/tadjtau_f=exp((v+158.6)/11.2)/(1+exp((v+75)/5.5))/tadjalpha1=controls*h_inf/tau_sbeta1=(1-h_inf)/tau_salpha2=controlf*h_inf/tau_fbeta2=(1-h_inf)/tau_f}UNITSON