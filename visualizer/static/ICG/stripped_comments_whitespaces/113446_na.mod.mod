UNITS{(mV)=(millivolt)(mA)=(milliamp)}INDEPENDENT{tFROM0TO1WITH100(ms)}NEURON{SUFFIXnachanUSEIONnaREADenaWRITEinaRANGEgnabar,ina,interval,freq,n,firing,qnaGLOBALshiftm,shifth,scaletaum,scaletauh}UNITS{PI=(pi)(1)FARADAY=96485.309(coul)R=(k-mole)(joule/degC)}PARAMETER{celsius=36(degC)gnabar=1e-3(mho/cm2)shiftm=0(mV)shifth=0(mV)scaletaum=1(mV)scaletauh=1(mV)}ASSIGNED{ina(mA/cm2)v(mV)ena(mV)dt(ms)diam(um)freqintervalnfiring}STATE{mambhahbqna}BREAKPOINT{SOLVEnastateMETHODsparseina=gnabar*ma*ma*ma*ha*(v-ena)}INITIAL{ma=m_inf(v)ha=h_inf(v)mb=1-mahb=1-hafreq=0n=0interval=0firing=0qna=0ina=gnabar*ma*ma*ma*ha*(v-ena)}LOCALa1,a2,b1,b2KINETICnastate{COMPARTMENTdiam*diam*PI/4{qna}telspike()a1=m_a(v)a2=m_b(v)b1=h_a(v)b2=h_b(v)~mb<->ma(a1,a2)~hb<->ha(b1,b2)CONSERVEma+mb=1CONSERVEha+hb=1~qna<<(-ina*PI*diam*(1e4)/FARADAY)}PROCEDUREtelspike(){if((ma*ma*ma*ha>.01)&&!firing){n=n+1if(n>1){freq=1000/interval}firing=1interval=0}if((ma*ma*ma*ha<.01)&&firing){firing=0}interval=interval+dt/2}FUNCTIONm_a(v(mV)){TABLEDEPENDshiftm,scaletaumFROM-150TO150WITH301m_a=scaletauh*0.32*(13.1-v-70-shiftm)/(exp((13.1-v-70-shiftm)/4)-1)}FUNCTIONm_b(v(mV)){TABLEDEPENDshiftm,scaletaumFROM-150TO150WITH301m_b=scaletaum*0.28*(v-40.1+70+shiftm)/(exp((v-40.1+70+shiftm)/5)-1)}FUNCTIONh_a(v(mV)){TABLEDEPENDshifth,scaletauhFROM-150TO150WITH301h_a=scaletauh*0.128*exp((17-v-70-shifth)/18)}FUNCTIONh_b(v(mV)){TABLEDEPENDshifth,scaletauhFROM-150TO150WITH301h_b=scaletauh*4/(1+exp((40-v-70-shifth)/5))}FUNCTIONm_inf(v(mV)){m_inf=m_a(v)/(m_a(v)+m_b(v))}FUNCTIONh_inf(v(mV)){h_inf=h_a(v)/(h_a(v)+h_b(v))}FUNCTIONwindow(v(mV)){window=gnabar*m_inf(v)^3*h_inf(v)*(v-ena)}