UNITS{(molar)=(1/liter)(mV)=(millivolt)(mA)=(milliamp)(mM)=(millimolar)}INDEPENDENT{tFROM0TO1WITH100(ms)}NEURON{SUFFIXnapUSEIONkREADkoUSEIONnaREADnai,nao,enaWRITEinaGLOBALina_p_h,tau_act,conc_half,hellingRANGEgnabar,ina}UNITS{FARADAY=96485.309(coul)R=(k-mole)(joule/degC)}PARAMETER{celsius(degC)gnabar=1e-6(mho/cm2)helling=-.765(mM)conc_half=7(mM)ina_p_h=25000(ms)tau_act=6(ms)}ASSIGNED{ina(mA/cm2)ena(mV)v(mV)nai(mM)nao(mM)ko(mM)}STATE{mambhahb}BREAKPOINT{SOLVEnastateMETHODsparseina=gnabar*ma*ma*ha*kdep(ko)*(v-ena)}INITIAL{ma=m_inf(v)mb=1-maha=h_inf(v)hb=1-haina=gnabar*ma*ma*ha*kdep(ko)*(v-ena)}LOCALa1,a2,b1,b2KINETICnastate{a1=m_a(v)a2=m_b(v)b1=h_a(v)b2=h_b(v)~mb<->ma(a1,a2)~hb<->ha(b1,b2)CONSERVEma+mb=1CONSERVEha+hb=1}FUNCTIONkdep(ko(mM)){TABLEDEPENDconc_half,hellingFROM0TO150WITH150kdep=1+2/(1+exp((ko-conc_half)/helling))}FUNCTIONm_a(v(mV)){TABLEFROM-150TO150WITH200m_a=m_inf(v)/tau_act}FUNCTIONm_inf(v){TABLEFROM-150TO150WITH200m_inf=1/(1+(exp(-(v+39.7)/7.0)))}FUNCTIONm_b(v(mV)){TABLEFROM-150TO150WITH200m_b=(1-m_inf(v))/tau_act}FUNCTIONh_a(v(mV)){TABLEFROM-150TO150WITH200h_a=(1/ina_p_h)*(0.128*exp((7-v-70)/18))}FUNCTIONh_b(v(mV)){TABLEFROM-150TO150WITH200h_b=(1/ina_p_h)*4/(1+exp((30-v-70)/5))}FUNCTIONh_inf(v){TABLEFROM-150TO150WITH200h_inf=h_a(v)/(h_a(v)+h_b(v))}FUNCTIONghk(v(mV),ci(mM),co(mM))(.001coul/cm3){LOCALz,eci,ecoz=(1e-3)*1*FARADAY*v/(R*(celsius+273.11247574))eco=co*efun(z)eci=ci*efun(-z)ghk=(.001)*1*FARADAY*(eci-eco)}FUNCTIONefun(z){if(fabs(z)<1e-4){efun=1-z/2}else{efun=z/(exp(z)-1)}}