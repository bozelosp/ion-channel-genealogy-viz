NEURON{ARTIFICIAL_CELLstimRANGEy,frequency,number,start,noise,change,event,flag,hey,on,end}PARAMETER{frequency=1(1/s)<1e-9,1e9>number=10<0,1e9>start=50(ms)noise=0<0,1>}ASSIGNED{yevent(ms)onend(ms)change(ms)hey}PROCEDUREseed(x){set_seed(x)}INITIAL{on=0y=0if(noise<0){noise=0}if(noise>1){noise=1}if(start>=0&&number>0){event=start+invl((1/frequency)*(1000))-(1/frequency)*(1000)*(1.-noise)if(event<0){event=0}if(event>change){init_sequence(t)net_send(change-t,4)hey=4}else{net_send(event-t,3)hey=3}}}PROCEDUREinit_sequence(t(ms)){if(number>0){on=1event=tend=t+1e-6+invl((1/frequency)*(1000))*(number-1)}}FUNCTIONinvl(mean(ms))(ms){if(mean<=0.){mean=.01(ms)}if(noise==0){invl=mean}else{invl=(1.-noise)*mean+noise*mean*exprand(1)}}PROCEDUREevent_time(){if(number>0){event=event+invl((1/frequency)*(1000))}if(event>end){on=0}}NET_RECEIVE(w){if(flag==0){y=2net_event(t)net_send(.1,2)hey=2}if(flag==3){if(on==0){init_sequence(t)net_send(0,1)hey=1}}if(flag==1&&on==1){y=2net_event(t)event=tevent_time()if(event>change){net_send(change-t,4)hey=4}else{if(on==1){net_send(event-t,1)hey=1}}net_send(.1,2)hey=2}if(flag==2){y=0}if(flag==4){event=tevent_time()if(on==1){if(event>change){net_send(change-t,4)hey=4}else{net_send(event-t,1)hey=1}}}}