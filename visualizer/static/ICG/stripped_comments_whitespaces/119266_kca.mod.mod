NEURON{SUFFIXkcaUSEIONkREADekWRITEikUSEIONcaREADcaiRANGEgbar,po,ikGLOBALm_inf,tau_m}UNITS{(mA)=(milliamp)(mV)=(millivolt)(molar)=(1/liter)(mM)=(millimolar)}ASSIGNED{v(mV)celsius(degC)ek(mV)cai(mM)ik(mA/cm2)pom_inftau_m(ms)}PARAMETER{gbar=0.01(mho/cm2)taumin=100(ms)b=0.005(mM)}STATE{m}BREAKPOINT{SOLVEstatesMETHODcnexppo=m*mik=gbar*po*(v-ek)}DERIVATIVEstates{rates(cai)m'=(m_inf-m)/tau_m}INITIAL{rates(cai)m=m_inf}PROCEDURErates(cai(mM)){LOCALaa=cai/bm_inf=a/(a+1)tau_m=taumin+1(ms)*1(mM)/(cai+b)}