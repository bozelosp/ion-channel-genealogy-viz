NEURON{POINT_PROCESSNetStimdRANGEyRANGEinterv1,interv2,swu,swd,number,startRANGEnoise}PARAMETER{interv1=10(ms)<1e-9,1e9>interv2=10(ms)<1e-9,1e9>interval=10number=10<0,1e9>start=50(ms)noise=0<0,1>swu=400swd=2000sw=2000flag=0tpre=0}ASSIGNED{yevent(ms)onend(ms)}PROCEDUREseed(x){set_seed(x)}INITIAL{on=0y=0flag=0tpre=0sw=2000if(noise<0){noise=0}if(noise>1){noise=1}if(start>=0&&number>0){event=start+invl(interv1)net_send(event,3)}}PROCEDUREinit_sequence(t(ms)){if(number>0){on=1event=tend=t+1e-6+invl(interv1)*(number-1)}}FUNCTIONinvl(mean(ms))(ms){if(mean<=0.){mean=.01(ms)}if(noise==0){invl=mean}else{invl=(1.-noise)*mean+noise*mean*exprand(1)}}PROCEDUREevent_time(){if(flag==0&&t-tpre>swd){flag=1tpre=t}if(flag==1&&t-tpre>=swu){flag=0tpre=t}if(flag==0){interval=interv1}else{interval=interv2}if(number>0){event=event+invl(interval)}if(event>end){on=0}}NET_RECEIVE(w){if(flag==0){if(w>0&&on==0){init_sequence(t)net_send(0,1)}elseif(w<0&&on==1){on=0}}if(flag==3){if(on==0){init_sequence(t)net_send(0,1)}}if(flag==1&&on==1){y=2net_event(t)event_time()if(on==1){net_send(event-t,1)}net_send(.1,2)}if(flag==2){y=0}}