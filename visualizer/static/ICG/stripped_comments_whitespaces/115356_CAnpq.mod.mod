UNITS{(mA)=(milliamp)(mV)=(millivolt)(molar)=(1/liter)(mM)=(millimolar)F=96485(coul)R=8.3134(joule/degC)}PARAMETER{v(mV)celsius(degC)PcanpqBar=.000154(cm/s)ki=.00002(mM)cai(mM)cao(mM)q10m=11.45q10Ampl=2.1}NEURON{SUFFIXCAnpqUSEIONcaREADcai,caoWRITEicaRANGEPcanpqBarGLOBALminf,taum}STATE{m}ASSIGNED{ica(mA/cm2)Pcanpq(cm/s)minftaum}INITIAL{rates(v)m=minf}UNITSOFFBREAKPOINT{LOCALqAmplqAmpl=q10Ampl^((celsius-21)/10)SOLVEstatesMETHODcnexpPcanpq=qAmpl*PcanpqBar*m*mica=Pcanpq*ghk(v,cai,cao)}FUNCTIONghk(v(mV),ci(mM),co(mM))(mV){LOCALaa=2*F*v/(R*(celsius+273.15)*1000)ghk=2*F/1000*(co-ci*exp(a))*func(a)}FUNCTIONfunc(a){if(fabs(a)<1e-4){func=-1+a/2}else{func=a/(1-exp(a))}}FUNCTIONalpm(v(mV)){alpm=0.1967*(-1.0*(v-15)+19.88)/(exp((-1.0*(v-15)+19.88)/10.0)-1.0)}FUNCTIONbetm(v(mV)){betm=0.046*exp(-(v-15)/20.73)}DERIVATIVEstates{rates(v)m'=(minf-m)/taum}PROCEDURErates(v(mV)){LOCALa,qmTABLEtaum,minfFROM-150TO150WITH3000qm=q10m^((celsius-22)/10)a=alpm(v)taum=1/((a+betm(v))*qm)minf=1/(1+exp(-(v+11)/5.7))^0.5}UNITSON