INDEPENDENT{tFROM0TO1WITH1(ms)}NEURON{POINT_PROCESSNMDAPOINTERpreRANGEC,R,R0,R1,g,gmax,lastrelease,B,spkNONSPECIFIC_CURRENTiGLOBALCmax,Cdur,Alpha,Beta,Erev,Prethresh,Deadtime,Rinf,Rtau}INCLUDE"queue.inc"UNITS{(nA)=(nanoamp)(mV)=(millivolt)(umho)=(micromho)(mM)=(milli/liter)}PARAMETER{mg=1.(mM)Cmax=1(mM)Cdur=5.0(ms)Alpha=0.072(/msmM)Beta=0.0066(/ms)Erev=0(mV)Prethresh=0Deadtime=1(ms)gmax=0.001(umho)vmin=-120(mV)vmax=100(mV)}ASSIGNED{v(mV)i(nA)g(umho)C(mM)BRR0R1RinfRtau(ms)prespklastrelease(ms)}INITIAL{initq()R=0C=0R0=0R1=0Rinf=Cmax*Alpha/(Cmax*Alpha+Beta)Rtau=1/((Alpha*Cmax)+Beta)lastrelease=-9e9rates(v)}BREAKPOINT{rates(v)SOLVEreleaseg=gmax*R*Bi=g*(v-Erev)}PROCEDURErelease(){LOCALqif(!spk&&pre>Prethresh){spk=1pushq(t+delay)}if(spk&&pre<Prethresh){spk=0}q=((t-lastrelease)-Cdur)if(q>Deadtime){if(t>=queu[head]){popq()C=CmaxR0=Rlastrelease=t}}elseif(q<0){if(t>queu[head]){popq()}}elseif(C==Cmax){R1=RC=0.}if(C>0){R=Rinf+(R0-Rinf)*exptable(-(t-lastrelease)/Rtau)}else{R=R1*exptable(-Beta*(t-(lastrelease+Cdur)))}VERBATIMreturn0;ENDVERBATIM}FUNCTIONexptable(x){TABLEFROM-10TO10WITH2000if((x>-10)&&(x<10)){exptable=exp(x)}else{exptable=0.}}PROCEDURErates(v(mV)){TABLEBDEPENDmgFROMvminTOvmaxWITH200B=1/(1+exp(0.062(/mV)*-v)*(mg/3.57(mM)))}