NEURON{SUFFIXmycaUSEIONcaREADecaWRITEicaRANGEgbarRANGEar2,vhalfsRANGEinf,fac,tauRANGEtausRANGEWGLOBALtaumin}UNITS{(mA)=(milliamp)(mV)=(millivolt)}INDEPENDENT{tFROM0TO1WITH1(ms)}PARAMETER{a0r=0.0003(ms)b0r=0.0003(ms)zetar=12(1)zetas=12(1)gms=0.2(1)gmr=0.2(1)a0s=0.0003(ms)vvs=2(mV)vhalfr=-60(mV)v(mV)W=0.016(/mV)celsius=34(degC)dt(ms)gbar=.12(mho/cm2)eca=140.0(mV)ar2=1.0b=0taumin=3}STATE{mhns}ASSIGNED{ica(mA/cm2)inf[4]fac[4]tau[4]}BREAKPOINT{SOLVEstatesica=gbar*m*m*h*s*(v-eca)}INITIAL{states()s=1ica=gbar*m*m*h*s*(v-eca)}PROCEDUREcalcg(){mhn(v*1(/mV))m=m+fac[0]*(inf[0]-m)h=h+fac[1]*(inf[1]-h)n=n+fac[2]*(inf[2]-n)s=s+fac[3]*(inf[3]-s)}PROCEDUREstates(){calcg()VERBATIMreturn0;ENDVERBATIM}FUNCTIONvarss(v,i){LOCALmax,min,vhalf,smoothif(i==0){varss=1/(1+exp((v+40)/(-3)))}elseif(i==1){varss=1/(1+exp((v+45)/(3)))}else{max=1min=0smooth=2vhalf=-60varss=alpv(v,vhalfr)}}FUNCTIONalpr(v(mV)){alpr=exp(1.e-3*zetar*(v-vhalfr)*9.648e4/(8.315*(273.16+celsius)))}FUNCTIONalpv(v(mV),vh){alpv=(1+ar2*exp((v-vh)/vvs))/(1+exp((v-vh)/vvs))}FUNCTIONbetr(v(mV)){betr=exp(1.e-3*zetar*gmr*(v-vhalfr)*9.648e4/(8.315*(273.16+celsius)))}FUNCTIONvartau(v,i){LOCALalpha,beta,sum,tmpif(i==0){vartau=0.05}elseif(i==1){vartau=0.5}else{tmp=betr(v)/(a0r+b0r*alpr(v))if(tmp<taumin){tmp=taumin}VERBATIMENDVERBATIMvartau=tmp}}PROCEDUREmhn(v){LOCALa,bFROMi=0TO2{tau[i]=vartau(v,i)inf[i]=varss(v,i)fac[i]=(1-exp(-dt/tau[i]))}}