NEURON{SUFFIXHHnaUSEIONnaREADenaWRITEinaRANGEgnabar,inaGLOBALinf,ena}UNITS{(mA)=(milliamp)(mV)=(millivolt)(S)=(siemens)}INDEPENDENT{tFROM0TO1WITH1(ms)}PARAMETER{v(mV)celsius=6.3(degC)dt(ms)gnabar=.120(S/cm2)ena=50(mV)}STATE{mh}ASSIGNED{ina(mA/cm2)inf[2]}LOCALfac[2]INITIAL{rate(v*1(/mV))m=inf[0]h=inf[1]}BREAKPOINT{SOLVEstatesina=gnabar*m*m*m*h*(v-ena)}PROCEDUREstates(){rate(v*1(/mV))m=m+fac[0]*(inf[0]-m)h=h+fac[1]*(inf[1]-h)VERBATIMreturn0;ENDVERBATIM}UNITSOFFFUNCTIONalp(v(mV),i){LOCALa,b,c,q10v=-v-65q10=3^((celsius-6.3)/10)if(i==0){alp=q10*.1*expM1(v+25,10)}elseif(i==1){alp=q10*.07*exp(v/20)}}FUNCTIONbet(v,i){LOCALa,b,c,q10v=-v-65q10=3^((celsius-6.3)/10)if(i==0){bet=q10*4*exp(v/18)}elseif(i==1){bet=q10*1/(exp(.1*v+3)+1)}}FUNCTIONexpM1(x,y){if(fabs(x/y)<1e-6){expM1=y*(1-x/y/2)}else{expM1=x/(exp(x/y)-1)}}PROCEDURErate(v){LOCALa,b,tauTABLEinf,facDEPENDdt,celsiusFROM-100TO100WITH200FROMi=0TO1{a=alp(v,i)b=bet(v,i)tau=1/(a+b)inf[i]=a/(a+b)fac[i]=(1-exp(-dt/tau))}}UNITSON