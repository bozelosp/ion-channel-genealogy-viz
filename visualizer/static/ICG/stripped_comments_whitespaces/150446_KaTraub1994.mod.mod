NEURON{SUFFIXKaUSEIONkREADekWRITEikRANGEgbar,g,iGLOBALVm}UNITS{(S)=(siemens)(mA)=(milliamp)(mV)=(millivolt)}PARAMETER{gbar=1.0(S/cm2)Vm=-65(mV)}ASSIGNED{v(mV)ek(mV)ik(mA/cm2)i(mA/cm2)g(S/cm2)minfhinfmtau(ms)htau(ms)}STATE{mh}BREAKPOINT{SOLVEstatesMETHODcnexpg=gbar*m*hi=g*(v-ek)ik=i}INITIAL{rates(v)m=minfh=hinf}DERIVATIVEstates{rates(v)m'=(minf-m)/mtauh'=(hinf-h)/htau}PROCEDURErates(v(mV)){LOCALalpham,betam,alphah,betah,smallTABLEminf,mtau,hinf,htauFROM-100TO50WITH200UNITSOFFsmall=(13.1-(v-Vm))/10if(fabs(small)>1e-6){alpham=0.02*(13.1-(v-Vm))/(exp((13.1-(v-Vm))/10)-1)}else{alpham=0.02*10/(1+small/2)}small=((v-Vm)-40.1)/10if(fabs(small)>1e-6){betam=0.0175*((v-Vm)-40.1)/(exp(((v-Vm)-40.1)/10)-1)}else{betam=0.0175*10/(1+small/2)}minf=alpham/(alpham+betam)mtau=1/(alpham+betam)alphah=0.0016*exp((-13-(v-Vm))/18)betah=0.05/(1+exp((10.1-(v-Vm))/5))hinf=alphah/(alphah+betah)htau=1/(alphah+betah)UNITSON}