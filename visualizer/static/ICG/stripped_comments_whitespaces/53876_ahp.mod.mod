NEURON{SUFFIXahpUSEIONcaREADcaiUSEIONkREADekWRITEikRANGEgbar,q,tau_q,qinf,betaq_const}UNITS{(S)=(siemens)(mV)=(millivolt)(mA)=(milliamp)}PARAMETER{gbar=2167e-6(S/cm2)<0,1e9>betaq_const=0.074}ASSIGNED{ek(mV)cai(mM)ik(mA/cm2)v(mV)g(S/cm2)qinftau_q(ms)}STATE{q}BREAKPOINT{SOLVEstatesMETHODcnexpg=gbar*q*qik=g*(v-ek)}INITIAL{q=alphaq(v)/(alphaq(v)+betaq(v))}DERIVATIVEstates{rates(v)q'=(qinf-q)/tau_q}FUNCTIONalphaq(Vm(mV))(/ms){UNITSOFFalphaq=3.5e9*(cai)^3UNITSON}FUNCTIONbetaq(Vm(mV))(/ms){UNITSOFFbetaq=betaq_constUNITSON}FUNCTIONtauq(Vm(mV))(/ms){UNITSOFFtauq=1.0/(alphaq(Vm)+betaq(Vm))UNITSON}PROCEDURErates(Vm(mV)){tau_q=tauq(Vm)qinf=alphaq(Vm)*tau_q}