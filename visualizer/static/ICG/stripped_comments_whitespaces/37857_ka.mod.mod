UNITS{(mA)=(milliamp)(mV)=(millivolt)(nA)=(nanoamp)}NEURON{SUFFIXkaUSEIONkREADekWRITEikRANGEgkabar,gka,ikGLOBALainf,binf,cinf,atau,btau,ctau}INDEPENDENT{tFROM0TO1WITH1(ms)}PARAMETER{v(mV)celsius=22(degC)dt(ms)ek=-77(mV)gkabar=0.00477(mho/cm2)<0,1e9>}STATE{abc}ASSIGNED{ik(mA/cm2)gka(mho/cm2)ainfbinfcinfatau(ms)btau(ms)ctau(ms)}LOCALaexp,bexp,cexpBREAKPOINT{SOLVEstatesgka=gkabar*(a^4)*b*cik=gka*(v-ek)}UNITSOFFINITIAL{trates(v)a=ainfb=binfc=cinf}PROCEDUREstates(){trates(v)a=a+aexp*(ainf-a)b=b+bexp*(binf-b)c=c+cexp*(cinf-c)VERBATIMreturn0;ENDVERBATIM}LOCALq10PROCEDURErates(v){q10=3^((celsius-22)/10)ainf=(1/(1+exp(-1*(v+31)/6)))^0.25binf=1/(1+exp((v+66)/7))^0.5cinf=1/(1+exp((v+66)/7))^0.5atau=(100/(7*exp((v+60)/14)+29*exp(-(v+60)/24)))+0.1btau=(1000/(14*exp((v+60)/27)+29*exp(-(v+60)/24)))+1ctau=(90/(1+exp((-66-v)/17)))+10}PROCEDUREtrates(v){LOCALtincTABLEainf,aexp,binf,bexp,cinf,cexpDEPENDdt,celsiusFROM-150TO150WITH300rates(v)tinc=-dt*q10aexp=1-exp(tinc/atau)bexp=1-exp(tinc/btau)cexp=1-exp(tinc/ctau)}FUNCTIONvtrap(x,y){if(fabs(x/y)<1e-6){vtrap=y*(1-x/y/2)}else{vtrap=x/(exp(x/y)-1)}}UNITSON