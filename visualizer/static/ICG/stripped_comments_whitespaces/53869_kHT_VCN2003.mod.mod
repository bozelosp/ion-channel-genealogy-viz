INDEPENDENT{tFROM0TO1WITH1(ms)}NEURON{SUFFIXkHT_VCN2003USEIONkREADekWRITEikRANGEgkbarRANGEn_inf,p_infRANGEtau_n,tau_pRANGEn_exp,p_expRANGEik,gk}UNITS{(mA)=(milliamp)(mV)=(millivolt)}PARAMETER{gkbar=0.03(mho/cm2)ek=-70(mV)celsius=22(degC)dt(ms)v(mV)}STATE{nprr}ASSIGNED{gk(mho/cm2)ik(mA/cm2)n_infp_inftau_ntau_pn_expp_exptadj}BREAKPOINT{SOLVEstatesgk=gkbar*(rr*n^2+(1-rr)*p)ik=gk*(v-ek)}PROCEDUREstates(){evaluate_fct(v)n=n+n_exp*(n_inf-n)p=p+p_exp*(p_inf-p)VERBATIMreturn0;ENDVERBATIM}UNITSOFFINITIAL{tadj=3.0^((celsius-22)/10)evaluate_fct(v)n=n_infp=p_infrr=0.85}PROCEDUREevaluate_fct(v(mV)){tau_n=(100/(11*exp((v+60)/24)+21*exp(-(v+60)/23))+0.7)/tadjn_inf=1/(1+exp(-(v+15)/5))^2tau_p=(100/(4*exp((v+60)/32)+5*exp(-(v+60)/22))+5)/tadjp_inf=1/(1+exp(-(v+23)/6))n_exp=1-exp(-dt/tau_n)p_exp=1-exp(-dt/tau_p)}UNITSON