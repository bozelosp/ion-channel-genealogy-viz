UNITS{(molar)=(1/liter)}UNITS{(mV)=(millivolt)(mA)=(milliamp)(mM)=(millimolar)}INDEPENDENT{tFROM0TO1WITH100(ms)}NEURON{SUFFIXcagkUSEIONcaREADcaiUSEIONkREADekWRITEikRANGEgkbarGLOBALoinf,tau}UNITS{FARADAY=(faraday)(kilocoulombs)R=8.313424(joule/degC)}PARAMETER{celsius=20(degC)v(mV)gkbar=.01(mho/cm2)cai=1e-3(mM)ek(mV)dt(ms)d1=.84d2=1.k1=.18(mM)k2=.011(mM)abar=.28(/ms)bbar=.48(/ms)}ASSIGNED{ik(mA/cm2)oinftau(ms)}STATE{o}BREAKPOINT{SOLVEstateik=gkbar*o*(v-ek)}LOCALfacPROCEDUREstate(){rate(v,cai)o=o+fac*(oinf-o)VERBATIMreturn0;ENDVERBATIM}FUNCTIONalp(v(mV),ca(mM))(1/ms){alp=abar/(1+exp1(k1,d1,v)/ca)}FUNCTIONbet(v(mV),ca(mM))(1/ms){bet=bbar/(1+ca/exp1(k2,d2,v))}FUNCTIONexp1(k(mM),d,v(mV))(mM){exp1=k*exp(-2*d*FARADAY*v/R/(273.15+celsius))}PROCEDURErate(v(mV),ca(mM)){LOCALaa=alp(v,ca)tau=1/(a+bet(v,ca))oinf=a*taufac=(1-exp(-dt/tau))}