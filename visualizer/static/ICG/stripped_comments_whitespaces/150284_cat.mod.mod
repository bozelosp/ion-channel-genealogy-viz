UNITS{(mV)=(millivolt)(mA)=(milliamp)(S)=(siemens)(molar)=(1/liter)(mM)=(millimolar)FARADAY=(faraday)(coulomb)R=(k-mole)(joule/degC)}NEURON{SUFFIXcatUSEIONcaREADcai,caoWRITEicaRANGEpcatbar,ica}PARAMETER{pcatbar=7.6e-7(cm/s)mvhalf=-51.73(mV)mslope=-6.53(mV)mshift=0(mV)hvhalf=-80(mV)hslope=6.7(mV)hshift=0(mV)qfact=3}ASSIGNED{v(mV)ica(mA/cm2)eca(mV)celsius(degC)cai(mM)cao(mM)minfhinf}STATE{mh}BREAKPOINT{SOLVEstatesMETHODcnexpica=ghk(v,cai,cao)*pcatbar*m*m*m*h}INITIAL{settables(v)m=minfh=hinf}DERIVATIVEstates{settables(v)m'=(minf-m)/(mtau(v)/qfact)h'=(hinf-h)/(htau(v)/qfact)}FUNCTION_TABLEmtau(v(mV))(ms)FUNCTION_TABLEhtau(v(mV))(ms)PROCEDUREsettables(v(mV)){TABLEminf,hinfDEPENDmshift,hshiftFROM-100TO100WITH201minf=1/(1+exp((v-mvhalf-mshift)/mslope))hinf=1/(1+exp((v-hvhalf-hshift)/hslope))}FUNCTIONghk(v(mV),ci(mM),co(mM))(.001coul/cm3){LOCALz,eci,ecoz=(1e-3)*2*FARADAY*v/(R*(celsius+273.15))eco=co*efun(z)eci=ci*efun(-z)ghk=(.001)*2*FARADAY*(eci-eco)}FUNCTIONefun(z){if(fabs(z)<1e-4){efun=1-z/2}else{efun=z/(exp(z)-1)}}