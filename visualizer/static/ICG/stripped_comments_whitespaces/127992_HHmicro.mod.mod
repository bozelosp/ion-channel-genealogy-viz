INDEPENDENT{tFROM0TO1WITH1(ms)}UNITS{(mA)=(milliamp)(mV)=(millivolt)(S)=(siemens)(pS)=(picosiemens)(um)=(micron)}NEURON{SUFFIXHHmicroUSEIONnaREADenaWRITEinaUSEIONkREADekWRITEikNONSPECIFIC_CURRENTilRANGEelRANGEgnabar,gkbar,gna,gk,glRANGEm0h0,m1h0,m2h0,m3h0,m0h1,m1h1,m2h1,m3h1RANGEn0,n1,n2,n3,n4RANGEgamma_na,gamma_kRANGENna,NkGLOBALm_inf,h_inf,n_inf,tau_m,tau_h,tau_nRANGEseedTHREADSAFE}PARAMETER{gnabar=0.0(S/cm2)gkbar=0.036(S/cm2)gl=0.0(S/cm2)el=-54.3(mV)gamma_na=10(pS)gamma_k=10(pS)seed=5061983}STATE{mhn}ASSIGNED{ina(mA/cm2)ik(mA/cm2)il(mA/cm2)gna(S/cm2)gk(S/cm2)ena(mV)ek(mV)dt(ms)area(um2)celsius(degC)v(mV)NnaNkm0h0m1h0m2h0m3h0m0h1m1h1m2h1m3h1n1n2n3n4n5m_infh_infn_inftau_m(ms)tau_h(ms)tau_n(ms)}INITIAL{m=0h=0n=0Nna=ceil(((1e-8)*area)*(gnabar)/((1e-12)*gamma_na))Nk=ceil(((1e-8)*area)*(gkbar)/((1e-12)*gamma_k))VERBATIMENDVERBATIMm0h0=0m1h0=0m2h0=0m3h0=0m0h1=Nnam1h1=0m2h1=0m3h1=0n1=Nkn2=0n3=0n4=0n5=0set_seed(seed)}BREAKPOINT{SOLVEstatesMETHODcnexpgna=m3h1*((1e-12)*gamma_na)/((1e-8)*area)gk=n5*((1e-12)*gamma_k)/((1e-8)*area)ina=gna*(v-ena)ik=gk*(v-ek)il=gl*(v-el)}DERIVATIVEstates{UNITSOFFm'=mh'=hn'=nUNITSONnoise()}FUNCTIONvtrap(x,y){if(fabs(x/y)<1e-6){vtrap=y*(1-x/y/2)}else{vtrap=x/(exp(x/y)-1)}}FUNCTIONalpham(Vm(mV))(/ms){UNITSOFFalpham=.1*vtrap(-(Vm+40),10)UNITSON}FUNCTIONbetam(Vm(mV))(/ms){UNITSOFFbetam=4*exp(-(Vm+65)/18)UNITSON}FUNCTIONalphah(Vm(mV))(/ms){UNITSOFFalphah=.07*exp(-(Vm+65)/20)UNITSON}FUNCTIONbetah(Vm(mV))(/ms){UNITSOFFbetah=1/(exp(-(Vm+35)/10)+1)UNITSON}FUNCTIONalphan(Vm(mV))(/ms){UNITSOFFalphan=.01*vtrap(-(Vm+55),10)UNITSON}FUNCTIONbetan(Vm(mV))(/ms){UNITSOFFbetan=.125*exp(-(Vm+65)/80)UNITSON}PROCEDUREnoise(){LOCALp,am,bm,ah,bh,an,bn,m0h0_merk,m1h0_merk,m2h0_merk,m3h0_merk,m0h1_merk,m1h1_merk,m2h1_merk,m3h1_merk,n1_merk,n2_merk,n3_merk,n4_merk,n5_merk,rnd,denam=alpham(v)bm=betam(v)ah=alphah(v)bh=betah(v)an=alphan(v)bn=betan(v)m0h0_merk=m0h0m1h0_merk=m1h0m2h0_merk=m2h0m3h0_merk=m3h0m0h1_merk=m0h1m1h1_merk=m1h1m2h1_merk=m2h1m3h1_merk=m3h1n1_merk=n1n2_merk=n2n3_merk=n3n4_merk=n4n5_merk=n5den=ah+3*amp=1-exp(-dt*den)FROMii=1TOm0h0_merk{if(scop_random()<=p){if(scop_random()<=ah/den){m0h0=m0h0-1m0h1=m0h1+1}else{m0h0=m0h0-1m1h0=m1h0+1}}}den=ah+2*am+bmp=1-exp(-dt*den)FROMii=1TOm1h0_merk{if(scop_random()<=p){rnd=scop_random()if(rnd<=ah/den){m1h0=m1h0-1m1h1=m1h1+1}elseif(rnd<=(ah+2*am)/den){m1h0=m1h0-1m2h0=m2h0+1}else{m1h0=m1h0-1m0h0=m0h0+1}}}den=ah+am+2*bmp=1-exp(-dt*den)FROMii=1TOm2h0_merk{if(scop_random()<=p){rnd=scop_random()if(rnd<=ah/den){m2h0=m2h0-1m2h1=m2h1+1}elseif(rnd<=(ah+am)/den){m2h0=m2h0-1m3h0=m3h0+1}else{m2h0=m2h0-1m1h0=m1h0+1}}}den=ah+3*bmp=1-exp(-dt*den)FROMii=1TOm3h0_merk{if(scop_random()<=p){rnd=scop_random()if(rnd<=ah/den){m3h0=m3h0-1m3h1=m3h1+1}else{m3h0=m3h0-1m2h0=m2h0+1}}}den=bh+3*amp=1-exp(-dt*den)FROMii=1TOm0h1_merk{if(scop_random()<=p){rnd=scop_random()if(rnd<=bh/den){m0h1=m0h1-1m0h0=m0h0+1}else{m0h1=m0h1-1m1h1=m1h1+1}}}den=bh+2*am+bmp=1-exp(-dt*den)FROMii=1TOm1h1_merk{if(scop_random()<=p){rnd=scop_random()if(rnd<=bh/den){m1h1=m1h1-1m1h0=m1h0+1}elseif(rnd<=(bh+2*am)/den){m1h1=m1h1-1m2h1=m2h1+1}else{m1h1=m1h1-1m0h1=m0h1+1}}}den=bh+am+2*bmp=1-exp(-dt*den)FROMii=1TOm2h1_merk{if(scop_random()<=p){rnd=scop_random()if(rnd<=bh/den){m2h1=m2h1-1m2h0=m2h0+1}elseif(rnd<=(bh+am)/den){m2h1=m2h1-1m3h1=m3h1+1}else{m2h1=m2h1-1m1h1=m1h1+1}}}den=bh+3*bmp=1-exp(-dt*den)FROMii=1TOm3h1_merk{if(scop_random()<=p){rnd=scop_random()if(rnd<=bh/den){m3h1=m3h1-1m3h0=m3h0+1}else{m3h1=m3h1-1m2h1=m2h1+1}}}den=4*anp=1-exp(-dt*den)FROMii=1TOn1_merk{if(scop_random()<=p){n1=n1-1n2=n2+1}}den=3*an+bnp=1-exp(-dt*den)FROMii=1TOn2_merk{if(scop_random()<=p){if(scop_random()<=3*an/den){n2=n2-1n3=n3+1}else{n2=n2-1n1=n1+1}}}den=2*an+2*bnp=1-exp(-dt*den)FROMii=1TOn3_merk{if(scop_random()<=p){if(scop_random()<=2*an/den){n3=n3-1n4=n4+1}else{n3=n3-1n2=n2+1}}}den=an+3*bnp=1-exp(-dt*den)FROMii=1TOn4_merk{if(scop_random()<=p){if(scop_random()<=an/den){n4=n4-1n5=n5+1}else{n4=n4-1n3=n3+1}}}den=4*bnp=1-exp(-dt*den)FROMii=1TOn5_merk{if(scop_random()<=p){n5=n5-1n4=n4+1}}}