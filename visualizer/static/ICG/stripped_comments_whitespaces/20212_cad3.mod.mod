INDEPENDENT{tFROM0TO1WITH1(ms)}NEURON{SUFFIXcad3USEIONcaREADica,caiWRITEcaiRANGEmGLOBALdepth,kt,kd,cainf,taur}UNITS{(molar)=(1/liter)(mM)=(millimolar)(um)=(micron)(mA)=(milliamp)(msM)=(msmM)FARADAY=(faraday)(coulomb)}PARAMETER{depth=.1(um)taur=200(ms)cainf=1e-8(mM)cai(mM)kt=1(mM/ms)kd=5e-4(mM)}STATE{m(mM)}INITIAL{m=cainf}ASSIGNED{ica(mA/cm2)drive_channel(mM/ms)drive_pump(mM/ms)}BREAKPOINT{SOLVEstateMETHODderivimplicit}DERIVATIVEstate{drive_channel=-(10000)*ica/(2*FARADAY*depth)if(drive_channel<=0.){drive_channel=0.}drive_pump=-kt*m/(m+kd)m'=drive_channel+drive_pump+(cainf-m)/taurcai=m}