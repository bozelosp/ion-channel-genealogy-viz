INDEPENDENT{tFROM0TO1WITH1(ms)}NEURON{SUFFIXiAHP2USEIONkREADekWRITEikUSEIONcaREADcaiRANGEgkbar,m_inf,tau_mGLOBALbeta,cacRANGEik}UNITS{(mA)=(milliamp)(mV)=(millivolt)(molar)=(1/liter)(mM)=(millimolar)}PARAMETER{v(mV)celsius(degC)dt(ms)ek(mV)cai(mM)gkbar=.03(mho/cm2)beta=0.03(1/ms)cac=0.025(mM)taumin=0.1(ms)}STATE{m}ASSIGNED{ik(mA/cm2)m_inftau_m(ms)tadj}BREAKPOINT{SOLVEstatesik=gkbar*m*m*(v-ek)}PROCEDUREstates(){evaluate_fct(v,cai)m=m+(1-exp(-dt/tau_m))*(m_inf-m)}UNITSOFFINITIAL{tadj=3^((celsius-22.0)/10)evaluate_fct(v,cai)m=m_inf}PROCEDUREevaluate_fct(v(mV),cai(mM)){LOCALcarcar=(cai/cac)^2m_inf=car/(1+car)tau_m=1/beta/(1+car)/tadjif(tau_m<taumin){tau_m=taumin}}UNITSON