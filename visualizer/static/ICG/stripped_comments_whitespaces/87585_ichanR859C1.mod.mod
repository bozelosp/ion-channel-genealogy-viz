UNITS{(mA)=(milliamp)(mV)=(millivolt)(uF)=(microfarad)(molar)=(1/liter)(nA)=(nanoamp)(mM)=(millimolar)(um)=(micron)(S)=(siemens)FARADAY=96520(coul)R=8.3134(joule/degC)}NEURON{SUFFIXichanR859C1USEIONnaREADenaWRITEinaUSEIONkREADekWRITEikRANGEgnat,gkfRANGEgnatbar,gkfbarRANGEgl,elRANGEminf,mtau,hinf,htau,sinf,stau,nfinf,nftau,inat,m,h,s}INDEPENDENT{tFROM0TO100WITH100(ms)}PARAMETER{celsius=6.3(degC)dt(ms)ena(mV)gnatbar=0.0(mho/cm2)ek(mV)gkfbar=1.0(mho/cm2)gl=0.0(mho/cm2)el(mV)}ASSIGNED{v(mV)gnat(mho/cm2)gkf(mho/cm2)ina(mA/cm2)ik(mA/cm2)il(mA/cm2)minfhinfsinfnfinfmtau(ms)htau(ms)stau(ms)nftau(ms)mexphexpsexpnfexp}STATE{mhsnf}BREAKPOINT{SOLVEstatesgnat=gnatbar*m*m*m*h*sina=gnat*(v-ena)gkf=gkfbar*nf*nf*nf*nfik=gkf*(v-ek)il=gl*(v-el)}UNITSOFFINITIAL{trates(v)m=minfh=hinfs=sinfnf=nfinfVERBATIMreturn0;ENDVERBATIM}PROCEDUREstates(){trates(v)m=m+mexp*(minf-m)h=h+hexp*(hinf-h)s=s+sexp*(sinf-s)nf=nf+nfexp*(nfinf-nf)VERBATIMreturn0;ENDVERBATIM}LOCALq10PROCEDURErates(v(mV)){LOCALalpha,beta,sumq10=3^((celsius-6.3)/10)minf=1/(1+exp(-(v+21.3)*3.5*0.03937))mtau=0.15hinf=1/(1+exp((v+41.9)/6.7))htau=23.12*exp(-0.5*((v+77.58)/43.92)^2)sinf=1/(1+exp((v+46.0)/6.6))stau=1000*(190.2*exp(-0.5*((v+90.4)/38.9)^2))alpha=-0.07*vtrap((v+65-47),-6)beta=0.264/exp((v+65-22)/40)sum=alpha+betanftau=1/sumnfinf=alpha/sum}PROCEDUREtrates(v(mV)){LOCALtincTABLEminf,mexp,hinf,hexp,sinf,sexp,nfinf,nfexp,mtau,htau,stau,nftauDEPENDdt,celsiusFROM-100TO100WITH200rates(v)tinc=-dt*q10mexp=1-exp(tinc/mtau)hexp=1-exp(tinc/htau)sexp=1-exp(tinc/stau)nfexp=1-exp(tinc/nftau)}FUNCTIONvtrap(x,y){if(fabs(x/y)<1e-6){vtrap=y*(1-x/y/2)}else{vtrap=x/(exp(x/y)-1)}}UNITSON