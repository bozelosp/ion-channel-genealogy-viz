INDEPENDENT{tFROM0TO1WITH1(ms)}NEURON{SUFFIXcarUSEIONcaREADcai,caoWRITEicaRANGEpbar,minf,taum,hinf,tauh,shift,shifthGLOBALqm,qh}UNITS{(molar)=(1/liter)(mV)=(millivolt)(mA)=(milliamp)(mM)=(millimolar)FARADAY=(faraday)(coulomb)R=(k-mole)(joule/degC)}PARAMETER{v(mV)celsius(degC)pbar=.4e-4(cm/s)shift=2(mV)shifth=0(mV)cai(mM)cao(mM)qm=1qh=1}STATE{mh}ASSIGNED{ica(mA/cm2)minftaum(ms)hinftauh(ms)phimphih}BREAKPOINT{SOLVEcastateMETHODcnexpica=pbar*m*m*h*ghk(v,cai,cao)}DERIVATIVEcastate{evaluatefct(v)m'=(minf-m)/taumh'=(hinf-h)/tauh}UNITSOFFINITIAL{phim=qm^((celsius-24)/10)phih=qh^((celsius-24)/10)evaluatefct(v)m=minfh=hinf}PROCEDUREevaluatefct(v(mV)){minf=1/(1+exp(-(v+shift+23)/7.4))hinf=1/(1+exp((v+shifth+79)/7.8))taum=(5.5/(cosh(0.032*(v+shift+23))))/phimtauh=(771/(cosh(0.047*(v+shifth+79))))/phih}FUNCTIONghk(v(mV),ci(mM),co(mM))(.001coul/cm3){LOCALz,eci,ecoz=(1e-3)*2*FARADAY*v/(R*(celsius+273.15))eco=co*efun(z)eci=ci*efun(-z)ghk=(.001)*2*FARADAY*(eci-eco)}FUNCTIONefun(z){if(fabs(z)<1e-4){efun=1-z/2}else{efun=z/(exp(z)-1)}}FUNCTIONnongat(v,cai,cao){nongat=pbar*ghk(v,cai,cao)}UNITSON