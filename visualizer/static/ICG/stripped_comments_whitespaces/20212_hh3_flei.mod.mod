NEURON{SUFFIXhh3_fleiUSEIONnaREADenaWRITEinaUSEIONkREADekWRITEikNONSPECIFIC_CURRENTilRANGEgnabar,gkbar,gl,elRANGEb_iGLOBALWRANGEinf,tau}UNITS{(mA)=(milliamp)(mV)=(millivolt)}INDEPENDENT{tFROM0TO1WITH1(ms)}PARAMETER{v(mV)celsius=37(degC)dt(ms)gnabar=0.0(mho/cm2)gkbar=.12(mho/cm2)gl=0.0(mho/cm2)ena=40(mV)ek=-100(mV)el=-70.0(mV)W=0.016(/mV)b_i=0.2}STATE{mhns}ASSIGNED{ina(mA/cm2)ik(mA/cm2)il(mA/cm2)inf[4]tau[4]}LOCALfac[4]BREAKPOINT{SOLVEstatesina=gnabar*m*m*h*s*(v-ena)ik=gkbar*n*n*(v-ek)il=gl*(v-el)}INITIAL{states()m=inf[0]h=inf[1]n=inf[2]s=inf[3]}PROCEDUREstates(){mhn(v*1(/mV))m=m+fac[0]*(inf[0]-m)h=h+fac[1]*(inf[1]-h)n=n+fac[2]*(inf[2]-n)s=s+fac[3]*(inf[3]-s)VERBATIMreturn0;ENDVERBATIM}UNITSOFFFUNCTIONexpM1(x,y){if(fabs(x/y)<1e-6){expM1=y*(1-x/2)}else{expM1=x/(exp(x/y)-1)}}FUNCTIONvarss(v,i){if(i==0){varss=1/(1+exp((v+40)/(-3)))}elseif(i==1){varss=1/(1+exp((v+45)/(3)))}elseif(i==2){varss=1/(1+exp((v+40)/(-3)))}else{varss=0.5}}FUNCTIONvartau(v,i){LOCALalpha,beta,sumif(i==0){vartau=0.05}elseif(i==1){vartau=0.5}elseif(i==2){vartau=2}else{alpha=4e-4*exp(9.6*(v+60)*W)beta=4e-4*exp(-2.4*(v+60)*W)sum=alpha+betaif((1/sum)<3.00){vartau=3.00}else{vartau=1/sum}printf("%f%f\n",v,vartau)}}PROCEDUREmhn(v){LOCALa,bTABLEinf,facDEPENDdt,celsiusFROM-100TO100WITH200FROMi=0TO3{tau[i]=vartau(v,i)inf[i]=varss(v,i)fac[i]=(1-exp(-dt/tau[i]))}}UNITSON