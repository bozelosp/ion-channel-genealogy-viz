NEURON{SUFFIXKcUSEIONkREADekWRITEikUSEIONcaREADcaiRANGEgbar,g,iGLOBALVm}UNITS{(S)=(siemens)(mA)=(milliamp)(mV)=(millivolt)(molar)=(1/liter)(mM)=(millimolar)}PARAMETER{gbar=1.0(S/cm2)Vm=-65(mV)}ASSIGNED{v(mV)ek(mV)cai(mM)ik(mA/cm2)i(mA/cm2)g(S/cm2)minfmtau(ms)}STATE{m}BREAKPOINT{SOLVEstatesMETHODcnexpif(cai/(250(mM))<1){g=gbar*m*cai/(250(mM))}else{g=gbar*m}i=g*(v-ek)ik=i}INITIAL{rates(v)m=minf}DERIVATIVEstates{rates(v)m'=(minf-m)/mtau}PROCEDURErates(v(mV)){LOCALalpham,betamTABLEminf,mtauFROM-100TO50WITH200UNITSOFFif(v-Vm<=50){alpham=exp((v-Vm-10)/11-(v-Vm-6.5)/27)/18.975betam=2*exp(-(v-Vm-6.5)/27)-alpham}else{alpham=2*exp(-(v-Vm-6.5)/27)betam=0}minf=alpham/(alpham+betam)mtau=1/(alpham+betam)UNITSON}