NEURON{SUFFIXcanUSEIONcaREADcai,ecaWRITEicaRANGEgcalbar,ica,poGLOBALhinf,minf,s_inf}UNITS{(mA)=(milliamp)(mV)=(millivolt)(molar)=(1/liter)(mM)=(millimolar)FARADAY=(faraday)(coulomb)R=(k-mole)(joule/degC)}PARAMETER{gcalbar=1.0(mho/cm2)ki=0.025(mM)zetam=-3.4zetah=2vhalfm=-21(mV)vhalfh=-40(mV)tm0=1.5(ms)th0=75(ms)taumin=2(ms)}ASSIGNED{v(mV)celsius(degC)ica(mA/cm2)pocai(mM)eca(mV)minfhinfs_inf}FUNCTIONh2(cai(mM)){h2=ki/(ki+cai)}STATE{mhs}INITIAL{rates(v,cai)m=minfh=hinfs=s_inf}BREAKPOINT{SOLVEstatesMETHODcnexppo=m*m*hica=gcalbar*po*h2(cai)*(v-eca)}FUNCTIONghk(v(mV),ci(mM),co(mM))(.001coul/cm3){LOCALz,eci,ecoz=(1e-3)*2*FARADAY*v/(R*(celsius+273.15))eco=co*efun(z)eci=ci*efun(-z)ghk=(.001)*2*FARADAY*(eci-eco)}FUNCTIONefun(z){if(fabs(z)<1e-4){efun=1-z/2}else{efun=z/(exp(z)-1)}}DERIVATIVEstates{rates(v,cai)m'=(minf-m)/tm0h'=(hinf-h)/th0s'=(s_inf-s)/taumin}PROCEDURErates(v(mV),cai(mM)){LOCALa,b,alpha2a=alpm(v)minf=1/(1+a)b=alph(v)hinf=1/(1+b)alpha2=(ki/cai)^2s_inf=alpha2/(alpha2+1)}FUNCTIONalpm(v(mV)){UNITSOFFalpm=exp(1.e-3*zetam*(v-vhalfm)*9.648e4/(8.315*(273.16+celsius)))UNITSON}FUNCTIONalph(v(mV)){UNITSOFFalph=exp(1.e-3*zetah*(v-vhalfh)*9.648e4/(8.315*(273.16+celsius)))UNITSON}