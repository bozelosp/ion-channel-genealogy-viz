NEURON{SUFFIXsKCaUSEIONcaREADcaiUSEIONkREADki,ekWRITEikRANGEgk,isKCaGLOBALsKCatau,activate_Q10,Q10,gmaxQ10,rate_k,gmax_k,temp1,temp2,tempb}UNITS{(mM)=(milli/liter)(mA)=(milliamp)F=(faraday)(coulombs)}PARAMETER{v(mV)dt(ms)gk=0.0001(mho/cm2)sKCatau=2.365325544e+01(ms)kicelsiusactivate_Q10=1Q10=1.5gmaxQ10=1.5temp1=19.0(degC)temp2=29.0(degC)tempb=23.0(degC)}ASSIGNED{ek(mV)cai(mM)ica(mA/cm2)ik(mA/cm2)winfwtau(ms)rate_kgmax_k}STATE{w}BREAKPOINT{SOLVEintegrateMETHODcnexpik=(gk*gmax_k)*w*(v-ek)}UNITSOFFINITIAL{LOCALktemp,ktempb,ktemp1,ktemp2if(activate_Q10>0){rate_k=Q10^((celsius-tempb)/10)gmax_k=gmaxQ10^((celsius-tempb)/10)}else{rate_k=1.0gmax_k=1.0}setinf(cai)w=winf}DERIVATIVEintegrate{setinf(cai)w'=(winf-w)/wtau}PROCEDUREsetinf(cai){LOCALwcaiwcai=cai*1000winf=0.81/(1+exp((llog(wcai)+0.3)/-0.46))wtau=sKCatau/rate_k}FUNCTIONllog(x){if(x>1e-11){llog=log(x)}else{llog=0}}UNITSON