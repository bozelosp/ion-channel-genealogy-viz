NEURON{THREADSAFESUFFIXwrapGLOBALINSTALLEDGLOBALverbose}PARAMETER{INSTALLED=0verbose=0}VERBATIM#include<math.h>#include<stdlib.h>double*wrap(double*x,intn,intflen){double*y=(double*)calloc(n,sizeof(double));inti,j=0;for(i=flen/2+1;i<flen;i++)y[j++]=x[i];j=n-flen/2-1;for(i=0;i<=flen/2;i++)y[j++]=x[i];returny;}voidwraparound(void*vv){double*x,*y;intvsz,fsz,i;vsz=vector_instance_px(vv,&x);fsz=(int)*getarg(1);if(fsz>vsz){printf("wraparoundERRA:invalidfilterlen%d>vectorlen%d!\n",fsz,vsz);return;}y=wrap(x,vsz,fsz);for(i=0;i<vsz;i++)x[i]=y[i];free(y);}ENDVERBATIMPROCEDUREinstall(){if(INSTALLED==1){printf("alreadyinstalledwrap.mod")}else{INSTALLED=1VERBATIMinstall_vector_method("wraparound",wraparound);ENDVERBATIM}}