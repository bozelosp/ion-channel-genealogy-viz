NEURON{SUFFIXnaxDAUSEIONnaREADenaWRITEinaRANGEgbarGLOBALminf,hinf,mtau,htau,thinf,qinf}PARAMETER{tone_period=6000DA_period=2000DA_start=96000DA_t1=-0.3DA_period2=200DA_start2=54001DA_t2=-0.9gbar=0.010(mho/cm2)tha=-30(mV)qa=7.2(mV)Ra=0.4(/ms)Rb=0.124(/ms)thi1=-45(mV)thi2=-45(mV)qd=1.5(mV)qg=1.5(mV)mmin=0.02hmin=0.5q10=2Rg=0.01(/ms)Rd=.03(/ms)thinf=-50(mV)qinf=4(mV)ena(mV)celsius(degC)v(mV)}UNITS{(mA)=(milliamp)(mV)=(millivolt)(pS)=(picosiemens)(um)=(micron)}ASSIGNED{ina(mA/cm2)thegna(mho/cm2)minfhinfmtau(ms)htau(ms)tha1}STATE{mh}BREAKPOINT{SOLVEstatesMETHODcnexpthegna=gbar*m*m*m*hina=thegna*(v-ena)}INITIAL{trates(v)m=minfh=hinf}DERIVATIVEstates{trates(v)m'=(minf-m)/mtauh'=(hinf-h)/htau}PROCEDUREtrates(vm){LOCALa,b,qtqt=q10^((celsius-24)/10)tha1=tha+DA1(t)+DA2(t)a=trap0(vm,tha1,Ra,qa)b=trap0(-vm,-tha1,Rb,qa)mtau=1/(a+b)/qtif(mtau<mmin){mtau=mmin}minf=a/(a+b)a=trap0(vm,thi1,Rd,qd)b=trap0(-vm,-thi2,Rg,qg)htau=1/(a+b)/qtif(htau<hmin){htau=hmin}hinf=1/(1+exp((vm-thinf)/qinf))}FUNCTIONtrap0(v,th,a,q){if(fabs(v-th)>1e-6){trap0=a*(v-th)/(1-exp(-(v-th)/q))}else{trap0=a*q}}FUNCTIONDA1(t){if(t>DA_start&&(t/tone_period-floor(t/tone_period))>=(1-DA_period/tone_period)){DA1=DA_t1}elseif(t>DA_start&&(t/tone_period-floor(t/tone_period))==0){DA1=DA_t1}else{DA1=0}}FUNCTIONDA2(t){if(t>DA_start2&&(t/tone_period-floor(t/tone_period))>=(1-DA_period2/tone_period)){DA2=DA_t2}elseif(t>DA_start2&&(t/tone_period-floor(t/tone_period))==0){DA2=DA_t2}else{DA2=0}}