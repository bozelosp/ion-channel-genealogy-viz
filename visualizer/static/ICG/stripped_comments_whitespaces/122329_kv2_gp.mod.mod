NEURON{SUFFIXkv2_gpUSEIONkREADekWRITEikRANGEg,ik,an,bn,gbarGLOBALa0,a1,ah,ac,b0,bc,Cq10}UNITS{(mV)=(millivolt)(mA)=(milliamp)(S)=(siemens)}PARAMETER{gbar=1(S/cm2)celsius(degC)Cq10=3a0=100.74(1/ms)a1=0.612(1/ms-mV)ah=-84.51(mV)ac=-11.84(mV)b0=0.0051(1/ms)bc=22.02(mV)}ASSIGNED{v(mV)ek(mV)g(S/cm2)ik(mA/cm2)an(1/ms)bn(1/ms)kf1(1/ms)kb1(1/ms)kf2(1/ms)kb2(1/ms)kf3(1/ms)kb3(1/ms)kf4(1/ms)kb4(1/ms)}STATE{c1c2c3c4o}BREAKPOINT{SOLVEkinMETHODsparseg=gbar*oik=g*(v-ek)}INITIAL{SOLVEkinSTEADYSTATEsparse}KINETICkin{rates(v)~c4<->c3(kf1,kb1)~c3<->c2(kf2,kb2)~c2<->c1(kf3,kb3)~c1<->o(kf4,kb4)CONSERVEc4+c3+c2+c1+o=1}PROCEDURErates(v(mV)){LOCALq10q10=Cq10^((celsius-22(degC))/10(degC))an=q10*(a0-a1*v)/(exp((ah+v)/ac)-1)bn=q10*(b0)/(exp(v/bc))kf1=4*ankb1=bnkf2=3*ankb2=2*bnkf3=2*ankb3=3*bnkf4=ankb4=4*bn}