NEURON{SUFFIXKDRIUSEIONkREADekWRITEikRANGEgkbar,ikGLOBALinf}UNITS{(mA)=(milliamp)(mV)=(millivolt)}INDEPENDENT{tFROM0TO1WITH1(ms)}PARAMETER{v(mV)dt(ms)gkbar=1.0(mho/cm2)<0,1e9>ek=-84(mV)celsius=6.3(degC)}STATE{nh}ASSIGNED{ik(mA/cm2)inf[2]}LOCALfac[2]INITIAL{rate(v*1(/mV))n=inf[0]h=inf[1]}BREAKPOINT{SOLVEstatesik=gkbar*n*n*n*n*h*(v-ek)}PROCEDUREstates(){rate(v*1(/mV))n=n+fac[0]*(inf[0]-n)h=h+fac[1]*(inf[1]-h)VERBATIMreturn0;ENDVERBATIM}UNITSOFFFUNCTIONalp(v(mV),i){LOCALa,b,c,q10v=vq10=3^((celsius-6.3)/10)if(i==0){alp=q10*1*.035*expM1(-v-15,9)}elseif(i==1){alp=q10*0.0083*(1/(exp((v+20)/10)+1)+1)}}FUNCTIONbet(v,i){LOCALa,b,c,q10v=vq10=3^((celsius-6.3)/10)if(i==0){bet=q10*1*.014*exp((-v+12)/46)}elseif(i==1){bet=q10*0.0083/(exp((-v-20)/10)+1)}}FUNCTIONexpM1(x,y){if(fabs(x/y)<1e-6){expM1=y*(1-x/y/2)}else{expM1=x/(exp(x/y)-1)}}PROCEDURErate(v){LOCALa,b,tauTABLEinf,facDEPENDdt,celsiusFROM-160TO100WITH200FROMi=0TO1{a=alp(v,i)b=bet(v,i)tau=1/(a+b)inf[i]=a/(a+b)fac[i]=(1-exp(-dt/tau))}}UNITSON