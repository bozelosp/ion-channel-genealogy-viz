INDEPENDENT{tFROM0TO1WITH1(ms)}NEURON{SUFFIXiHUSEIONhREADehWRITEihVALENCE1USEIONcaREADcaiRANGEghbar,tau_s,tau_f,tau_c,ihGLOBALcac}UNITS{(mA)=(milliamp)(mV)=(millivolt)(molar)=(1/liter)(mM)=(millimolar)}PARAMETER{v(mV)cai(mM)celsius(degC)eh=-43(mV)ghbar=4e-6(mho/cm2)cac=5e-4(mM)}STATE{s1s2f1f2}ASSIGNED{ih(mA/cm2)h_inftau_s(ms)tau_f(ms)tau_c(ms)alpha_s(1/ms)alpha_f(1/ms)beta_s(1/ms)beta_f(1/ms)Ck2(1/ms)tadjs0f0}BREAKPOINT{SOLVEstatesMETHODderivimplicitih=ghbar*(s1+s2)*(f1+f2)*(v-eh)}UNITSOFFDERIVATIVEstates{evaluate_fct(v,cai)s1'=alpha_s*s0-beta_s*s1+k2*(s2-C*s1)f1'=alpha_f*f0-beta_f*f1+k2*(f2-C*f1)s2'=-k2*(s2-C*s1)f2'=-k2*(f2-C*f1)s0=1-s1-s2f0=1-f1-f2}INITIAL{tadj=3^((celsius-35.5)/10)evaluate_fct(v,cai)s1=alpha_s/(beta_s+alpha_s*(1+C))s2=alpha_s*C/(beta_s+alpha_s*(1+C))s0=1-s1-s2f1=alpha_f/(beta_f+alpha_f*(1+C))f2=alpha_f*C/(beta_f+alpha_f*(1+C))f0=1-f1-f2tau_c=1/(1+C)/k2}PROCEDUREevaluate_fct(v(mV),cai(mM)){h_inf=1/(1+exp((v+68.9)/6.5))tau_s=exp((v+183.6)/15.24)/tadjtau_f=exp((v+158.6)/11.2)/(1+exp((v+75)/5.5))/tadjalpha_s=h_inf/tau_salpha_f=h_inf/tau_fbeta_s=(1-h_inf)/tau_sbeta_f=(1-h_inf)/tau_fC=cai*cai/(cac*cac)k2=4e-4*tadj}UNITSON