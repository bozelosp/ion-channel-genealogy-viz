NEURON{SUFFIXKahpUSEIONkREADekWRITEikUSEIONcaREADcaiRANGEgbar,g,i}UNITS{(mV)=(millivolt)(mA)=(milliamp)(molar)=(1/liter)(mM)=(millimolar)}PARAMETER{gbar=1.0(S/cm2)}ASSIGNED{v(mV)cai(mM)ek(mV)ik(mA/cm2)i(mA/cm2)g(S/cm2)minfmtau(ms)}STATE{m}BREAKPOINT{SOLVEstatesMETHODcnexpg=gbar*mi=g*(v-ek)ik=i}INITIAL{rates(v,cai)m=minf}DERIVATIVEstates{rates(v,cai)m'=(minf-m)/mtau}PROCEDURErates(v(mV),ca(mM)){LOCALa,alpham,betamUNITSOFFa=0.2*1e-4*caif(a<0.01){alpham=a}else{alpham=0.01}betam=0.001minf=alpham/(alpham+betam)mtau=1/(alpham+betam)UNITSON}