INDEPENDENT{tFROM0TO1WITH1(ms)}NEURON{SUFFIXit2USEIONcaREADcai,caoWRITEicaRANGEgcabar,gGLOBALm_inf,tau_m,h_inf,tau_h,shift2,sm,sh,phi_m,phi_h,hx,mx,shift1}UNITS{(molar)=(1/liter)(mV)=(millivolt)(mA)=(milliamp)(mM)=(millimolar)FARADAY=(faraday)(coulomb)R=(k-mole)(joule/degC)}PARAMETER{v(mV)celsius=36(degC)gcabar=8.5e-6(mho/cm2)hx=1.5mx=3.0cai=5e-5(mM)cao=2(mM)minf1=46.2hinf1=69.7taum1=5.4taum2=125.7taum3=-19.7taum4=-0.54taum5=13tauh1=21tauh2=22.2tauh3=9.1tauh4=362.9tauh5=46.9sm=8.7sh=6.4shift1=-8(mV)shift2=0(mV)}STATE{mh}ASSIGNED{ica(mA/cm2)g(mho/cm2)carev(mV)m_inftau_m(ms)h_inftau_h(ms)phi_mphi_h}BREAKPOINT{SOLVEcastateMETHODcnexpg=gcabar*m*m*hica=g*ghk(v,cai,cao)}DERIVATIVEcastate{evaluate_fct(v)m'=(m_inf-m)/tau_mh'=(h_inf-h)/tau_h}UNITSOFFINITIAL{VERBATIMcai=_ion_cai;cao=_ion_cao;ENDVERBATIMphi_m=mx^((celsius-23.5)/10)phi_h=hx^((celsius-23.5)/10)evaluate_fct(v)m=m_infh=h_inf}PROCEDUREevaluate_fct(v(mV)){m_inf=1.0/(1+exp(-(v+shift1+minf1)/sm))h_inf=1.0/(1+exp((v+shift2+hinf1)/sh))tau_m=(taum1+1.0/(exp((v+shift1+taum2)/(taum3))+exp((v+shift1+taum4)/taum5)))/phi_mtau_h=(tauh1+1/(exp((v+shift2+tauh2)/tauh3)+exp(-(v+shift2+tauh4)/tauh5)))/phi_h}FUNCTIONghk(v(mV),Ci(mM),Co(mM))(.001coul/cm3){LOCALz,eci,ecoz=(1e-3)*2*FARADAY*v/(R*(celsius+273.15))eco=Co*efun(z)eci=Ci*efun(-z)ghk=(.001)*2*FARADAY*(eci-eco)}FUNCTIONefun(z){if(fabs(z)<1e-4){efun=1-z/2}else{efun=z/(exp(z)-1)}}UNITSON