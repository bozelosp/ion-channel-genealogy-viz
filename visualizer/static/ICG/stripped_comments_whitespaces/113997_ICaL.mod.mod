NEURON{SUFFIXiLUSEIONcaREADcai,caoWRITEicaRANGEpca,minf,mtau}UNITS{(mA)=(milliamp)(mV)=(millivolt)(mM)=(milli/liter)}PARAMETER{v(mV)celsius(degC)cai(mM)cao(mM)pca=2.76e-4(cm/s)}STATE{m}ASSIGNED{ica(mA/cm2)mtau(ms)minftadj}BREAKPOINT{SOLVEstatesMETHODcnexpica=pca*m^2*nrn_ghk(v,cai,cao,2)}DERIVATIVEstates{rates()m'=(minf-m)/mtau}INITIAL{tadj=3^((celsius-23.5)/10)rates()m=minf}PROCEDURErates(){LOCALa,bUNITSOFFa=1.6/(1+exp(-0.072*(v-5)))b=0.02*vtrap(-(v-1.31),5.36)mtau=1/(a+b)/tadjminf=1/(1+exp((v+10)/-10))}FUNCTIONvtrap(x,c){if(fabs(x/c)<1e-6){vtrap=c+x/2}else{vtrap=x/(1-exp(-x/c))}}