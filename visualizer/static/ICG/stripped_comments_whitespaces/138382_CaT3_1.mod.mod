INDEPENDENT{tFROM0TO1WITH1(ms)}NEURON{SUFFIXCaT3_1USEIONcaREADcai,caoWRITEicaVALENCE2RANGEg,pcabar,minf,taum,hinf,tauhRANGEica,m,h}UNITS{(molar)=(1/liter)(mV)=(millivolt)(mA)=(milliamp)(mM)=(millimolar)}CONSTANT{F=9.6485e4(coulombs)R=8.3145(joule/kelvin)}PARAMETER{v(mV)celsius(degC)eca(mV)pcabar=2.5e-4(cm/s)cai(mM)cao(mM)v0_m_inf=-52(mV)v0_h_inf=-72(mV)k_m_inf=-5(mV)k_h_inf=7(mV)C_tau_m=1A_tau_m=1.0v0_tau_m1=-40(mV)v0_tau_m2=-102(mV)k_tau_m1=9(mV)k_tau_m2=-18(mV)C_tau_h=15A_tau_h=1.0v0_tau_h1=-32(mV)k_tau_h1=7(mV)}STATE{mh}ASSIGNED{ica(mA/cm2)g(coulombs/cm3)minftaum(ms)hinftauh(ms)T(kelvin)E(volt)zeta}BREAKPOINT{SOLVEcastateMETHODcnexpica=(1e3)*pcabar*m*m*h*g}DERIVATIVEcastate{evaluate_fct(v)m'=(minf-m)/taumh'=(hinf-h)/tauh}FUNCTIONghk(v(mV),ci(mM),co(mM),z)(coulombs/cm3){E=(1e-3)*vzeta=(z*F*E)/(R*T)if(fabs(1-exp(-zeta))<1e-6){ghk=(1e-6)*(z*F)*(ci-co*exp(-zeta))*(1+zeta/2)}else{ghk=(1e-6)*(z*zeta*F)*(ci-co*exp(-zeta))/(1-exp(-zeta))}}UNITSOFFINITIAL{T=kelvinfkt(celsius)evaluate_fct(v)m=minfh=hinf}PROCEDUREevaluate_fct(v(mV)){minf=1.0/(1+exp((v-v0_m_inf)/k_m_inf))hinf=1.0/(1+exp((v-v0_h_inf)/k_h_inf))if(v<=-90){taum=1}else{taum=(C_tau_m+A_tau_m/(exp((v-v0_tau_m1)/k_tau_m1)+exp((v-v0_tau_m2)/k_tau_m2)))}tauh=(C_tau_h+A_tau_h/exp((v-v0_tau_h1)/k_tau_h1))g=ghk(v,cai,cao,2)}FUNCTIONkelvinfkt(t(degC))(kelvin){kelvinfkt=273.19+t}UNITSON