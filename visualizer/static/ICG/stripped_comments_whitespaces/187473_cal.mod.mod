UNITS{(mA)=(milliamp)(mV)=(millivolt)F=(faraday)(coulomb)R=(k-mole)(joule/degC)TEMP=25(degC)}PARAMETER{v(mV)celsius(degC)gcalbar=.003(mho/cm2)ki=.001(mM)ca0=.00007(mM)cao=2(mM)tfa=1}NEURON{SUFFIXcalUSEIONcaREADecaWRITEicaRANGEgcalbar,gcal,mGLOBALminf,tau,eca}STATE{mca_i(mM)}ASSIGNED{ica(mA/cm2)gcal(mho/cm2)minftau(ms)eca(mV)}INITIAL{ca_i=ca0rate(v)m=minf}BREAKPOINT{SOLVEstateMETHODcnexpgcal=gcalbar*m*mica=gcal*(v-eca)}FUNCTIONefun(z){if(fabs(z)<1e-4){efun=1-z/2}else{efun=z/(exp(z)-1)}}FUNCTIONalp(v(mV))(1/ms){TABLEFROM-150TO150WITH200alp=15.69*(-1.0*v+81.5)/(exp((-1.0*v+81.5)/10.0)-1.0)}FUNCTIONbet(v(mV))(1/ms){TABLEFROM-150TO150WITH200bet=0.29*exp(-v/10.86)}DERIVATIVEstate{rate(v)m'=(minf-m)/tau}PROCEDURErate(v(mV)){LOCALaa=alp(v)tau=1/(tfa*(a+bet(v)))minf=tfa*a*tau}