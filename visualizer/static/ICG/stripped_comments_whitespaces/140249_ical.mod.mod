INDEPENDENT{tFROM0TO1WITH1(ms)}NEURON{SUFFIXicalUSEIONcaREADcai,caoWRITEicaRANGEpcabar,gGLOBALm_inf,taum,sh1,sh2}UNITS{(mA)=(milliamp)(mV)=(millivolt)(molar)=(1/liter)(mM)=(millimolar)FARADAY=(faraday)(coulomb)R=(k-mole)(joule/degC)}PARAMETER{v(mV)celsius=36(degC)eca=120(mV)cai=.00005(mM)cao=2(mM)pcabar=9e-4(mho/cm2)sh1=-17sh2=-7}STATE{m}INITIAL{tadj=3^((celsius-21.0)/10)evaluate_fct(v)m=m_inf}ASSIGNED{ica(mA/cm2)g(mho/cm2)m_inftaum(ms)tadj}BREAKPOINT{SOLVEstatesMETHODcnexpg=pcabar*m*mica=g*ghk(v,cai,cao)}DERIVATIVEstates{evaluate_fct(v)m'=(m_inf-m)/taum}UNITSOFFPROCEDUREevaluate_fct(v(mV)){LOCALa,ba=1.6/(1+exp(-0.072*(v+sh1+5)))b=0.02*(v+sh2-1.31)/(exp((v+sh2-1.31)/5.36)-1)taum=1.0/(a+b)/tadjm_inf=a/(a+b)}FUNCTIONghk(v(mV),ci(mM),co(mM))(.001coul/cm3){LOCALz,eci,ecoz=(1e-3)*2*FARADAY*v/(R*(celsius+273.15))eco=co*efun(z)eci=ci*efun(-z)ghk=(.001)*2*FARADAY*(eci-eco)}FUNCTIONefun(z){if(fabs(z)<1e-4){efun=1-z/2}else{efun=z/(exp(z)-1)}}UNITSON