NEURON{ARTIFICIAL_CELLINTFRANGEVAM,VNM,VGA,VGB,AHPRANGEtauAM,tauNM,tauGA,tauGB,tauahp,ahpwtRANGEVGBdel,tGB,VGBa,rebound,offsetGBRANGERMP,VTH,Vm,Vblock,refractoryRANGEtaum,myinvl,oinvl,WINV,invltRANGEt0,tg,tGB,refracRANGEnbur,tbur,cburPOINTERsopGLOBALAMdec,NMdec,GAdec,GBdecGLOBALvdt,next,WEX,mg,RES,ESIN,BbGLOBALtauGBGP,wGBGP,GPkd,GnGLOBALEAM,ENM,EGA,EGB,spkhtGLOBALprnum}PARAMETER{tauAM=10(ms)tauNM=300(ms)tauGA=10(ms)tauGB=300(ms)tauGBGP=50(ms)taum=10(ms)myinvl=100(ms)WINV=0wGBGP=1(ms)GPkd=100ahpwt=0tauahp=10(ms)refrac=5(ms)VTH=-45Vblock=-20vdt=0.1mg=1sop=0AMdec=1NMdec=1GAdec=1GBdec=1nbur=1tbur=2VGBdel=30rebound=0.01offsetGB=0RMP=-65EAM=65ENM=90EGA=-15EGB=-30spkht=50prnum=-1}ASSIGNED{VAMVNMVGAVGBVGBaAHPt0(ms)tGB(ms)tg(ms)refractorynextWEXRESESINGnBbcburVminvltoinvl}CONSTRUCTOR{VERBATIM{intlid,lty;if(ifarg(2)){lid=(int)*getarg(2);}else{lid=UINT_MAX;}if(ifarg(3)){lty=(int)*getarg(3);}else{lty=-1;}IDP=(id0*)hoc_Ecalloc(1,sizeof(id0));hoc_malchk();ip=IDP;ip->id=lid;ip->type=lty;ip->invl=ip->record=ip->jitter=ip->input=0;ip->rve=-1;}ENDVERBATIM}DESTRUCTOR{VERBATIM{free(IDP);}ENDVERBATIM}INITIAL{VAM=0VNM=0VGA=0VGB=0VGBa=0t0=ttGB=ttg=0offsetGB=0AHP=0invlt=-1VERBATIMjtpt=0;errflag=0;ENDVERBATIMrefractory=0if(vinflag()){randspk()net_send(next,2)}if(recflag()){recini()}}NET_RECEIVE(wAM,wNM,wGA,wGB,wflg){LOCALtmp,rflg,wrec,id,jflg,iflg,invlflg,tyINITIAL{wNM=wNMwGA=wGAwGB=wGBwflg=0}VERBATIMip=IDP;_lrflg=(double)ip->record;_ljflg=(double)ip->jitter;_liflg=(double)ip->input;_linvlflg=(double)ip->invl;_lwrec=(double)ip->wrec;_lid=(double)ip->id;_lty=(double)ip->type;ENDVERBATIMif(flag==4){cbur=cbur-1if(cbur>0){net_send(tbur,4)}else{net_send(refrac-AHP/10,3)}if(jflg){tmp=t+jitter()/10}else{tmp=t}net_event(tmp)if(rflg){recspk(tmp)}if(wrec){wrecord(tmp,-1,0)}}elseif(flag==0&&wGB==0&&wflg==1){VERBATIMip->input=1;ENDVERBATIMiflg=1wflg=2randspk()net_send(next,2)}elseif(flag==0&&wGB==0&&wflg==2){VERBATIMip->input=0;ENDVERBATIMiflg=0wflg=1}else{if(rflg){record()}if(VAM>hoc_epsilon){VAM=VAM*EXP(-(t-t0)/tauAM)}else{VAM=0}if(VNM>hoc_epsilon){VNM=VNM*EXP(-(t-t0)/tauNM)}else{VNM=0}if(VGA<-hoc_epsilon){VGA=VGA*EXP(-(t-t0)/tauGA)}else{VGA=0}VGB=esinr(t-tGB)if(AHP<-hoc_epsilon){AHP=AHP*EXP(-(t-t0)/tauahp)}else{AHP=0}Vm=VAM+VNM+VGA+VGB+AHPif(flag==0){if(wAM>0&&VAM<EAM){tmp=wAM*(1-Vm/EAM)VAM=VAM+tmpif(wrec){wrecord(t,0,tmp)}}if(wNM>0&&VNM<ENM){rates(RMP+Vm)tmp=wNM*Bb*(1-Vm/ENM)VNM=VNM+tmpif(wrec){wrecord(t,1,tmp)}}if(VNM>1.2*ENM){pid()printf("****ERR}if(wGA>0&&VGA>EGA){tmp=wGA*(1-Vm/EGA)VGA=VGA-tmpif(wrec){wrecord(t,2,tmp)}}if(wGB>0){net_send(VGBdel,5)}if(invlflg){Vm=RMP+VAM+VNM+VGA+VGB+AHPif(invlt==-1){if(Vm>RMP){oinvl=myinvlinvlt=tnet_send(myinvl,1)}}else{tmp=shift(Vm)if(tmp!=0){net_move(tmp)if(id()<prnum){pid()printf("****MOVEt=%gto%gVm=%g%g,%g\n",t,tmp,Vm,invlt,oinvl)}}}}}elseif(flag==5){offsetGB=VGBwflg=wflg*EXP(-(t-tGB)/tauGBGP)+wGBGPcoop(wflg)if(VGB>EGB){tmp=wGB*(1-Vm/EGB)*GnVGB=VGB-tmpif(wrec){wrecord(t,3,tmp)}}VGBa=VGBtGB=t}elseif(flag==2){if(iflg==0){flag=-1}else{randspk()net_send(next,2)if(WEX<0){net_event(t)if(rflg){recspk(t)}if(wrec){wrecord(t,-1,0)}}else{tmp=WEX*(1-Vm/EAM)VAM=VAM+tmpif(wrec){wrecord(t,0,tmp)}}}}elseif(flag==1){if(WINV<0){net_event(t)if(rflg){recspk(t)}if(wrec){wrecord(t,-1,0)}}else{tmp=WINV*(1-Vm/EAM)VAM=VAM+tmpif(wrec){wrecord(t,0,tmp)}}oinvl=myinvlinvlt=tnet_send(myinvl,1)}elseif(flag==3){refractory=0}Vm=VAM+VNM+VGA+VGB+RMP+AHPif(refractory==0&&(Vm>VTH&&Vm<Vblock)){AHP=AHP-ahpwtif(jflg){tmp=t+jitter()}else{tmp=t}net_event(tmp)if(rflg){recspk(tmp)}if(wrec){wrecord(tmp,-2,0)}VAM=VAM*AMdecVNM=VNM*NMdecVGA=VGA*GAdecVGB=VGB*GBdecif(nbur>1){cbur=nbur-1net_send(tbur,4)}else{net_send(refrac-AHP/10,3)}refractory=1}t0=t}}PROCEDURErandspk(){VERBATIMip=IDP;if(ip->rvi>ip->rve){ip->input=0;}else{WEX=wsp[ip->rvi];next=vsp[ip->rvi++]-t;}ENDVERBATIM}VERBATIMdoubleval(doublexx,doubleta){vii[1]=VAM*EXP(-(xx-ta)/tauAM);vii[2]=VNM*EXP(-(xx-ta)/tauNM);vii[3]=VGA*EXP(-(xx-ta)/tauGA);vii[4]=esinr(xx-tGB);vii[5]=AHP*EXP(-(xx-ta)/tauahp);vii[6]=vii[1]+vii[2]+vii[3]+vii[4]+vii[5];}ENDVERBATIMPROCEDURErecord(){VERBATIM{intk;doubleti;vp=SOP;if(tg>=t)return;if(vp->p>=vp->size){if(errflag)return;printf("****WARNINGoutofrecordingroomforINTFtype%did%dat%g****\n",IDP->type,IDP->id,t);printf("****************WARNING:NofurtherWARNINGS****************\n");errflag=1;return;}for(ti=tg;ti<=t&&vp->p<vp->size;ti+=vdt,vp->p++){val(ti,tg);vp->vvo[0][vp->p]=ti;for(k=1;k<NSV;k++)if(vp->vvo[k]!=0){vp->vvo[k][vp->p]=vii[k]+RMP;}}tg=t;}ENDVERBATIM}PROCEDURErecspk(x){VERBATIM{intk;vp=SOP;record();if(vp->p>=vp->size||vp->vvo[6]==0)return;vp->vvo[0][vp->p-1]=_lx;vp->vvo[6][vp->p-1]=spkht;tg=_lx;}ENDVERBATIM}PROCEDURErecclr(){VERBATIM{intk;if(IDP->record){if(SOP!=nil){vp=SOP;vp->size=0;vp->p=0;for(k=0;k<NSV;k++){vp->vv[k]=nil;vp->vvo[k]=nil;}}elseprintf("INTFrecclrERR:nilpointer\n");}IDP->record=0;}ENDVERBATIM}PROCEDURErecfree(){VERBATIMif(SOP!=nil){free(SOP);SOP=nil;}elseprintf("INTFrecfreeERR:nilpointer\n");IDP->record=0;ENDVERBATIM}PROCEDUREinitvspks(){VERBATIM{intmax,i,err=0;double*iv,last;if(!ifarg(1)){printf("Returninitvspks(ivspks,vspks,wvspks)\n");return0.;}ip=IDP;i=vector_arg_px(1,&iv);max=vector_arg_px(2,&vsp);if(max!=i){err=1;printf("initvspksERR:vecsofdifferentsize\n");}if(max==0){err=1;printf("initvspksERR:vecnotinitialized\n");}max=vector_arg_px(3,&wsp);if(max!=i){err=1;printf("initvspksERR:3rdvecisofdifferentsize\n");}ip->vinflg=1;for(i=0;i<max&&(int)iv[i]!=ip->id;i++);if(i==max){printf("initvspksWARN:%dnotfoundinivspks\n",ip->id);ip->vinflg=0;ip->rve=-1;return(0.);}ip->rvb=ip->rvi=i;last=vsp[i++];for(;i<max&&(int)iv[i]==ip->id;i++){if(vsp[i]<=last){err=1;printf("initvspksERR:nonmonotonicforcell#%d:%g%g\n",ip->id,last,vsp[i]);}last=vsp[i];}ip->rve=i-1;if(err){ip->rve=0;hoc_execerror("",0);}}ENDVERBATIM}PROCEDUREinitjitter(){VERBATIM{intmax,i,err=0;jtpt=0;if(!ifarg(1)){printf("Returninitjitter(vec)\n");return(0.);}max=vector_arg_px(1,&jsp);if(max==0){err=1;printf("initjitterERR:vecnotinitialized\n");}for(i=0;i<max;i++)if(jsp[i]<=0){err=1;printf("initjitterERR:vecshouldbe>0:%g\n",jsp[i]);}if(err){jsp=nil;jitmax=0.;return(0.);}if(max!=jitmax){printf("WARNING:resettingjitmax_INTFto%d\n",max);jitmax=max;}}ENDVERBATIM}PROCEDUREinitinvl(){VERBATIMprintf("initinvl()NOTBEINGUSED\n");return(0.);{inti,err=0;if(!ifarg(1)){printf("Returninitinvl(vec)\n");return(0.);}invlmax=vector_arg_px(1,&invlp);if(invlmax==0){err=1;printf("initinvlERR:vecnotinitialized\n");}if(err){invlmax=-1;invlp=nil;return(0.);}}ENDVERBATIM}FUNCTIONinvlflag(){VERBATIMip=IDP;if(ip->invl==1&&invlp==nil){printf("INTFinvlflagERR:pointernotinitialized\n");hoc_execerror("",0);}_linvlflag=(double)ip->invl;ENDVERBATIM}FUNCTIONshift(vl){VERBATIMdoubleexpand,tmp,min,max;if((t<(invlt-myinvl)+myinvl/2)&&invlt!=-1){_lshift=0.;}else{expand=-(_lvl-(-65))/20;if(expand>1.)expand=1.;if(expand<-1.)expand=-1.;if(expand>0.){max=1.5*myinvl;tmp=oinvl+0.8*expand*(max-oinvl);}else{min=0.5*myinvl;tmp=oinvl+0.8*expand*(oinvl-min);}if(invlt+tmp<t+2){_lshift=0.;}else{oinvl=tmp;_lshift=invlt+oinvl;}}ENDVERBATIM}PROCEDURErecini(){VERBATIM{intk;if(SOP==nil){printf("INTFrecordERR:butpointernotinitialized\n");hoc_execerror("",0);}else{vp=SOP;vp->p=0;for(k=0;k<NSV;k++)if(vp->vvo[k]!=0)vector_resize(vp->vv[k],vp->size);}}ENDVERBATIM}PROCEDUREfini(){VERBATIM{intk;IDP->rvi=IDP->rvb;if(IDP->record){record();for(k=0;k<NSV;k++)if(vp->vvo[k]!=0){vector_resize(vp->vv[k],vp->p);}}}ENDVERBATIM}PROCEDUREchk(){VERBATIM{inti,lfg;ip=IDP;printf("ID:%d;typ:%d;rec:%dwrec:%dinp:%djit:%dinvl:%d\n",ip->id,ip->type,ip->record,ip->wrec,ip->input,ip->jitter,ip->invl);if(ifarg(1))lfg=(int)*getarg(1);elselfg=0;if(lfg==1){if(SOP!=nil){vp=SOP;printf("p%dsize%dtg%g\n",vp->p,vp->size,tg);for(i=0;i<NSV;i++)printf("%d%x%x;",i,vp->vv[i],vp->vvo[i]);}elseprintf("Recordingpointersnotinitialized");}if(lfg==2){printf("Globalvectorsforinputandjitter:\n");if(vsp!=nil)printf("VSP:%x(%d/%d-%d)\n",vsp,ip->rvi,ip->rvb,ip->rve);elseprintf("noVSP\n");if(jsp!=nil)printf("JSP:%x(%d/%d)\n",jsp,jtpt,jitmax);elseprintf("noJSP\n");}if(lfg==3){if(vsp!=nil){printf("VSP:(%d/%d-%d)\n",ip->rvi,ip->rvb,ip->rve);for(i=ip->rvb;i<=ip->rve;i++)printf("%d:%g",i,vsp[i]);printf("\n");}elseprintf("noVSP\n");}if(lfg==4){if(invlp!=nil){printf("INVLP:(%d)\n",invlmax);for(i=0;i<invlmax;i++)printf("%d:%g",i,invlp[i]);printf("\n");}elseprintf("noINVLP\n");}if(lfg==5){printf("wwpt%dwwsz%d\nWWvecs:",wwpt,wwsz);for(i=0;i<NSW;i++)printf("%d%x%x;",i,ww[i],wwo[i]);}}ENDVERBATIM}FUNCTIONpid(){VERBATIMprintf("INTF%d(%d)",IDP->id,IDP->type);_lpid=(double)IDP->id;ENDVERBATIM}FUNCTIONid(){VERBATIM_lid=(double)IDP->id;ENDVERBATIM}FUNCTIONtype(){VERBATIM_ltype=(double)IDP->type;ENDVERBATIM}PROCEDUREinitrec(){VERBATIM{inti;void*vv;name=gargstr(1);if(SOP==nil){IDP->record=1;SOP=(vpt*)ecalloc(1,sizeof(vpt));SOP->size=0;}if(IDP->record==0){recini();IDP->record=1;}vp=SOP;i=(int)varnum();if(i==-1){printf("INTFrecordERR%snotrecognized\n",name);hoc_execerror("",0);}vp->vv[i]=vector_arg(2);vector_arg_px(2,&(vp->vvo[i]));if(vp->size==0){vp->size=(unsignedint)vector_buffer_size(vp->vv[i]);}elseif(vp->size!=(unsignedint)vector_buffer_size(vp->vv[i])){printf("INTFinitrecERRvectorsnotallsamesize:%dvs%d",vp->size,vector_buffer_size(vp->vv[i]));hoc_execerror("",0);}}ENDVERBATIM}FUNCTIONvarnum(){LOCALii=-1VERBATIMif(strcmp(name,"time")==0){_li=0.;}elseif(strcmp(name,"VAM")==0){_li=1.;}elseif(strcmp(name,"VNM")==0){_li=2.;}elseif(strcmp(name,"VGA")==0){_li=3.;}elseif(strcmp(name,"VGB")==0){_li=4.;}elseif(strcmp(name,"AHP")==0){_li=5.;}elseif(strcmp(name,"V")==0){_li=6.;}elseif(strcmp(name,"VM")==0){_li=6.;}ENDVERBATIMvarnum=i}PROCEDUREvecname(){VERBATIMinti;i=(int)*getarg(1);if(i==0)printf("time\n");elseif(i==1)printf("VAM\n");elseif(i==2)printf("VNM\n");elseif(i==3)printf("VGA\n");elseif(i==4)printf("VGB\n");elseif(i==5)printf("AHP\n");elseif(i==6)printf("V\n");ENDVERBATIM}PROCEDURErebuild(){LOCALs0,w0,wwaz,ii,wflg,tmpVERBATIMintii,jj;doublei0,tstop;ip=IDP;vp=SOP;ip->record=1;ip->input=0;i0=wwo[1][0];initmodel();_lwwaz=wwaz;_lii=0.;tstop=(ifarg(1))?(*getarg(1)):0.;ENDVERBATIMWHILE(ii<wwaz){VERBATIMintii=(int)_lii;if(wwo[1][ii]!=i0){printf("ERRORwrongidat%d%gnot%g\n",ii,wwo[1][ii],i0);hoc_execerror("",0);}t=wwo[0][ii];_ls0=wwo[2][ii];_lw0=wwo[3][ii];ENDVERBATIMrecord()if(VAM>hoc_epsilon){VAM=VAM*EXP(-(t-t0)/tauAM)}else{VAM=0}if(VNM>hoc_epsilon){VNM=VNM*EXP(-(t-t0)/tauNM)}else{VNM=0}if(VGA<-hoc_epsilon){VGA=VGA*EXP(-(t-t0)/tauGA)}else{VGA=0}VGB=esinr(t-tGB)if(AHP<-hoc_epsilon){AHP=AHP*EXP(-(t-t0)/tauahp)}else{AHP=0}if(s0==0){VAM=VAM+w0}if(s0==1){VNM=VNM+w0}if(s0==2){VGA=VGA-w0}if(s0==3){offsetGB=VGBVGB=VGB-w0VGBa=VGBtGB=t}if(s0==-2){recspk(t)AHP=AHP-ahpwtVAM=VAM*AMdecVNM=VNM*NMdecVGA=VGA*GAdecVGB=VGB*GBdec}if(s0==-1){recspk(t)}t0=tii=ii+1}if(tstop>0){VERBATIMt=tstop;ENDVERBATIMrecord()}}PROCEDUREinitwrec(){VERBATIM{intk;if(!ifarg(4)){wwsz=WSZ;wf1=hoc_obj_file_arg(1);wf2=hoc_obj_file_arg(2);}elseif(!ifarg(8)){if(NSW!=4){printf("INTFinitwrecERRw-vecscompiledfor4args\n");hoc_execerror("",0);}IDP->wrec=1;for(k=0;k<NSW;k++){ww[k]=vector_arg(k+1);wwaz=vector_arg_px(k+1,&(wwo[k]));}if(wwsz==0)wwsz=(unsignedint)vector_buffer_size(ww[0]);for(k=0;k<NSW;k++)if(wwsz!=(unsignedint)vector_buffer_size(ww[k])){printf("INTFinitwrecERRw-vecssizeerr:%d,%d,%d",k,wwsz,vector_buffer_size(ww[k]));}}else{if(NSW!=8){printf("INTFinitwrecERRw-vecscompiledfor8args\n");hoc_execerror("",0);}IDP->wrec=1;for(k=0;k<NSW;k++){ww[k]=vector_arg(k+1);wwaz=vector_arg_px(k+1,&(wwo[k]));}if(wwsz==0)wwsz=(unsignedint)vector_buffer_size(ww[0]);for(k=0;k<NSW;k++)if(wwsz!=(unsignedint)vector_buffer_size(ww[k])){printf("INTFinitwrecERRw-vecssizeerr:%d,%d,%d",k,wwsz,vector_buffer_size(ww[k]));}}}ENDVERBATIM}PROCEDUREwrecord(t,s0,w0){VERBATIM{intk;doubleid=(double)IDP->id;if(wwpt>=wwsz){wwpt=0;fprintf(wf1,"fwrite(&wwt,sizeof(float),WSZ,wf2);fwrite(&wwi,sizeof(int),WSZ,wf2);fwrite(&wws,sizeof(char),WSZ,wf2);fwrite(&www,sizeof(float),WSZ,wf2);}wwt[wwpt]=(float)_lt;wwi[wwpt]=(unsignedint)IDP->id;wws[wwpt]=(char)_ls0;www[wwpt]=(float)_lw0;wwpt++;}ENDVERBATIM}FUNCTIONwrec(){VERBATIMip=IDP;if(ifarg(1))ip->wrec=(short)*getarg(1);_lwrec=(double)ip->wrec;ENDVERBATIM}FUNCTIONwwszset(){VERBATIMif(ifarg(1))wwsz=(short)*getarg(1);_lwwszset=(double)wwsz;ENDVERBATIM}FUNCTIONwwfree(){VERBATIMintk;IDP->wrec=0;wwsz=0;wwpt=0;for(k=0;k<NSW;k++){ww[k]=nil;wwo[k]=nil;}ENDVERBATIM}FUNCTIONjitter(){if(jitmax>0&&jtpt>=jitmax){jtpt=0printf("Warning,cyclingthroughjittervectoratt=%g\n",t)}if(jitmax>0){VERBATIM_ljitter=jsp[jtpt++];ENDVERBATIM}else{jitter=0}}PROCEDUREglobal_init(){VERBATIMintk;if(wwo[0]!=0){printf("Initializingglobalwwvectors\n");wwpt=0;for(k=0;k<NSW;k++)vector_resize(ww[k],wwsz);}ENDVERBATIM}PROCEDUREglobal_fini(){VERBATIM{intk;if(IDP->wrec){if(wwo[0]!=0){for(k=0;k<NSW;k++)vector_resize(ww[k],wwpt);}else{fprintf(wf1,"fwrite(&wwt,sizeof(float),wwpt,wf2);fwrite(&wwi,sizeof(int),wwpt,wf2);fwrite(&wws,sizeof(char),wwpt,wf2);fwrite(&www,sizeof(float),wwpt,wf2);printf("Closingfilewithwwpt=%datlocation%d\n",wwpt,ftell(wf2));fclose(wf1);fclose(wf2);}}else{printf("WARNING:global_fini()calledfrom%d:%dwithnowrecpointers\n",IDP->type,IDP->id);}}ENDVERBATIM}FUNCTIONfflag(){fflag=1}FUNCTIONthresh(){thresh=VTH-RMP}FUNCTIONrecflag(){VERBATIM_lrecflag=(double)IDP->record;ENDVERBATIM}FUNCTIONvinflag(){VERBATIMip=IDP;if(ip->vinflg==0&&vsp==nil){}elseif(ip->vinflg==1&&ip->rve==-1){printf("INTFvinflagERR:pointernotinitialized\n");hoc_execerror("",0);}elseif(ip->rve>=0){if(vsp==nil){printf("INTFvinflagERR1:pointernotinitialized\n");hoc_execerror("",0);}ip->rvi=ip->rvb;ip->input=1;}_lvinflag=(double)ip->vinflg;ENDVERBATIM}FUNCTIONjitset(){VERBATIMip=IDP;if(ifarg(1))ip->jitter=(short)*getarg(1);_ljitset=(double)ip->jitter;ENDVERBATIM}FUNCTIONinvlset(){VERBATIMip=IDP;if(ifarg(1))ip->invl=(short)*getarg(1);_linvlset=(double)ip->invl;ENDVERBATIM}FUNCTIONvinset(){VERBATIMip=IDP;if(ifarg(1))ip->vinflg=(short)*getarg(1);if(ip->vinflg==1){ip->input=1;ip->rvi=ip->rvb;}_lvinset=(double)ip->vinflg;ENDVERBATIM}PROCEDUREEXPo(x){TABLERESFROM-20TO0WITH5000RES=exp(x)}FUNCTIONEXP(x){EXPo(x)EXP=RES}FUNCTIONesinr(x){ESINo(PI*x/tauGB)if(x<tauGB){esinr=(VGBa-offsetGB)*ESIN+offsetGB}elseif(x>2*tauGB){esinr=0}else{esinr=rebound*VGBa*ESIN}}PROCEDUREESINo(x){TABLEESINFROM0TO2*PIWITH3000ESIN=sin(x)}PROCEDURErates(vv){TABLEBbDEPENDmgFROM-100TO50WITH300Bb=1/(1+exp(0.062(/mV)*-vv)*(mg/3.57(mM)))}PROCEDUREcoop(x){TABLEGnDEPENDGPkdFROM0TO10WITH100Gn=(x^4)/(x^4+GPkd)}