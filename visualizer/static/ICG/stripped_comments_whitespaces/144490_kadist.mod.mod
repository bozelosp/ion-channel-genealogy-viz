UNITS{(mA)=(milliamp)(mV)=(millivolt)FARADAY=(faraday)(coulomb)R=(k-mole)(joule/degC)}PARAMETER{v(mV)ek=-80(mV)celsius=24(degC)gkabar=1.0(mho/cm2)vhalfn=-1(mV)vhalfl=-56(mV)a0n=0.1(/ms)zetan=-1.8(1)zetal=3(1)gmn=0.39(1)gml=1(1)lmin=2(ms)nmin=0.1(ms)pw=-1(1)tq=-40(mV)qq=5(mV)q10=5}NEURON{SUFFIXkadUSEIONkREADekWRITEikRANGEgkabar,gka,gmaxGLOBALninf,linf,taul,taun,lmin}STATE{nl}ASSIGNED{ik(mA/cm2)ninflinftaul(ms)taun(ms)gka(mho/cm2)gmax(mho/cm2)}INITIAL{rates(v)n=ninfl=linfgka=gkabar*n*lik=gka*(v-ek)gmax=gka}BREAKPOINT{SOLVEstatesMETHODcnexpgka=gkabar*n*lik=gka*(v-ek)if(gka>gmax){gmax=gka}}FUNCTIONalpn(v(mV)){LOCALzetazeta=zetan+pw/(1+exp((v-tq)/qq))alpn=exp((1.e-3)*zeta*(v-vhalfn)*FARADAY/(R*(273.16(degC)+celsius)))}FUNCTIONbetn(v(mV)){LOCALzetazeta=zetan+pw/(1+exp((v-tq)/qq))betn=exp((1.e-3)*zeta*gmn*(v-vhalfn)*FARADAY/(R*(273.16(degC)+celsius)))}FUNCTIONalpl(v(mV)){alpl=exp((1.e-3)*zetal*(v-vhalfl)*FARADAY/(R*(273.16(degC)+celsius)))}FUNCTIONbetl(v(mV)){betl=exp((1.e-3)*zetal*gml*(v-vhalfl)*FARADAY/(R*(273.16(degC)+celsius)))}DERIVATIVEstates{rates(v)n'=(ninf-n)/taunl'=(linf-l)/taul}PROCEDURErates(v(mV)){LOCALa,qtTABLEninf,taun,linf,taulDEPENDcelsius,vhalfn,vhalfl,a0n,zetan,zetal,gmn,gml,lmin,nmin,pw,tq,qq,q10FROM-100TO100WITH200qt=q10^((celsius-24(degC))/10(degC))a=alpn(v)ninf=1/(1+a)taun=betn(v)/(qt*a0n*(1+a))if(taun<nmin){taun=nmin}a=alpl(v)linf=1/(1+a)taul=0.26(ms/mV)*(v+50(mV))if(taul<lmin){taul=lmin}}